var QX=Object.defineProperty,qX=Object.defineProperties;var $X=Object.getOwnPropertyDescriptors;var tg=Object.getOwnPropertySymbols;var eV=Object.prototype.hasOwnProperty,tV=Object.prototype.propertyIsEnumerable;var ng=(n,e,t)=>e in n?QX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,be=(n,e)=>{for(var t in e||={})eV.call(e,t)&&ng(n,t,e[t]);if(tg)for(var t of tg(e))tV.call(e,t)&&ng(n,t,e[t]);return n},Ct=(n,e)=>qX(n,$X(e));var lt=(n,e,t)=>new Promise((i,s)=>{var o=a=>{try{l(t.next(a))}catch(c){s(c)}},r=a=>{try{l(t.throw(a))}catch(c){s(c)}},l=a=>a.done?i(a.value):Promise.resolve(a.value).then(o,r);l((t=t.apply(n,e)).next())});function ig(n,e){return Object.is(n,e)}var kt=null,da=!1,Su=1,Go=Symbol("SIGNAL");function mt(n){let e=kt;return kt=n,e}function Cu(){return kt}var ua={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Wu(n){if(da)throw new Error("");if(kt===null)return;kt.consumerOnSignalRead(n);let e=kt.nextProducerIndex++;if(ma(kt),e<kt.producerNode.length&&kt.producerNode[e]!==n&&Pr(kt)){let t=kt.producerNode[e];ha(t,kt.producerIndexOfThis[e])}kt.producerNode[e]!==n&&(kt.producerNode[e]=n,kt.producerIndexOfThis[e]=Pr(kt)?ag(n,kt,e):0),kt.producerLastReadVersion[e]=n.version}function sg(){Su++}function og(n){if(!(Pr(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Su)){if(!n.producerMustRecompute(n)&&!Lu(n)){Ru(n);return}n.producerRecomputeValue(n),Ru(n)}}function xu(n){if(n.liveConsumerNode===void 0)return;let e=da;da=!0;try{for(let t of n.liveConsumerNode)t.dirty||nV(t)}finally{da=e}}function rg(){return kt?.consumerAllowSignalWrites!==!1}function nV(n){n.dirty=!0,xu(n),n.consumerMarkedDirty?.(n)}function Ru(n){n.dirty=!1,n.lastCleanEpoch=Su}function vu(n){return n&&(n.nextProducerIndex=0),mt(n)}function lg(n,e){if(mt(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Pr(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)ha(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Lu(n){ma(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(og(t),i!==t.version))return!0}return!1}function Mu(n){if(ma(n),Pr(n))for(let e=0;e<n.producerNode.length;e++)ha(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function ag(n,e,t){if(cg(n),n.liveConsumerNode.length===0&&dg(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=ag(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function ha(n,e){if(cg(n),n.liveConsumerNode.length===1&&dg(n))for(let i=0;i<n.producerNode.length;i++)ha(n.producerNode[i],n.producerIndexOfThis[i]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let i=n.liveConsumerIndexOfThis[e],s=n.liveConsumerNode[e];ma(s),s.producerIndexOfThis[i]=e}}function Pr(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function ma(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function cg(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function dg(n){return n.producerNode!==void 0}function iV(){throw new Error}var ug=iV;function sV(n){ug(n)}function Tu(n){ug=n}var oV=null;function Yu(n,e){rg()||sV(n),n.equal(n.value,e)||(n.value=e,rV(n))}var Nu=Ct(be({},ua),{equal:ig,value:void 0,kind:"signal"});function rV(n){n.version++,sg(),xu(n),oV?.()}var wu;function Er(){return wu}function xi(n){let e=wu;return wu=n,e}var pa=Symbol("NotFound");function Ne(n){return typeof n=="function"}function Xo(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ba=Xo(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,s)=>`${s+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function zr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Nt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ne(i))try{i()}catch(o){e=o instanceof ba?o.errors:[o]}let{_finalizers:s}=this;if(s){this._finalizers=null;for(let o of s)try{hg(o)}catch(r){e=e??[],r instanceof ba?e=[...e,...r.errors]:e.push(r)}}if(e)throw new ba(e)}}add(e){var t;if(e&&e!==this)if(this.closed)hg(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&zr(t,e)}remove(e){let{_finalizers:t}=this;t&&zr(t,e),e instanceof n&&e._removeParent(this)}};Nt.EMPTY=(()=>{let n=new Nt;return n.closed=!0,n})();var Hu=Nt.EMPTY;function fa(n){return n instanceof Nt||n&&"closed"in n&&Ne(n.remove)&&Ne(n.add)&&Ne(n.unsubscribe)}function hg(n){Ne(n)?n():n.unsubscribe()}var jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Vo={setTimeout(n,e,...t){let{delegate:i}=Vo;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Vo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ga(n){Vo.setTimeout(()=>{let{onUnhandledError:e}=jn;if(e)e(n);else throw n})}function Dr(){}var mg=Ku("C",void 0,void 0);function pg(n){return Ku("E",void 0,n)}function bg(n){return Ku("N",n,void 0)}function Ku(n,e,t){return{kind:n,value:e,error:t}}var Hs=null;function Ro(n){if(jn.useDeprecatedSynchronousErrorHandling){let e=!Hs;if(e&&(Hs={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Hs;if(Hs=null,t)throw i}}else n()}function fg(n){jn.useDeprecatedSynchronousErrorHandling&&Hs&&(Hs.errorThrown=!0,Hs.error=n)}var Ks=class extends Nt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,fa(e)&&e.add(this)):this.destination=fV}static create(e,t,i){return new So(e,t,i)}next(e){this.isStopped?Uu(bg(e),this):this._next(e)}error(e){this.isStopped?Uu(pg(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Uu(mg,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},pV=Function.prototype.bind;function ku(n,e){return pV.call(n,e)}var Ju=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Za(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Za(i)}else Za(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Za(t)}}},So=class extends Ks{constructor(e,t,i){super();let s;if(Ne(e)||!e)s={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&jn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),s={next:e.next&&ku(e.next,o),error:e.error&&ku(e.error,o),complete:e.complete&&ku(e.complete,o)}):s=e}this.destination=new Ju(s)}};function Za(n){jn.useDeprecatedSynchronousErrorHandling?fg(n):ga(n)}function bV(n){throw n}function Uu(n,e){let{onStoppedNotification:t}=jn;t&&Vo.setTimeout(()=>t(n,e))}var fV={closed:!0,next:Dr,error:bV,complete:Dr};var Co=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Gn(n){return n}function Au(...n){return Fu(n)}function Fu(n){return n.length===0?Gn:n.length===1?n[0]:function(t){return n.reduce((i,s)=>s(i),t)}}var bt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,s){let o=ZV(t)?t:new So(t,i,s);return Ro(()=>{let{operator:r,source:l}=this;o.add(r?r.call(o,l):l?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=gg(i),new i((s,o)=>{let r=new So({next:l=>{try{t(l)}catch(a){o(a),r.unsubscribe()}},error:o,complete:s});this.subscribe(r)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Co](){return this}pipe(...t){return Fu(t)(this)}toPromise(t){return t=gg(t),new t((i,s)=>{let o;this.subscribe(r=>o=r,r=>s(r),()=>i(o))})}}return n.create=e=>new n(e),n})();function gg(n){var e;return(e=n??jn.Promise)!==null&&e!==void 0?e:Promise}function gV(n){return n&&Ne(n.next)&&Ne(n.error)&&Ne(n.complete)}function ZV(n){return n&&n instanceof Ks||gV(n)&&fa(n)}function Bu(n){return Ne(n?.lift)}function et(n){return e=>{if(Bu(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function tt(n,e,t,i,s){return new Pu(n,e,t,i,s)}var Pu=class extends Ks{constructor(e,t,i,s,o,r){super(e),this.onFinalize=o,this.shouldUnsubscribe=r,this._next=t?function(l){try{t(l)}catch(a){e.error(a)}}:super._next,this._error=s?function(l){try{s(l)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Wo(){return et((n,e)=>{let t=null;n._refCount++;let i=tt(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let s=n._connection,o=t;t=null,s&&(!o||s===o)&&s.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var xo=class extends bt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Bu(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Nt;let t=this.getSubject();e.add(this.source.subscribe(tt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Nt.EMPTY)}return e}refCount(){return Wo()(this)}};var Zg=Xo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var jt=(()=>{class n extends bt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new ya(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Zg}next(t){Ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:s,observers:o}=this;return i||s?Hu:(this.currentObservers=null,o.push(t),new Nt(()=>{this.currentObservers=null,zr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:s,isStopped:o}=this;i?t.error(s):o&&t.complete()}asObservable(){let t=new bt;return t.source=this,t}}return n.create=(e,t)=>new ya(e,t),n})(),ya=class extends jt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Hu}};var Ot=class extends jt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var pn=new bt(n=>n.complete());function yg(n){return n&&Ne(n.schedule)}function Ig(n){return n[n.length-1]}function Gg(n){return Ne(Ig(n))?n.pop():void 0}function is(n){return yg(Ig(n))?n.pop():void 0}function Vg(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function l(d){try{c(i.next(d))}catch(u){r(u)}}function a(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(l,a)}c((i=i.apply(n,e||[])).next())})}function Xg(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ks(n){return this instanceof ks?(this.v=n,this):new ks(n)}function Rg(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",r),s[Symbol.asyncIterator]=function(){return this},s;function r(m){return function(f){return Promise.resolve(f).then(m,u)}}function l(m,f){i[m]&&(s[m]=function(g){return new Promise(function(b,p){o.push([m,g,b,p])>1||a(m,g)})},f&&(s[m]=f(s[m])))}function a(m,f){try{c(i[m](f))}catch(g){h(o[0][3],g)}}function c(m){m.value instanceof ks?Promise.resolve(m.value.v).then(d,u):h(o[0][2],m)}function d(m){a("next",m)}function u(m){a("throw",m)}function h(m,f){m(f),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Sg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Xg=="function"?Xg(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(r){return new Promise(function(l,a){r=n[o](r),s(l,a,r.done,r.value)})}}function s(o,r,l,a){Promise.resolve(a).then(function(c){o({value:c,done:l})},r)}}var Ia=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ga(n){return Ne(n?.then)}function Xa(n){return Ne(n[Co])}function Va(n){return Symbol.asyncIterator&&Ne(n?.[Symbol.asyncIterator])}function Ra(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function yV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Sa=yV();function Ca(n){return Ne(n?.[Sa])}function Wa(n){return Rg(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:s}=yield ks(t.read());if(s)return yield ks(void 0);yield yield ks(i)}}finally{t.releaseLock()}})}function xa(n){return Ne(n?.getReader)}function Et(n){if(n instanceof bt)return n;if(n!=null){if(Xa(n))return IV(n);if(Ia(n))return GV(n);if(Ga(n))return XV(n);if(Va(n))return Cg(n);if(Ca(n))return VV(n);if(xa(n))return RV(n)}throw Ra(n)}function IV(n){return new bt(e=>{let t=n[Co]();if(Ne(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function GV(n){return new bt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function XV(n){return new bt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ga)})}function VV(n){return new bt(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Cg(n){return new bt(e=>{SV(n,e).catch(t=>e.error(t))})}function RV(n){return Cg(Wa(n))}function SV(n,e){var t,i,s,o;return Vg(this,void 0,void 0,function*(){try{for(t=Sg(n);i=yield t.next(),!i.done;){let r=i.value;if(e.next(r),e.closed)return}}catch(r){s={error:r}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(s)throw s.error}}e.complete()})}function bn(n,e,t,i=0,s=!1){let o=e.schedule(function(){t(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!s)return o}function va(n,e=0){return et((t,i)=>{t.subscribe(tt(i,s=>bn(i,n,()=>i.next(s),e),()=>bn(i,n,()=>i.complete(),e),s=>bn(i,n,()=>i.error(s),e)))})}function La(n,e=0){return et((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Wg(n,e){return Et(n).pipe(La(e),va(e))}function xg(n,e){return Et(n).pipe(La(e),va(e))}function vg(n,e){return new bt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function Lg(n,e){return new bt(t=>{let i;return bn(t,e,()=>{i=n[Sa](),bn(t,e,()=>{let s,o;try{({value:s,done:o}=i.next())}catch(r){t.error(r);return}o?t.complete():t.next(s)},0,!0)}),()=>Ne(i?.return)&&i.return()})}function Ma(n,e){if(!n)throw new Error("Iterable cannot be null");return new bt(t=>{bn(t,e,()=>{let i=n[Symbol.asyncIterator]();bn(t,e,()=>{i.next().then(s=>{s.done?t.complete():t.next(s.value)})},0,!0)})})}function Mg(n,e){return Ma(Wa(n),e)}function Tg(n,e){if(n!=null){if(Xa(n))return Wg(n,e);if(Ia(n))return vg(n,e);if(Ga(n))return xg(n,e);if(Va(n))return Ma(n,e);if(Ca(n))return Lg(n,e);if(xa(n))return Mg(n,e)}throw Ra(n)}function wt(n,e){return e?Tg(n,e):Et(n)}function we(...n){let e=is(n);return wt(n,e)}function vo(n,e){let t=Ne(n)?n:()=>n,i=s=>s.error(t());return new bt(e?s=>e.schedule(i,0,s):i)}function Eu(n){return!!n&&(n instanceof bt||Ne(n.lift)&&Ne(n.subscribe))}var vi=Xo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function st(n,e){return et((t,i)=>{let s=0;t.subscribe(tt(i,o=>{i.next(n.call(e,o,s++))}))})}var{isArray:CV}=Array;function WV(n,e){return CV(e)?n(...e):n(e)}function Yg(n){return st(e=>WV(n,e))}var{isArray:xV}=Array,{getPrototypeOf:vV,prototype:LV,keys:MV}=Object;function Ng(n){if(n.length===1){let e=n[0];if(xV(e))return{args:e,keys:null};if(TV(e)){let t=MV(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function TV(n){return n&&typeof n=="object"&&vV(n)===LV}function wg(n,e){return n.reduce((t,i,s)=>(t[i]=e[s],t),{})}function Ta(...n){let e=is(n),t=Gg(n),{args:i,keys:s}=Ng(n);if(i.length===0)return wt([],e);let o=new bt(YV(i,e,s?r=>wg(s,r):Gn));return t?o.pipe(Yg(t)):o}function YV(n,e,t=Gn){return i=>{Hg(e,()=>{let{length:s}=n,o=new Array(s),r=s,l=s;for(let a=0;a<s;a++)Hg(e,()=>{let c=wt(n[a],e),d=!1;c.subscribe(tt(i,u=>{o[a]=u,d||(d=!0,l--),l||i.next(t(o.slice()))},()=>{--r||i.complete()}))},i)},i)}}function Hg(n,e,t){n?bn(t,n,e):e()}function Kg(n,e,t,i,s,o,r,l){let a=[],c=0,d=0,u=!1,h=()=>{u&&!a.length&&!c&&e.complete()},m=g=>c<i?f(g):a.push(g),f=g=>{o&&e.next(g),c++;let b=!1;Et(t(g,d++)).subscribe(tt(e,p=>{s?.(p),o?m(p):e.next(p)},()=>{b=!0},void 0,()=>{if(b)try{for(c--;a.length&&c<i;){let p=a.shift();r?bn(e,r,()=>f(p)):f(p)}h()}catch(p){e.error(p)}}))};return n.subscribe(tt(e,m,()=>{u=!0,h()})),()=>{l?.()}}function Ut(n,e,t=1/0){return Ne(e)?Ut((i,s)=>st((o,r)=>e(i,o,s,r))(Et(n(i,s))),t):(typeof e=="number"&&(t=e),et((i,s)=>Kg(i,s,n,t)))}function kg(n=1/0){return Ut(Gn,n)}function Ug(){return kg(1)}function Lo(...n){return Ug()(wt(n,is(n)))}function Ya(n){return new bt(e=>{Et(n()).subscribe(e)})}function On(n,e){return et((t,i)=>{let s=0;t.subscribe(tt(i,o=>n.call(e,o,s++)&&i.next(o)))})}function ss(n){return et((e,t)=>{let i=null,s=!1,o;i=e.subscribe(tt(t,void 0,void 0,r=>{o=Et(n(r,ss(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):s=!0})),s&&(i.unsubscribe(),i=null,o.subscribe(t))})}function Jg(n,e,t,i,s){return(o,r)=>{let l=t,a=e,c=0;o.subscribe(tt(r,d=>{let u=c++;a=l?n(a,d,u):(l=!0,d),i&&r.next(a)},s&&(()=>{l&&r.next(a),r.complete()})))}}function Mo(n,e){return Ne(e)?Ut(n,e,1):Ut(n,1)}function os(n){return et((e,t)=>{let i=!1;e.subscribe(tt(t,s=>{i=!0,t.next(s)},()=>{i||t.next(n),t.complete()}))})}function Li(n){return n<=0?()=>pn:et((e,t)=>{let i=0;e.subscribe(tt(t,s=>{++i<=n&&(t.next(s),n<=i&&t.complete())}))})}function Na(n=NV){return et((e,t)=>{let i=!1;e.subscribe(tt(t,s=>{i=!0,t.next(s)},()=>i?t.complete():t.error(n())))})}function NV(){return new vi}function _r(n){return et((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Mi(n,e){let t=arguments.length>=2;return i=>i.pipe(n?On((s,o)=>n(s,o,i)):Gn,Li(1),t?os(e):Na(()=>new vi))}function To(n){return n<=0?()=>pn:et((e,t)=>{let i=[];e.subscribe(tt(t,s=>{i.push(s),n<i.length&&i.shift()},()=>{for(let s of i)t.next(s);t.complete()},void 0,()=>{i=null}))})}function zu(n,e){let t=arguments.length>=2;return i=>i.pipe(n?On((s,o)=>n(s,o,i)):Gn,To(1),t?os(e):Na(()=>new vi))}function Du(n,e){return et(Jg(n,e,arguments.length>=2,!0))}function _u(...n){let e=is(n);return et((t,i)=>{(e?Lo(n,t,e):Lo(n,t)).subscribe(i)})}function Qn(n,e){return et((t,i)=>{let s=null,o=0,r=!1,l=()=>r&&!s&&i.complete();t.subscribe(tt(i,a=>{s?.unsubscribe();let c=0,d=o++;Et(n(a,d)).subscribe(s=tt(i,u=>i.next(e?e(a,u,d,c++):u),()=>{s=null,l()}))},()=>{r=!0,l()}))})}function ju(n){return et((e,t)=>{Et(n).subscribe(tt(t,()=>t.complete(),Dr)),!t.closed&&e.subscribe(t)})}function Qt(n,e,t){let i=Ne(n)||e||t?{next:n,error:e,complete:t}:n;return i?et((s,o)=>{var r;(r=i.subscribe)===null||r===void 0||r.call(i);let l=!0;s.subscribe(tt(o,a=>{var c;(c=i.next)===null||c===void 0||c.call(i,a),o.next(a)},()=>{var a;l=!1,(a=i.complete)===null||a===void 0||a.call(i),o.complete()},a=>{var c;l=!1,(c=i.error)===null||c===void 0||c.call(i,a),o.error(a)},()=>{var a,c;l&&((a=i.unsubscribe)===null||a===void 0||a.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):Gn}var Se=class extends Error{code;constructor(e,t){super(HV(e,t)),this.code=e}};function wV(n){return`NG0${Math.abs(n)}`}function HV(n,e){return`${wV(n)}${e?": "+e:""}`}var R0=Symbol("InputSignalNode#UNSET"),KV=Ct(be({},Nu),{transformFn:void 0,applyValueToInputSignal(n,e){Yu(n,e)}});function S0(n,e){let t=Object.create(KV);t.value=n,t.transformFn=e?.transform;function i(){if(Wu(t),t.value===R0){let s=null;throw new Se(-950,s)}return t.value}return i[Go]=t,i}function Hh(n){return{toString:n}.toString()}function yt(n){for(let e in n)if(n[e]===yt)return e;throw Error("Could not find renamed property on target object.")}function Xn(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Xn).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Ag(n,e){return n?e?`${n} ${e}`:n:e||""}var kV=yt({__forward_ref__:yt});function C0(n){return n.__forward_ref__=C0,n.toString=function(){return Xn(this())},n}function Yn(n){return W0(n)?n():n}function W0(n){return typeof n=="function"&&n.hasOwnProperty(kV)&&n.__forward_ref__===C0}function Le(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function rc(n){return Fg(n,v0)||Fg(n,L0)}function x0(n){return rc(n)!==null}function Fg(n,e){return n.hasOwnProperty(e)?n[e]:null}function UV(n){let e=n&&(n[v0]||n[L0]);return e||null}function Bg(n){return n&&(n.hasOwnProperty(Pg)||n.hasOwnProperty(JV))?n[Pg]:null}var v0=yt({\u0275prov:yt}),Pg=yt({\u0275inj:yt}),L0=yt({ngInjectableDef:yt}),JV=yt({ngInjectorDef:yt}),ve=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Le({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function M0(n){return n&&!!n.\u0275providers}var AV=yt({\u0275cmp:yt}),FV=yt({\u0275dir:yt}),BV=yt({\u0275pipe:yt}),PV=yt({\u0275mod:yt}),Ja=yt({\u0275fac:yt}),qr=yt({__NG_ELEMENT_ID__:yt}),Eg=yt({__NG_ENV_ID__:yt});function EV(n){return typeof n=="string"?n:n==null?"":String(n)}function zV(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():EV(n)}function T0(n,e){throw new Se(-200,n)}function Kh(n,e){throw new Se(-201,!1)}var Ue=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ue||{}),sh;function Y0(){return sh}function Tn(n){let e=sh;return sh=n,e}function N0(n,e,t){let i=rc(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&Ue.Optional)return null;if(e!==void 0)return e;Kh(n,"Injector")}var DV={},Us=DV,_V="__NG_DI_FLAG__",Aa=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=t;return this.injector.get(e,i.optional?pa:Us,i)}},Fa="ngTempTokenPath",jV="ngTokenPath",OV=/\n/gm,QV="\u0275",zg="__source";function qV(n,e=Ue.Default){if(Er()===void 0)throw new Se(-203,!1);if(Er()===null)return N0(n,void 0,e);{let t=Er(),i;return t instanceof Aa?i=t.injector:i=t,i.get(n,e&Ue.Optional?null:void 0,e)}}function Ee(n,e=Ue.Default){return(Y0()||qV)(Yn(n),e)}function se(n,e=Ue.Default){return Ee(n,lc(e))}function lc(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function oh(n){let e=[];for(let t=0;t<n.length;t++){let i=Yn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new Se(900,!1);let s,o=Ue.Default;for(let r=0;r<i.length;r++){let l=i[r],a=$V(l);typeof a=="number"?a===-1?s=l.token:o|=a:s=l}e.push(Ee(s,o))}else e.push(Ee(i))}return e}function $V(n){return n[_V]}function eR(n,e,t,i){let s=n[Fa];throw e[zg]&&s.unshift(e[zg]),n.message=tR(`
`+n.message,s,t,i),n[jV]=s,n[Fa]=null,n}function tR(n,e,t,i=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==QV?n.slice(2):n;let s=Xn(e);if(Array.isArray(e))s=e.map(Xn).join(" -> ");else if(typeof e=="object"){let o=[];for(let r in e)if(e.hasOwnProperty(r)){let l=e[r];o.push(r+":"+(typeof l=="string"?JSON.stringify(l):Xn(l)))}s=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${s}]: ${n.replace(OV,`
  `)}`}function Ko(n,e){let t=n.hasOwnProperty(Ja);return t?n[Ja]:null}function kh(n,e){n.forEach(t=>Array.isArray(t)?kh(t,e):e(t))}function w0(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Ba(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var ko={},Uo=[],$r=new ve(""),H0=new ve("",-1),K0=new ve(""),Pa=class{get(e,t=Us){if(t===Us){let i=new Error(`NullInjectorError: No provider for ${Xn(e)}!`);throw i.name="NullInjectorError",i}return t}};function k0(n,e){let t=n[PV]||null;if(!t&&e===!0)throw new Error(`Type ${Xn(n)} does not have '\u0275mod' property.`);return t}function Jo(n){return n[AV]||null}function nR(n){return n[FV]||null}function iR(n){return n[BV]||null}function Uh(n){return{\u0275providers:n}}function sR(...n){return{\u0275providers:U0(!0,n),\u0275fromNgModule:!0}}function U0(n,...e){let t=[],i=new Set,s,o=r=>{t.push(r)};return kh(e,r=>{let l=r;rh(l,o,[],i)&&(s||=[],s.push(l))}),s!==void 0&&J0(s,o),t}function J0(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:s}=n[t];Jh(s,o=>{e(o,i)})}}function rh(n,e,t,i){if(n=Yn(n),!n)return!1;let s=null,o=Bg(n),r=!o&&Jo(n);if(!o&&!r){let a=n.ngModule;if(o=Bg(a),o)s=a;else return!1}else{if(r&&!r.standalone)return!1;s=n}let l=i.has(s);if(r){if(l)return!1;if(i.add(s),r.dependencies){let a=typeof r.dependencies=="function"?r.dependencies():r.dependencies;for(let c of a)rh(c,e,t,i)}}else if(o){if(o.imports!=null&&!l){i.add(s);let c;try{kh(o.imports,d=>{rh(d,e,t,i)&&(c||=[],c.push(d))})}finally{}c!==void 0&&J0(c,e)}if(!l){let c=Ko(s)||(()=>new s);e({provide:s,useFactory:c,deps:Uo},s),e({provide:K0,useValue:s,multi:!0},s),e({provide:$r,useValue:()=>Ee(s),multi:!0},s)}let a=o.providers;if(a!=null&&!l){let c=n;Jh(a,d=>{e(d,c)})}}else return!1;return s!==n&&n.providers!==void 0}function Jh(n,e){for(let t of n)M0(t)&&(t=t.\u0275providers),Array.isArray(t)?Jh(t,e):e(t)}var oR=yt({provide:String,useValue:yt});function A0(n){return n!==null&&typeof n=="object"&&oR in n}function rR(n){return!!(n&&n.useExisting)}function lR(n){return!!(n&&n.useFactory)}function lh(n){return typeof n=="function"}var ac=new ve(""),wa={},Dg={},Ou;function Ah(){return Ou===void 0&&(Ou=new Pa),Ou}var Hn=class{},el=class extends Hn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,s){super(),this.parent=t,this.source=i,this.scopes=s,ch(e,r=>this.processProvider(r)),this.records.set(H0,Yo(void 0,this)),s.has("environment")&&this.records.set(Hn,Yo(void 0,this));let o=this.records.get(ac);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(K0,Uo,Ue.Self))}retrieve(e,t){let i=t;return this.get(e,i.optional?pa:Us,i)}destroy(){Or(this),this._destroyed=!0;let e=mt(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),mt(e)}}onDestroy(e){return Or(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Or(this);let t=xi(this),i=Tn(void 0),s;try{return e()}finally{xi(t),Tn(i)}}get(e,t=Us,i=Ue.Default){if(Or(this),e.hasOwnProperty(Eg))return e[Eg](this);i=lc(i);let s,o=xi(this),r=Tn(void 0);try{if(!(i&Ue.SkipSelf)){let a=this.records.get(e);if(a===void 0){let c=mR(e)&&rc(e);c&&this.injectableDefInScope(c)?a=Yo(ah(e),wa):a=null,this.records.set(e,a)}if(a!=null)return this.hydrate(e,a,i)}let l=i&Ue.Self?Ah():this.parent;return t=i&Ue.Optional&&t===Us?null:t,l.get(e,t)}catch(l){if(l.name==="NullInjectorError"){if((l[Fa]=l[Fa]||[]).unshift(Xn(e)),o)throw l;return eR(l,e,"R3InjectorError",this.source)}else throw l}finally{Tn(r),xi(o)}}resolveInjectorInitializers(){let e=mt(null),t=xi(this),i=Tn(void 0),s;try{let o=this.get($r,Uo,Ue.Self);for(let r of o)r()}finally{xi(t),Tn(i),mt(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Xn(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Yn(e);let t=lh(e)?e:Yn(e&&e.provide),i=cR(e);if(!lh(e)&&e.multi===!0){let s=this.records.get(t);s||(s=Yo(void 0,wa,!0),s.factory=()=>oh(s.multi),this.records.set(t,s)),t=e,s.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let s=mt(null);try{return t.value===Dg?T0(Xn(e)):t.value===wa&&(t.value=Dg,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&hR(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{mt(s)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Yn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function ah(n){let e=rc(n),t=e!==null?e.factory:Ko(n);if(t!==null)return t;if(n instanceof ve)throw new Se(204,!1);if(n instanceof Function)return aR(n);throw new Se(204,!1)}function aR(n){if(n.length>0)throw new Se(204,!1);let t=UV(n);return t!==null?()=>t.factory(n):()=>new n}function cR(n){if(A0(n))return Yo(void 0,n.useValue);{let e=dR(n);return Yo(e,wa)}}function dR(n,e,t){let i;if(lh(n)){let s=Yn(n);return Ko(s)||ah(s)}else if(A0(n))i=()=>Yn(n.useValue);else if(lR(n))i=()=>n.useFactory(...oh(n.deps||[]));else if(rR(n))i=(s,o)=>Ee(Yn(n.useExisting),o!==void 0&&o&Ue.Optional?Ue.Optional:void 0);else{let s=Yn(n&&(n.useClass||n.provide));if(uR(n))i=()=>new s(...oh(n.deps));else return Ko(s)||ah(s)}return i}function Or(n){if(n.destroyed)throw new Se(205,!1)}function Yo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function uR(n){return!!n.deps}function hR(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function mR(n){return typeof n=="function"||typeof n=="object"&&n instanceof ve}function ch(n,e){for(let t of n)Array.isArray(t)?ch(t,e):t&&M0(t)?ch(t.\u0275providers,e):e(t)}function ti(n,e){let t;n instanceof el?(Or(n),t=n):t=new Aa(n);let i,s=xi(t),o=Tn(void 0);try{return e()}finally{xi(s),Tn(o)}}function pR(){return Y0()!==void 0||Er()!=null}function bR(n){return typeof n=="function"}var Ti=0,rt=1,Pe=2,cn=3,$n=4,ni=5,Ea=6,_g=7,ei=8,tl=9,ls=10,bi=11,nl=12,jg=13,al=14,fi=15,il=16,No=17,cc=18,dc=19,F0=20,rs=21,Qu=22,za=23,Nn=24,qu=25,as=26,B0=1;var Fs=7,Da=8,_a=9,wn=10;function Js(n){return Array.isArray(n)&&typeof n[B0]=="object"}function Yi(n){return Array.isArray(n)&&n[B0]===!0}function P0(n){return(n.flags&4)!==0}function uc(n){return n.componentOffset>-1}function fR(n){return(n.flags&1)===1}function Ds(n){return!!n.template}function ja(n){return(n[Pe]&512)!==0}function Fo(n){return(n[Pe]&256)===256}var dh=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function E0(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var z0=(()=>{let n=()=>D0;return n.ngInherit=!0,n})();function D0(n){return n.type.prototype.ngOnChanges&&(n.setInput=ZR),gR}function gR(){let n=j0(this),e=n?.current;if(e){let t=n.previous;if(t===ko)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function ZR(n,e,t,i,s){let o=this.declaredInputs[i],r=j0(n)||yR(n,{previous:ko,current:null}),l=r.current||(r.current={}),a=r.previous,c=a[o];l[o]=new dh(c&&c.currentValue,t,a===ko),E0(n,e,s,t)}var _0="__ngSimpleChanges__";function j0(n){return n[_0]||null}function yR(n,e){return n[_0]=e}var Og=null;var Wt=function(n,e=null,t){Og?.(n,e,t)},IR="svg",GR="math";function cs(n){for(;Array.isArray(n);)n=n[Ti];return n}function _s(n,e){return cs(e[n.index])}function XR(n,e){return n.data[e]}function Bs(n,e){let t=e[n];return Js(t)?t:t[Ti]}function Fh(n){return(n[Pe]&128)===128}function VR(n){return Yi(n[cn])}function Qg(n,e){return e==null?null:n[e]}function O0(n){n[No]=0}function Q0(n){n[Pe]&1024||(n[Pe]|=1024,Fh(n)&&mc(n))}function hc(n){return!!(n[Pe]&9216||n[Nn]?.dirty)}function uh(n){n[ls].changeDetectionScheduler?.notify(8),n[Pe]&64&&(n[Pe]|=1024),hc(n)&&mc(n)}function mc(n){n[ls].changeDetectionScheduler?.notify(0);let e=Ps(n);for(;e!==null&&!(e[Pe]&8192||(e[Pe]|=8192,!Fh(e)));)e=Ps(e)}function q0(n,e){if(Fo(n))throw new Se(911,!1);n[rs]===null&&(n[rs]=[]),n[rs].push(e)}function RR(n,e){if(n[rs]===null)return;let t=n[rs].indexOf(e);t!==-1&&n[rs].splice(t,1)}function Ps(n){let e=n[cn];return Yi(e)?e[cn]:e}var ft={lFrame:oZ(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var hh=!1;function SR(){return ft.lFrame.elementDepthCount}function CR(){ft.lFrame.elementDepthCount++}function WR(){ft.lFrame.elementDepthCount--}function xR(){return ft.bindingsEnabled}function vR(){return ft.skipHydrationRootTNode!==null}function LR(n){return ft.skipHydrationRootTNode===n}function MR(){ft.skipHydrationRootTNode=null}function gi(){return ft.lFrame.lView}function Bh(){return ft.lFrame.tView}function js(){let n=$0();for(;n!==null&&n.type===64;)n=n.parent;return n}function $0(){return ft.lFrame.currentTNode}function TR(){let n=ft.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function pc(n,e){let t=ft.lFrame;t.currentTNode=n,t.isParent=e}function eZ(){return ft.lFrame.isParent}function YR(){ft.lFrame.isParent=!1}function tZ(){return hh}function qg(n){let e=hh;return hh=n,e}function NR(n){return ft.lFrame.bindingIndex=n}function wR(){return ft.lFrame.inI18n}function HR(n,e){let t=ft.lFrame;t.bindingIndex=t.bindingRootIndex=n,mh(e)}function KR(){return ft.lFrame.currentDirectiveIndex}function mh(n){ft.lFrame.currentDirectiveIndex=n}function nZ(n){ft.lFrame.currentQueryIndex=n}function kR(n){let e=n[rt];return e.type===2?e.declTNode:e.type===1?n[ni]:null}function iZ(n,e,t){if(t&Ue.SkipSelf){let s=e,o=n;for(;s=s.parent,s===null&&!(t&Ue.Host);)if(s=kR(o),s===null||(o=o[al],s.type&10))break;if(s===null)return!1;e=s,n=o}let i=ft.lFrame=sZ();return i.currentTNode=e,i.lView=n,!0}function Ph(n){let e=sZ(),t=n[rt];ft.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function sZ(){let n=ft.lFrame,e=n===null?null:n.child;return e===null?oZ(n):e}function oZ(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function rZ(){let n=ft.lFrame;return ft.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var lZ=rZ;function Eh(){let n=rZ();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function UR(){return ft.lFrame.selectedIndex}function Es(n){ft.lFrame.selectedIndex=n}function JR(){return ft.lFrame.currentNamespace}var aZ=!0;function cZ(){return aZ}function dZ(n){aZ=n}function AR(n,e,t){let{ngOnChanges:i,ngOnInit:s,ngDoCheck:o}=e.type.prototype;if(i){let r=D0(e);(t.preOrderHooks??=[]).push(n,r),(t.preOrderCheckHooks??=[]).push(n,r)}s&&(t.preOrderHooks??=[]).push(0-n,s),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function FR(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:l,ngAfterViewInit:a,ngAfterViewChecked:c,ngOnDestroy:d}=o;r&&(n.contentHooks??=[]).push(-t,r),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),a&&(n.viewHooks??=[]).push(-t,a),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Ha(n,e,t){uZ(n,e,3,t)}function Ka(n,e,t,i){(n[Pe]&3)===t&&uZ(n,e,t,i)}function $u(n,e){let t=n[Pe];(t&3)===e&&(t&=16383,t+=1,n[Pe]=t)}function uZ(n,e,t,i){let s=i!==void 0?n[No]&65535:0,o=i??-1,r=e.length-1,l=0;for(let a=s;a<r;a++)if(typeof e[a+1]=="number"){if(l=e[a],i!=null&&l>=i)break}else e[a]<0&&(n[No]+=65536),(l<o||o==-1)&&(BR(n,t,e,a),n[No]=(n[No]&4294901760)+a+2),a++}function $g(n,e){Wt(4,n,e);let t=mt(null);try{e.call(n)}finally{mt(t),Wt(5,n,e)}}function BR(n,e,t,i){let s=t[i]<0,o=t[i+1],r=s?-t[i]:t[i],l=n[r];s?n[Pe]>>14<n[No]>>16&&(n[Pe]&3)===e&&(n[Pe]+=16384,$g(l,o)):$g(l,o)}var Ho=-1,sl=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=i}};function PR(n){return(n.flags&8)!==0}function ER(n){return(n.flags&16)!==0}function zR(n,e,t){let i=0;for(;i<t.length;){let s=t[i];if(typeof s=="number"){if(s!==0)break;i++;let o=t[i++],r=t[i++],l=t[i++];n.setAttribute(e,r,l,o)}else{let o=s,r=t[++i];_R(o)?n.setProperty(e,o,r):n.setAttribute(e,o,r),i++}}return i}function DR(n){return n===3||n===4||n===6}function _R(n){return n.charCodeAt(0)===64}function hZ(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let s=e[i];typeof s=="number"?t=s:t===0||(t===-1||t===2?e0(n,t,s,null,e[++i]):e0(n,t,s,null,null))}}return n}function e0(n,e,t,i,s){let o=0,r=n.length;if(e===-1)r=-1;else for(;o<n.length;){let l=n[o++];if(typeof l=="number"){if(l===e){r=-1;break}else if(l>e){r=o-1;break}}}for(;o<n.length;){let l=n[o];if(typeof l=="number")break;if(l===t){s!==null&&(n[o+1]=s);return}o++,s!==null&&o++}r!==-1&&(n.splice(r,0,e),o=r+1),n.splice(o++,0,t),s!==null&&n.splice(o++,0,s)}function mZ(n){return n!==Ho}function Oa(n){return n&32767}function jR(n){return n>>16}function Qa(n,e){let t=jR(n),i=e;for(;t>0;)i=i[al],t--;return i}var ph=!0;function t0(n){let e=ph;return ph=n,e}var OR=256,pZ=OR-1,bZ=5,QR=0,pi={};function qR(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(qr)&&(i=t[qr]),i==null&&(i=t[qr]=QR++);let s=i&pZ,o=1<<s;e.data[n+(s>>bZ)]|=o}function fZ(n,e){let t=gZ(n,e);if(t!==-1)return t;let i=e[rt];i.firstCreatePass&&(n.injectorIndex=e.length,eh(i.data,n),eh(e,null),eh(i.blueprint,null));let s=zh(n,e),o=n.injectorIndex;if(mZ(s)){let r=Oa(s),l=Qa(s,e),a=l[rt].data;for(let c=0;c<8;c++)e[o+c]=l[r+c]|a[r+c]}return e[o+8]=s,o}function eh(n,e){n.push(0,0,0,0,0,0,0,0,e)}function gZ(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function zh(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,s=e;for(;s!==null;){if(i=XZ(s),i===null)return Ho;if(t++,s=s[al],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Ho}function $R(n,e,t){qR(n,e,t)}function ZZ(n,e,t){if(t&Ue.Optional||n!==void 0)return n;Kh(e,"NodeInjector")}function yZ(n,e,t,i){if(t&Ue.Optional&&i===void 0&&(i=null),(t&(Ue.Self|Ue.Host))===0){let s=n[tl],o=Tn(void 0);try{return s?s.get(e,i,t&Ue.Optional):N0(e,i,t&Ue.Optional)}finally{Tn(o)}}return ZZ(i,e,t)}function IZ(n,e,t,i=Ue.Default,s){if(n!==null){if(e[Pe]&2048&&!(i&Ue.Self)){let r=sS(n,e,t,i,pi);if(r!==pi)return r}let o=GZ(n,e,t,i,pi);if(o!==pi)return o}return yZ(e,t,i,s)}function GZ(n,e,t,i,s){let o=nS(t);if(typeof o=="function"){if(!iZ(e,n,i))return i&Ue.Host?ZZ(s,t,i):yZ(e,t,i,s);try{let r;if(r=o(i),r==null&&!(i&Ue.Optional))Kh(t);else return r}finally{lZ()}}else if(typeof o=="number"){let r=null,l=gZ(n,e),a=Ho,c=i&Ue.Host?e[fi][ni]:null;for((l===-1||i&Ue.SkipSelf)&&(a=l===-1?zh(n,e):e[l+8],a===Ho||!i0(i,!1)?l=-1:(r=e[rt],l=Oa(a),e=Qa(a,e)));l!==-1;){let d=e[rt];if(n0(o,l,d.data)){let u=eS(l,e,t,r,i,c);if(u!==pi)return u}a=e[l+8],a!==Ho&&i0(i,e[rt].data[l+8]===c)&&n0(o,l,e)?(r=d,l=Oa(a),e=Qa(a,e)):l=-1}}return s}function eS(n,e,t,i,s,o){let r=e[rt],l=r.data[n+8],a=i==null?uc(l)&&ph:i!=r&&(l.type&3)!==0,c=s&Ue.Host&&o===l,d=tS(l,r,t,a,c);return d!==null?bh(e,r,d,l,s):pi}function tS(n,e,t,i,s){let o=n.providerIndexes,r=e.data,l=o&1048575,a=n.directiveStart,c=n.directiveEnd,d=o>>20,u=i?l:l+d,h=s?l+d:c;for(let m=u;m<h;m++){let f=r[m];if(m<a&&t===f||m>=a&&f.type===t)return m}if(s){let m=r[a];if(m&&Ds(m)&&m.type===t)return a}return null}function bh(n,e,t,i,s){let o=n[t],r=e.data;if(o instanceof sl){let l=o;l.resolving&&T0(zV(r[t]));let a=t0(l.canSeeViewProviders);l.resolving=!0;let c,d=l.injectImpl?Tn(l.injectImpl):null,u=iZ(n,i,Ue.Default);try{o=n[t]=l.factory(void 0,s,r,n,i),e.firstCreatePass&&t>=i.directiveStart&&AR(t,r[t],e)}finally{d!==null&&Tn(d),t0(a),l.resolving=!1,lZ()}}return o}function nS(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(qr)?n[qr]:void 0;return typeof e=="number"?e>=0?e&pZ:iS:e}function n0(n,e,t){let i=1<<n;return!!(t[e+(n>>bZ)]&i)}function i0(n,e){return!(n&Ue.Self)&&!(n&Ue.Host&&e)}var As=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return IZ(this._tNode,this._lView,e,lc(i),t)}};function iS(){return new As(js(),gi())}function Dh(n){return Hh(()=>{let e=n.prototype.constructor,t=e[Ja]||fh(e),i=Object.prototype,s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==i;){let o=s[Ja]||fh(s);if(o&&o!==t)return o;s=Object.getPrototypeOf(s)}return o=>new o})}function fh(n){return W0(n)?()=>{let e=fh(Yn(n));return e&&e()}:Ko(n)}function sS(n,e,t,i,s){let o=n,r=e;for(;o!==null&&r!==null&&r[Pe]&2048&&!ja(r);){let l=GZ(o,r,t,i|Ue.Self,pi);if(l!==pi)return l;let a=o.parent;if(!a){let c=r[F0];if(c){let d=c.get(t,pi,i);if(d!==pi)return d}a=XZ(r),r=r[al]}o=a}return s}function XZ(n){let e=n[rt],t=e.type;return t===2?e.declTNode:t===1?n[ni]:null}function s0(n,e=null,t=null,i){let s=VZ(n,e,t,i);return s.resolveInjectorInitializers(),s}function VZ(n,e=null,t=null,i,s=new Set){let o=[t||Uo,sR(n)];return i=i||(typeof n=="object"?void 0:Xn(n)),new el(o,e||Ah(),i||null,s)}var ds=class n{static THROW_IF_NOT_FOUND=Us;static NULL=new Pa;static create(e,t){if(Array.isArray(e))return s0({name:""},t,e,"");{let i=e.name??"";return s0({name:i},e.parent,e.providers,i)}}static \u0275prov=Le({token:n,providedIn:"any",factory:()=>Ee(H0)});static __NG_ELEMENT_ID__=-1};var oS=new ve("");oS.__NG_ELEMENT_ID__=n=>{let e=js();if(e===null)throw new Se(204,!1);if(e.type&2)return e.value;if(n&Ue.Optional)return null;throw new Se(204,!1)};var RZ=!1,bc=(()=>{class n{static __NG_ELEMENT_ID__=rS;static __NG_ENV_ID__=t=>t}return n})(),gh=class extends bc{_lView;constructor(e){super(),this._lView=e}onDestroy(e){let t=this._lView;return Fo(t)?(e(),()=>{}):(q0(t,e),()=>RR(t,e))}};function rS(){return new gh(gi())}var ol=class{},_h=new ve("",{providedIn:"root",factory:()=>!1});var SZ=new ve(""),CZ=new ve(""),Bo=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Ot(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Le({token:n,providedIn:"root",factory:()=>new n})}return n})();var Zh=class extends jt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,pR()&&(this.destroyRef=se(bc,{optional:!0})??void 0,this.pendingTasks=se(Bo,{optional:!0})??void 0)}emit(e){let t=mt(null);try{super.next(e)}finally{mt(t)}}subscribe(e,t,i){let s=e,o=t||(()=>null),r=i;if(e&&typeof e=="object"){let a=e;s=a.next?.bind(a),o=a.error?.bind(a),r=a.complete?.bind(a)}this.__isAsync&&(o=this.wrapInTimeout(o),s&&(s=this.wrapInTimeout(s)),r&&(r=this.wrapInTimeout(r)));let l=super.subscribe({next:s,error:o,complete:r});return e instanceof Nt&&e.add(l),l}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},fn=Zh;function qa(...n){}function WZ(n){let e,t;function i(){n=qa;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function o0(n){return queueMicrotask(()=>n()),()=>{n=qa}}var jh="isAngularZone",$a=jh+"_ID",lS=0,zt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new fn(!1);onMicrotaskEmpty=new fn(!1);onStable=new fn(!1);onError=new fn(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:s=!1,scheduleInRootZone:o=RZ}=e;if(typeof Zone>"u")throw new Se(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!s&&i,r.shouldCoalesceRunChangeDetection=s,r.callbackScheduled=!1,r.scheduleInRootZone=o,dS(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(jh)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Se(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Se(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,s){let o=this._inner,r=o.scheduleEventTask("NgZoneEvent: "+s,e,aS,qa,qa);try{return o.runTask(r,t,i)}finally{o.cancelTask(r)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},aS={};function Oh(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function cS(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){WZ(()=>{n.callbackScheduled=!1,yh(n),n.isCheckStableRunning=!0,Oh(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),yh(n)}function dS(n){let e=()=>{cS(n)},t=lS++;n._inner=n._inner.fork({name:"angular",properties:{[jh]:!0,[$a]:t,[$a+t]:!0},onInvokeTask:(i,s,o,r,l,a)=>{if(uS(a))return i.invokeTask(o,r,l,a);try{return r0(n),i.invokeTask(o,r,l,a)}finally{(n.shouldCoalesceEventChangeDetection&&r.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),l0(n)}},onInvoke:(i,s,o,r,l,a,c)=>{try{return r0(n),i.invoke(o,r,l,a,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!hS(a)&&e(),l0(n)}},onHasTask:(i,s,o,r)=>{i.hasTask(o,r),s===o&&(r.change=="microTask"?(n._hasPendingMicrotasks=r.microTask,yh(n),Oh(n)):r.change=="macroTask"&&(n.hasPendingMacrotasks=r.macroTask))},onHandleError:(i,s,o,r)=>(i.handleError(o,r),n.runOutsideAngular(()=>n.onError.emit(r)),!1)})}function yh(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function r0(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function l0(n){n._nesting--,Oh(n)}var Ih=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new fn;onMicrotaskEmpty=new fn;onStable=new fn;onError=new fn;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,s){return e.apply(t,i)}};function uS(n){return xZ(n,"__ignore_ng_zone__")}function hS(n){return xZ(n,"__scheduler_tick__")}function xZ(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var us=class{_console=console;handleError(e){this._console.error("ERROR",e)}},mS=new ve("",{providedIn:"root",factory:()=>{let n=se(zt),e=se(us);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function a0(n,e){return S0(n,e)}function pS(n){return S0(R0,n)}var vZ=(a0.required=pS,a0);function bS(){return Qh(js(),gi())}function Qh(n,e){return new fS(_s(n,e))}var fS=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=bS}return n})();function LZ(n){return(n.flags&128)===128}var MZ=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(MZ||{}),TZ=new Map,gS=0;function ZS(){return gS++}function yS(n){TZ.set(n[dc],n)}function Gh(n){TZ.delete(n[dc])}var c0="__ngContext__";function fc(n,e){Js(e)?(n[c0]=e[dc],yS(e)):n[c0]=e}function YZ(n){return wZ(n[nl])}function NZ(n){return wZ(n[$n])}function wZ(n){for(;n!==null&&!Yi(n);)n=n[$n];return n}var Xh;function HZ(n){Xh=n}function IS(){if(Xh!==void 0)return Xh;if(typeof document<"u")return document;throw new Se(210,!1)}var qh=new ve("",{providedIn:"root",factory:()=>GS}),GS="ng",$h=new ve(""),cl=new ve("",{providedIn:"platform",factory:()=>"unknown"});var em=new ve("",{providedIn:"root",factory:()=>IS().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var XS="h",VS="b";var KZ=!1,RS=new ve("",{providedIn:"root",factory:()=>KZ});var kZ=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(kZ||{}),gc=new ve(""),d0=new Set;function tm(n){d0.has(n)||(d0.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var SS=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Le({token:n,providedIn:"root",factory:()=>new n})}return n})();var CS=()=>null;function UZ(n,e,t=!1){return CS(n,e,t)}function JZ(n,e){let t=n.contentQueries;if(t!==null){let i=mt(null);try{for(let s=0;s<t.length;s+=2){let o=t[s],r=t[s+1];if(r!==-1){let l=n.data[r];nZ(o),l.contentQueries(2,e[r],r)}}}finally{mt(i)}}}function Vh(n,e,t){nZ(0);let i=mt(null);try{e(n,t)}finally{mt(i)}}function AZ(n,e,t){if(P0(e)){let i=mt(null);try{let s=e.directiveStart,o=e.directiveEnd;for(let r=s;r<o;r++){let l=n.data[r];if(l.contentQueries){let a=t[r];l.contentQueries(1,a,r)}}}finally{mt(i)}}}var Zi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Zi||{});function FZ(n){return n instanceof Function?n():n}function WS(n,e,t){let i=n.length;for(;;){let s=n.indexOf(e,t);if(s===-1)return s;if(s===0||n.charCodeAt(s-1)<=32){let o=e.length;if(s+o===i||n.charCodeAt(s+o)<=32)return s}t=s+1}}var BZ="ng-template";function xS(n,e,t,i){let s=0;if(i){for(;s<e.length&&typeof e[s]=="string";s+=2)if(e[s]==="class"&&WS(e[s+1].toLowerCase(),t,0)!==-1)return!0}else if(nm(n))return!1;if(s=e.indexOf(1,s),s>-1){let o;for(;++s<e.length&&typeof(o=e[s])=="string";)if(o.toLowerCase()===t)return!0}return!1}function nm(n){return n.type===4&&n.value!==BZ}function vS(n,e,t){let i=n.type===4&&!t?BZ:n.value;return e===i}function LS(n,e,t){let i=4,s=n.attrs,o=s!==null?YS(s):0,r=!1;for(let l=0;l<e.length;l++){let a=e[l];if(typeof a=="number"){if(!r&&!qn(i)&&!qn(a))return!1;if(r&&qn(a))continue;r=!1,i=a|i&1;continue}if(!r)if(i&4){if(i=2|i&1,a!==""&&!vS(n,a,t)||a===""&&e.length===1){if(qn(i))return!1;r=!0}}else if(i&8){if(s===null||!xS(n,s,a,t)){if(qn(i))return!1;r=!0}}else{let c=e[++l],d=MS(a,s,nm(n),t);if(d===-1){if(qn(i))return!1;r=!0;continue}if(c!==""){let u;if(d>o?u="":u=s[d+1].toLowerCase(),i&2&&c!==u){if(qn(i))return!1;r=!0}}}}return qn(i)||r}function qn(n){return(n&1)===0}function MS(n,e,t,i){if(e===null)return-1;let s=0;if(i||!t){let o=!1;for(;s<e.length;){let r=e[s];if(r===n)return s;if(r===3||r===6)o=!0;else if(r===1||r===2){let l=e[++s];for(;typeof l=="string";)l=e[++s];continue}else{if(r===4)break;if(r===0){s+=4;continue}}s+=o?1:2}return-1}else return NS(e,n)}function TS(n,e,t=!1){for(let i=0;i<e.length;i++)if(LS(n,e[i],t))return!0;return!1}function YS(n){for(let e=0;e<n.length;e++){let t=n[e];if(DR(t))return e}return n.length}function NS(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function u0(n,e){return n?":not("+e.trim()+")":e}function wS(n){let e=n[0],t=1,i=2,s="",o=!1;for(;t<n.length;){let r=n[t];if(typeof r=="string")if(i&2){let l=n[++t];s+="["+r+(l.length>0?'="'+l+'"':"")+"]"}else i&8?s+="."+r:i&4&&(s+=" "+r);else s!==""&&!qn(r)&&(e+=u0(o,s),s=""),i=r,o=o||!qn(i);t++}return s!==""&&(e+=u0(o,s)),e}function HS(n){return n.map(wS).join(",")}function KS(n){let e=[],t=[],i=1,s=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")s===2?o!==""&&e.push(o,n[++i]):s===8&&t.push(o);else{if(!qn(s))break;s=o}i++}return t.length&&e.push(1,...t),e}var PZ={};function kS(n,e){return n.createText(e)}function EZ(n,e,t){return n.createElement(e,t)}function ec(n,e,t,i,s){n.insertBefore(e,t,i,s)}function zZ(n,e,t){n.appendChild(e,t)}function h0(n,e,t,i,s){i!==null?ec(n,e,t,i,s):zZ(n,e,t)}function US(n,e,t){n.removeChild(null,e,t)}function JS(n,e,t){n.setAttribute(e,"style",t)}function AS(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function DZ(n,e,t){let{mergedAttrs:i,classes:s,styles:o}=t;i!==null&&zR(n,e,i),s!==null&&AS(n,e,s),o!==null&&JS(n,e,o)}function _Z(n,e,t,i,s,o,r,l,a,c,d){let u=as+i,h=u+s,m=FS(u,h),f=typeof c=="function"?c():c;return m[rt]={type:n,blueprint:m,template:t,queries:null,viewQuery:l,declTNode:e,data:m.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof r=="function"?r():r,firstChild:null,schemas:a,consts:f,incompleteFirstPass:!1,ssrId:d}}function FS(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:PZ);return t}function BS(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=_Z(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function jZ(n,e,t,i,s,o,r,l,a,c,d){let u=e.blueprint.slice();return u[Ti]=s,u[Pe]=i|4|128|8|64|1024,(c!==null||n&&n[Pe]&2048)&&(u[Pe]|=2048),O0(u),u[cn]=u[al]=n,u[ei]=t,u[ls]=r||n&&n[ls],u[bi]=l||n&&n[bi],u[tl]=a||n&&n[tl]||null,u[ni]=o,u[dc]=ZS(),u[Ea]=d,u[F0]=c,u[fi]=e.type==2?n[fi]:u,u}function PS(n,e,t){let i=_s(e,n),s=BS(t),o=n[ls].rendererFactory,r=qZ(n,jZ(n,s,null,OZ(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=r}function OZ(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function QZ(n,e,t,i){if(t===0)return-1;let s=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return s}function qZ(n,e){return n[nl]?n[jg][$n]=e:n[nl]=e,n[jg]=e,e}function ES(n,e,t,i){if(!i)if((e[Pe]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Ha(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Ka(e,o,0,t)}Es(t)}var Zc=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Zc||{});function Rh(n,e,t,i){let s=mt(null);try{let[o,r,l]=n.inputs[t],a=null;(r&Zc.SignalBased)!==0&&(a=e[o][Go]),a!==null&&a.transformFn!==void 0?i=a.transformFn(i):l!==null&&(i=l.call(e,i)),n.setInput!==null?n.setInput(e,a,i,t,o):E0(e,a,o,i)}finally{mt(s)}}function $Z(n,e,t,i,s){let o=UR(),r=i&2;try{Es(-1),r&&e.length>as&&ES(n,e,as,!1),Wt(r?2:0,s),t(i,s)}finally{Es(o),Wt(r?3:1,s)}}function ey(n,e,t){OS(n,e,t),(t.flags&64)===64&&QS(n,e,t)}function zS(n,e,t=_s){let i=e.localNames;if(i!==null){let s=e.index+1;for(let o=0;o<i.length;o+=2){let r=i[o+1],l=r===-1?t(e,n):n[r];n[s++]=l}}}function DS(n,e,t,i){let o=i.get(RS,KZ)||t===Zi.ShadowDom,r=n.selectRootElement(e,o);return _S(r),r}function _S(n){jS(n)}var jS=()=>null;function OS(n,e,t){let i=t.directiveStart,s=t.directiveEnd;uc(t)&&PS(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||fZ(t,e);let o=t.initialInputs;for(let r=i;r<s;r++){let l=n.data[r],a=bh(e,n,r,t);if(fc(a,e),o!==null&&eC(e,r-i,a,l,t,o),Ds(l)){let c=Bs(t.index,e);c[ei]=bh(e,n,r,t)}}}function QS(n,e,t){let i=t.directiveStart,s=t.directiveEnd,o=t.index,r=KR();try{Es(o);for(let l=i;l<s;l++){let a=n.data[l],c=e[l];mh(l),(a.hostBindings!==null||a.hostVars!==0||a.hostAttrs!==null)&&qS(a,c)}}finally{Es(-1),mh(r)}}function qS(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function $S(n,e){let t=n.directiveRegistry,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];TS(e,o.selectors,!1)&&(i??=[],Ds(o)?i.unshift(o):i.push(o))}return i}function eC(n,e,t,i,s,o){let r=o[e];if(r!==null)for(let l=0;l<r.length;l+=2){let a=r[l],c=r[l+1];Rh(i,t,a,c)}}function tC(n,e){let t=n[tl],i=t?t.get(us,null):null;i&&i.handleError(e)}function ty(n,e,t,i,s){let o=n.inputs?.[i],r=n.hostDirectiveInputs?.[i],l=!1;if(r)for(let a=0;a<r.length;a+=2){let c=r[a],d=r[a+1],u=e.data[c];Rh(u,t[c],d,s),l=!0}if(o)for(let a of o){let c=t[a],d=e.data[a];Rh(d,c,i,s),l=!0}return l}function nC(n,e){let t=Bs(e,n),i=t[rt];iC(i,t);let s=t[Ti];s!==null&&t[Ea]===null&&(t[Ea]=UZ(s,t[tl])),Wt(18),ny(i,t,t[ei]),Wt(19,t[ei])}function iC(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ny(n,e,t){Ph(e);try{let i=n.viewQuery;i!==null&&Vh(1,i,t);let s=n.template;s!==null&&$Z(n,e,s,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[cc]?.finishViewCreation(n),n.staticContentQueries&&JZ(n,e),n.staticViewQueries&&Vh(2,n.viewQuery,t);let o=n.components;o!==null&&sC(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Pe]&=-5,Eh()}}function sC(n,e){for(let t=0;t<e.length;t++)nC(n,e[t])}function m0(n,e){return!e||e.firstChild===null||LZ(n)}var oC;function im(n,e){return oC(n,e)}var Po=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Po||{});function iy(n){return(n.flags&32)===32}function wo(n,e,t,i,s){if(i!=null){let o,r=!1;Yi(i)?o=i:Js(i)&&(r=!0,i=i[Ti]);let l=cs(i);n===0&&t!==null?s==null?zZ(e,t,l):ec(e,t,l,s||null,!0):n===1&&t!==null?ec(e,t,l,s||null,!0):n===2?US(e,l,r):n===3&&e.destroyNode(l),o!=null&&gC(e,n,o,t,s)}}function rC(n,e){sy(n,e),e[Ti]=null,e[ni]=null}function lC(n,e,t,i,s,o){i[Ti]=s,i[ni]=e,yc(n,i,t,1,s,o)}function sy(n,e){e[ls].changeDetectionScheduler?.notify(9),yc(n,e,e[bi],2,null,null)}function aC(n){let e=n[nl];if(!e)return th(n[rt],n);for(;e;){let t=null;if(Js(e))t=e[nl];else{let i=e[wn];i&&(t=i)}if(!t){for(;e&&!e[$n]&&e!==n;)Js(e)&&th(e[rt],e),e=e[cn];e===null&&(e=n),Js(e)&&th(e[rt],e),t=e&&e[$n]}e=t}}function sm(n,e){let t=n[_a],i=t.indexOf(e);t.splice(i,1)}function oy(n,e){if(Fo(e))return;let t=e[bi];t.destroyNode&&yc(n,e,t,3,null,null),aC(e)}function th(n,e){if(Fo(e))return;let t=mt(null);try{e[Pe]&=-129,e[Pe]|=256,e[Nn]&&Mu(e[Nn]),dC(n,e),cC(n,e),e[rt].type===1&&e[bi].destroy();let i=e[il];if(i!==null&&Yi(e[cn])){i!==e[cn]&&sm(i,e);let s=e[cc];s!==null&&s.detachView(n)}Gh(e)}finally{mt(t)}}function cC(n,e){let t=n.cleanup,i=e[_g];if(t!==null)for(let r=0;r<t.length-1;r+=2)if(typeof t[r]=="string"){let l=t[r+3];l>=0?i[l]():i[-l].unsubscribe(),r+=2}else{let l=i[t[r+1]];t[r].call(l)}i!==null&&(e[_g]=null);let s=e[rs];if(s!==null){e[rs]=null;for(let r=0;r<s.length;r++){let l=s[r];l()}}let o=e[za];if(o!==null){e[za]=null;for(let r of o)r.destroy()}}function dC(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let s=e[t[i]];if(!(s instanceof sl)){let o=t[i+1];if(Array.isArray(o))for(let r=0;r<o.length;r+=2){let l=s[o[r]],a=o[r+1];Wt(4,l,a);try{a.call(l)}finally{Wt(5,l,a)}}else{Wt(4,s,o);try{o.call(s)}finally{Wt(5,s,o)}}}}}function uC(n,e,t){return hC(n,e.parent,t)}function hC(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Ti];if(uc(i)){let{encapsulation:s}=n.data[i.directiveStart+i.componentOffset];if(s===Zi.None||s===Zi.Emulated)return null}return _s(i,t)}function mC(n,e,t){return bC(n,e,t)}function pC(n,e,t){return n.type&40?_s(n,t):null}var bC=pC,p0;function ry(n,e,t,i){let s=uC(n,i,e),o=e[bi],r=i.parent||e[ni],l=mC(r,i,e);if(s!=null)if(Array.isArray(t))for(let a=0;a<t.length;a++)h0(o,s,t[a],l,!1);else h0(o,s,t,l,!1);p0!==void 0&&p0(o,i,e,t,s)}function Qr(n,e){if(e!==null){let t=e.type;if(t&3)return _s(e,n);if(t&4)return Sh(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return Qr(n,i);{let s=n[e.index];return Yi(s)?Sh(-1,s):cs(s)}}else{if(t&128)return Qr(n,e.next);if(t&32)return im(e,n)()||cs(n[e.index]);{let i=ly(n,e);if(i!==null){if(Array.isArray(i))return i[0];let s=Ps(n[fi]);return Qr(s,i)}else return Qr(n,e.next)}}}return null}function ly(n,e){if(e!==null){let i=n[fi][ni],s=e.projection;return i.projection[s]}return null}function Sh(n,e){let t=wn+n+1;if(t<e.length){let i=e[t],s=i[rt].firstChild;if(s!==null)return Qr(i,s)}return e[Fs]}function om(n,e,t,i,s,o,r){for(;t!=null;){if(t.type===128){t=t.next;continue}let l=i[t.index],a=t.type;if(r&&e===0&&(l&&fc(cs(l),i),t.flags|=2),!iy(t))if(a&8)om(n,e,t.child,i,s,o,!1),wo(e,n,s,l,o);else if(a&32){let c=im(t,i),d;for(;d=c();)wo(e,n,s,d,o);wo(e,n,s,l,o)}else a&16?fC(n,e,i,t,s,o):wo(e,n,s,l,o);t=r?t.projectionNext:t.next}}function yc(n,e,t,i,s,o){om(t,i,n.firstChild,e,s,o,!1)}function fC(n,e,t,i,s,o){let r=t[fi],a=r[ni].projection[i.projection];if(Array.isArray(a))for(let c=0;c<a.length;c++){let d=a[c];wo(e,n,s,d,o)}else{let c=a,d=r[cn];LZ(i)&&(c.flags|=128),om(n,e,c,d,s,o,!0)}}function gC(n,e,t,i,s){let o=t[Fs],r=cs(t);o!==r&&wo(e,n,i,o,s);for(let l=wn;l<t.length;l++){let a=t[l];yc(a[rt],a,n,e,i,o)}}function tc(n,e,t,i,s=!1){for(;t!==null;){if(t.type===128){t=s?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(cs(o)),Yi(o)&&ZC(o,i);let r=t.type;if(r&8)tc(n,e,t.child,i);else if(r&32){let l=im(t,e),a;for(;a=l();)i.push(a)}else if(r&16){let l=ly(e,t);if(Array.isArray(l))i.push(...l);else{let a=Ps(e[fi]);tc(a[rt],a,l,i,!0)}}t=s?t.projectionNext:t.next}return i}function ZC(n,e){for(let t=wn;t<n.length;t++){let i=n[t],s=i[rt].firstChild;s!==null&&tc(i[rt],i,s,e)}n[Fs]!==n[Ti]&&e.push(n[Fs])}function ay(n){if(n[qu]!==null){for(let e of n[qu])e.impl.addSequence(e);n[qu].length=0}}var cy=[];function yC(n){return n[Nn]??IC(n)}function IC(n){let e=cy.pop()??Object.create(XC);return e.lView=n,e}function GC(n){n.lView[Nn]!==n&&(n.lView=null,cy.push(n))}var XC=Ct(be({},ua),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{mc(n.lView)},consumerOnSignalRead(){this.lView[Nn]=this}});function VC(n){let e=n[Nn]??Object.create(RC);return e.lView=n,e}var RC=Ct(be({},ua),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Ps(n.lView);for(;e&&!dy(e[rt]);)e=Ps(e);e&&Q0(e)},consumerOnSignalRead(){this.lView[Nn]=this}});function dy(n){return n.type!==2}function uy(n){if(n[za]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[za])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[Pe]&8192)}}var SC=100;function hy(n,e=!0,t=0){let s=n[ls].rendererFactory,o=!1;o||s.begin?.();try{CC(n,t)}catch(r){throw e&&tC(n,r),r}finally{o||s.end?.()}}function CC(n,e){let t=tZ();try{qg(!0),Ch(n,e);let i=0;for(;hc(n);){if(i===SC)throw new Se(103,!1);i++,Ch(n,1)}}finally{qg(t)}}function WC(n,e,t,i){if(Fo(e))return;let s=e[Pe],o=!1,r=!1;Ph(e);let l=!0,a=null,c=null;o||(dy(n)?(c=yC(e),a=vu(c)):Cu()===null?(l=!1,c=VC(e),a=vu(c)):e[Nn]&&(Mu(e[Nn]),e[Nn]=null));try{O0(e),NR(n.bindingStartIndex),t!==null&&$Z(n,e,t,2,i);let d=(s&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&Ha(e,m,null)}else{let m=n.preOrderHooks;m!==null&&Ka(e,m,0,null),$u(e,0)}if(r||xC(e),uy(e),my(e,0),n.contentQueries!==null&&JZ(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&Ha(e,m)}else{let m=n.contentHooks;m!==null&&Ka(e,m,1),$u(e,1)}LC(n,e);let u=n.components;u!==null&&by(e,u,0);let h=n.viewQuery;if(h!==null&&Vh(2,h,i),!o)if(d){let m=n.viewCheckHooks;m!==null&&Ha(e,m)}else{let m=n.viewHooks;m!==null&&Ka(e,m,2),$u(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Qu]){for(let m of e[Qu])m();e[Qu]=null}o||(ay(e),e[Pe]&=-73)}catch(d){throw o||mc(e),d}finally{c!==null&&(lg(c,a),l&&GC(c)),Eh()}}function my(n,e){for(let t=YZ(n);t!==null;t=NZ(t))for(let i=wn;i<t.length;i++){let s=t[i];py(s,e)}}function xC(n){for(let e=YZ(n);e!==null;e=NZ(e)){if(!(e[Pe]&2))continue;let t=e[_a];for(let i=0;i<t.length;i++){let s=t[i];Q0(s)}}}function vC(n,e,t){Wt(18);let i=Bs(e,n);py(i,t),Wt(19,i[ei])}function py(n,e){Fh(n)&&Ch(n,e)}function Ch(n,e){let i=n[rt],s=n[Pe],o=n[Nn],r=!!(e===0&&s&16);if(r||=!!(s&64&&e===0),r||=!!(s&1024),r||=!!(o?.dirty&&Lu(o)),r||=!1,o&&(o.dirty=!1),n[Pe]&=-9217,r)WC(i,n,i.template,n[ei]);else if(s&8192){uy(n),my(n,1);let l=i.components;l!==null&&by(n,l,1),ay(n)}}function by(n,e,t){for(let i=0;i<e.length;i++)vC(n,e[i],t)}function LC(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let s=t[i];if(s<0)Es(~s);else{let o=s,r=t[++i],l=t[++i];HR(r,o);let a=e[o];Wt(24,a),l(2,a),Wt(25,a)}}}finally{Es(-1)}}function fy(n,e){let t=tZ()?64:1088;for(n[ls].changeDetectionScheduler?.notify(e);n;){n[Pe]|=t;let i=Ps(n);if(ja(n)&&!i)return n;n=i}return null}function MC(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function TC(n,e,t,i=!0){let s=e[rt];if(YC(s,e,n,t),i){let r=Sh(t,n),l=e[bi],a=l.parentNode(n[Fs]);a!==null&&lC(s,n[ni],l,e,a,r)}let o=e[Ea];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Wh(n,e){if(n.length<=wn)return;let t=wn+e,i=n[t];if(i){let s=i[il];s!==null&&s!==n&&sm(s,i),e>0&&(n[t-1][$n]=i[$n]);let o=Ba(n,wn+e);rC(i[rt],i);let r=o[cc];r!==null&&r.detachView(o[rt]),i[cn]=null,i[$n]=null,i[Pe]&=-129}return i}function YC(n,e,t,i){let s=wn+i,o=t.length;i>0&&(t[s-1][$n]=e),i<o-wn?(e[$n]=t[s],w0(t,wn+i,e)):(t.push(e),e[$n]=null),e[cn]=t;let r=e[il];r!==null&&t!==r&&gy(r,e);let l=e[cc];l!==null&&l.insertView(n),uh(e),e[Pe]|=128}function gy(n,e){let t=n[_a],i=e[cn];if(Js(i))n[Pe]|=2;else{let s=i[cn][fi];e[fi]!==s&&(n[Pe]|=2)}t===null?n[_a]=[e]:t.push(e)}var nc=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[rt];return tc(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i}get context(){return this._lView[ei]}set context(e){this._lView[ei]=e}get destroyed(){return Fo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[cn];if(Yi(e)){let t=e[Da],i=t?t.indexOf(this):-1;i>-1&&(Wh(e,i),Ba(t,i))}this._attachedToViewContainer=!1}oy(this._lView[rt],this._lView)}onDestroy(e){q0(this._lView,e)}markForCheck(){fy(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Pe]&=-129}reattach(){uh(this._lView),this._lView[Pe]|=128}detectChanges(){this._lView[Pe]|=1024,hy(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ja(this._lView),t=this._lView[il];t!==null&&!e&&sm(t,this._lView),sy(this._lView[rt],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Se(902,!1);this._appRef=e;let t=ja(this._lView),i=this._lView[il];i!==null&&!t&&gy(i,this._lView),uh(this._lView)}};function Zy(n,e,t,i,s){let o=n.data[e];if(o===null)o=NC(n,e,t,i,s),wR()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=s;let r=TR();o.injectorIndex=r===null?-1:r.injectorIndex}return pc(o,!0),o}function NC(n,e,t,i,s){let o=$0(),r=eZ(),l=r?o:o&&o.parent,a=n.data[e]=HC(n,l,t,e,i,s);return wC(n,a,o,r),a}function wC(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function HC(n,e,t,i,s,o){let r=e?e.injectorIndex:-1,l=0;return vR()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:r,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:s,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Xk=new RegExp(`^(\\d+)*(${VS}|${XS})*(.*)`);var KC=()=>null;function b0(n,e){return KC(n,e)}var kC=class{},yy=class{},xh=class{resolveComponentFactory(e){throw Error(`No component factory found for ${Xn(e)}.`)}},Ic=class{static NULL=new xh},Ao=class{};var UC=(()=>{class n{static \u0275prov=Le({token:n,providedIn:"root",factory:()=>null})}return n})();var nh={},vh=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=lc(i);let s=this.injector.get(e,nh,i);return s!==nh||t===nh?s:this.parentInjector.get(e,t,i)}};function f0(n,e,t){let i=t?n.styles:null,s=t?n.classes:null,o=0;if(e!==null)for(let r=0;r<e.length;r++){let l=e[r];if(typeof l=="number")o=l;else if(o==1)s=Ag(s,l);else if(o==2){let a=l,c=e[++r];i=Ag(i,a+": "+c+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=s:n.classesWithoutHost=s}function JC(n,e=Ue.Default){let t=gi();if(t===null)return Ee(n,e);let i=js();return IZ(i,t,Yn(n),e)}function AC(n,e,t,i,s){let o=i===null?null:{"":-1},r=s(n,t);if(r!==null){let l,a=null,c=null,d=BC(r);d===null?l=r:[l,a,c]=d,zC(n,e,t,l,o,a,c)}o!==null&&i!==null&&FC(t,i,o)}function FC(n,e,t){let i=n.localNames=[];for(let s=0;s<e.length;s+=2){let o=t[e[s+1]];if(o==null)throw new Se(-301,!1);i.push(e[s],o)}}function BC(n){let e=null,t=!1;for(let r=0;r<n.length;r++){let l=n[r];if(r===0&&Ds(l)&&(e=l),l.findHostDirectiveDefs!==null){t=!0;break}}if(!t)return null;let i=null,s=null,o=null;for(let r of n)r.findHostDirectiveDefs!==null&&(i??=[],s??=new Map,o??=new Map,PC(r,i,o,s)),r===e&&(i??=[],i.push(r));return i!==null?(i.push(...e===null?n:n.slice(1)),[i,s,o]):null}function PC(n,e,t,i){let s=e.length;n.findHostDirectiveDefs(n,e,i),t.set(n,[s,e.length-1])}function EC(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function zC(n,e,t,i,s,o,r){let l=i.length,a=!1;for(let h=0;h<l;h++){let m=i[h];!a&&Ds(m)&&(a=!0,EC(n,t,h)),$R(fZ(t,e),n,m.type)}qC(t,n.data.length,l);for(let h=0;h<l;h++){let m=i[h];m.providersResolver&&m.providersResolver(m)}let c=!1,d=!1,u=QZ(n,e,l,null);l>0&&(t.directiveToIndex=new Map);for(let h=0;h<l;h++){let m=i[h];if(t.mergedAttrs=hZ(t.mergedAttrs,m.hostAttrs),_C(n,t,e,u,m),QC(u,m,s),r!==null&&r.has(m)){let[g,b]=r.get(m);t.directiveToIndex.set(m.type,[u,g+t.directiveStart,b+t.directiveStart])}else(o===null||!o.has(m))&&t.directiveToIndex.set(m.type,u);m.contentQueries!==null&&(t.flags|=4),(m.hostBindings!==null||m.hostAttrs!==null||m.hostVars!==0)&&(t.flags|=64);let f=m.type.prototype;!c&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!d&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),u++}DC(n,t,o)}function DC(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let s=n.data[i];if(t===null||!t.has(s))g0(0,e,s,i),g0(1,e,s,i),y0(e,i,!1);else{let o=t.get(s);Z0(0,e,o,i),Z0(1,e,o,i),y0(e,i,!0)}}}function g0(n,e,t,i){let s=n===0?t.inputs:t.outputs;for(let o in s)if(s.hasOwnProperty(o)){let r;n===0?r=e.inputs??={}:r=e.outputs??={},r[o]??=[],r[o].push(i),Iy(e,o)}}function Z0(n,e,t,i){let s=n===0?t.inputs:t.outputs;for(let o in s)if(s.hasOwnProperty(o)){let r=s[o],l;n===0?l=e.hostDirectiveInputs??={}:l=e.hostDirectiveOutputs??={},l[r]??=[],l[r].push(i,o),Iy(e,r)}}function Iy(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function y0(n,e,t){let{attrs:i,inputs:s,hostDirectiveInputs:o}=n;if(i===null||!t&&s===null||t&&o===null||nm(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let r=null,l=0;for(;l<i.length;){let a=i[l];if(a===0){l+=4;continue}else if(a===5){l+=2;continue}else if(typeof a=="number")break;if(!t&&s.hasOwnProperty(a)){let c=s[a];for(let d of c)if(d===e){r??=[],r.push(a,i[l+1]);break}}else if(t&&o.hasOwnProperty(a)){let c=o[a];for(let d=0;d<c.length;d+=2)if(c[d]===e){r??=[],r.push(c[d+1],i[l+1]);break}}l+=2}n.initialInputs??=[],n.initialInputs.push(r)}function _C(n,e,t,i,s){n.data[i]=s;let o=s.factory||(s.factory=Ko(s.type,!0)),r=new sl(o,Ds(s),JC);n.blueprint[i]=r,t[i]=r,jC(n,e,i,QZ(n,t,s.hostVars,PZ),s)}function jC(n,e,t,i,s){let o=s.hostBindings;if(o){let r=n.hostBindingOpCodes;r===null&&(r=n.hostBindingOpCodes=[]);let l=~e.index;OC(r)!=l&&r.push(l),r.push(t,i,o)}}function OC(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function QC(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Ds(e)&&(t[""]=n)}}function qC(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Gy(n,e,t,i,s,o,r,l){let a=e.consts,c=Qg(a,r),d=Zy(e,n,2,i,c);return o&&AC(e,t,d,Qg(a,l),s),d.mergedAttrs=hZ(d.mergedAttrs,d.attrs),d.attrs!==null&&f0(d,d.attrs,!1),d.mergedAttrs!==null&&f0(d,d.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,d),d}function Xy(n,e){FR(n,e),P0(e)&&n.queries.elementEnd(e)}var ic=class extends Ic{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Jo(e);return new rl(t,this.ngModule)}};function $C(n){return Object.keys(n).map(e=>{let[t,i,s]=n[e],o={propName:t,templateName:e,isSignal:(i&Zc.SignalBased)!==0};return s&&(o.transform=s),o})}function eW(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function tW(n,e,t){let i=e instanceof Hn?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new vh(t,i):t}function nW(n){let e=n.get(Ao,null);if(e===null)throw new Se(407,!1);let t=n.get(UC,null),i=n.get(ol,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i}}function iW(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return EZ(e,t,t==="svg"?IR:t==="math"?GR:null)}var rl=class extends yy{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=$C(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=eW(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=HS(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,s){Wt(22);let o=mt(null);try{let r=this.componentDef,l=i?["ng-version","19.2.15"]:KS(this.componentDef.selectors[0]),a=_Z(0,null,null,1,0,null,null,null,null,[l],null),c=tW(r,s||this.ngModule,e),d=nW(c),u=d.rendererFactory.createRenderer(null,r),h=i?DS(u,i,r.encapsulation,c):iW(r,u),m=jZ(null,a,null,512|OZ(r),null,null,d,u,c,null,UZ(h,c,!0));m[as]=h,Ph(m);let f=null;try{let g=Gy(as,a,m,"#host",()=>[this.componentDef],!0,0);h&&(DZ(u,h,g),fc(h,m)),ey(a,m,g),AZ(a,g,m),Xy(a,g),t!==void 0&&sW(g,this.ngContentSelectors,t),f=Bs(g.index,m),m[ei]=f[ei],ny(a,m,null)}catch(g){throw f!==null&&Gh(f),Gh(m),g}finally{Wt(23),Eh()}return new Lh(this.componentType,m)}finally{mt(o)}}},Lh=class extends kC{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=XR(t[rt],as),this.location=Qh(this._tNode,t),this.instance=Bs(this._tNode.index,t)[ei],this.hostView=this.changeDetectorRef=new nc(t,void 0,!1),this.componentType=e}setInput(e,t){let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView,o=ty(i,s[rt],s,e,t);this.previousInputValues.set(e,t);let r=Bs(i.index,s);fy(r,1)}get injector(){return new As(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function sW(n,e,t){let i=n.projection=[];for(let s=0;s<e.length;s++){let o=t[s];i.push(o!=null&&o.length?Array.from(o):null)}}var rm=(()=>{class n{static __NG_ELEMENT_ID__=oW}return n})();function oW(){let n=js();return lW(n,gi())}var rW=rm,Vy=class extends rW{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Qh(this._hostTNode,this._hostLView)}get injector(){return new As(this._hostTNode,this._hostLView)}get parentInjector(){let e=zh(this._hostTNode,this._hostLView);if(mZ(e)){let t=Qa(e,this._hostLView),i=Oa(e),s=t[rt].data[i+8];return new As(s,t)}else return new As(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=I0(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-wn}createEmbeddedView(e,t,i){let s,o;typeof i=="number"?s=i:i!=null&&(s=i.index,o=i.injector);let r=b0(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},o,r);return this.insertImpl(l,s,m0(this._hostTNode,r)),l}createComponent(e,t,i,s,o){let r=e&&!bR(e),l;if(r)l=t;else{let f=t||{};l=f.index,i=f.injector,s=f.projectableNodes,o=f.environmentInjector||f.ngModuleRef}let a=r?e:new rl(Jo(e)),c=i||this.parentInjector;if(!o&&a.ngModule==null){let g=(r?c:this.parentInjector).get(Hn,null);g&&(o=g)}let d=Jo(a.componentType??{}),u=b0(this._lContainer,d?.id??null),h=u?.firstChild??null,m=a.create(c,s,h,o);return this.insertImpl(m.hostView,l,m0(this._hostTNode,u)),m}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let s=e._lView;if(VR(s)){let l=this.indexOf(e);if(l!==-1)this.detach(l);else{let a=s[cn],c=new Vy(a,a[ni],a[cn]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),r=this._lContainer;return TC(r,s,o,i),e.attachToViewContainerRef(),w0(ih(r),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=I0(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=Wh(this._lContainer,t);i&&(Ba(ih(this._lContainer),t),oy(i[rt],i))}detach(e){let t=this._adjustIndex(e,-1),i=Wh(this._lContainer,t);return i&&Ba(ih(this._lContainer),t)!=null?new nc(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function I0(n){return n[Da]}function ih(n){return n[Da]||(n[Da]=[])}function lW(n,e){let t,i=e[n.index];return Yi(i)?t=i:(t=MC(i,e,null,n),e[n.index]=t,qZ(e,t)),cW(t,e,n,i),new Vy(t,n,e)}function aW(n,e){let t=n[bi],i=t.createComment(""),s=_s(e,n),o=t.parentNode(s);return ec(t,o,i,t.nextSibling(s),!1),i}var cW=dW;function dW(n,e,t,i){if(n[Fs])return;let s;t.type&8?s=cs(i):s=aW(e,t),n[Fs]=s}var ll=class{},lm=class{};var Mh=class extends ll{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new ic(this);constructor(e,t,i,s=!0){super(),this.ngModuleType=e,this._parent=t;let o=k0(e);this._bootstrapComponents=FZ(o.bootstrap),this._r3Injector=VZ(e,t,[{provide:ll,useValue:this},{provide:Ic,useValue:this.componentFactoryResolver},...i],Xn(e),new Set(["environment"])),s&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Th=class extends lm{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Mh(this.moduleType,e,[])}};var sc=class extends ll{injector;componentFactoryResolver=new ic(this);instance=null;constructor(e){super();let t=new el([...e.providers,{provide:ll,useValue:this},{provide:Ic,useValue:this.componentFactoryResolver}],e.parent||Ah(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Gc(n,e,t=null){return new sc({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var uW=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=U0(!1,t.type),s=i.length>0?Gc([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,s)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Le({token:n,providedIn:"environment",factory:()=>new n(Ee(Hn))})}return n})();function Xc(n){return Hh(()=>{let e=Sy(n),t=Ct(be({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===MZ.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?s=>s.get(uW).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Zi.Emulated,styles:n.styles||Uo,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&tm("NgStandalone"),Cy(t);let i=n.dependencies;return t.directiveDefs=G0(i,!1),t.pipeDefs=G0(i,!0),t.id=fW(t),t})}function hW(n){return Jo(n)||nR(n)}function mW(n){return n!==null}function pW(n,e){if(n==null)return ko;let t={};for(let i in n)if(n.hasOwnProperty(i)){let s=n[i],o,r,l,a;Array.isArray(s)?(l=s[0],o=s[1],r=s[2]??o,a=s[3]||null):(o=s,r=s,l=Zc.None,a=null),t[o]=[i,l,a],e[o]=r}return t}function bW(n){if(n==null)return ko;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ry(n){return Hh(()=>{let e=Sy(n);return Cy(e),e})}function Sy(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||ko,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Uo,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:pW(n.inputs,e),outputs:bW(n.outputs),debugInfo:null}}function Cy(n){n.features?.forEach(e=>e(n))}function G0(n,e){if(!n)return null;let t=e?iR:hW;return()=>(typeof n=="function"?n():n).map(i=>t(i)).filter(mW)}function fW(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Wy=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var xy=new ve("");var gW=(()=>{class n{static \u0275prov=Le({token:n,providedIn:"root",factory:()=>new Yh})}return n})(),Yh=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}};function Vc(n){return!!n&&typeof n.then=="function"}function ZW(n){return!!n&&typeof n.subscribe=="function"}var yW=new ve("");var vy=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=se(yW,{optional:!0})??[];injector=se(ds);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let s of this.appInits){let o=ti(this.injector,s);if(Vc(o))t.push(o);else if(ZW(o)){let r=new Promise((l,a)=>{o.subscribe({complete:l,error:a})});t.push(r)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(s=>{this.reject(s)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),am=new ve("");function IW(){Tu(()=>{throw new Se(600,!1)})}function GW(n){return n.isBoundToModule}var XW=10;var zs=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=se(mS);afterRenderManager=se(SS);zonelessEnabled=se(_h);rootEffectScheduler=se(gW);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new jt;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=se(Bo).hasPendingTasks.pipe(st(t=>!t));constructor(){se(gc,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:s=>{s&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=se(Hn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,s=ds.NULL){Wt(10);let o=t instanceof yy;if(!this._injector.get(vy).done){let m="";throw new Se(405,m)}let l;o?l=t:l=this._injector.get(Ic).resolveComponentFactory(t),this.componentTypes.push(l.componentType);let a=GW(l)?void 0:this._injector.get(ll),c=i||l.selector,d=l.create(s,[],c,a),u=d.location.nativeElement,h=d.injector.get(xy,null);return h?.registerApplication(u),d.onDestroy(()=>{this.detachView(d.hostView),ka(this.components,d),h?.unregisterApplication(u)}),this._loadComponent(d),Wt(11,d),d}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Wt(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(kZ.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Se(101,!1);let t=mt(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,mt(t),this.afterTick.next(),Wt(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Ao,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<XW;)Wt(14),this.synchronizeOnce(),Wt(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:s}of this.allViews)VW(i,s,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>hc(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;ka(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(am,[]).forEach(s=>s(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ka(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Se(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ka(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function VW(n,e,t,i){if(!t&&!hc(n))return;hy(n,e,t&&!i?0:1)}function X0(n,e,t,i,s){ty(e,n,t,s?"class":"style",i)}function Ly(n,e,t,i){let s=gi(),o=Bh(),r=as+n,l=s[bi],a=o.firstCreatePass?Gy(r,o,s,e,$S,xR(),t,i):o.data[r],c=RW(o,s,a,l,e,n);s[r]=c;let d=fR(a);return pc(a,!0),DZ(l,c,a),!iy(a)&&cZ()&&ry(o,s,c,a),(SR()===0||d)&&fc(c,s),CR(),d&&(ey(o,s,a),AZ(o,a,s)),i!==null&&zS(s,a),Ly}function My(){let n=js();eZ()?YR():(n=n.parent,pc(n,!1));let e=n;LR(e)&&MR(),WR();let t=Bh();return t.firstCreatePass&&Xy(t,e),e.classesWithoutHost!=null&&PR(e)&&X0(t,e,gi(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&ER(e)&&X0(t,e,gi(),e.stylesWithoutHost,!1),My}function cm(n,e,t,i){return Ly(n,e,t,i),My(),cm}var RW=(n,e,t,i,s,o)=>(dZ(!0),EZ(i,s,JR()));var oc="en-US";var SW=oc;function CW(n){typeof n=="string"&&(SW=n.toLowerCase().replace(/_/g,"-"))}function Ty(n,e=""){let t=gi(),i=Bh(),s=n+as,o=i.firstCreatePass?Zy(i,s,1,e,null):i.data[s],r=WW(i,t,o,e,n);t[s]=r,cZ()&&ry(i,t,r,o),pc(o,!1)}var WW=(n,e,t,i,s)=>(dZ(!0),kS(e[bi],i));var Nh=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Yy=(()=>{class n{compileModuleSync(t){return new Th(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),s=k0(t),o=FZ(s.declarations).reduce((r,l)=>{let a=Jo(l);return a&&r.push(new rl(a)),r},[]);return new Nh(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var xW=(()=>{class n{zone=se(zt);changeDetectionScheduler=se(ol);applicationRef=se(zs);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vW=new ve("",{factory:()=>!1});function Ny({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new zt(Ct(be({},Hy()),{scheduleInRootZone:t})),[{provide:zt,useFactory:n},{provide:$r,multi:!0,useFactory:()=>{let i=se(xW,{optional:!0});return()=>i.initialize()}},{provide:$r,multi:!0,useFactory:()=>{let i=se(LW);return()=>{i.initialize()}}},e===!0?{provide:SZ,useValue:!0}:[],{provide:CZ,useValue:t??RZ}]}function wy(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,i=Ny({ngZoneFactory:()=>{let s=Hy(n);return s.scheduleInRootZone=t,s.shouldCoalesceEventChangeDetection&&tm("NgZone_CoalesceEvent"),new zt(s)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Uh([{provide:vW,useValue:!0},{provide:_h,useValue:!1},i])}function Hy(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var LW=(()=>{class n{subscription=new Nt;initialized=!1;zone=se(zt);pendingTasks=se(Bo);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{zt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{zt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var MW=(()=>{class n{appRef=se(zs);taskService=se(Bo);ngZone=se(zt);zonelessEnabled=se(_h);tracing=se(gc,{optional:!0});disableScheduling=se(SZ,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Nt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get($a):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(se(CZ,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ih||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let s=this.useMicrotaskScheduler?o0:WZ;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>s(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>s(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get($a+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,o0(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function TW(){return typeof $localize<"u"&&$localize.locale||oc}var Ky=new ve("",{providedIn:"root",factory:()=>se(Ky,Ue.Optional|Ue.SkipSelf)||TW()});var wh=new ve(""),YW=new ve("");function jr(n){return!n.moduleRef}function NW(n){let e=jr(n)?n.r3Injector:n.moduleRef.injector,t=e.get(zt);return t.run(()=>{jr(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(us,null),s;if(t.runOutsideAngular(()=>{s=t.onError.subscribe({next:o=>{i.handleError(o)}})}),jr(n)){let o=()=>e.destroy(),r=n.platformInjector.get(wh);r.add(o),e.onDestroy(()=>{s.unsubscribe(),r.delete(o)})}else{let o=()=>n.moduleRef.destroy(),r=n.platformInjector.get(wh);r.add(o),n.moduleRef.onDestroy(()=>{ka(n.allPlatformModules,n.moduleRef),s.unsubscribe(),r.delete(o)})}return HW(i,t,()=>{let o=e.get(vy);return o.runInitializers(),o.donePromise.then(()=>{let r=e.get(Ky,oc);if(CW(r||oc),!e.get(YW,!0))return jr(n)?e.get(zs):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(jr(n)){let a=e.get(zs);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return wW(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function wW(n,e){let t=n.injector.get(zs);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Se(-403,!1);e.push(n)}function HW(n,e,t){try{let i=t();return Vc(i)?i.catch(s=>{throw e.runOutsideAngular(()=>n.handleError(s)),s}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}var Ua=null;function KW(n=[],e){return ds.create({name:e,providers:[{provide:ac,useValue:"platform"},{provide:wh,useValue:new Set([()=>Ua=null])},...n]})}function kW(n=[]){if(Ua)return Ua;let e=KW(n);return Ua=e,IW(),UW(e),e}function UW(n){let e=n.get($h,null);ti(n,()=>{e?.forEach(t=>t())})}var ky=(()=>{class n{static __NG_ELEMENT_ID__=JW}return n})();function JW(n){return AW(js(),gi(),(n&16)===16)}function AW(n,e,t){if(uc(n)&&!t){let i=Bs(n.index,e);return new nc(i,i)}else if(n.type&175){let i=e[fi];return new nc(i,e)}return null}function Uy(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:s}=n;Wt(8);try{let o=s?.injector??kW(i),r=[Ny({}),{provide:ol,useExisting:MW},...t||[]],l=new sc({providers:r,parent:o,debugName:"",runEnvironmentInitializers:!1});return NW({r3Injector:l.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{Wt(9)}}var V0=class{[Go];constructor(e){this[Go]=e}destroy(){this[Go].destroy()}};var tn=new ve("");var Fy=null;function Ni(){return Fy}function dm(n){Fy??=n}var dl=class{},um=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(By),providedIn:"platform"})}return n})();var By=(()=>{class n extends um{_location;_history;_doc=se(tn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ni().getBaseHref(this._doc)}onPopState(t){let i=Ni().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Ni().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,s){this._history.pushState(t,i,s)}replaceState(t,i,s){this._history.replaceState(t,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Py(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function Jy(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function hs(n){return n&&n[0]!=="?"?`?${n}`:n}var Rc=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(zy),providedIn:"root"})}return n})(),Ey=new ve(""),zy=(()=>{class n extends Rc{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??se(tn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Py(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+hs(this._platformLocation.search),s=this._platformLocation.hash;return s&&t?`${i}${s}`:i}pushState(t,i,s,o){let r=this.prepareExternalUrl(s+hs(o));this._platformLocation.pushState(t,i,r)}replaceState(t,i,s,o){let r=this.prepareExternalUrl(s+hs(o));this._platformLocation.replaceState(t,i,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(Ee(um),Ee(Ey,8))};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Eo=(()=>{class n{_subject=new jt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=PW(Jy(Ay(i))),this._locationStrategy.onPopState(s=>{this._subject.next({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+hs(i))}normalize(t){return n.stripTrailingSlash(BW(this._basePath,Ay(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",s=null){this._locationStrategy.pushState(s,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+hs(i)),s)}replaceState(t,i="",s=null){this._locationStrategy.replaceState(s,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+hs(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(s=>s(t,i))}subscribe(t,i,s){return this._subject.subscribe({next:t,error:i??void 0,complete:s??void 0})}static normalizeQueryParams=hs;static joinWithSlash=Py;static stripTrailingSlash=Jy;static \u0275fac=function(i){return new(i||n)(Ee(Rc))};static \u0275prov=Le({token:n,factory:()=>FW(),providedIn:"root"})}return n})();function FW(){return new Eo(Ee(Rc))}function BW(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Ay(n){return n.replace(/\/index.html$/,"")}function PW(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function hm(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[s,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(s.trim()===e)return decodeURIComponent(o)}return null}var mm="browser",Dy="server";function Sc(n){return n===Dy}var ul=class{};var xc=new ve(""),gm=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,s,o){return this._findPluginFor(i).addEventListener(t,i,s,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new Se(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(Ee(xc),Ee(zt))};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})(),hl=class{_doc;constructor(e){this._doc=e}manager},Cc="ng-app-id";function _y(n){for(let e of n)e.remove()}function jy(n,e){let t=e.createElement("style");return t.textContent=n,t}function EW(n,e,t,i){let s=n.head?.querySelectorAll(`style[${Cc}="${e}"],link[${Cc}="${e}"]`);if(s)for(let o of s)o.removeAttribute(Cc),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function bm(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Zm=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,i,s,o={}){this.doc=t,this.appId=i,this.nonce=s,this.isServer=Sc(o),EW(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let s of t)this.addUsage(s,this.inline,jy);i?.forEach(s=>this.addUsage(s,this.external,bm))}removeStyles(t,i){for(let s of t)this.removeUsage(s,this.inline);i?.forEach(s=>this.removeUsage(s,this.external))}addUsage(t,i,s){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(r=>this.addElement(r,s(t,this.doc)))})}removeUsage(t,i){let s=i.get(t);s&&(s.usage--,s.usage<=0&&(_y(s.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])_y(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:s}]of this.inline)s.push(this.addElement(t,jy(i,this.doc)));for(let[i,{elements:s}]of this.external)s.push(this.addElement(t,bm(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(Cc,this.appId),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(Ee(tn),Ee(qh),Ee(em,8),Ee(cl))};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})(),pm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ym=/%COMP%/g;var Qy="%COMP%",zW=`_nghost-${Qy}`,DW=`_ngcontent-${Qy}`,_W=!0,jW=new ve("",{providedIn:"root",factory:()=>_W});function OW(n){return DW.replace(ym,n)}function QW(n){return zW.replace(ym,n)}function qy(n,e){return e.map(t=>t.replace(ym,n))}var Im=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,s,o,r,l,a,c=null,d=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=r,this.platformId=l,this.ngZone=a,this.nonce=c,this.tracingService=d,this.platformIsServer=Sc(l),this.defaultRenderer=new ml(t,r,a,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Zi.ShadowDom&&(i=Ct(be({},i),{encapsulation:Zi.Emulated}));let s=this.getOrCreateRenderer(t,i);return s instanceof Wc?s.applyToHost(t):s instanceof pl&&s.applyStyles(),s}getOrCreateRenderer(t,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let r=this.doc,l=this.ngZone,a=this.eventManager,c=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,u=this.platformIsServer,h=this.tracingService;switch(i.encapsulation){case Zi.Emulated:o=new Wc(a,c,i,this.appId,d,r,l,u,h);break;case Zi.ShadowDom:return new fm(a,c,t,i,r,l,this.nonce,u,h);default:o=new pl(a,c,i,d,r,l,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(Ee(gm),Ee(Zm),Ee(qh),Ee(jW),Ee(tn),Ee(cl),Ee(zt),Ee(em),Ee(gc,8))};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})(),ml=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,s,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=s,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(pm[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Oy(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Oy(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Se(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,s){if(s){t=s+":"+t;let o=pm[s];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let s=pm[i];s?e.removeAttributeNS(s,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,s){s&(Po.DashCase|Po.Important)?e.style.setProperty(t,i,s&Po.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Po.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,s){if(typeof e=="string"&&(e=Ni().getGlobalEventTarget(this.doc,e),!e))throw new Se(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,s)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Oy(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var fm=class extends ml{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,s,o,r,l,a,c){super(e,o,r,a,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=s.styles;d=qy(s.id,d);for(let h of d){let m=document.createElement("style");l&&m.setAttribute("nonce",l),m.textContent=h,this.shadowRoot.appendChild(m)}let u=s.getExternalStyles?.();if(u)for(let h of u){let m=bm(h,o);l&&m.setAttribute("nonce",l),this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},pl=class extends ml{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,s,o,r,l,a,c){super(e,o,r,l,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=s;let d=i.styles;this.styles=c?qy(c,d):d,this.styleUrls=i.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Wc=class extends pl{contentAttr;hostAttr;constructor(e,t,i,s,o,r,l,a,c){let d=s+"-"+i.id;super(e,t,i,o,r,l,a,c,d),this.contentAttr=OW(d),this.hostAttr=QW(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var vc=class n extends dl{supportsDOMEvents=!0;static makeCurrent(){dm(new n)}onAndCancel(e,t,i,s){return e.addEventListener(t,i,s),()=>{e.removeEventListener(t,i,s)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=ex();return t==null?null:tx(t)}resetBaseElement(){bl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return hm(document.cookie,e)}},bl=null;function ex(){return bl=bl||document.head.querySelector("base"),bl?bl.getAttribute("href"):null}function tx(n){return new URL(n,document.baseURI).pathname}var nx=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})(),eI=(()=>{class n extends hl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,s,o){return t.addEventListener(i,s,o),()=>this.removeEventListener(t,i,s,o)}removeEventListener(t,i,s,o){return t.removeEventListener(i,s,o)}static \u0275fac=function(i){return new(i||n)(Ee(tn))};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})(),$y=["alt","control","meta","shift"],ix={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sx={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},tI=(()=>{class n extends hl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,s,o){let r=n.parseEventName(i),l=n.eventCallback(r.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ni().onAndCancel(t,r.domEventName,l,o))}static parseEventName(t){let i=t.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=n._normalizeKey(i.pop()),r="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),r="code."),$y.forEach(c=>{let d=i.indexOf(c);d>-1&&(i.splice(d,1),r+=c+".")}),r+=o,i.length!=0||o.length===0)return null;let a={};return a.domEventName=s,a.fullKey=r,a}static matchEventFullKeyCode(t,i){let s=ix[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(s=t.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),$y.forEach(r=>{if(r!==s){let l=sx[r];l(t)&&(o+=r+".")}}),o+=s,o===i)}static eventCallback(t,i,s){return o=>{n.matchEventFullKeyCode(o,t)&&s.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(Ee(tn))};static \u0275prov=Le({token:n,factory:n.\u0275fac})}return n})();function Gm(n,e,t){return Uy(be({rootComponent:n,platformRef:t?.platformRef},ox(e)))}function ox(n){return{appProviders:[...dx,...n?.providers??[]],platformProviders:cx}}function rx(){vc.makeCurrent()}function lx(){return new us}function ax(){return HZ(document),document}var cx=[{provide:cl,useValue:mm},{provide:$h,useValue:rx,multi:!0},{provide:tn,useFactory:ax}];var dx=[{provide:ac,useValue:"root"},{provide:us,useFactory:lx},{provide:xc,useClass:eI,multi:!0,deps:[tn]},{provide:xc,useClass:tI,multi:!0,deps:[tn]},Im,Zm,gm,{provide:Ao,useExisting:Im},{provide:ul,useClass:nx},[]];var nI=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(Ee(tn))};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Je="primary",Wl=Symbol("RouteTitle"),Cm=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Qo(n){return new Cm(n)}function hx(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let s={};for(let o=0;o<i.length;o++){let r=i[o],l=n[o];if(r[0]===":")s[r.substring(1)]=l;else if(r!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:s}}function mx(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!yi(n[t],e[t]))return!1;return!0}function yi(n,e){let t=n?Wm(n):void 0,i=e?Wm(e):void 0;if(!t||!i||t.length!=i.length)return!1;let s;for(let o=0;o<t.length;o++)if(s=t[o],!dI(n[s],e[s]))return!1;return!0}function Wm(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function dI(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((s,o)=>i[o]===s)}else return n===e}function uI(n){return n.length>0?n[n.length-1]:null}function bs(n){return Eu(n)?n:Vc(n)?wt(Promise.resolve(n)):we(n)}var px={exact:mI,subset:pI},hI={exact:bx,subset:fx,ignored:()=>!0};function iI(n,e,t){return px[t.paths](n.root,e.root,t.matrixParams)&&hI[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function bx(n,e){return yi(n,e)}function mI(n,e,t){if(!qs(n.segments,e.segments)||!Tc(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!mI(n.children[i],e.children[i],t))return!1;return!0}function fx(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>dI(n[t],e[t]))}function pI(n,e,t){return bI(n,e,e.segments,t)}function bI(n,e,t,i){if(n.segments.length>t.length){let s=n.segments.slice(0,t.length);return!(!qs(s,t)||e.hasChildren()||!Tc(s,t,i))}else if(n.segments.length===t.length){if(!qs(n.segments,t)||!Tc(n.segments,t,i))return!1;for(let s in e.children)if(!n.children[s]||!pI(n.children[s],e.children[s],i))return!1;return!0}else{let s=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!qs(n.segments,s)||!Tc(n.segments,s,i)||!n.children[Je]?!1:bI(n.children[Je],e,o,i)}}function Tc(n,e,t){return e.every((i,s)=>hI[t](n[s].parameters,i.parameters))}var Hi=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ut([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){return yx.serialize(this)}},ut=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Yc(this)}},Qs=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Qo(this.parameters),this._parameterMap}toString(){return gI(this)}};function gx(n,e){return qs(n,e)&&n.every((t,i)=>yi(t.parameters,e[i].parameters))}function qs(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function Zx(n,e){let t=[];return Object.entries(n.children).forEach(([i,s])=>{i===Je&&(t=t.concat(e(s,i)))}),Object.entries(n.children).forEach(([i,s])=>{i!==Je&&(t=t.concat(e(s,i)))}),t}var zc=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>new qo,providedIn:"root"})}return n})(),qo=class{parse(e){let t=new vm(e);return new Hi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${fl(e.root,!0)}`,i=Xx(e.queryParams),s=typeof e.fragment=="string"?`#${Ix(e.fragment)}`:"";return`${t}${i}${s}`}},yx=new qo;function Yc(n){return n.segments.map(e=>gI(e)).join("/")}function fl(n,e){if(!n.hasChildren())return Yc(n);if(e){let t=n.children[Je]?fl(n.children[Je],!1):"",i=[];return Object.entries(n.children).forEach(([s,o])=>{s!==Je&&i.push(`${s}:${fl(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=Zx(n,(i,s)=>s===Je?[fl(n.children[Je],!1)]:[`${s}:${fl(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Je]!=null?`${Yc(n)}/${t[0]}`:`${Yc(n)}/(${t.join("//")})`}}function fI(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lc(n){return fI(n).replace(/%3B/gi,";")}function Ix(n){return encodeURI(n)}function xm(n){return fI(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Nc(n){return decodeURIComponent(n)}function sI(n){return Nc(n.replace(/\+/g,"%20"))}function gI(n){return`${xm(n.path)}${Gx(n.parameters)}`}function Gx(n){return Object.entries(n).map(([e,t])=>`;${xm(e)}=${xm(t)}`).join("")}function Xx(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(s=>`${Lc(t)}=${Lc(s)}`).join("&"):`${Lc(t)}=${Lc(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Vx=/^[^\/()?;#]+/;function Xm(n){let e=n.match(Vx);return e?e[0]:""}var Rx=/^[^\/()?;=#]+/;function Sx(n){let e=n.match(Rx);return e?e[0]:""}var Cx=/^[^=?&#]+/;function Wx(n){let e=n.match(Cx);return e?e[0]:""}var xx=/^[^&#]+/;function vx(n){let e=n.match(xx);return e?e[0]:""}var vm=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ut([],{}):new ut([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Je]=new ut(e,t)),i}parseSegment(){let e=Xm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Se(4009,!1);return this.capture(e),new Qs(Nc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Sx(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=Xm(this.remaining);s&&(i=s,this.capture(i))}e[Nc(t)]=Nc(i)}parseQueryParam(e){let t=Wx(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=vx(this.remaining);r&&(i=r,this.capture(i))}let s=sI(t),o=sI(i);if(e.hasOwnProperty(s)){let r=e[s];Array.isArray(r)||(r=[r],e[s]=r),r.push(o)}else e[s]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Xm(this.remaining),s=this.remaining[i.length];if(s!=="/"&&s!==")"&&s!==";")throw new Se(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Je);let r=this.parseChildren();t[o]=Object.keys(r).length===1?r[Je]:new ut([],r),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Se(4011,!1)}};function ZI(n){return n.segments.length>0?new ut([],{[Je]:n}):n}function yI(n){let e={};for(let[i,s]of Object.entries(n.children)){let o=yI(s);if(i===Je&&o.segments.length===0&&o.hasChildren())for(let[r,l]of Object.entries(o.children))e[r]=l;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new ut(n.segments,e);return Lx(t)}function Lx(n){if(n.numberOfChildren===1&&n.children[Je]){let e=n.children[Je];return new ut(n.segments.concat(e.segments),e.children)}return n}function $o(n){return n instanceof Hi}function Mx(n,e,t=null,i=null){let s=II(n);return GI(s,e,t,i)}function II(n){let e;function t(o){let r={};for(let a of o.children){let c=t(a);r[a.outlet]=c}let l=new ut(o.url,r);return o===n&&(e=l),l}let i=t(n.root),s=ZI(i);return e??s}function GI(n,e,t,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return Vm(s,s,s,t,i);let o=Tx(e);if(o.toRoot())return Vm(s,s,new ut([],{}),t,i);let r=Yx(o,s,n),l=r.processChildren?Zl(r.segmentGroup,r.index,o.commands):VI(r.segmentGroup,r.index,o.commands);return Vm(s,r.segmentGroup,l,t,i)}function Hc(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Il(n){return typeof n=="object"&&n!=null&&n.outlets}function Vm(n,e,t,i,s){let o={};i&&Object.entries(i).forEach(([a,c])=>{o[a]=Array.isArray(c)?c.map(d=>`${d}`):`${c}`});let r;n===e?r=t:r=XI(n,e,t);let l=ZI(yI(r));return new Hi(l,o,s)}function XI(n,e,t){let i={};return Object.entries(n.children).forEach(([s,o])=>{o===e?i[s]=t:i[s]=XI(o,e,t)}),new ut(n.segments,i)}var Kc=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Hc(i[0]))throw new Se(4003,!1);let s=i.find(Il);if(s&&s!==uI(i))throw new Se(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Tx(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Kc(!0,0,n);let e=0,t=!1,i=n.reduce((s,o,r)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let l={};return Object.entries(o.outlets).forEach(([a,c])=>{l[a]=typeof c=="string"?c.split("/"):c}),[...s,{outlets:l}]}if(o.segmentPath)return[...s,o.segmentPath]}return typeof o!="string"?[...s,o]:r===0?(o.split("/").forEach((l,a)=>{a==0&&l==="."||(a==0&&l===""?t=!0:l===".."?e++:l!=""&&s.push(l))}),s):[...s,o]},[]);return new Kc(t,e,i)}var _o=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function Yx(n,e,t){if(n.isAbsolute)return new _o(e,!0,0);if(!t)return new _o(e,!1,NaN);if(t.parent===null)return new _o(t,!0,0);let i=Hc(n.commands[0])?0:1,s=t.segments.length-1+i;return Nx(t,s,n.numberOfDoubleDots)}function Nx(n,e,t){let i=n,s=e,o=t;for(;o>s;){if(o-=s,i=i.parent,!i)throw new Se(4005,!1);s=i.segments.length}return new _o(i,!1,s-o)}function wx(n){return Il(n[0])?n[0].outlets:{[Je]:n}}function VI(n,e,t){if(n??=new ut([],{}),n.segments.length===0&&n.hasChildren())return Zl(n,e,t);let i=Hx(n,e,t),s=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new ut(n.segments.slice(0,i.pathIndex),{});return o.children[Je]=new ut(n.segments.slice(i.pathIndex),n.children),Zl(o,0,s)}else return i.match&&s.length===0?new ut(n.segments,{}):i.match&&!n.hasChildren()?Lm(n,e,t):i.match?Zl(n,0,s):Lm(n,e,t)}function Zl(n,e,t){if(t.length===0)return new ut(n.segments,{});{let i=wx(t),s={};if(Object.keys(i).some(o=>o!==Je)&&n.children[Je]&&n.numberOfChildren===1&&n.children[Je].segments.length===0){let o=Zl(n.children[Je],e,t);return new ut(n.segments,o.children)}return Object.entries(i).forEach(([o,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(s[o]=VI(n.children[o],e,r))}),Object.entries(n.children).forEach(([o,r])=>{i[o]===void 0&&(s[o]=r)}),new ut(n.segments,s)}}function Hx(n,e,t){let i=0,s=e,o={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(i>=t.length)return o;let r=n.segments[s],l=t[i];if(Il(l))break;let a=`${l}`,c=i<t.length-1?t[i+1]:null;if(s>0&&a===void 0)break;if(a&&c&&typeof c=="object"&&c.outlets===void 0){if(!rI(a,c,r))return o;i+=2}else{if(!rI(a,{},r))return o;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}function Lm(n,e,t){let i=n.segments.slice(0,e),s=0;for(;s<t.length;){let o=t[s];if(Il(o)){let a=Kx(o.outlets);return new ut(i,a)}if(s===0&&Hc(t[0])){let a=n.segments[e];i.push(new Qs(a.path,oI(t[0]))),s++;continue}let r=Il(o)?o.outlets[Je]:`${o}`,l=s<t.length-1?t[s+1]:null;r&&l&&Hc(l)?(i.push(new Qs(r,oI(l))),s+=2):(i.push(new Qs(r,{})),s++)}return new ut(i,{})}function Kx(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=Lm(new ut([],{}),0,i))}),e}function oI(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function rI(n,e,t){return n==t.path&&yi(e,t.parameters)}var wc="imperative",qt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(qt||{}),Kn=class{id;url;constructor(e,t){this.id=e,this.url=t}},er=class extends Kn{type=qt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",s=null){super(e,t),this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ms=class extends Kn{urlAfterRedirects;type=qt.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Rn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Rn||{}),kc=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(kc||{}),wi=class extends Kn{reason;code;type=qt.NavigationCancel;constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ps=class extends Kn{reason;code;type=qt.NavigationSkipped;constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s}},Gl=class extends Kn{error;target;type=qt.NavigationError;constructor(e,t,i,s){super(e,t),this.error=i,this.target=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Uc=class extends Kn{urlAfterRedirects;state;type=qt.RoutesRecognized;constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mm=class extends Kn{urlAfterRedirects;state;type=qt.GuardsCheckStart;constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tm=class extends Kn{urlAfterRedirects;state;shouldActivate;type=qt.GuardsCheckEnd;constructor(e,t,i,s,o){super(e,t),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ym=class extends Kn{urlAfterRedirects;state;type=qt.ResolveStart;constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nm=class extends Kn{urlAfterRedirects;state;type=qt.ResolveEnd;constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wm=class{route;type=qt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Hm=class{route;type=qt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Km=class{snapshot;type=qt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},km=class{snapshot;type=qt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Um=class{snapshot;type=qt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jm=class{snapshot;type=qt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Xl=class{},tr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function kx(n,e){return n.providers&&!n._injector&&(n._injector=Gc(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ii(n){return n.outlet||Je}function Ux(n,e){let t=n.filter(i=>ii(i)===e);return t.push(...n.filter(i=>ii(i)!==e)),t}function xl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Am=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return xl(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new vl(this.rootInjector)}},vl=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let s=this.getOrCreateContext(t);s.outlet=i,this.contexts.set(t,s)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Am(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(Ee(Hn))};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Jc=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Fm(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=Fm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Bm(e,this._root);return t.length<2?[]:t[t.length-2].children.map(s=>s.value).filter(s=>s!==e)}pathFromRoot(e){return Bm(e,this._root).map(t=>t.value)}};function Fm(n,e){if(n===e.value)return e;for(let t of e.children){let i=Fm(n,t);if(i)return i}return null}function Bm(n,e){if(n===e.value)return[e];for(let t of e.children){let i=Bm(n,t);if(i.length)return i.unshift(e),i}return[]}var Vn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Do(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ac=class extends Jc{snapshot;constructor(e,t){super(e),this.snapshot=t,qm(this,e)}toString(){return this.snapshot.toString()}};function RI(n){let e=Jx(n),t=new Ot([new Qs("",{})]),i=new Ot({}),s=new Ot({}),o=new Ot({}),r=new Ot(""),l=new $s(t,i,o,r,s,Je,n,e.root);return l.snapshot=e.root,new Ac(new Vn(l,[]),e)}function Jx(n){let e={},t={},i={},s="",o=new jo([],e,i,s,t,Je,n,null,{});return new Bc("",new Vn(o,[]))}var $s=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,s,o,r,l,a){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=s,this.dataSubject=o,this.outlet=r,this.component=l,this._futureSnapshot=a,this.title=this.dataSubject?.pipe(st(c=>c[Wl]))??we(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(st(e=>Qo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(st(e=>Qo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Fc(n,e,t="emptyOnly"){let i,{routeConfig:s}=n;return e!==null&&(t==="always"||s?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:be(be({},e.params),n.params),data:be(be({},e.data),n.data),resolve:be(be(be(be({},n.data),e.data),s?.data),n._resolvedData)}:i={params:be({},n.params),data:be({},n.data),resolve:be(be({},n.data),n._resolvedData??{})},s&&CI(s)&&(i.resolve[Wl]=s.title),i}var jo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Wl]}constructor(e,t,i,s,o,r,l,a,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=o,this.outlet=r,this.component=l,this.routeConfig=a,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Qo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Bc=class extends Jc{url;constructor(e,t){super(t),this.url=e,qm(this,t)}toString(){return SI(this._root)}};function qm(n,e){e.value._routerState=n,e.children.forEach(t=>qm(n,t))}function SI(n){let e=n.children.length>0?` { ${n.children.map(SI).join(", ")} } `:"";return`${n.value}${e}`}function Rm(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,yi(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),yi(e.params,t.params)||n.paramsSubject.next(t.params),mx(e.url,t.url)||n.urlSubject.next(t.url),yi(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Pm(n,e){let t=yi(n.params,e.params)&&gx(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||Pm(n.parent,e.parent))}function CI(n){return typeof n.title=="string"||n.title===null}var Ax=new ve(""),WI=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Je;activateEvents=new fn;deactivateEvents=new fn;attachEvents=new fn;detachEvents=new fn;routerOutletData=vZ(void 0);parentContexts=se(vl);location=se(rm);changeDetector=se(ky);inputBinder=se(Dc,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:s}=t.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Se(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Se(4013,!1);this._activatedRoute=t;let s=this.location,r=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,a=new Em(t,l,s.injector,this.routerOutletData);this.activated=s.createComponent(r,{index:s.length,injector:a,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ry({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[z0]})}return n})(),Em=class{route;childContexts;parent;outletData;constructor(e,t,i,s){this.route=e,this.childContexts=t,this.parent=i,this.outletData=s}get(e,t){return e===$s?this.route:e===vl?this.childContexts:e===Ax?this.outletData:this.parent.get(e,t)}},Dc=new ve("");var xI=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Xc({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,s){i&1&&cm(0,"router-outlet")},dependencies:[WI],encapsulation:2})}return n})();function $m(n){let e=n.children&&n.children.map($m),t=e?Ct(be({},n),{children:e}):be({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Je&&(t.component=xI),t}function Fx(n,e,t){let i=Vl(n,e._root,t?t._root:void 0);return new Ac(i,e)}function Vl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let s=Bx(n,e,t);return new Vn(i,s)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let r=o.route;return r.value._futureSnapshot=e.value,r.children=e.children.map(l=>Vl(n,l)),r}}let i=Px(e.value),s=e.children.map(o=>Vl(n,o));return new Vn(i,s)}}function Bx(n,e,t){return e.children.map(i=>{for(let s of t.children)if(n.shouldReuseRoute(i.value,s.value.snapshot))return Vl(n,i,s);return Vl(n,i)})}function Px(n){return new $s(new Ot(n.url),new Ot(n.params),new Ot(n.queryParams),new Ot(n.fragment),new Ot(n.data),n.outlet,n.component,n)}var Rl=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},vI="ngNavigationCancelingError";function Pc(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=$o(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,s=LI(!1,Rn.Redirect);return s.url=t,s.navigationBehaviorOptions=i,s}function LI(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[vI]=!0,t.cancellationCode=e,t}function Ex(n){return MI(n)&&$o(n.url)}function MI(n){return!!n&&n[vI]}var zx=(n,e,t,i)=>st(s=>(new zm(e,s.targetRouterState,s.currentRouterState,t,i).activate(n),s)),zm=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,s,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=s,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Rm(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let s=Do(t);e.children.forEach(o=>{let r=o.value.outlet;this.deactivateRoutes(o,s[r],i),delete s[r]}),Object.values(s).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let s=e.value,o=t?t.value:null;if(s===o)if(s.component){let r=i.getContext(s.outlet);r&&this.deactivateChildRoutes(e,t,r.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,o=Do(e);for(let r of Object.values(o))this.deactivateRouteAndItsChildren(r,s);if(i&&i.outlet){let r=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,o=Do(e);for(let r of Object.values(o))this.deactivateRouteAndItsChildren(r,s);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let s=Do(t);e.children.forEach(o=>{this.activateRoutes(o,s[o.value.outlet],i),this.forwardEvent(new Jm(o.value.snapshot))}),e.children.length&&this.forwardEvent(new km(e.value.snapshot))}activateRoutes(e,t,i){let s=e.value,o=t?t.value:null;if(Rm(s),s===o)if(s.component){let r=i.getOrCreateContext(s.outlet);this.activateChildRoutes(e,t,r.children)}else this.activateChildRoutes(e,t,i);else if(s.component){let r=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){let l=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),r.children.onOutletReAttached(l.contexts),r.attachRef=l.componentRef,r.route=l.route.value,r.outlet&&r.outlet.attach(l.componentRef,l.route.value),Rm(l.route.value),this.activateChildRoutes(e,null,r.children)}else r.attachRef=null,r.route=s,r.outlet&&r.outlet.activateWith(s,r.injector),this.activateChildRoutes(e,null,r.children)}else this.activateChildRoutes(e,null,i)}},Ec=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Oo=class{component;route;constructor(e,t){this.component=e,this.route=t}};function Dx(n,e,t){let i=n._root,s=e?e._root:null;return gl(i,s,t,[i.value])}function _x(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ir(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!x0(n)?n:e.get(n):i}function gl(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){let o=Do(e);return n.children.forEach(r=>{jx(r,o[r.value.outlet],t,i.concat([r.value]),s),delete o[r.value.outlet]}),Object.entries(o).forEach(([r,l])=>yl(l,t.getContext(r),s)),s}function jx(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,r=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(r&&o.routeConfig===r.routeConfig){let a=Ox(r,o,o.routeConfig.runGuardsAndResolvers);a?s.canActivateChecks.push(new Ec(i)):(o.data=r.data,o._resolvedData=r._resolvedData),o.component?gl(n,e,l?l.children:null,i,s):gl(n,e,t,i,s),a&&l&&l.outlet&&l.outlet.isActivated&&s.canDeactivateChecks.push(new Oo(l.outlet.component,r))}else r&&yl(e,l,s),s.canActivateChecks.push(new Ec(i)),o.component?gl(n,null,l?l.children:null,i,s):gl(n,null,t,i,s);return s}function Ox(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!qs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!qs(n.url,e.url)||!yi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pm(n,e)||!yi(n.queryParams,e.queryParams);case"paramsChange":default:return!Pm(n,e)}}function yl(n,e,t){let i=Do(n),s=n.value;Object.entries(i).forEach(([o,r])=>{s.component?e?yl(r,e.children.getContext(o),t):yl(r,null,t):yl(r,e,t)}),s.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Oo(e.outlet.component,s)):t.canDeactivateChecks.push(new Oo(null,s)):t.canDeactivateChecks.push(new Oo(null,s))}function Ll(n){return typeof n=="function"}function Qx(n){return typeof n=="boolean"}function qx(n){return n&&Ll(n.canLoad)}function $x(n){return n&&Ll(n.canActivate)}function ev(n){return n&&Ll(n.canActivateChild)}function tv(n){return n&&Ll(n.canDeactivate)}function nv(n){return n&&Ll(n.canMatch)}function TI(n){return n instanceof vi||n?.name==="EmptyError"}var Mc=Symbol("INITIAL_VALUE");function nr(){return Qn(n=>Ta(n.map(e=>e.pipe(Li(1),_u(Mc)))).pipe(st(e=>{for(let t of e)if(t!==!0){if(t===Mc)return Mc;if(t===!1||iv(t))return t}return!0}),On(e=>e!==Mc),Li(1)))}function iv(n){return $o(n)||n instanceof Rl}function sv(n,e){return Ut(t=>{let{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:o,canDeactivateChecks:r}}=t;return r.length===0&&o.length===0?we(Ct(be({},t),{guardsResult:!0})):ov(r,i,s,n).pipe(Ut(l=>l&&Qx(l)?rv(i,o,n,e):we(l)),st(l=>Ct(be({},t),{guardsResult:l})))})}function ov(n,e,t,i){return wt(n).pipe(Ut(s=>uv(s.component,s.route,t,e,i)),Mi(s=>s!==!0,!0))}function rv(n,e,t,i){return wt(e).pipe(Mo(s=>Lo(av(s.route.parent,i),lv(s.route,i),dv(n,s.path,t),cv(n,s.route,t))),Mi(s=>s!==!0,!0))}function lv(n,e){return n!==null&&e&&e(new Um(n)),we(!0)}function av(n,e){return n!==null&&e&&e(new Km(n)),we(!0)}function cv(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return we(!0);let s=i.map(o=>Ya(()=>{let r=xl(e)??t,l=ir(o,r),a=$x(l)?l.canActivate(e,n):ti(r,()=>l(e,n));return bs(a).pipe(Mi())}));return we(s).pipe(nr())}function dv(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(r=>_x(r)).filter(r=>r!==null).map(r=>Ya(()=>{let l=r.guards.map(a=>{let c=xl(r.node)??t,d=ir(a,c),u=ev(d)?d.canActivateChild(i,n):ti(c,()=>d(i,n));return bs(u).pipe(Mi())});return we(l).pipe(nr())}));return we(o).pipe(nr())}function uv(n,e,t,i,s){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return we(!0);let r=o.map(l=>{let a=xl(e)??s,c=ir(l,a),d=tv(c)?c.canDeactivate(n,e,t,i):ti(a,()=>c(n,e,t,i));return bs(d).pipe(Mi())});return we(r).pipe(nr())}function hv(n,e,t,i){let s=e.canLoad;if(s===void 0||s.length===0)return we(!0);let o=s.map(r=>{let l=ir(r,n),a=qx(l)?l.canLoad(e,t):ti(n,()=>l(e,t));return bs(a)});return we(o).pipe(nr(),YI(i))}function YI(n){return Au(Qt(e=>{if(typeof e!="boolean")throw Pc(n,e)}),st(e=>e===!0))}function mv(n,e,t,i){let s=e.canMatch;if(!s||s.length===0)return we(!0);let o=s.map(r=>{let l=ir(r,n),a=nv(l)?l.canMatch(e,t):ti(n,()=>l(e,t));return bs(a)});return we(o).pipe(nr(),YI(i))}var Sl=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Cl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function zo(n){return vo(new Sl(n))}function pv(n){return vo(new Se(4e3,!1))}function bv(n){return vo(LI(!1,Rn.GuardRejected))}var Dm=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],s=t.root;for(;;){if(i=i.concat(s.segments),s.numberOfChildren===0)return we(i);if(s.numberOfChildren>1||!s.children[Je])return pv(`${e.redirectTo}`);s=s.children[Je]}}applyRedirectCommands(e,t,i,s,o){if(typeof t!="string"){let l=t,{queryParams:a,fragment:c,routeConfig:d,url:u,outlet:h,params:m,data:f,title:g}=s,b=ti(o,()=>l({params:m,data:f,queryParams:a,fragment:c,routeConfig:d,url:u,outlet:h,title:g}));if(b instanceof Hi)throw new Cl(b);t=b}let r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t[0]==="/")throw new Cl(r);return r}applyRedirectCreateUrlTree(e,t,i,s){let o=this.createSegmentGroup(e,t.root,i,s);return new Hi(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([s,o])=>{if(typeof o=="string"&&o[0]===":"){let l=o.substring(1);i[s]=t[l]}else i[s]=o}),i}createSegmentGroup(e,t,i,s){let o=this.createSegments(e,t.segments,i,s),r={};return Object.entries(t.children).forEach(([l,a])=>{r[l]=this.createSegmentGroup(e,a,i,s)}),new ut(o,r)}createSegments(e,t,i,s){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,s):this.findOrReturn(o,i))}findPosParam(e,t,i){let s=i[t.path.substring(1)];if(!s)throw new Se(4001,!1);return s}findOrReturn(e,t){let i=0;for(let s of t){if(s.path===e.path)return t.splice(i),s;i++}return e}},_m={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function fv(n,e,t,i,s){let o=NI(n,e,t);return o.matched?(i=kx(e,i),mv(i,e,t,s).pipe(st(r=>r===!0?o:be({},_m)))):we(o)}function NI(n,e,t){if(e.path==="**")return gv(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?be({},_m):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let s=(e.matcher||hx)(t,n,e);if(!s)return be({},_m);let o={};Object.entries(s.posParams??{}).forEach(([l,a])=>{o[l]=a.path});let r=s.consumed.length>0?be(be({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:r,positionalParamSegments:s.posParams??{}}}function gv(n){return{matched:!0,parameters:n.length>0?uI(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function lI(n,e,t,i){return t.length>0&&Iv(n,t,i)?{segmentGroup:new ut(e,yv(i,new ut(t,n.children))),slicedSegments:[]}:t.length===0&&Gv(n,t,i)?{segmentGroup:new ut(n.segments,Zv(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new ut(n.segments,n.children),slicedSegments:t}}function Zv(n,e,t,i){let s={};for(let o of t)if(_c(n,e,o)&&!i[ii(o)]){let r=new ut([],{});s[ii(o)]=r}return be(be({},i),s)}function yv(n,e){let t={};t[Je]=e;for(let i of n)if(i.path===""&&ii(i)!==Je){let s=new ut([],{});t[ii(i)]=s}return t}function Iv(n,e,t){return t.some(i=>_c(n,e,i)&&ii(i)!==Je)}function Gv(n,e,t){return t.some(i=>_c(n,e,i))}function _c(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Xv(n,e,t){return e.length===0&&!n.children[t]}var jm=class{};function Vv(n,e,t,i,s,o,r="emptyOnly"){return new Om(n,e,t,i,s,r,o).recognize()}var Rv=31,Om=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,s,o,r,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=s,this.urlTree=o,this.paramsInheritanceStrategy=r,this.urlSerializer=l,this.applyRedirects=new Dm(this.urlSerializer,this.urlTree)}noMatchError(e){return new Se(4002,`'${e.segmentGroup}'`)}recognize(){let e=lI(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(st(({children:t,rootSnapshot:i})=>{let s=new Vn(i,t),o=new Bc("",s),r=Mx(i,[],this.urlTree.queryParams,this.urlTree.fragment);return r.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(r),{state:o,tree:r}}))}match(e){let t=new jo([],Object.freeze({}),Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Je,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Je,t).pipe(st(i=>({children:i,rootSnapshot:t})),ss(i=>{if(i instanceof Cl)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Sl?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,s,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,s,!0,o).pipe(st(r=>r instanceof Vn?[r]:[]))}processChildren(e,t,i,s){let o=[];for(let r of Object.keys(i.children))r==="primary"?o.unshift(r):o.push(r);return wt(o).pipe(Mo(r=>{let l=i.children[r],a=Ux(t,r);return this.processSegmentGroup(e,a,l,r,s)}),Du((r,l)=>(r.push(...l),r)),os(null),zu(),Ut(r=>{if(r===null)return zo(i);let l=wI(r);return Sv(l),we(l)}))}processSegment(e,t,i,s,o,r,l){return wt(t).pipe(Mo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,s,o,r,l).pipe(ss(c=>{if(c instanceof Sl)return we(null);throw c}))),Mi(a=>!!a),ss(a=>{if(TI(a))return Xv(i,s,o)?we(new jm):zo(i);throw a}))}processSegmentAgainstRoute(e,t,i,s,o,r,l,a){return ii(i)!==r&&(r===Je||!_c(s,o,i))?zo(s):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,s,i,o,r,a):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,s,t,i,o,r,a):zo(s)}expandSegmentAgainstRouteUsingRedirect(e,t,i,s,o,r,l){let{matched:a,parameters:c,consumedSegments:d,positionalParamSegments:u,remainingSegments:h}=NI(t,s,o);if(!a)return zo(t);typeof s.redirectTo=="string"&&s.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Rv&&(this.allowRedirects=!1));let m=new jo(o,c,Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,aI(s),ii(s),s.component??s._loadedComponent??null,s,cI(s)),f=Fc(m,l,this.paramsInheritanceStrategy);m.params=Object.freeze(f.params),m.data=Object.freeze(f.data);let g=this.applyRedirects.applyRedirectCommands(d,s.redirectTo,u,m,e);return this.applyRedirects.lineralizeSegments(s,g).pipe(Ut(b=>this.processSegment(e,i,t,b.concat(h),r,!1,l)))}matchSegmentAgainstRoute(e,t,i,s,o,r){let l=fv(t,i,s,e,this.urlSerializer);return i.path==="**"&&(t.children={}),l.pipe(Qn(a=>a.matched?(e=i._injector??e,this.getChildConfig(e,i,s).pipe(Qn(({routes:c})=>{let d=i._loadedInjector??e,{parameters:u,consumedSegments:h,remainingSegments:m}=a,f=new jo(h,u,Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,aI(i),ii(i),i.component??i._loadedComponent??null,i,cI(i)),g=Fc(f,r,this.paramsInheritanceStrategy);f.params=Object.freeze(g.params),f.data=Object.freeze(g.data);let{segmentGroup:b,slicedSegments:p}=lI(t,h,m,c);if(p.length===0&&b.hasChildren())return this.processChildren(d,c,b,f).pipe(st(V=>new Vn(f,V)));if(c.length===0&&p.length===0)return we(new Vn(f,[]));let R=ii(i)===o;return this.processSegment(d,c,b,p,R?Je:o,!0,f).pipe(st(V=>new Vn(f,V instanceof Vn?[V]:[])))}))):zo(t)))}getChildConfig(e,t,i){return t.children?we({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?we({routes:t._loadedRoutes,injector:t._loadedInjector}):hv(e,t,i,this.urlSerializer).pipe(Ut(s=>s?this.configLoader.loadChildren(e,t).pipe(Qt(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):bv(t))):we({routes:[],injector:e})}};function Sv(n){n.sort((e,t)=>e.value.outlet===Je?-1:t.value.outlet===Je?1:e.value.outlet.localeCompare(t.value.outlet))}function Cv(n){let e=n.value.routeConfig;return e&&e.path===""}function wI(n){let e=[],t=new Set;for(let i of n){if(!Cv(i)){e.push(i);continue}let s=e.find(o=>i.value.routeConfig===o.value.routeConfig);s!==void 0?(s.children.push(...i.children),t.add(s)):e.push(i)}for(let i of t){let s=wI(i.children);e.push(new Vn(i.value,s))}return e.filter(i=>!t.has(i))}function aI(n){return n.data||{}}function cI(n){return n.resolve||{}}function Wv(n,e,t,i,s,o){return Ut(r=>Vv(n,e,t,i,r.extractedUrl,s,o).pipe(st(({state:l,tree:a})=>Ct(be({},r),{targetSnapshot:l,urlAfterRedirects:a}))))}function xv(n,e){return Ut(t=>{let{targetSnapshot:i,guards:{canActivateChecks:s}}=t;if(!s.length)return we(t);let o=new Set(s.map(a=>a.route)),r=new Set;for(let a of o)if(!r.has(a))for(let c of HI(a))r.add(c);let l=0;return wt(r).pipe(Mo(a=>o.has(a)?vv(a,i,n,e):(a.data=Fc(a,a.parent,n).resolve,we(void 0))),Qt(()=>l++),To(1),Ut(a=>l===r.size?we(t):pn))})}function HI(n){let e=n.children.map(t=>HI(t)).flat();return[n,...e]}function vv(n,e,t,i){let s=n.routeConfig,o=n._resolve;return s?.title!==void 0&&!CI(s)&&(o[Wl]=s.title),Lv(o,n,e,i).pipe(st(r=>(n._resolvedData=r,n.data=Fc(n,n.parent,t).resolve,null)))}function Lv(n,e,t,i){let s=Wm(n);if(s.length===0)return we({});let o={};return wt(s).pipe(Ut(r=>Mv(n[r],e,t,i).pipe(Mi(),Qt(l=>{if(l instanceof Rl)throw Pc(new qo,l);o[r]=l}))),To(1),st(()=>o),ss(r=>TI(r)?pn:vo(r)))}function Mv(n,e,t,i){let s=xl(e)??i,o=ir(n,s),r=o.resolve?o.resolve(e,t):ti(s,()=>o(e,t));return bs(r)}function Sm(n){return Qn(e=>{let t=n(e);return t?wt(t).pipe(st(()=>e)):we(e)})}var KI=(()=>{class n{buildTitle(t){let i,s=t.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===Je);return i}getResolvedTitleForRoute(t){return t.data[Wl]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(Tv),providedIn:"root"})}return n})(),Tv=(()=>{class n extends KI{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(Ee(nI))};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jc=new ve("",{providedIn:"root",factory:()=>({})}),Oc=new ve(""),kI=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=se(Yy);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return we(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let i=bs(t.loadComponent()).pipe(st(UI),Qt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),_r(()=>{this.componentLoaders.delete(t)})),s=new xo(i,()=>new jt).pipe(Wo());return this.componentLoaders.set(t,s),s}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return we({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Yv(i,this.compiler,t,this.onLoadEndListener).pipe(_r(()=>{this.childrenLoaders.delete(i)})),r=new xo(o,()=>new jt).pipe(Wo());return this.childrenLoaders.set(i,r),r}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Yv(n,e,t,i){return bs(n.loadChildren()).pipe(st(UI),Ut(s=>s instanceof lm||Array.isArray(s)?we(s):wt(e.compileModuleAsync(s))),st(s=>{i&&i(n);let o,r,l=!1;return Array.isArray(s)?(r=s,l=!0):(o=s.create(t).injector,r=o.get(Oc,[],{optional:!0,self:!0}).flat()),{routes:r.map($m),injector:o}}))}function Nv(n){return n&&typeof n=="object"&&"default"in n}function UI(n){return Nv(n)?n.default:n}var ep=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(wv),providedIn:"root"})}return n})(),wv=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),JI=new ve("");var AI=new ve(""),FI=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new jt;transitionAbortSubject=new jt;configLoader=se(kI);environmentInjector=se(Hn);destroyRef=se(bc);urlSerializer=se(zc);rootContexts=se(vl);location=se(Eo);inputBindingEnabled=se(Dc,{optional:!0})!==null;titleStrategy=se(KI);options=se(jc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=se(ep);createViewTransition=se(JI,{optional:!0});navigationErrorHandler=se(AI,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>we(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=s=>this.events.next(new wm(s)),i=s=>this.events.next(new Hm(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(Ct(be({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))}setupNavigations(t){return this.transitions=new Ot(null),this.transitions.pipe(On(i=>i!==null),Qn(i=>{let s=!1,o=!1;return we(i).pipe(Qn(r=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Rn.SupersededByNewNavigation),pn;this.currentTransition=i,this.currentNavigation={id:r.id,initialUrl:r.rawUrl,extractedUrl:r.extractedUrl,targetBrowserUrl:typeof r.extras.browserUrl=="string"?this.urlSerializer.parse(r.extras.browserUrl):r.extras.browserUrl,trigger:r.source,extras:r.extras,previousNavigation:this.lastSuccessfulNavigation?Ct(be({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=r.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&a!=="reload"){let c="";return this.events.next(new ps(r.id,this.urlSerializer.serialize(r.rawUrl),c,kc.IgnoredSameUrlNavigation)),r.resolve(!1),pn}if(this.urlHandlingStrategy.shouldProcessUrl(r.rawUrl))return we(r).pipe(Qn(c=>(this.events.next(new er(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?pn:Promise.resolve(c))),Wv(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Qt(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation=Ct(be({},this.currentNavigation),{finalUrl:c.urlAfterRedirects});let d=new Uc(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(r.currentRawUrl)){let{id:c,extractedUrl:d,source:u,restoredState:h,extras:m}=r,f=new er(c,this.urlSerializer.serialize(d),u,h);this.events.next(f);let g=RI(this.rootComponentType).snapshot;return this.currentTransition=i=Ct(be({},r),{targetSnapshot:g,urlAfterRedirects:d,extras:Ct(be({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,we(i)}else{let c="";return this.events.next(new ps(r.id,this.urlSerializer.serialize(r.extractedUrl),c,kc.IgnoredByUrlHandlingStrategy)),r.resolve(!1),pn}}),Qt(r=>{let l=new Mm(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects),r.targetSnapshot);this.events.next(l)}),st(r=>(this.currentTransition=i=Ct(be({},r),{guards:Dx(r.targetSnapshot,r.currentSnapshot,this.rootContexts)}),i)),sv(this.environmentInjector,r=>this.events.next(r)),Qt(r=>{if(i.guardsResult=r.guardsResult,r.guardsResult&&typeof r.guardsResult!="boolean")throw Pc(this.urlSerializer,r.guardsResult);let l=new Tm(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects),r.targetSnapshot,!!r.guardsResult);this.events.next(l)}),On(r=>r.guardsResult?!0:(this.cancelNavigationTransition(r,"",Rn.GuardRejected),!1)),Sm(r=>{if(r.guards.canActivateChecks.length!==0)return we(r).pipe(Qt(l=>{let a=new Ym(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(a)}),Qn(l=>{let a=!1;return we(l).pipe(xv(this.paramsInheritanceStrategy,this.environmentInjector),Qt({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(l,"",Rn.NoDataFromResolver)}}))}),Qt(l=>{let a=new Nm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(a)}))}),Sm(r=>{let l=a=>{let c=[];a.routeConfig?.loadComponent&&!a.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(a.routeConfig).pipe(Qt(d=>{a.component=d}),st(()=>{})));for(let d of a.children)c.push(...l(d));return c};return Ta(l(r.targetSnapshot.root)).pipe(os(null),Li(1))}),Sm(()=>this.afterPreactivation()),Qn(()=>{let{currentSnapshot:r,targetSnapshot:l}=i,a=this.createViewTransition?.(this.environmentInjector,r.root,l.root);return a?wt(a).pipe(st(()=>i)):we(i)}),st(r=>{let l=Fx(t.routeReuseStrategy,r.targetSnapshot,r.currentRouterState);return this.currentTransition=i=Ct(be({},r),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,i}),Qt(()=>{this.events.next(new Xl)}),zx(this.rootContexts,t.routeReuseStrategy,r=>this.events.next(r),this.inputBindingEnabled),Li(1),Qt({next:r=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ms(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects))),this.titleStrategy?.updateTitle(r.targetRouterState.snapshot),r.resolve(!0)},complete:()=>{s=!0}}),ju(this.transitionAbortSubject.pipe(Qt(r=>{throw r}))),_r(()=>{!s&&!o&&this.cancelNavigationTransition(i,"",Rn.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),ss(r=>{if(this.destroyed)return i.resolve(!1),pn;if(o=!0,MI(r))this.events.next(new wi(i.id,this.urlSerializer.serialize(i.extractedUrl),r.message,r.cancellationCode)),Ex(r)?this.events.next(new tr(r.url,r.navigationBehaviorOptions)):i.resolve(!1);else{let l=new Gl(i.id,this.urlSerializer.serialize(i.extractedUrl),r,i.targetSnapshot??void 0);try{let a=ti(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(a instanceof Rl){let{message:c,cancellationCode:d}=Pc(this.urlSerializer,a);this.events.next(new wi(i.id,this.urlSerializer.serialize(i.extractedUrl),c,d)),this.events.next(new tr(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(l),r}catch(a){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(a)}}return pn}))}))}cancelNavigationTransition(t,i,s){let o=new wi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,s);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Hv(n){return n!==wc}var Kv=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(kv),providedIn:"root"})}return n})(),Qm=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},kv=(()=>{class n extends Qm{static \u0275fac=(()=>{let t;return function(s){return(t||(t=Dh(n)))(s||n)}})();static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),BI=(()=>{class n{urlSerializer=se(zc);options=se(jc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=se(Eo);urlHandlingStrategy=se(ep);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Hi;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:s}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,r=s??o;return r instanceof Hi?this.urlSerializer.serialize(r):r}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:s}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,s),this.routerState=t):this.rawUrlTree=s}routerState=RI(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:()=>se(Uv),providedIn:"root"})}return n})(),Uv=(()=>{class n extends BI{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof er?this.updateStateMemento():t instanceof ps?this.commitTransition(i):t instanceof Uc?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Xl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof wi&&(t.code===Rn.GuardRejected||t.code===Rn.NoDataFromResolver)?this.restoreHistory(i):t instanceof Gl?this.restoreHistory(i,!0):t instanceof ms&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:s}){let{replaceUrl:o,state:r}=i;if(this.location.isCurrentPathEqualTo(t)||o){let l=this.browserPageId,a=be(be({},r),this.generateNgRouterState(s,l));this.location.replaceState(t,"",a)}else{let l=be(be({},r),this.generateNgRouterState(s,this.browserPageId+1));this.location.go(t,"",l)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(s){return(t||(t=Dh(n)))(s||n)}})();static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function PI(n,e){n.events.pipe(On(t=>t instanceof ms||t instanceof wi||t instanceof Gl||t instanceof ps),st(t=>t instanceof ms||t instanceof ps?0:(t instanceof wi?t.code===Rn.Redirect||t.code===Rn.SupersededByNewNavigation:!1)?2:1),On(t=>t!==2),Li(1)).subscribe(()=>{e()})}var Jv={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Av={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},tp=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=se(Wy);stateManager=se(BI);options=se(jc,{optional:!0})||{};pendingTasks=se(Bo);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=se(FI);urlSerializer=se(zc);location=se(Eo);urlHandlingStrategy=se(ep);_events=new jt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=se(Kv);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=se(Oc,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!se(Dc,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Nt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof wi&&i.code!==Rn.Redirect&&i.code!==Rn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ms)this.navigated=!0;else if(i instanceof tr){let r=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),a=be({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Hv(s.source)},r);this.scheduleNavigation(l,wc,null,a,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Bv(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),wc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,s)=>{this.navigateToSyncWithBrowser(t,s,i)})}navigateToSyncWithBrowser(t,i,s){let o={replaceUrl:!0},r=s?.navigationId?s:null;if(s){let a=be({},s);delete a.navigationId,delete a.\u0275routerPageId,Object.keys(a).length!==0&&(o.state=a)}let l=this.parseUrl(t);this.scheduleNavigation(l,i,r,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map($m),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:s,queryParams:o,fragment:r,queryParamsHandling:l,preserveFragment:a}=i,c=a?this.currentUrlTree.fragment:r,d=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":d=be(be({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let u;try{let h=s?s.snapshot:this.routerState.snapshot.root;u=II(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),u=this.currentUrlTree.root}return GI(u,t,d,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){let s=$o(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,wc,null,i)}navigate(t,i={skipLocationChange:!1}){return Fv(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let s;if(i===!0?s=be({},Jv):i===!1?s=be({},Av):s=i,$o(t))return iI(this.currentUrlTree,t,s);let o=this.parseUrl(t);return iI(this.currentUrlTree,o,s)}removeEmptyProps(t){return Object.entries(t).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(t,i,s,o,r){if(this.disposed)return Promise.resolve(!1);let l,a,c;r?(l=r.resolve,a=r.reject,c=r.promise):c=new Promise((u,h)=>{l=u,a=h});let d=this.pendingTasks.add();return PI(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:l,reject:a,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(u=>Promise.reject(u))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Fv(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Se(4008,!1)}function Bv(n){return!(n instanceof Xl)&&!(n instanceof tr)}var Pv=new ve("");function np(n,...e){return Uh([{provide:Oc,multi:!0,useValue:n},[],{provide:$s,useFactory:Ev,deps:[tp]},{provide:am,multi:!0,useFactory:zv},e.map(t=>t.\u0275providers)])}function Ev(n){return n.routerState.root}function zv(){let n=se(ds);return e=>{let t=n.get(zs);if(e!==t.components[0])return;let i=n.get(tp),s=n.get(Dv);n.get(_v)===1&&i.initialNavigation(),n.get(jv,null,Ue.Optional)?.setUpPreloading(),n.get(Pv,null,Ue.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}var Dv=new ve("",{factory:()=>new jt}),_v=new ve("",{providedIn:"root",factory:()=>1});var jv=new ve("");var EI=[];var zI={providers:[wy({eventCoalescing:!0}),np(EI)]};var _b="170";var Qv=0,DI=1,qv=2;var fX=1,$v=2,Bi=3,Vi=0,Zn=1,li=2,Rs=0,Gr=1,_I=2,jI=3,OI=4,e2=5,lo=100,t2=101,n2=102,i2=103,s2=104,o2=200,r2=201,l2=202,a2=203,wp=204,Hp=205,c2=206,d2=207,u2=208,h2=209,m2=210,p2=211,b2=212,f2=213,g2=214,Kp=0,kp=1,Up=2,Sr=3,Jp=4,Ap=5,Fp=6,Bp=7,gX=0,Z2=1,y2=2,Ss=0,I2=1,G2=2,X2=3,V2=4,R2=5,S2=6,C2=7,QI="attached",W2="detached",qI=300,Cr=301,Wr=302,Pp=303,Ep=304,lu=306,uo=1e3,Ei=1001,El=1002,ln=1003,jb=1004;var yr=1005;var gn=1006,Al=1007;var Gi=1008;var _i=1009,ZX=1010,yX=1011,zl=1012,Ob=1013,ho=1014,ci=1015,sa=1016,Qb=1017,qb=1018,xr=1020,IX=35902,GX=1021,XX=1022,Un=1023,VX=1024,RX=1025,Xr=1026,vr=1027,$b=1028,ef=1029,SX=1030,tf=1031;var nf=1033,Rd=33776,Sd=33777,Cd=33778,Wd=33779,zp=35840,Dp=35841,_p=35842,jp=35843,Op=36196,Qp=37492,qp=37496,$p=37808,eb=37809,tb=37810,nb=37811,ib=37812,sb=37813,ob=37814,rb=37815,lb=37816,ab=37817,cb=37818,db=37819,ub=37820,hb=37821,xd=36492,mb=36494,pb=36495,CX=36283,bb=36284,fb=36285,gb=36286;var Lr=2300,Mr=2301,ip=2302,$I=2400,eG=2401,tG=2402,x2=2500;var WX=0,au=1,oa=2,v2=3200,L2=3201;var xX=0,M2=1,Xs="",Kt="srgb",an="srgb-linear",cu="linear",gt="srgb";var sr=7680;var nG=519,T2=512,Y2=513,N2=514,vX=515,w2=516,H2=517,K2=518,k2=519,Zb=35044;var iG="300 es",zi=2e3,vd=2001,Cs=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let s=this._listeners[e];if(s!==void 0){let o=s.indexOf(t);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let s=i.slice(0);for(let o=0,r=s.length;o<r;o++)s[o].call(this,e);e.target=null}}},nn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],sG=1234567,Fl=Math.PI/180,Tr=180/Math.PI;function di(){let n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(nn[n&255]+nn[n>>8&255]+nn[n>>16&255]+nn[n>>24&255]+"-"+nn[e&255]+nn[e>>8&255]+"-"+nn[e>>16&15|64]+nn[e>>24&255]+"-"+nn[t&63|128]+nn[t>>8&255]+"-"+nn[t>>16&255]+nn[t>>24&255]+nn[i&255]+nn[i>>8&255]+nn[i>>16&255]+nn[i>>24&255]).toLowerCase()}function on(n,e,t){return Math.max(e,Math.min(t,n))}function sf(n,e){return(n%e+e)%e}function U2(n,e,t,i,s){return i+(n-e)*(s-i)/(t-e)}function J2(n,e,t){return n!==e?(t-n)/(e-n):0}function Bl(n,e,t){return(1-t)*n+t*e}function A2(n,e,t,i){return Bl(n,e,1-Math.exp(-t*i))}function F2(n,e=1){return e-Math.abs(sf(n,e*2)-e)}function B2(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function P2(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function E2(n,e){return n+Math.floor(Math.random()*(e-n+1))}function z2(n,e){return n+Math.random()*(e-n)}function D2(n){return n*(.5-Math.random())}function _2(n){n!==void 0&&(sG=n);let e=sG+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function j2(n){return n*Fl}function O2(n){return n*Tr}function Q2(n){return(n&n-1)===0&&n!==0}function q2(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function $2(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function e5(n,e,t,i,s){let o=Math.cos,r=Math.sin,l=o(t/2),a=r(t/2),c=o((e+i)/2),d=r((e+i)/2),u=o((e-i)/2),h=r((e-i)/2),m=o((i-e)/2),f=r((i-e)/2);switch(s){case"XYX":n.set(l*d,a*u,a*h,l*c);break;case"YZY":n.set(a*h,l*d,a*u,l*c);break;case"ZXZ":n.set(a*u,a*h,l*d,l*c);break;case"XZX":n.set(l*d,a*f,a*m,l*c);break;case"YXY":n.set(a*m,l*d,a*f,l*c);break;case"ZYZ":n.set(a*f,a*m,l*d,l*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function ai(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function pt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var LX={DEG2RAD:Fl,RAD2DEG:Tr,generateUUID:di,clamp:on,euclideanModulo:sf,mapLinear:U2,inverseLerp:J2,lerp:Bl,damp:A2,pingpong:F2,smoothstep:B2,smootherstep:P2,randInt:E2,randFloat:z2,randFloatSpread:D2,seededRandom:_2,degToRad:j2,radToDeg:O2,isPowerOfTwo:Q2,ceilPowerOfTwo:q2,floorPowerOfTwo:$2,setQuaternionFromProperEuler:e5,normalize:pt,denormalize:ai},Oe=class n{constructor(e=0,t=0){n.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(on(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),s=Math.sin(t),o=this.x-e.x,r=this.y-e.y;return this.x=o*i-r*s+e.x,this.y=o*s+r*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ae=class n{constructor(e,t,i,s,o,r,l,a,c){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,r,l,a,c)}set(e,t,i,s,o,r,l,a,c){let d=this.elements;return d[0]=e,d[1]=s,d[2]=l,d[3]=t,d[4]=o,d[5]=a,d[6]=i,d[7]=r,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,r=i[0],l=i[3],a=i[6],c=i[1],d=i[4],u=i[7],h=i[2],m=i[5],f=i[8],g=s[0],b=s[3],p=s[6],R=s[1],V=s[4],I=s[7],w=s[2],W=s[5],C=s[8];return o[0]=r*g+l*R+a*w,o[3]=r*b+l*V+a*W,o[6]=r*p+l*I+a*C,o[1]=c*g+d*R+u*w,o[4]=c*b+d*V+u*W,o[7]=c*p+d*I+u*C,o[2]=h*g+m*R+f*w,o[5]=h*b+m*V+f*W,o[8]=h*p+m*I+f*C,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8];return t*r*d-t*l*c-i*o*d+i*l*a+s*o*c-s*r*a}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8],u=d*r-l*c,h=l*a-d*o,m=c*o-r*a,f=t*u+i*h+s*m;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let g=1/f;return e[0]=u*g,e[1]=(s*c-d*i)*g,e[2]=(l*i-s*r)*g,e[3]=h*g,e[4]=(d*t-s*a)*g,e[5]=(s*o-l*t)*g,e[6]=m*g,e[7]=(i*a-c*t)*g,e[8]=(r*t-i*o)*g,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,o,r,l){let a=Math.cos(o),c=Math.sin(o);return this.set(i*a,i*c,-i*(a*r+c*l)+r+e,-s*c,s*a,-s*(-c*r+a*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(sp.makeScale(e,t)),this}rotate(e){return this.premultiply(sp.makeRotation(-e)),this}translate(e,t){return this.premultiply(sp.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},sp=new Ae;function MX(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Dl(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function t5(){let n=Dl("canvas");return n.style.display="block",n}var oG={};function Ul(n){n in oG||(oG[n]=!0,console.warn(n))}function n5(n,e,t){return new Promise(function(i,s){function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:s();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:i()}}setTimeout(o,t)})}function i5(n){let e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function s5(n){let e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}var je={enabled:!0,workingColorSpace:an,spaces:{},convert:function(n,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===gt&&(n.r=Di(n.r),n.g=Di(n.g),n.b=Di(n.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(n.applyMatrix3(this.spaces[e].toXYZ),n.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===gt&&(n.r=Vr(n.r),n.g=Vr(n.g),n.b=Vr(n.b))),n},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===Xs?cu:this.spaces[n].transfer},getLuminanceCoefficients:function(n,e=this.workingColorSpace){return n.fromArray(this.spaces[e].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,e,t){return n.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace}};function Di(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Vr(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}var rG=[.64,.33,.3,.6,.15,.06],lG=[.2126,.7152,.0722],aG=[.3127,.329],cG=new Ae().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),dG=new Ae().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);je.define({[an]:{primaries:rG,whitePoint:aG,transfer:cu,toXYZ:cG,fromXYZ:dG,luminanceCoefficients:lG,workingColorSpaceConfig:{unpackColorSpace:Kt},outputColorSpaceConfig:{drawingBufferColorSpace:Kt}},[Kt]:{primaries:rG,whitePoint:aG,transfer:gt,toXYZ:cG,fromXYZ:dG,luminanceCoefficients:lG,outputColorSpaceConfig:{drawingBufferColorSpace:Kt}}});var or,yb=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{or===void 0&&(or=Dl("canvas")),or.width=e.width,or.height=e.height;let i=or.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=or}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Dl("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let r=0;r<o.length;r++)o[r]=Di(o[r]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Di(t[i]/255)*255):t[i]=Di(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},o5=0,Ld=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:o5++}),this.uuid=di(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let r=0,l=s.length;r<l;r++)s[r].isDataTexture?o.push(op(s[r].image)):o.push(op(s[r]))}else o=op(s);i.url=o}return t||(e.images[this.uuid]=i),i}};function op(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?yb.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var r5=0,Pn=(()=>{class n extends Cs{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,s=Ei,o=Ei,r=gn,l=Gi,a=Un,c=_i,d=n.DEFAULT_ANISOTROPY,u=Xs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:r5++}),this.uuid=di(),this.name="",this.source=new Ld(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=o,this.magFilter=r,this.minFilter=l,this.anisotropy=d,this.format=a,this.internalFormat=null,this.type=c,this.offset=new Oe(0,0),this.repeat=new Oe(1,1),this.center=new Oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ae,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==qI)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case uo:t.x=t.x-Math.floor(t.x);break;case Ei:t.x=t.x<0?0:1;break;case El:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case uo:t.y=t.y-Math.floor(t.y);break;case Ei:t.y=t.y<0?0:1;break;case El:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=qI,n.DEFAULT_ANISOTROPY=1,n})(),at=class n{constructor(e=0,t=0,i=0,s=1){n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=this.w,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*s+r[12]*o,this.y=r[1]*t+r[5]*i+r[9]*s+r[13]*o,this.z=r[2]*t+r[6]*i+r[10]*s+r[14]*o,this.w=r[3]*t+r[7]*i+r[11]*s+r[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,o,a=e.elements,c=a[0],d=a[4],u=a[8],h=a[1],m=a[5],f=a[9],g=a[2],b=a[6],p=a[10];if(Math.abs(d-h)<.01&&Math.abs(u-g)<.01&&Math.abs(f-b)<.01){if(Math.abs(d+h)<.1&&Math.abs(u+g)<.1&&Math.abs(f+b)<.1&&Math.abs(c+m+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let V=(c+1)/2,I=(m+1)/2,w=(p+1)/2,W=(d+h)/4,C=(u+g)/4,N=(f+b)/4;return V>I&&V>w?V<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(V),s=W/i,o=C/i):I>w?I<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(I),i=W/s,o=N/s):w<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(w),i=C/o,s=N/o),this.set(i,s,o,t),this}let R=Math.sqrt((b-f)*(b-f)+(u-g)*(u-g)+(h-d)*(h-d));return Math.abs(R)<.001&&(R=1),this.x=(b-f)/R,this.y=(u-g)/R,this.z=(h-d)/R,this.w=Math.acos((c+m+p-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Ib=class extends Cs{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new at(0,0,e,t),this.scissorTest=!1,this.viewport=new at(0,0,e,t);let s={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:gn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);let o=new Pn(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];let r=i.count;for(let l=0;l<r;l++)this.textures[l]=o.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,s=e.textures.length;i<s;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Ld(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},ji=class extends Ib{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},Md=class extends Pn{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=ln,this.minFilter=ln,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};var Gb=class extends Pn{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=ln,this.minFilter=ln,this.wrapR=Ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var ui=class{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,o,r,l){let a=i[s+0],c=i[s+1],d=i[s+2],u=i[s+3],h=o[r+0],m=o[r+1],f=o[r+2],g=o[r+3];if(l===0){e[t+0]=a,e[t+1]=c,e[t+2]=d,e[t+3]=u;return}if(l===1){e[t+0]=h,e[t+1]=m,e[t+2]=f,e[t+3]=g;return}if(u!==g||a!==h||c!==m||d!==f){let b=1-l,p=a*h+c*m+d*f+u*g,R=p>=0?1:-1,V=1-p*p;if(V>Number.EPSILON){let w=Math.sqrt(V),W=Math.atan2(w,p*R);b=Math.sin(b*W)/w,l=Math.sin(l*W)/w}let I=l*R;if(a=a*b+h*I,c=c*b+m*I,d=d*b+f*I,u=u*b+g*I,b===1-l){let w=1/Math.sqrt(a*a+c*c+d*d+u*u);a*=w,c*=w,d*=w,u*=w}}e[t]=a,e[t+1]=c,e[t+2]=d,e[t+3]=u}static multiplyQuaternionsFlat(e,t,i,s,o,r){let l=i[s],a=i[s+1],c=i[s+2],d=i[s+3],u=o[r],h=o[r+1],m=o[r+2],f=o[r+3];return e[t]=l*f+d*u+a*m-c*h,e[t+1]=a*f+d*h+c*u-l*m,e[t+2]=c*f+d*m+l*h-a*u,e[t+3]=d*f-l*u-a*h-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let i=e._x,s=e._y,o=e._z,r=e._order,l=Math.cos,a=Math.sin,c=l(i/2),d=l(s/2),u=l(o/2),h=a(i/2),m=a(s/2),f=a(o/2);switch(r){case"XYZ":this._x=h*d*u+c*m*f,this._y=c*m*u-h*d*f,this._z=c*d*f+h*m*u,this._w=c*d*u-h*m*f;break;case"YXZ":this._x=h*d*u+c*m*f,this._y=c*m*u-h*d*f,this._z=c*d*f-h*m*u,this._w=c*d*u+h*m*f;break;case"ZXY":this._x=h*d*u-c*m*f,this._y=c*m*u+h*d*f,this._z=c*d*f+h*m*u,this._w=c*d*u-h*m*f;break;case"ZYX":this._x=h*d*u-c*m*f,this._y=c*m*u+h*d*f,this._z=c*d*f-h*m*u,this._w=c*d*u+h*m*f;break;case"YZX":this._x=h*d*u+c*m*f,this._y=c*m*u+h*d*f,this._z=c*d*f-h*m*u,this._w=c*d*u-h*m*f;break;case"XZY":this._x=h*d*u-c*m*f,this._y=c*m*u-h*d*f,this._z=c*d*f+h*m*u,this._w=c*d*u+h*m*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],s=t[4],o=t[8],r=t[1],l=t[5],a=t[9],c=t[2],d=t[6],u=t[10],h=i+l+u;if(h>0){let m=.5/Math.sqrt(h+1);this._w=.25/m,this._x=(d-a)*m,this._y=(o-c)*m,this._z=(r-s)*m}else if(i>l&&i>u){let m=2*Math.sqrt(1+i-l-u);this._w=(d-a)/m,this._x=.25*m,this._y=(s+r)/m,this._z=(o+c)/m}else if(l>u){let m=2*Math.sqrt(1+l-i-u);this._w=(o-c)/m,this._x=(s+r)/m,this._y=.25*m,this._z=(a+d)/m}else{let m=2*Math.sqrt(1+u-i-l);this._w=(r-s)/m,this._x=(o+c)/m,this._y=(a+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(on(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,s=e._y,o=e._z,r=e._w,l=t._x,a=t._y,c=t._z,d=t._w;return this._x=i*d+r*l+s*c-o*a,this._y=s*d+r*a+o*l-i*c,this._z=o*d+r*c+i*a-s*l,this._w=r*d-i*l-s*a-o*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,s=this._y,o=this._z,r=this._w,l=r*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=r,this._x=i,this._y=s,this._z=o,this;let a=1-l*l;if(a<=Number.EPSILON){let m=1-t;return this._w=m*r+t*this._w,this._x=m*i+t*this._x,this._y=m*s+t*this._y,this._z=m*o+t*this._z,this.normalize(),this}let c=Math.sqrt(a),d=Math.atan2(c,l),u=Math.sin((1-t)*d)/c,h=Math.sin(t*d)/c;return this._w=r*u+this._w*h,this._x=i*u+this._x*h,this._y=s*u+this._y*h,this._z=o*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},T=class n{constructor(e=0,t=0,i=0){n.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(uG.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(uG.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*s,this.y=o[1]*t+o[4]*i+o[7]*s,this.z=o[2]*t+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,s=this.z,o=e.elements,r=1/(o[3]*t+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*s+o[12])*r,this.y=(o[1]*t+o[5]*i+o[9]*s+o[13])*r,this.z=(o[2]*t+o[6]*i+o[10]*s+o[14])*r,this}applyQuaternion(e){let t=this.x,i=this.y,s=this.z,o=e.x,r=e.y,l=e.z,a=e.w,c=2*(r*s-l*i),d=2*(l*t-o*s),u=2*(o*i-r*t);return this.x=t+a*c+r*u-l*d,this.y=i+a*d+l*c-o*u,this.z=s+a*u+o*d-r*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s,this.y=o[1]*t+o[5]*i+o[9]*s,this.z=o[2]*t+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,s=e.y,o=e.z,r=t.x,l=t.y,a=t.z;return this.x=s*a-o*l,this.y=o*r-i*a,this.z=i*l-s*r,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return rp.copy(this).projectOnVector(e),this.sub(rp)}reflect(e){return this.sub(rp.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(on(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},rp=new T,uG=new ui,An=class{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(si.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(si.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=si.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let o=i.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let r=0,l=o.count;r<l;r++)e.isMesh===!0?e.getVertexPosition(r,si):si.fromBufferAttribute(o,r),si.applyMatrix4(e.matrixWorld),this.expandByPoint(si);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Qc.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Qc.copy(i.boundingBox)),Qc.applyMatrix4(e.matrixWorld),this.union(Qc)}let s=e.children;for(let o=0,r=s.length;o<r;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,si),si.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ml),qc.subVectors(this.max,Ml),rr.subVectors(e.a,Ml),lr.subVectors(e.b,Ml),ar.subVectors(e.c,Ml),fs.subVectors(lr,rr),gs.subVectors(ar,lr),eo.subVectors(rr,ar);let t=[0,-fs.z,fs.y,0,-gs.z,gs.y,0,-eo.z,eo.y,fs.z,0,-fs.x,gs.z,0,-gs.x,eo.z,0,-eo.x,-fs.y,fs.x,0,-gs.y,gs.x,0,-eo.y,eo.x,0];return!lp(t,rr,lr,ar,qc)||(t=[1,0,0,0,1,0,0,0,1],!lp(t,rr,lr,ar,qc))?!1:($c.crossVectors(fs,gs),t=[$c.x,$c.y,$c.z],lp(t,rr,lr,ar,qc))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,si).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(si).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ki[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ki[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ki[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ki[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ki[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ki[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ki[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ki[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ki),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Ki=[new T,new T,new T,new T,new T,new T,new T,new T],si=new T,Qc=new An,rr=new T,lr=new T,ar=new T,fs=new T,gs=new T,eo=new T,Ml=new T,qc=new T,$c=new T,to=new T;function lp(n,e,t,i,s){for(let o=0,r=n.length-3;o<=r;o+=3){to.fromArray(n,o);let l=s.x*Math.abs(to.x)+s.y*Math.abs(to.y)+s.z*Math.abs(to.z),a=e.dot(to),c=t.dot(to),d=i.dot(to);if(Math.max(-Math.max(a,c,d),Math.min(a,c,d))>l)return!1}return!0}var l5=new An,Tl=new T,ap=new T,Wn=class{constructor(e=new T,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):l5.setFromPoints(e).getCenter(i);let s=0;for(let o=0,r=e.length;o<r;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Tl.subVectors(e,this.center);let t=Tl.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(Tl,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ap.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Tl.copy(e.center).add(ap)),this.expandByPoint(Tl.copy(e.center).sub(ap))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},ki=new T,cp=new T,ed=new T,Zs=new T,dp=new T,td=new T,up=new T,mo=class{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ki)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=ki.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ki.copy(this.origin).addScaledVector(this.direction,t),ki.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){cp.copy(e).add(t).multiplyScalar(.5),ed.copy(t).sub(e).normalize(),Zs.copy(this.origin).sub(cp);let o=e.distanceTo(t)*.5,r=-this.direction.dot(ed),l=Zs.dot(this.direction),a=-Zs.dot(ed),c=Zs.lengthSq(),d=Math.abs(1-r*r),u,h,m,f;if(d>0)if(u=r*a-l,h=r*l-a,f=o*d,u>=0)if(h>=-f)if(h<=f){let g=1/d;u*=g,h*=g,m=u*(u+r*h+2*l)+h*(r*u+h+2*a)+c}else h=o,u=Math.max(0,-(r*h+l)),m=-u*u+h*(h+2*a)+c;else h=-o,u=Math.max(0,-(r*h+l)),m=-u*u+h*(h+2*a)+c;else h<=-f?(u=Math.max(0,-(-r*o+l)),h=u>0?-o:Math.min(Math.max(-o,-a),o),m=-u*u+h*(h+2*a)+c):h<=f?(u=0,h=Math.min(Math.max(-o,-a),o),m=h*(h+2*a)+c):(u=Math.max(0,-(r*o+l)),h=u>0?o:Math.min(Math.max(-o,-a),o),m=-u*u+h*(h+2*a)+c);else h=r>0?-o:o,u=Math.max(0,-(r*h+l)),m=-u*u+h*(h+2*a)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,u),s&&s.copy(cp).addScaledVector(ed,h),m}intersectSphere(e,t){ki.subVectors(e.center,this.origin);let i=ki.dot(this.direction),s=ki.dot(ki)-i*i,o=e.radius*e.radius;if(s>o)return null;let r=Math.sqrt(o-s),l=i-r,a=i+r;return a<0?null:l<0?this.at(a,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,o,r,l,a,c=1/this.direction.x,d=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,s=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,s=(e.min.x-h.x)*c),d>=0?(o=(e.min.y-h.y)*d,r=(e.max.y-h.y)*d):(o=(e.max.y-h.y)*d,r=(e.min.y-h.y)*d),i>r||o>s||((o>i||isNaN(i))&&(i=o),(r<s||isNaN(s))&&(s=r),u>=0?(l=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(l=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),i>a||l>s)||((l>i||i!==i)&&(i=l),(a<s||s!==s)&&(s=a),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,ki)!==null}intersectTriangle(e,t,i,s,o){dp.subVectors(t,e),td.subVectors(i,e),up.crossVectors(dp,td);let r=this.direction.dot(up),l;if(r>0){if(s)return null;l=1}else if(r<0)l=-1,r=-r;else return null;Zs.subVectors(this.origin,e);let a=l*this.direction.dot(td.crossVectors(Zs,td));if(a<0)return null;let c=l*this.direction.dot(dp.cross(Zs));if(c<0||a+c>r)return null;let d=-l*Zs.dot(up);return d<0?null:this.at(d/r,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ye=class n{constructor(e,t,i,s,o,r,l,a,c,d,u,h,m,f,g,b){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,r,l,a,c,d,u,h,m,f,g,b)}set(e,t,i,s,o,r,l,a,c,d,u,h,m,f,g,b){let p=this.elements;return p[0]=e,p[4]=t,p[8]=i,p[12]=s,p[1]=o,p[5]=r,p[9]=l,p[13]=a,p[2]=c,p[6]=d,p[10]=u,p[14]=h,p[3]=m,p[7]=f,p[11]=g,p[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,s=1/cr.setFromMatrixColumn(e,0).length(),o=1/cr.setFromMatrixColumn(e,1).length(),r=1/cr.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*r,t[9]=i[9]*r,t[10]=i[10]*r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,s=e.y,o=e.z,r=Math.cos(i),l=Math.sin(i),a=Math.cos(s),c=Math.sin(s),d=Math.cos(o),u=Math.sin(o);if(e.order==="XYZ"){let h=r*d,m=r*u,f=l*d,g=l*u;t[0]=a*d,t[4]=-a*u,t[8]=c,t[1]=m+f*c,t[5]=h-g*c,t[9]=-l*a,t[2]=g-h*c,t[6]=f+m*c,t[10]=r*a}else if(e.order==="YXZ"){let h=a*d,m=a*u,f=c*d,g=c*u;t[0]=h+g*l,t[4]=f*l-m,t[8]=r*c,t[1]=r*u,t[5]=r*d,t[9]=-l,t[2]=m*l-f,t[6]=g+h*l,t[10]=r*a}else if(e.order==="ZXY"){let h=a*d,m=a*u,f=c*d,g=c*u;t[0]=h-g*l,t[4]=-r*u,t[8]=f+m*l,t[1]=m+f*l,t[5]=r*d,t[9]=g-h*l,t[2]=-r*c,t[6]=l,t[10]=r*a}else if(e.order==="ZYX"){let h=r*d,m=r*u,f=l*d,g=l*u;t[0]=a*d,t[4]=f*c-m,t[8]=h*c+g,t[1]=a*u,t[5]=g*c+h,t[9]=m*c-f,t[2]=-c,t[6]=l*a,t[10]=r*a}else if(e.order==="YZX"){let h=r*a,m=r*c,f=l*a,g=l*c;t[0]=a*d,t[4]=g-h*u,t[8]=f*u+m,t[1]=u,t[5]=r*d,t[9]=-l*d,t[2]=-c*d,t[6]=m*u+f,t[10]=h-g*u}else if(e.order==="XZY"){let h=r*a,m=r*c,f=l*a,g=l*c;t[0]=a*d,t[4]=-u,t[8]=c*d,t[1]=h*u+g,t[5]=r*d,t[9]=m*u-f,t[2]=f*u-m,t[6]=l*d,t[10]=g*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(a5,e,c5)}lookAt(e,t,i){let s=this.elements;return Sn.subVectors(e,t),Sn.lengthSq()===0&&(Sn.z=1),Sn.normalize(),ys.crossVectors(i,Sn),ys.lengthSq()===0&&(Math.abs(i.z)===1?Sn.x+=1e-4:Sn.z+=1e-4,Sn.normalize(),ys.crossVectors(i,Sn)),ys.normalize(),nd.crossVectors(Sn,ys),s[0]=ys.x,s[4]=nd.x,s[8]=Sn.x,s[1]=ys.y,s[5]=nd.y,s[9]=Sn.y,s[2]=ys.z,s[6]=nd.z,s[10]=Sn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,r=i[0],l=i[4],a=i[8],c=i[12],d=i[1],u=i[5],h=i[9],m=i[13],f=i[2],g=i[6],b=i[10],p=i[14],R=i[3],V=i[7],I=i[11],w=i[15],W=s[0],C=s[4],N=s[8],X=s[12],G=s[1],x=s[5],F=s[9],U=s[13],z=s[2],j=s[6],B=s[10],Q=s[14],J=s[3],ne=s[7],de=s[11],fe=s[15];return o[0]=r*W+l*G+a*z+c*J,o[4]=r*C+l*x+a*j+c*ne,o[8]=r*N+l*F+a*B+c*de,o[12]=r*X+l*U+a*Q+c*fe,o[1]=d*W+u*G+h*z+m*J,o[5]=d*C+u*x+h*j+m*ne,o[9]=d*N+u*F+h*B+m*de,o[13]=d*X+u*U+h*Q+m*fe,o[2]=f*W+g*G+b*z+p*J,o[6]=f*C+g*x+b*j+p*ne,o[10]=f*N+g*F+b*B+p*de,o[14]=f*X+g*U+b*Q+p*fe,o[3]=R*W+V*G+I*z+w*J,o[7]=R*C+V*x+I*j+w*ne,o[11]=R*N+V*F+I*B+w*de,o[15]=R*X+V*U+I*Q+w*fe,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],s=e[8],o=e[12],r=e[1],l=e[5],a=e[9],c=e[13],d=e[2],u=e[6],h=e[10],m=e[14],f=e[3],g=e[7],b=e[11],p=e[15];return f*(+o*a*u-s*c*u-o*l*h+i*c*h+s*l*m-i*a*m)+g*(+t*a*m-t*c*h+o*r*h-s*r*m+s*c*d-o*a*d)+b*(+t*c*u-t*l*m-o*r*u+i*r*m+o*l*d-i*c*d)+p*(-s*l*d-t*a*u+t*l*h+s*r*u-i*r*h+i*a*d)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8],u=e[9],h=e[10],m=e[11],f=e[12],g=e[13],b=e[14],p=e[15],R=u*b*c-g*h*c+g*a*m-l*b*m-u*a*p+l*h*p,V=f*h*c-d*b*c-f*a*m+r*b*m+d*a*p-r*h*p,I=d*g*c-f*u*c+f*l*m-r*g*m-d*l*p+r*u*p,w=f*u*a-d*g*a-f*l*h+r*g*h+d*l*b-r*u*b,W=t*R+i*V+s*I+o*w;if(W===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let C=1/W;return e[0]=R*C,e[1]=(g*h*o-u*b*o-g*s*m+i*b*m+u*s*p-i*h*p)*C,e[2]=(l*b*o-g*a*o+g*s*c-i*b*c-l*s*p+i*a*p)*C,e[3]=(u*a*o-l*h*o-u*s*c+i*h*c+l*s*m-i*a*m)*C,e[4]=V*C,e[5]=(d*b*o-f*h*o+f*s*m-t*b*m-d*s*p+t*h*p)*C,e[6]=(f*a*o-r*b*o-f*s*c+t*b*c+r*s*p-t*a*p)*C,e[7]=(r*h*o-d*a*o+d*s*c-t*h*c-r*s*m+t*a*m)*C,e[8]=I*C,e[9]=(f*u*o-d*g*o-f*i*m+t*g*m+d*i*p-t*u*p)*C,e[10]=(r*g*o-f*l*o+f*i*c-t*g*c-r*i*p+t*l*p)*C,e[11]=(d*l*o-r*u*o-d*i*c+t*u*c+r*i*m-t*l*m)*C,e[12]=w*C,e[13]=(d*g*s-f*u*s+f*i*h-t*g*h-d*i*b+t*u*b)*C,e[14]=(f*l*s-r*g*s-f*i*a+t*g*a+r*i*b-t*l*b)*C,e[15]=(r*u*s-d*l*s+d*i*a-t*u*a-r*i*h+t*l*h)*C,this}scale(e){let t=this.elements,i=e.x,s=e.y,o=e.z;return t[0]*=i,t[4]*=s,t[8]*=o,t[1]*=i,t[5]*=s,t[9]*=o,t[2]*=i,t[6]*=s,t[10]*=o,t[3]*=i,t[7]*=s,t[11]*=o,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),s=Math.sin(t),o=1-i,r=e.x,l=e.y,a=e.z,c=o*r,d=o*l;return this.set(c*r+i,c*l-s*a,c*a+s*l,0,c*l+s*a,d*l+i,d*a-s*r,0,c*a-s*l,d*a+s*r,o*a*a+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,o,r){return this.set(1,i,o,0,e,1,r,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){let s=this.elements,o=t._x,r=t._y,l=t._z,a=t._w,c=o+o,d=r+r,u=l+l,h=o*c,m=o*d,f=o*u,g=r*d,b=r*u,p=l*u,R=a*c,V=a*d,I=a*u,w=i.x,W=i.y,C=i.z;return s[0]=(1-(g+p))*w,s[1]=(m+I)*w,s[2]=(f-V)*w,s[3]=0,s[4]=(m-I)*W,s[5]=(1-(h+p))*W,s[6]=(b+R)*W,s[7]=0,s[8]=(f+V)*C,s[9]=(b-R)*C,s[10]=(1-(h+g))*C,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){let s=this.elements,o=cr.set(s[0],s[1],s[2]).length(),r=cr.set(s[4],s[5],s[6]).length(),l=cr.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],oi.copy(this);let c=1/o,d=1/r,u=1/l;return oi.elements[0]*=c,oi.elements[1]*=c,oi.elements[2]*=c,oi.elements[4]*=d,oi.elements[5]*=d,oi.elements[6]*=d,oi.elements[8]*=u,oi.elements[9]*=u,oi.elements[10]*=u,t.setFromRotationMatrix(oi),i.x=o,i.y=r,i.z=l,this}makePerspective(e,t,i,s,o,r,l=zi){let a=this.elements,c=2*o/(t-e),d=2*o/(i-s),u=(t+e)/(t-e),h=(i+s)/(i-s),m,f;if(l===zi)m=-(r+o)/(r-o),f=-2*r*o/(r-o);else if(l===vd)m=-r/(r-o),f=-r*o/(r-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return a[0]=c,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=d,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=m,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,s,o,r,l=zi){let a=this.elements,c=1/(t-e),d=1/(i-s),u=1/(r-o),h=(t+e)*c,m=(i+s)*d,f,g;if(l===zi)f=(r+o)*u,g=-2*u;else if(l===vd)f=o*u,g=-1*u;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*d,a[9]=0,a[13]=-m,a[2]=0,a[6]=0,a[10]=g,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},cr=new T,oi=new Ye,a5=new T(0,0,0),c5=new T(1,1,1),ys=new T,nd=new T,Sn=new T,hG=new Ye,mG=new ui,po=(()=>{class n{constructor(t=0,i=0,s=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=s,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,s,o=this._order){return this._x=t,this._y=i,this._z=s,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,s=!0){let o=t.elements,r=o[0],l=o[4],a=o[8],c=o[1],d=o[5],u=o[9],h=o[2],m=o[6],f=o[10];switch(i){case"XYZ":this._y=Math.asin(on(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-l,r)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-on(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(on(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(c,r));break;case"ZYX":this._y=Math.asin(-on(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(m,f),this._z=Math.atan2(c,r)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(on(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,d),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-on(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,s){return hG.makeRotationFromQuaternion(t),this.setFromRotationMatrix(hG,i,s)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return mG.setFromEuler(this),this.setFromQuaternion(mG,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})(),_l=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},d5=0,pG=new T,dr=new ui,Ui=new Ye,id=new T,Yl=new T,u5=new T,h5=new ui,bG=new T(1,0,0),fG=new T(0,1,0),gG=new T(0,0,1),ZG={type:"added"},m5={type:"removed"},ur={type:"childadded",child:null},hp={type:"childremoved",child:null},_t=(()=>{class n extends Cs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:d5++}),this.uuid=di(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let t=new T,i=new po,s=new ui,o=new T(1,1,1);function r(){s.setFromEuler(i,!1)}function l(){i.setFromQuaternion(s,void 0,!1)}i._onChange(r),s._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ye},normalMatrix:{value:new Ae}}),this.matrix=new Ye,this.matrixWorld=new Ye,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new _l,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return dr.setFromAxisAngle(t,i),this.quaternion.multiply(dr),this}rotateOnWorldAxis(t,i){return dr.setFromAxisAngle(t,i),this.quaternion.premultiply(dr),this}rotateX(t){return this.rotateOnAxis(bG,t)}rotateY(t){return this.rotateOnAxis(fG,t)}rotateZ(t){return this.rotateOnAxis(gG,t)}translateOnAxis(t,i){return pG.copy(t).applyQuaternion(this.quaternion),this.position.add(pG.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(bG,t)}translateY(t){return this.translateOnAxis(fG,t)}translateZ(t){return this.translateOnAxis(gG,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ui.copy(this.matrixWorld).invert())}lookAt(t,i,s){t.isVector3?id.copy(t):id.set(t,i,s);let o=this.parent;this.updateWorldMatrix(!0,!1),Yl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ui.lookAt(Yl,id,this.up):Ui.lookAt(id,Yl,this.up),this.quaternion.setFromRotationMatrix(Ui),o&&(Ui.extractRotation(o.matrixWorld),dr.setFromRotationMatrix(Ui),this.quaternion.premultiply(dr.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(ZG),ur.child=t,this.dispatchEvent(ur),ur.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}let i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(m5),hp.child=t,this.dispatchEvent(hp),hp.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Ui.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Ui.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ui),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(ZG),ur.child=t,this.dispatchEvent(ur),ur.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let s=0,o=this.children.length;s<o;s++){let l=this.children[s].getObjectByProperty(t,i);if(l!==void 0)return l}}getObjectsByProperty(t,i,s=[]){this[t]===i&&s.push(this);let o=this.children;for(let r=0,l=o.length;r<l;r++)o[r].getObjectsByProperty(t,i,s);return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yl,t,u5),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yl,h5,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].traverseVisible(t)}traverseAncestors(t){let i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateMatrixWorld(t)}updateWorldMatrix(t,i){let s=this.parent;if(t===!0&&s!==null&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){let o=this.children;for(let r=0,l=o.length;r<l;r++)o[r].updateWorldMatrix(!1,!0)}}toJSON(t){let i=t===void 0||typeof t=="string",s={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(o.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function r(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(t)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=r(t.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let c=a.shapes;if(Array.isArray(c))for(let d=0,u=c.length;d<u;d++){let h=c[d];r(t.shapes,h)}else r(t.shapes,c)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let c=0,d=this.material.length;c<d;c++)a.push(r(t.materials,this.material[c]));o.material=a}else o.material=r(t.materials,this.material);if(this.children.length>0){o.children=[];for(let a=0;a<this.children.length;a++)o.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let a=0;a<this.animations.length;a++){let c=this.animations[a];o.animations.push(r(t.animations,c))}}if(i){let a=l(t.geometries),c=l(t.materials),d=l(t.textures),u=l(t.images),h=l(t.shapes),m=l(t.skeletons),f=l(t.animations),g=l(t.nodes);a.length>0&&(s.geometries=a),c.length>0&&(s.materials=c),d.length>0&&(s.textures=d),u.length>0&&(s.images=u),h.length>0&&(s.shapes=h),m.length>0&&(s.skeletons=m),f.length>0&&(s.animations=f),g.length>0&&(s.nodes=g)}return s.object=o,s;function l(a){let c=[];for(let d in a){let u=a[d];delete u.metadata,c.push(u)}return c}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let s=0;s<t.children.length;s++){let o=t.children[s];this.add(o.clone())}return this}}return n.DEFAULT_UP=new T(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})(),ri=new T,Ji=new T,mp=new T,Ai=new T,hr=new T,mr=new T,yG=new T,pp=new T,bp=new T,fp=new T,gp=new at,Zp=new at,yp=new at,ao=class n{constructor(e=new T,t=new T,i=new T){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),ri.subVectors(e,t),s.cross(ri);let o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,t,i,s,o){ri.subVectors(s,t),Ji.subVectors(i,t),mp.subVectors(e,t);let r=ri.dot(ri),l=ri.dot(Ji),a=ri.dot(mp),c=Ji.dot(Ji),d=Ji.dot(mp),u=r*c-l*l;if(u===0)return o.set(0,0,0),null;let h=1/u,m=(c*a-l*d)*h,f=(r*d-l*a)*h;return o.set(1-m-f,f,m)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,Ai)===null?!1:Ai.x>=0&&Ai.y>=0&&Ai.x+Ai.y<=1}static getInterpolation(e,t,i,s,o,r,l,a){return this.getBarycoord(e,t,i,s,Ai)===null?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(o,Ai.x),a.addScaledVector(r,Ai.y),a.addScaledVector(l,Ai.z),a)}static getInterpolatedAttribute(e,t,i,s,o,r){return gp.setScalar(0),Zp.setScalar(0),yp.setScalar(0),gp.fromBufferAttribute(e,t),Zp.fromBufferAttribute(e,i),yp.fromBufferAttribute(e,s),r.setScalar(0),r.addScaledVector(gp,o.x),r.addScaledVector(Zp,o.y),r.addScaledVector(yp,o.z),r}static isFrontFacing(e,t,i,s){return ri.subVectors(i,t),Ji.subVectors(e,t),ri.cross(Ji).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ri.subVectors(this.c,this.b),Ji.subVectors(this.a,this.b),ri.cross(Ji).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return n.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,s,o){return n.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}containsPoint(e){return n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,s=this.b,o=this.c,r,l;hr.subVectors(s,i),mr.subVectors(o,i),pp.subVectors(e,i);let a=hr.dot(pp),c=mr.dot(pp);if(a<=0&&c<=0)return t.copy(i);bp.subVectors(e,s);let d=hr.dot(bp),u=mr.dot(bp);if(d>=0&&u<=d)return t.copy(s);let h=a*u-d*c;if(h<=0&&a>=0&&d<=0)return r=a/(a-d),t.copy(i).addScaledVector(hr,r);fp.subVectors(e,o);let m=hr.dot(fp),f=mr.dot(fp);if(f>=0&&m<=f)return t.copy(o);let g=m*c-a*f;if(g<=0&&c>=0&&f<=0)return l=c/(c-f),t.copy(i).addScaledVector(mr,l);let b=d*f-m*u;if(b<=0&&u-d>=0&&m-f>=0)return yG.subVectors(o,s),l=(u-d)/(u-d+(m-f)),t.copy(s).addScaledVector(yG,l);let p=1/(b+g+h);return r=g*p,l=h*p,t.copy(i).addScaledVector(hr,r).addScaledVector(mr,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},TX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Is={h:0,s:0,l:0},sd={h:0,s:0,l:0};function Ip(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}var xe=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){let s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Kt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,je.toWorkingColorSpace(this,t),this}setRGB(e,t,i,s=je.workingColorSpace){return this.r=e,this.g=t,this.b=i,je.toWorkingColorSpace(this,s),this}setHSL(e,t,i,s=je.workingColorSpace){if(e=sf(e,1),t=on(t,0,1),i=on(i,0,1),t===0)this.r=this.g=this.b=i;else{let o=i<=.5?i*(1+t):i+t-i*t,r=2*i-o;this.r=Ip(r,o,e+1/3),this.g=Ip(r,o,e),this.b=Ip(r,o,e-1/3)}return je.toWorkingColorSpace(this,s),this}setStyle(e,t=Kt){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o,r=s[1],l=s[2];switch(r){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){let o=s[1],r=o.length;if(r===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(r===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Kt){let i=TX[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Di(e.r),this.g=Di(e.g),this.b=Di(e.b),this}copyLinearToSRGB(e){return this.r=Vr(e.r),this.g=Vr(e.g),this.b=Vr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Kt){return je.fromWorkingColorSpace(sn.copy(this),e),Math.round(on(sn.r*255,0,255))*65536+Math.round(on(sn.g*255,0,255))*256+Math.round(on(sn.b*255,0,255))}getHexString(e=Kt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=je.workingColorSpace){je.fromWorkingColorSpace(sn.copy(this),t);let i=sn.r,s=sn.g,o=sn.b,r=Math.max(i,s,o),l=Math.min(i,s,o),a,c,d=(l+r)/2;if(l===r)a=0,c=0;else{let u=r-l;switch(c=d<=.5?u/(r+l):u/(2-r-l),r){case i:a=(s-o)/u+(s<o?6:0);break;case s:a=(o-i)/u+2;break;case o:a=(i-s)/u+4;break}a/=6}return e.h=a,e.s=c,e.l=d,e}getRGB(e,t=je.workingColorSpace){return je.fromWorkingColorSpace(sn.copy(this),t),e.r=sn.r,e.g=sn.g,e.b=sn.b,e}getStyle(e=Kt){je.fromWorkingColorSpace(sn.copy(this),e);let t=sn.r,i=sn.g,s=sn.b;return e!==Kt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(Is),this.setHSL(Is.h+e,Is.s+t,Is.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Is),e.getHSL(sd);let i=Bl(Is.h,sd.h,t),s=Bl(Is.s,sd.s,t),o=Bl(Is.l,sd.l,t);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*s,this.g=o[1]*t+o[4]*i+o[7]*s,this.b=o[2]*t+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},sn=new xe;xe.NAMES=TX;var p5=0,xn=class extends Cs{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:p5++}),this.uuid=di(),this.name="",this.blending=Gr,this.side=Vi,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=wp,this.blendDst=Hp,this.blendEquation=lo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xe(0,0,0),this.blendAlpha=0,this.depthFunc=Sr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nG,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sr,this.stencilZFail=sr,this.stencilZPass=sr,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Gr&&(i.blending=this.blending),this.side!==Vi&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==wp&&(i.blendSrc=this.blendSrc),this.blendDst!==Hp&&(i.blendDst=this.blendDst),this.blendEquation!==lo&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Sr&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==nG&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==sr&&(i.stencilFail=this.stencilFail),this.stencilZFail!==sr&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==sr&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){let r=[];for(let l in o){let a=o[l];delete a.metadata,r.push(a)}return r}if(t){let o=s(e.textures),r=s(e.images);o.length>0&&(i.textures=o),r.length>0&&(i.images=r)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let s=t.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},Ri=class extends xn{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new xe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new po,this.combine=gX,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var Ht=new T,od=new Oe,At=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Zb,this.updateRanges=[],this.gpuType=ci,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)od.fromBufferAttribute(this,t),od.applyMatrix3(e),this.setXY(t,od.x,od.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ht.fromBufferAttribute(this,t),Ht.applyMatrix3(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ht.fromBufferAttribute(this,t),Ht.applyMatrix4(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ht.fromBufferAttribute(this,t),Ht.applyNormalMatrix(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ht.fromBufferAttribute(this,t),Ht.transformDirection(e),this.setXYZ(t,Ht.x,Ht.y,Ht.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=ai(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=pt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ai(t,this.array)),t}setX(e,t){return this.normalized&&(t=pt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ai(t,this.array)),t}setY(e,t){return this.normalized&&(t=pt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ai(t,this.array)),t}setZ(e,t){return this.normalized&&(t=pt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ai(t,this.array)),t}setW(e,t){return this.normalized&&(t=pt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array),s=pt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e*=this.itemSize,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array),s=pt(s,this.array),o=pt(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zb&&(e.usage=this.usage),e}};var Td=class extends At{constructor(e,t,i){super(new Uint16Array(e),t,i)}};var Yd=class extends At{constructor(e,t,i){super(new Uint32Array(e),t,i)}};var Jn=class extends At{constructor(e,t,i){super(new Float32Array(e),t,i)}},b5=0,kn=new Ye,Gp=new _t,pr=new T,Cn=new An,Nl=new An,Dt=new T,Fn=class n extends Cs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:b5++}),this.uuid=di(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(MX(e)?Yd:Td)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let o=new Ae().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}let s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return kn.makeRotationFromQuaternion(e),this.applyMatrix4(kn),this}rotateX(e){return kn.makeRotationX(e),this.applyMatrix4(kn),this}rotateY(e){return kn.makeRotationY(e),this.applyMatrix4(kn),this}rotateZ(e){return kn.makeRotationZ(e),this.applyMatrix4(kn),this}translate(e,t,i){return kn.makeTranslation(e,t,i),this.applyMatrix4(kn),this}scale(e,t,i){return kn.makeScale(e,t,i),this.applyMatrix4(kn),this}lookAt(e){return Gp.lookAt(e),Gp.updateMatrix(),this.applyMatrix4(Gp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pr).negate(),this.translate(pr.x,pr.y,pr.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let i=[];for(let s=0,o=e.length;s<o;s++){let r=e[s];i.push(r.x,r.y,r.z||0)}this.setAttribute("position",new Jn(i,3))}else{for(let i=0,s=t.count;i<s;i++){let o=e[i];t.setXYZ(i,o.x,o.y,o.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new An);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){let o=t[i];Cn.setFromBufferAttribute(o),this.morphTargetsRelative?(Dt.addVectors(this.boundingBox.min,Cn.min),this.boundingBox.expandByPoint(Dt),Dt.addVectors(this.boundingBox.max,Cn.max),this.boundingBox.expandByPoint(Dt)):(this.boundingBox.expandByPoint(Cn.min),this.boundingBox.expandByPoint(Cn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Wn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new T,1/0);return}if(e){let i=this.boundingSphere.center;if(Cn.setFromBufferAttribute(e),t)for(let o=0,r=t.length;o<r;o++){let l=t[o];Nl.setFromBufferAttribute(l),this.morphTargetsRelative?(Dt.addVectors(Cn.min,Nl.min),Cn.expandByPoint(Dt),Dt.addVectors(Cn.max,Nl.max),Cn.expandByPoint(Dt)):(Cn.expandByPoint(Nl.min),Cn.expandByPoint(Nl.max))}Cn.getCenter(i);let s=0;for(let o=0,r=e.count;o<r;o++)Dt.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(Dt));if(t)for(let o=0,r=t.length;o<r;o++){let l=t[o],a=this.morphTargetsRelative;for(let c=0,d=l.count;c<d;c++)Dt.fromBufferAttribute(l,c),a&&(pr.fromBufferAttribute(e,c),Dt.add(pr)),s=Math.max(s,i.distanceToSquared(Dt))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.position,s=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new At(new Float32Array(4*i.count),4));let r=this.getAttribute("tangent"),l=[],a=[];for(let N=0;N<i.count;N++)l[N]=new T,a[N]=new T;let c=new T,d=new T,u=new T,h=new Oe,m=new Oe,f=new Oe,g=new T,b=new T;function p(N,X,G){c.fromBufferAttribute(i,N),d.fromBufferAttribute(i,X),u.fromBufferAttribute(i,G),h.fromBufferAttribute(o,N),m.fromBufferAttribute(o,X),f.fromBufferAttribute(o,G),d.sub(c),u.sub(c),m.sub(h),f.sub(h);let x=1/(m.x*f.y-f.x*m.y);isFinite(x)&&(g.copy(d).multiplyScalar(f.y).addScaledVector(u,-m.y).multiplyScalar(x),b.copy(u).multiplyScalar(m.x).addScaledVector(d,-f.x).multiplyScalar(x),l[N].add(g),l[X].add(g),l[G].add(g),a[N].add(b),a[X].add(b),a[G].add(b))}let R=this.groups;R.length===0&&(R=[{start:0,count:e.count}]);for(let N=0,X=R.length;N<X;++N){let G=R[N],x=G.start,F=G.count;for(let U=x,z=x+F;U<z;U+=3)p(e.getX(U+0),e.getX(U+1),e.getX(U+2))}let V=new T,I=new T,w=new T,W=new T;function C(N){w.fromBufferAttribute(s,N),W.copy(w);let X=l[N];V.copy(X),V.sub(w.multiplyScalar(w.dot(X))).normalize(),I.crossVectors(W,X);let x=I.dot(a[N])<0?-1:1;r.setXYZW(N,V.x,V.y,V.z,x)}for(let N=0,X=R.length;N<X;++N){let G=R[N],x=G.start,F=G.count;for(let U=x,z=x+F;U<z;U+=3)C(e.getX(U+0)),C(e.getX(U+1)),C(e.getX(U+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new At(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let h=0,m=i.count;h<m;h++)i.setXYZ(h,0,0,0);let s=new T,o=new T,r=new T,l=new T,a=new T,c=new T,d=new T,u=new T;if(e)for(let h=0,m=e.count;h<m;h+=3){let f=e.getX(h+0),g=e.getX(h+1),b=e.getX(h+2);s.fromBufferAttribute(t,f),o.fromBufferAttribute(t,g),r.fromBufferAttribute(t,b),d.subVectors(r,o),u.subVectors(s,o),d.cross(u),l.fromBufferAttribute(i,f),a.fromBufferAttribute(i,g),c.fromBufferAttribute(i,b),l.add(d),a.add(d),c.add(d),i.setXYZ(f,l.x,l.y,l.z),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(b,c.x,c.y,c.z)}else for(let h=0,m=t.count;h<m;h+=3)s.fromBufferAttribute(t,h+0),o.fromBufferAttribute(t,h+1),r.fromBufferAttribute(t,h+2),d.subVectors(r,o),u.subVectors(s,o),d.cross(u),i.setXYZ(h+0,d.x,d.y,d.z),i.setXYZ(h+1,d.x,d.y,d.z),i.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Dt.fromBufferAttribute(e,t),Dt.normalize(),e.setXYZ(t,Dt.x,Dt.y,Dt.z)}toNonIndexed(){function e(l,a){let c=l.array,d=l.itemSize,u=l.normalized,h=new c.constructor(a.length*d),m=0,f=0;for(let g=0,b=a.length;g<b;g++){l.isInterleavedBufferAttribute?m=a[g]*l.data.stride+l.offset:m=a[g]*d;for(let p=0;p<d;p++)h[f++]=c[m++]}return new At(h,d,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new n,i=this.index.array,s=this.attributes;for(let l in s){let a=s[l],c=e(a,i);t.setAttribute(l,c)}let o=this.morphAttributes;for(let l in o){let a=[],c=o[l];for(let d=0,u=c.length;d<u;d++){let h=c[d],m=e(h,i);a.push(m)}t.morphAttributes[l]=a}t.morphTargetsRelative=this.morphTargetsRelative;let r=this.groups;for(let l=0,a=r.length;l<a;l++){let c=r[l];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let a=this.parameters;for(let c in a)a[c]!==void 0&&(e[c]=a[c]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let a in i){let c=i[a];e.data.attributes[a]=c.toJSON(e.data)}let s={},o=!1;for(let a in this.morphAttributes){let c=this.morphAttributes[a],d=[];for(let u=0,h=c.length;u<h;u++){let m=c[u];d.push(m.toJSON(e.data))}d.length>0&&(s[a]=d,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);let r=this.groups;r.length>0&&(e.data.groups=JSON.parse(JSON.stringify(r)));let l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let s=e.attributes;for(let c in s){let d=s[c];this.setAttribute(c,d.clone(t))}let o=e.morphAttributes;for(let c in o){let d=[],u=o[c];for(let h=0,m=u.length;h<m;h++)d.push(u[h].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;let r=e.groups;for(let c=0,d=r.length;c<d;c++){let u=r[c];this.addGroup(u.start,u.count,u.materialIndex)}let l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());let a=e.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},IG=new Ye,no=new mo,rd=new Wn,GG=new T,ld=new T,ad=new T,cd=new T,Xp=new T,dd=new T,XG=new T,ud=new T,rn=class extends _t{constructor(e=new Fn,t=new Ri){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=s.length;o<r;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,t){let i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,r=i.morphTargetsRelative;t.fromBufferAttribute(s,e);let l=this.morphTargetInfluences;if(o&&l){dd.set(0,0,0);for(let a=0,c=o.length;a<c;a++){let d=l[a],u=o[a];d!==0&&(Xp.fromBufferAttribute(u,e),r?dd.addScaledVector(Xp,d):dd.addScaledVector(Xp.sub(t),d))}t.add(dd)}return t}raycast(e,t){let i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),rd.copy(i.boundingSphere),rd.applyMatrix4(o),no.copy(e.ray).recast(e.near),!(rd.containsPoint(no.origin)===!1&&(no.intersectSphere(rd,GG)===null||no.origin.distanceToSquared(GG)>(e.far-e.near)**2))&&(IG.copy(o).invert(),no.copy(e.ray).applyMatrix4(IG),!(i.boundingBox!==null&&no.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,no)))}_computeIntersections(e,t,i){let s,o=this.geometry,r=this.material,l=o.index,a=o.attributes.position,c=o.attributes.uv,d=o.attributes.uv1,u=o.attributes.normal,h=o.groups,m=o.drawRange;if(l!==null)if(Array.isArray(r))for(let f=0,g=h.length;f<g;f++){let b=h[f],p=r[b.materialIndex],R=Math.max(b.start,m.start),V=Math.min(l.count,Math.min(b.start+b.count,m.start+m.count));for(let I=R,w=V;I<w;I+=3){let W=l.getX(I),C=l.getX(I+1),N=l.getX(I+2);s=hd(this,p,e,i,c,d,u,W,C,N),s&&(s.faceIndex=Math.floor(I/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{let f=Math.max(0,m.start),g=Math.min(l.count,m.start+m.count);for(let b=f,p=g;b<p;b+=3){let R=l.getX(b),V=l.getX(b+1),I=l.getX(b+2);s=hd(this,r,e,i,c,d,u,R,V,I),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}else if(a!==void 0)if(Array.isArray(r))for(let f=0,g=h.length;f<g;f++){let b=h[f],p=r[b.materialIndex],R=Math.max(b.start,m.start),V=Math.min(a.count,Math.min(b.start+b.count,m.start+m.count));for(let I=R,w=V;I<w;I+=3){let W=I,C=I+1,N=I+2;s=hd(this,p,e,i,c,d,u,W,C,N),s&&(s.faceIndex=Math.floor(I/3),s.face.materialIndex=b.materialIndex,t.push(s))}}else{let f=Math.max(0,m.start),g=Math.min(a.count,m.start+m.count);for(let b=f,p=g;b<p;b+=3){let R=b,V=b+1,I=b+2;s=hd(this,r,e,i,c,d,u,R,V,I),s&&(s.faceIndex=Math.floor(b/3),t.push(s))}}}};function f5(n,e,t,i,s,o,r,l){let a;if(e.side===Zn?a=i.intersectTriangle(r,o,s,!0,l):a=i.intersectTriangle(s,o,r,e.side===Vi,l),a===null)return null;ud.copy(l),ud.applyMatrix4(n.matrixWorld);let c=t.ray.origin.distanceTo(ud);return c<t.near||c>t.far?null:{distance:c,point:ud.clone(),object:n}}function hd(n,e,t,i,s,o,r,l,a,c){n.getVertexPosition(l,ld),n.getVertexPosition(a,ad),n.getVertexPosition(c,cd);let d=f5(n,e,t,i,ld,ad,cd,XG);if(d){let u=new T;ao.getBarycoord(XG,ld,ad,cd,u),s&&(d.uv=ao.getInterpolatedAttribute(s,l,a,c,u,new Oe)),o&&(d.uv1=ao.getInterpolatedAttribute(o,l,a,c,u,new Oe)),r&&(d.normal=ao.getInterpolatedAttribute(r,l,a,c,u,new T),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));let h={a:l,b:a,c,normal:new T,materialIndex:0};ao.getNormal(ld,ad,cd,h.normal),d.face=h,d.barycoord=u}return d}var jl=class n extends Fn{constructor(e=1,t=1,i=1,s=1,o=1,r=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:o,depthSegments:r};let l=this;s=Math.floor(s),o=Math.floor(o),r=Math.floor(r);let a=[],c=[],d=[],u=[],h=0,m=0;f("z","y","x",-1,-1,i,t,e,r,o,0),f("z","y","x",1,-1,i,t,-e,r,o,1),f("x","z","y",1,1,e,i,t,s,r,2),f("x","z","y",1,-1,e,i,-t,s,r,3),f("x","y","z",1,-1,e,t,i,s,o,4),f("x","y","z",-1,-1,e,t,-i,s,o,5),this.setIndex(a),this.setAttribute("position",new Jn(c,3)),this.setAttribute("normal",new Jn(d,3)),this.setAttribute("uv",new Jn(u,2));function f(g,b,p,R,V,I,w,W,C,N,X){let G=I/C,x=w/N,F=I/2,U=w/2,z=W/2,j=C+1,B=N+1,Q=0,J=0,ne=new T;for(let de=0;de<B;de++){let fe=de*x-U;for(let ze=0;ze<j;ze++){let Zt=ze*G-F;ne[g]=Zt*R,ne[b]=fe*V,ne[p]=z,c.push(ne.x,ne.y,ne.z),ne[g]=0,ne[b]=0,ne[p]=W>0?1:-1,d.push(ne.x,ne.y,ne.z),u.push(ze/C),u.push(1-de/N),Q+=1}}for(let de=0;de<N;de++)for(let fe=0;fe<C;fe++){let ze=h+fe+j*de,Zt=h+fe+j*(de+1),E=h+(fe+1)+j*(de+1),te=h+(fe+1)+j*de;a.push(ze,Zt,te),a.push(Zt,E,te),J+=6}l.addGroup(m,J,X),m+=J,h+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Yr(n){let e={};for(let t in n){e[t]={};for(let i in n[t]){let s=n[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():Array.isArray(s)?e[t][i]=s.slice():e[t][i]=s}}return e}function un(n){let e={};for(let t=0;t<n.length;t++){let i=Yr(n[t]);for(let s in i)e[s]=i[s]}return e}function g5(n){let e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function YX(n){let e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:je.workingColorSpace}var Z5={clone:Yr,merge:un},y5=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,I5=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Si=class extends xn{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=y5,this.fragmentShader=I5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Yr(e.uniforms),this.uniformsGroups=g5(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let s in this.uniforms){let r=this.uniforms[s].value;r&&r.isTexture?t.uniforms[s]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[s]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[s]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[s]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[s]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[s]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[s]={type:"m4",value:r.toArray()}:t.uniforms[s]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},Nd=class extends _t{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ye,this.projectionMatrix=new Ye,this.projectionMatrixInverse=new Ye,this.coordinateSystem=zi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Gs=new T,VG=new Oe,RG=new Oe,Jt=class extends Nd{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Tr*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Fl*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Tr*2*Math.atan(Math.tan(Fl*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Gs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Gs.x,Gs.y).multiplyScalar(-e/Gs.z),Gs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Gs.x,Gs.y).multiplyScalar(-e/Gs.z)}getViewSize(e,t){return this.getViewBounds(e,VG,RG),t.subVectors(RG,VG)}setViewOffset(e,t,i,s,o,r){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Fl*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,o=-.5*s,r=this.view;if(this.view!==null&&this.view.enabled){let a=r.fullWidth,c=r.fullHeight;o+=r.offsetX*s/a,t-=r.offsetY*i/c,s*=r.width/a,i*=r.height/c}let l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},br=-90,fr=1,Xb=class extends _t{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let s=new Jt(br,fr,e,t);s.layers=this.layers,this.add(s);let o=new Jt(br,fr,e,t);o.layers=this.layers,this.add(o);let r=new Jt(br,fr,e,t);r.layers=this.layers,this.add(r);let l=new Jt(br,fr,e,t);l.layers=this.layers,this.add(l);let a=new Jt(br,fr,e,t);a.layers=this.layers,this.add(a);let c=new Jt(br,fr,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,s,o,r,l,a]=t;for(let c of t)this.remove(c);if(e===zi)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),r.up.set(0,0,1),r.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else if(e===vd)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),r.up.set(0,0,-1),r.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[o,r,l,a,c,d]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;let g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,o),e.setRenderTarget(i,1,s),e.render(t,r),e.setRenderTarget(i,2,s),e.render(t,l),e.setRenderTarget(i,3,s),e.render(t,a),e.setRenderTarget(i,4,s),e.render(t,c),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,s),e.render(t,d),e.setRenderTarget(u,h,m),e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}},wd=class extends Pn{constructor(e,t,i,s,o,r,l,a,c,d){e=e!==void 0?e:[],t=t!==void 0?t:Cr,super(e,t,i,s,o,r,l,a,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},Vb=class extends ji{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new wd(s,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:gn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new jl(5,5,5),o=new Si({name:"CubemapFromEquirect",uniforms:Yr(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Zn,blending:Rs});o.uniforms.tEquirect.value=t;let r=new rn(s,o),l=t.minFilter;return t.minFilter===Gi&&(t.minFilter=gn),new Xb(1,10,this).update(e,r),t.minFilter=l,r.geometry.dispose(),r.material.dispose(),this}clear(e,t,i,s){let o=e.getRenderTarget();for(let r=0;r<6;r++)e.setRenderTarget(this,r),e.clear(t,i,s);e.setRenderTarget(o)}},Vp=new T,G5=new T,X5=new Ae,Pi=class{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let s=Vp.subVectors(i,t).cross(G5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta(Vp),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||X5.getNormalMatrix(e),s=this.coplanarPoint(Vp).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},io=new Wn,md=new T,Ol=class{constructor(e=new Pi,t=new Pi,i=new Pi,s=new Pi,o=new Pi,r=new Pi){this.planes=[e,t,i,s,o,r]}set(e,t,i,s,o,r){let l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(r),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=zi){let i=this.planes,s=e.elements,o=s[0],r=s[1],l=s[2],a=s[3],c=s[4],d=s[5],u=s[6],h=s[7],m=s[8],f=s[9],g=s[10],b=s[11],p=s[12],R=s[13],V=s[14],I=s[15];if(i[0].setComponents(a-o,h-c,b-m,I-p).normalize(),i[1].setComponents(a+o,h+c,b+m,I+p).normalize(),i[2].setComponents(a+r,h+d,b+f,I+R).normalize(),i[3].setComponents(a-r,h-d,b-f,I-R).normalize(),i[4].setComponents(a-l,h-u,b-g,I-V).normalize(),t===zi)i[5].setComponents(a+l,h+u,b+g,I+V).normalize();else if(t===vd)i[5].setComponents(l,u,g,V).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),io.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),io.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(io)}intersectsSprite(e){return io.center.set(0,0,0),io.radius=.7071067811865476,io.applyMatrix4(e.matrixWorld),this.intersectsSphere(io)}intersectsSphere(e){let t=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let s=t[i];if(md.x=s.normal.x>0?e.max.x:e.min.x,md.y=s.normal.y>0?e.max.y:e.min.y,md.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(md)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function NX(){let n=null,e=!1,t=null,i=null;function s(o,r){t(o,r),i=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function V5(n){let e=new WeakMap;function t(l,a){let c=l.array,d=l.usage,u=c.byteLength,h=n.createBuffer();n.bindBuffer(a,h),n.bufferData(a,c,d),l.onUploadCallback();let m;if(c instanceof Float32Array)m=n.FLOAT;else if(c instanceof Uint16Array)l.isFloat16BufferAttribute?m=n.HALF_FLOAT:m=n.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=n.SHORT;else if(c instanceof Uint32Array)m=n.UNSIGNED_INT;else if(c instanceof Int32Array)m=n.INT;else if(c instanceof Int8Array)m=n.BYTE;else if(c instanceof Uint8Array)m=n.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:l.version,size:u}}function i(l,a,c){let d=a.array,u=a.updateRanges;if(n.bindBuffer(c,l),u.length===0)n.bufferSubData(c,0,d);else{u.sort((m,f)=>m.start-f.start);let h=0;for(let m=1;m<u.length;m++){let f=u[h],g=u[m];g.start<=f.start+f.count+1?f.count=Math.max(f.count,g.start+g.count-f.start):(++h,u[h]=g)}u.length=h+1;for(let m=0,f=u.length;m<f;m++){let g=u[m];n.bufferSubData(c,g.start*d.BYTES_PER_ELEMENT,d,g.start,g.count)}a.clearUpdateRanges()}a.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function o(l){l.isInterleavedBufferAttribute&&(l=l.data);let a=e.get(l);a&&(n.deleteBuffer(a.buffer),e.delete(l))}function r(l,a){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){let d=e.get(l);(!d||d.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}let c=e.get(l);if(c===void 0)e.set(l,t(l,a));else if(c.version<l.version){if(c.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(c.buffer,l,a),c.version=l.version}}return{get:s,remove:o,update:r}}var Hd=class n extends Fn{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};let o=e/2,r=t/2,l=Math.floor(i),a=Math.floor(s),c=l+1,d=a+1,u=e/l,h=t/a,m=[],f=[],g=[],b=[];for(let p=0;p<d;p++){let R=p*h-r;for(let V=0;V<c;V++){let I=V*u-o;f.push(I,-R,0),g.push(0,0,1),b.push(V/l),b.push(1-p/a)}}for(let p=0;p<a;p++)for(let R=0;R<l;R++){let V=R+c*p,I=R+c*(p+1),w=R+1+c*(p+1),W=R+1+c*p;m.push(V,I,W),m.push(I,w,W)}this.setIndex(m),this.setAttribute("position",new Jn(f,3)),this.setAttribute("normal",new Jn(g,3)),this.setAttribute("uv",new Jn(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}},R5=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,S5=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,C5=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,W5=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,x5=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,v5=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,L5=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,M5=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,T5=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Y5=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,N5=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,w5=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,H5=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,K5=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,k5=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,U5=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,J5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,A5=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,F5=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,B5=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,P5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,E5=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,z5=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,D5=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,_5=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,j5=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,O5=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Q5=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,q5=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$5=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,eL="gl_FragColor = linearToOutputTexel( gl_FragColor );",tL=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,nL=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,iL=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,sL=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,oL=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,rL=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,lL=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,aL=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,cL=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,dL=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,uL=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,hL=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,mL=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,pL=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,bL=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,fL=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,gL=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,ZL=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,yL=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,IL=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,GL=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,XL=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,VL=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,RL=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,SL=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,CL=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,WL=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,xL=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vL=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,LL=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ML=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,TL=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,YL=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,NL=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,wL=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,HL=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,KL=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,kL=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,UL=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,JL=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,AL=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,FL=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,BL=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,PL=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,EL=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,zL=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,DL=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,_L=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,jL=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,OL=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,QL=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qL=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,$L=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,e1=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,t1=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,n1=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,i1=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,s1=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,o1=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,r1=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,l1=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,a1=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,c1=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,d1=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,u1=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,h1=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,m1=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,p1=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,b1=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,f1=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,g1=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Z1=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,y1=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,I1=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,G1=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,X1=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,V1=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,R1=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,S1=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,C1=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,W1=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,x1=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,v1=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,L1=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,M1=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,T1=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Y1=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,N1=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,w1=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,H1=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,K1=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,k1=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,U1=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,J1=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A1=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,F1=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,B1=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,P1=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,E1=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,z1=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,D1=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,_1=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,j1=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,O1=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q1=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,q1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$1=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,e9=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,t9=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,n9=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Be={alphahash_fragment:R5,alphahash_pars_fragment:S5,alphamap_fragment:C5,alphamap_pars_fragment:W5,alphatest_fragment:x5,alphatest_pars_fragment:v5,aomap_fragment:L5,aomap_pars_fragment:M5,batching_pars_vertex:T5,batching_vertex:Y5,begin_vertex:N5,beginnormal_vertex:w5,bsdfs:H5,iridescence_fragment:K5,bumpmap_pars_fragment:k5,clipping_planes_fragment:U5,clipping_planes_pars_fragment:J5,clipping_planes_pars_vertex:A5,clipping_planes_vertex:F5,color_fragment:B5,color_pars_fragment:P5,color_pars_vertex:E5,color_vertex:z5,common:D5,cube_uv_reflection_fragment:_5,defaultnormal_vertex:j5,displacementmap_pars_vertex:O5,displacementmap_vertex:Q5,emissivemap_fragment:q5,emissivemap_pars_fragment:$5,colorspace_fragment:eL,colorspace_pars_fragment:tL,envmap_fragment:nL,envmap_common_pars_fragment:iL,envmap_pars_fragment:sL,envmap_pars_vertex:oL,envmap_physical_pars_fragment:fL,envmap_vertex:rL,fog_vertex:lL,fog_pars_vertex:aL,fog_fragment:cL,fog_pars_fragment:dL,gradientmap_pars_fragment:uL,lightmap_pars_fragment:hL,lights_lambert_fragment:mL,lights_lambert_pars_fragment:pL,lights_pars_begin:bL,lights_toon_fragment:gL,lights_toon_pars_fragment:ZL,lights_phong_fragment:yL,lights_phong_pars_fragment:IL,lights_physical_fragment:GL,lights_physical_pars_fragment:XL,lights_fragment_begin:VL,lights_fragment_maps:RL,lights_fragment_end:SL,logdepthbuf_fragment:CL,logdepthbuf_pars_fragment:WL,logdepthbuf_pars_vertex:xL,logdepthbuf_vertex:vL,map_fragment:LL,map_pars_fragment:ML,map_particle_fragment:TL,map_particle_pars_fragment:YL,metalnessmap_fragment:NL,metalnessmap_pars_fragment:wL,morphinstance_vertex:HL,morphcolor_vertex:KL,morphnormal_vertex:kL,morphtarget_pars_vertex:UL,morphtarget_vertex:JL,normal_fragment_begin:AL,normal_fragment_maps:FL,normal_pars_fragment:BL,normal_pars_vertex:PL,normal_vertex:EL,normalmap_pars_fragment:zL,clearcoat_normal_fragment_begin:DL,clearcoat_normal_fragment_maps:_L,clearcoat_pars_fragment:jL,iridescence_pars_fragment:OL,opaque_fragment:QL,packing:qL,premultiplied_alpha_fragment:$L,project_vertex:e1,dithering_fragment:t1,dithering_pars_fragment:n1,roughnessmap_fragment:i1,roughnessmap_pars_fragment:s1,shadowmap_pars_fragment:o1,shadowmap_pars_vertex:r1,shadowmap_vertex:l1,shadowmask_pars_fragment:a1,skinbase_vertex:c1,skinning_pars_vertex:d1,skinning_vertex:u1,skinnormal_vertex:h1,specularmap_fragment:m1,specularmap_pars_fragment:p1,tonemapping_fragment:b1,tonemapping_pars_fragment:f1,transmission_fragment:g1,transmission_pars_fragment:Z1,uv_pars_fragment:y1,uv_pars_vertex:I1,uv_vertex:G1,worldpos_vertex:X1,background_vert:V1,background_frag:R1,backgroundCube_vert:S1,backgroundCube_frag:C1,cube_vert:W1,cube_frag:x1,depth_vert:v1,depth_frag:L1,distanceRGBA_vert:M1,distanceRGBA_frag:T1,equirect_vert:Y1,equirect_frag:N1,linedashed_vert:w1,linedashed_frag:H1,meshbasic_vert:K1,meshbasic_frag:k1,meshlambert_vert:U1,meshlambert_frag:J1,meshmatcap_vert:A1,meshmatcap_frag:F1,meshnormal_vert:B1,meshnormal_frag:P1,meshphong_vert:E1,meshphong_frag:z1,meshphysical_vert:D1,meshphysical_frag:_1,meshtoon_vert:j1,meshtoon_frag:O1,points_vert:Q1,points_frag:q1,shadow_vert:$1,shadow_frag:e9,sprite_vert:t9,sprite_frag:n9},ie={common:{diffuse:{value:new xe(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ae},alphaMap:{value:null},alphaMapTransform:{value:new Ae},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ae}},envmap:{envMap:{value:null},envMapRotation:{value:new Ae},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ae}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ae}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ae},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ae},normalScale:{value:new Oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ae},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ae}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ae}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ae}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ae},alphaTest:{value:0},uvTransform:{value:new Ae}},sprite:{diffuse:{value:new xe(16777215)},opacity:{value:1},center:{value:new Oe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ae},alphaMap:{value:null},alphaMapTransform:{value:new Ae},alphaTest:{value:0}}},Ii={basic:{uniforms:un([ie.common,ie.specularmap,ie.envmap,ie.aomap,ie.lightmap,ie.fog]),vertexShader:Be.meshbasic_vert,fragmentShader:Be.meshbasic_frag},lambert:{uniforms:un([ie.common,ie.specularmap,ie.envmap,ie.aomap,ie.lightmap,ie.emissivemap,ie.bumpmap,ie.normalmap,ie.displacementmap,ie.fog,ie.lights,{emissive:{value:new xe(0)}}]),vertexShader:Be.meshlambert_vert,fragmentShader:Be.meshlambert_frag},phong:{uniforms:un([ie.common,ie.specularmap,ie.envmap,ie.aomap,ie.lightmap,ie.emissivemap,ie.bumpmap,ie.normalmap,ie.displacementmap,ie.fog,ie.lights,{emissive:{value:new xe(0)},specular:{value:new xe(1118481)},shininess:{value:30}}]),vertexShader:Be.meshphong_vert,fragmentShader:Be.meshphong_frag},standard:{uniforms:un([ie.common,ie.envmap,ie.aomap,ie.lightmap,ie.emissivemap,ie.bumpmap,ie.normalmap,ie.displacementmap,ie.roughnessmap,ie.metalnessmap,ie.fog,ie.lights,{emissive:{value:new xe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Be.meshphysical_vert,fragmentShader:Be.meshphysical_frag},toon:{uniforms:un([ie.common,ie.aomap,ie.lightmap,ie.emissivemap,ie.bumpmap,ie.normalmap,ie.displacementmap,ie.gradientmap,ie.fog,ie.lights,{emissive:{value:new xe(0)}}]),vertexShader:Be.meshtoon_vert,fragmentShader:Be.meshtoon_frag},matcap:{uniforms:un([ie.common,ie.bumpmap,ie.normalmap,ie.displacementmap,ie.fog,{matcap:{value:null}}]),vertexShader:Be.meshmatcap_vert,fragmentShader:Be.meshmatcap_frag},points:{uniforms:un([ie.points,ie.fog]),vertexShader:Be.points_vert,fragmentShader:Be.points_frag},dashed:{uniforms:un([ie.common,ie.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Be.linedashed_vert,fragmentShader:Be.linedashed_frag},depth:{uniforms:un([ie.common,ie.displacementmap]),vertexShader:Be.depth_vert,fragmentShader:Be.depth_frag},normal:{uniforms:un([ie.common,ie.bumpmap,ie.normalmap,ie.displacementmap,{opacity:{value:1}}]),vertexShader:Be.meshnormal_vert,fragmentShader:Be.meshnormal_frag},sprite:{uniforms:un([ie.sprite,ie.fog]),vertexShader:Be.sprite_vert,fragmentShader:Be.sprite_frag},background:{uniforms:{uvTransform:{value:new Ae},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Be.background_vert,fragmentShader:Be.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ae}},vertexShader:Be.backgroundCube_vert,fragmentShader:Be.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Be.cube_vert,fragmentShader:Be.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Be.equirect_vert,fragmentShader:Be.equirect_frag},distanceRGBA:{uniforms:un([ie.common,ie.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Be.distanceRGBA_vert,fragmentShader:Be.distanceRGBA_frag},shadow:{uniforms:un([ie.lights,ie.fog,{color:{value:new xe(0)},opacity:{value:1}}]),vertexShader:Be.shadow_vert,fragmentShader:Be.shadow_frag}};Ii.physical={uniforms:un([Ii.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ae},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ae},clearcoatNormalScale:{value:new Oe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ae},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ae},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ae},sheen:{value:0},sheenColor:{value:new xe(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ae},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ae},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ae},transmissionSamplerSize:{value:new Oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ae},attenuationDistance:{value:0},attenuationColor:{value:new xe(0)},specularColor:{value:new xe(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ae},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ae},anisotropyVector:{value:new Oe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ae}}]),vertexShader:Be.meshphysical_vert,fragmentShader:Be.meshphysical_frag};var pd={r:0,b:0,g:0},so=new po,i9=new Ye;function s9(n,e,t,i,s,o,r){let l=new xe(0),a=o===!0?0:1,c,d,u=null,h=0,m=null;function f(R){let V=R.isScene===!0?R.background:null;return V&&V.isTexture&&(V=(R.backgroundBlurriness>0?t:e).get(V)),V}function g(R){let V=!1,I=f(R);I===null?p(l,a):I&&I.isColor&&(p(I,1),V=!0);let w=n.xr.getEnvironmentBlendMode();w==="additive"?i.buffers.color.setClear(0,0,0,1,r):w==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,r),(n.autoClear||V)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function b(R,V){let I=f(V);I&&(I.isCubeTexture||I.mapping===lu)?(d===void 0&&(d=new rn(new jl(1,1,1),new Si({name:"BackgroundCubeMaterial",uniforms:Yr(Ii.backgroundCube.uniforms),vertexShader:Ii.backgroundCube.vertexShader,fragmentShader:Ii.backgroundCube.fragmentShader,side:Zn,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(w,W,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(d)),so.copy(V.backgroundRotation),so.x*=-1,so.y*=-1,so.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(so.y*=-1,so.z*=-1),d.material.uniforms.envMap.value=I,d.material.uniforms.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=V.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(i9.makeRotationFromEuler(so)),d.material.toneMapped=je.getTransfer(I.colorSpace)!==gt,(u!==I||h!==I.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,u=I,h=I.version,m=n.toneMapping),d.layers.enableAll(),R.unshift(d,d.geometry,d.material,0,0,null)):I&&I.isTexture&&(c===void 0&&(c=new rn(new Hd(2,2),new Si({name:"BackgroundMaterial",uniforms:Yr(Ii.background.uniforms),vertexShader:Ii.background.vertexShader,fragmentShader:Ii.background.fragmentShader,side:Vi,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(c)),c.material.uniforms.t2D.value=I,c.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,c.material.toneMapped=je.getTransfer(I.colorSpace)!==gt,I.matrixAutoUpdate===!0&&I.updateMatrix(),c.material.uniforms.uvTransform.value.copy(I.matrix),(u!==I||h!==I.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,u=I,h=I.version,m=n.toneMapping),c.layers.enableAll(),R.unshift(c,c.geometry,c.material,0,0,null))}function p(R,V){R.getRGB(pd,YX(n)),i.buffers.color.setClear(pd.r,pd.g,pd.b,V,r)}return{getClearColor:function(){return l},setClearColor:function(R,V=1){l.set(R),a=V,p(l,a)},getClearAlpha:function(){return a},setClearAlpha:function(R){a=R,p(l,a)},render:g,addToRenderList:b}}function o9(n,e){let t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},s=h(null),o=s,r=!1;function l(G,x,F,U,z){let j=!1,B=u(U,F,x);o!==B&&(o=B,c(o.object)),j=m(G,U,F,z),j&&f(G,U,F,z),z!==null&&e.update(z,n.ELEMENT_ARRAY_BUFFER),(j||r)&&(r=!1,I(G,x,F,U),z!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function a(){return n.createVertexArray()}function c(G){return n.bindVertexArray(G)}function d(G){return n.deleteVertexArray(G)}function u(G,x,F){let U=F.wireframe===!0,z=i[G.id];z===void 0&&(z={},i[G.id]=z);let j=z[x.id];j===void 0&&(j={},z[x.id]=j);let B=j[U];return B===void 0&&(B=h(a()),j[U]=B),B}function h(G){let x=[],F=[],U=[];for(let z=0;z<t;z++)x[z]=0,F[z]=0,U[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:x,enabledAttributes:F,attributeDivisors:U,object:G,attributes:{},index:null}}function m(G,x,F,U){let z=o.attributes,j=x.attributes,B=0,Q=F.getAttributes();for(let J in Q)if(Q[J].location>=0){let de=z[J],fe=j[J];if(fe===void 0&&(J==="instanceMatrix"&&G.instanceMatrix&&(fe=G.instanceMatrix),J==="instanceColor"&&G.instanceColor&&(fe=G.instanceColor)),de===void 0||de.attribute!==fe||fe&&de.data!==fe.data)return!0;B++}return o.attributesNum!==B||o.index!==U}function f(G,x,F,U){let z={},j=x.attributes,B=0,Q=F.getAttributes();for(let J in Q)if(Q[J].location>=0){let de=j[J];de===void 0&&(J==="instanceMatrix"&&G.instanceMatrix&&(de=G.instanceMatrix),J==="instanceColor"&&G.instanceColor&&(de=G.instanceColor));let fe={};fe.attribute=de,de&&de.data&&(fe.data=de.data),z[J]=fe,B++}o.attributes=z,o.attributesNum=B,o.index=U}function g(){let G=o.newAttributes;for(let x=0,F=G.length;x<F;x++)G[x]=0}function b(G){p(G,0)}function p(G,x){let F=o.newAttributes,U=o.enabledAttributes,z=o.attributeDivisors;F[G]=1,U[G]===0&&(n.enableVertexAttribArray(G),U[G]=1),z[G]!==x&&(n.vertexAttribDivisor(G,x),z[G]=x)}function R(){let G=o.newAttributes,x=o.enabledAttributes;for(let F=0,U=x.length;F<U;F++)x[F]!==G[F]&&(n.disableVertexAttribArray(F),x[F]=0)}function V(G,x,F,U,z,j,B){B===!0?n.vertexAttribIPointer(G,x,F,z,j):n.vertexAttribPointer(G,x,F,U,z,j)}function I(G,x,F,U){g();let z=U.attributes,j=F.getAttributes(),B=x.defaultAttributeValues;for(let Q in j){let J=j[Q];if(J.location>=0){let ne=z[Q];if(ne===void 0&&(Q==="instanceMatrix"&&G.instanceMatrix&&(ne=G.instanceMatrix),Q==="instanceColor"&&G.instanceColor&&(ne=G.instanceColor)),ne!==void 0){let de=ne.normalized,fe=ne.itemSize,ze=e.get(ne);if(ze===void 0)continue;let Zt=ze.buffer,E=ze.type,te=ze.bytesPerElement,Ie=E===n.INT||E===n.UNSIGNED_INT||ne.gpuType===Ob;if(ne.isInterleavedBufferAttribute){let re=ne.data,We=re.stride,He=ne.offset;if(re.isInstancedInterleavedBuffer){for(let De=0;De<J.locationSize;De++)p(J.location+De,re.meshPerAttribute);G.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=re.meshPerAttribute*re.count)}else for(let De=0;De<J.locationSize;De++)b(J.location+De);n.bindBuffer(n.ARRAY_BUFFER,Zt);for(let De=0;De<J.locationSize;De++)V(J.location+De,fe/J.locationSize,E,de,We*te,(He+fe/J.locationSize*De)*te,Ie)}else{if(ne.isInstancedBufferAttribute){for(let re=0;re<J.locationSize;re++)p(J.location+re,ne.meshPerAttribute);G.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let re=0;re<J.locationSize;re++)b(J.location+re);n.bindBuffer(n.ARRAY_BUFFER,Zt);for(let re=0;re<J.locationSize;re++)V(J.location+re,fe/J.locationSize,E,de,fe*te,fe/J.locationSize*re*te,Ie)}}else if(B!==void 0){let de=B[Q];if(de!==void 0)switch(de.length){case 2:n.vertexAttrib2fv(J.location,de);break;case 3:n.vertexAttrib3fv(J.location,de);break;case 4:n.vertexAttrib4fv(J.location,de);break;default:n.vertexAttrib1fv(J.location,de)}}}}R()}function w(){N();for(let G in i){let x=i[G];for(let F in x){let U=x[F];for(let z in U)d(U[z].object),delete U[z];delete x[F]}delete i[G]}}function W(G){if(i[G.id]===void 0)return;let x=i[G.id];for(let F in x){let U=x[F];for(let z in U)d(U[z].object),delete U[z];delete x[F]}delete i[G.id]}function C(G){for(let x in i){let F=i[x];if(F[G.id]===void 0)continue;let U=F[G.id];for(let z in U)d(U[z].object),delete U[z];delete F[G.id]}}function N(){X(),r=!0,o!==s&&(o=s,c(o.object))}function X(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:N,resetDefaultState:X,dispose:w,releaseStatesOfGeometry:W,releaseStatesOfProgram:C,initAttributes:g,enableAttribute:b,disableUnusedAttributes:R}}function r9(n,e,t){let i;function s(c){i=c}function o(c,d){n.drawArrays(i,c,d),t.update(d,i,1)}function r(c,d,u){u!==0&&(n.drawArraysInstanced(i,c,d,u),t.update(d,i,u))}function l(c,d,u){if(u===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,d,0,u);let m=0;for(let f=0;f<u;f++)m+=d[f];t.update(m,i,1)}function a(c,d,u,h){if(u===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let f=0;f<c.length;f++)r(c[f],d[f],h[f]);else{m.multiDrawArraysInstancedWEBGL(i,c,0,d,0,h,0,u);let f=0;for(let g=0;g<u;g++)f+=d[g]*h[g];t.update(f,i,1)}}this.setMode=s,this.render=o,this.renderInstances=r,this.renderMultiDraw=l,this.renderMultiDrawInstances=a}function l9(n,e,t,i){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){let C=e.get("EXT_texture_filter_anisotropic");s=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function r(C){return!(C!==Un&&i.convert(C)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(C){let N=C===sa&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(C!==_i&&i.convert(C)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&C!==ci&&!N)}function a(C){if(C==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp",d=a(c);d!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);let u=t.logarithmicDepthBuffer===!0,h=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),m=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=n.getParameter(n.MAX_TEXTURE_SIZE),b=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),p=n.getParameter(n.MAX_VERTEX_ATTRIBS),R=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),V=n.getParameter(n.MAX_VARYING_VECTORS),I=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),w=f>0,W=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:a,textureFormatReadable:r,textureTypeReadable:l,precision:c,logarithmicDepthBuffer:u,reverseDepthBuffer:h,maxTextures:m,maxVertexTextures:f,maxTextureSize:g,maxCubemapSize:b,maxAttributes:p,maxVertexUniforms:R,maxVaryings:V,maxFragmentUniforms:I,vertexTextures:w,maxSamples:W}}function a9(n){let e=this,t=null,i=0,s=!1,o=!1,r=new Pi,l=new Ae,a={value:null,needsUpdate:!1};this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){let m=u.length!==0||h||i!==0||s;return s=h,i=u.length,m},this.beginShadows=function(){o=!0,d(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(u,h){t=d(u,h,0)},this.setState=function(u,h,m){let f=u.clippingPlanes,g=u.clipIntersection,b=u.clipShadows,p=n.get(u);if(!s||f===null||f.length===0||o&&!b)o?d(null):c();else{let R=o?0:i,V=R*4,I=p.clippingState||null;a.value=I,I=d(f,h,V,m);for(let w=0;w!==V;++w)I[w]=t[w];p.clippingState=I,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=R}};function c(){a.value!==t&&(a.value=t,a.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(u,h,m,f){let g=u!==null?u.length:0,b=null;if(g!==0){if(b=a.value,f!==!0||b===null){let p=m+g*4,R=h.matrixWorldInverse;l.getNormalMatrix(R),(b===null||b.length<p)&&(b=new Float32Array(p));for(let V=0,I=m;V!==g;++V,I+=4)r.copy(u[V]).applyMatrix4(R,l),r.normal.toArray(b,I),b[I+3]=r.constant}a.value=b,a.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,b}}function c9(n){let e=new WeakMap;function t(r,l){return l===Pp?r.mapping=Cr:l===Ep&&(r.mapping=Wr),r}function i(r){if(r&&r.isTexture){let l=r.mapping;if(l===Pp||l===Ep)if(e.has(r)){let a=e.get(r).texture;return t(a,r.mapping)}else{let a=r.image;if(a&&a.height>0){let c=new Vb(a.height);return c.fromEquirectangularTexture(n,r),e.set(r,c),r.addEventListener("dispose",s),t(c.texture,r.mapping)}else return null}}return r}function s(r){let l=r.target;l.removeEventListener("dispose",s);let a=e.get(l);a!==void 0&&(e.delete(l),a.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}var Nr=class extends Nd{constructor(e=-1,t=1,i=1,s=-1,o=.1,r=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=o,this.far=r,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,o,r){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,o=i-e,r=i+e,l=s+t,a=s-t;if(this.view!==null&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,r=o+c*this.view.width,l-=d*this.view.offsetY,a=l-d*this.view.height}this.projectionMatrix.makeOrthographic(o,r,l,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Ir=4,SG=[.125,.215,.35,.446,.526,.582],co=20,Rp=new Nr,CG=new xe,Sp=null,Cp=0,Wp=0,xp=!1,ro=(1+Math.sqrt(5))/2,gr=1/ro,WG=[new T(-ro,gr,0),new T(ro,gr,0),new T(-gr,0,ro),new T(gr,0,ro),new T(0,ro,-gr),new T(0,ro,gr),new T(-1,1,-1),new T(1,1,-1),new T(-1,1,1),new T(1,1,1)],Kd=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100){Sp=this._renderer.getRenderTarget(),Cp=this._renderer.getActiveCubeFace(),Wp=this._renderer.getActiveMipmapLevel(),xp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,s,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=LG(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=vG(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Sp,Cp,Wp),this._renderer.xr.enabled=xp,e.scissorTest=!1,bd(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Cr||e.mapping===Wr?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Sp=this._renderer.getRenderTarget(),Cp=this._renderer.getActiveCubeFace(),Wp=this._renderer.getActiveMipmapLevel(),xp=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:gn,minFilter:gn,generateMipmaps:!1,type:sa,format:Un,colorSpace:an,depthBuffer:!1},s=xG(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=xG(e,t,i);let{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=d9(o)),this._blurMaterial=u9(o,e,t)}return s}_compileMaterial(e){let t=new rn(this._lodPlanes[0],e);this._renderer.compile(t,Rp)}_sceneToCubeUV(e,t,i,s){let l=new Jt(90,1,t,i),a=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],d=this._renderer,u=d.autoClear,h=d.toneMapping;d.getClearColor(CG),d.toneMapping=Ss,d.autoClear=!1;let m=new Ri({name:"PMREM.Background",side:Zn,depthWrite:!1,depthTest:!1}),f=new rn(new jl,m),g=!1,b=e.background;b?b.isColor&&(m.color.copy(b),e.background=null,g=!0):(m.color.copy(CG),g=!0);for(let p=0;p<6;p++){let R=p%3;R===0?(l.up.set(0,a[p],0),l.lookAt(c[p],0,0)):R===1?(l.up.set(0,0,a[p]),l.lookAt(0,c[p],0)):(l.up.set(0,a[p],0),l.lookAt(0,0,c[p]));let V=this._cubeSize;bd(s,R*V,p>2?V:0,V,V),d.setRenderTarget(s),g&&d.render(f,l),d.render(e,l)}f.geometry.dispose(),f.material.dispose(),d.toneMapping=h,d.autoClear=u,e.background=b}_textureToCubeUV(e,t){let i=this._renderer,s=e.mapping===Cr||e.mapping===Wr;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=LG()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=vG());let o=s?this._cubemapMaterial:this._equirectMaterial,r=new rn(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;let a=this._cubeSize;bd(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(r,Rp)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;let s=this._lodPlanes.length;for(let o=1;o<s;o++){let r=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=WG[(s-o-1)%WG.length];this._blur(e,o-1,o,r,l)}t.autoClear=i}_blur(e,t,i,s,o){let r=this._pingPongRenderTarget;this._halfBlur(e,r,t,i,s,"latitudinal",o),this._halfBlur(r,e,i,i,s,"longitudinal",o)}_halfBlur(e,t,i,s,o,r,l){let a=this._renderer,c=this._blurMaterial;r!=="latitudinal"&&r!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let d=3,u=new rn(this._lodPlanes[s],c),h=c.uniforms,m=this._sizeLods[i]-1,f=isFinite(o)?Math.PI/(2*m):2*Math.PI/(2*co-1),g=o/f,b=isFinite(o)?1+Math.floor(d*g):co;b>co&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${co}`);let p=[],R=0;for(let C=0;C<co;++C){let N=C/g,X=Math.exp(-N*N/2);p.push(X),C===0?R+=X:C<b&&(R+=2*X)}for(let C=0;C<p.length;C++)p[C]=p[C]/R;h.envMap.value=e.texture,h.samples.value=b,h.weights.value=p,h.latitudinal.value=r==="latitudinal",l&&(h.poleAxis.value=l);let{_lodMax:V}=this;h.dTheta.value=f,h.mipInt.value=V-i;let I=this._sizeLods[s],w=3*I*(s>V-Ir?s-V+Ir:0),W=4*(this._cubeSize-I);bd(t,w,W,3*I,2*I),a.setRenderTarget(t),a.render(u,Rp)}};function d9(n){let e=[],t=[],i=[],s=n,o=n-Ir+1+SG.length;for(let r=0;r<o;r++){let l=Math.pow(2,s);t.push(l);let a=1/l;r>n-Ir?a=SG[r-n+Ir-1]:r===0&&(a=0),i.push(a);let c=1/(l-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],m=6,f=6,g=3,b=2,p=1,R=new Float32Array(g*f*m),V=new Float32Array(b*f*m),I=new Float32Array(p*f*m);for(let W=0;W<m;W++){let C=W%3*2/3-1,N=W>2?0:-1,X=[C,N,0,C+2/3,N,0,C+2/3,N+1,0,C,N,0,C+2/3,N+1,0,C,N+1,0];R.set(X,g*f*W),V.set(h,b*f*W);let G=[W,W,W,W,W,W];I.set(G,p*f*W)}let w=new Fn;w.setAttribute("position",new At(R,g)),w.setAttribute("uv",new At(V,b)),w.setAttribute("faceIndex",new At(I,p)),e.push(w),s>Ir&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function xG(n,e,t){let i=new ji(n,e,t);return i.texture.mapping=lu,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function bd(n,e,t,i,s){n.viewport.set(e,t,i,s),n.scissor.set(e,t,i,s)}function u9(n,e,t){let i=new Float32Array(co),s=new T(0,1,0);return new Si({name:"SphericalGaussianBlur",defines:{n:co,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:of(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function vG(){return new Si({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:of(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function LG(){return new Si({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:of(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function of(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function h9(n){let e=new WeakMap,t=null;function i(l){if(l&&l.isTexture){let a=l.mapping,c=a===Pp||a===Ep,d=a===Cr||a===Wr;if(c||d){let u=e.get(l),h=u!==void 0?u.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==h)return t===null&&(t=new Kd(n)),u=c?t.fromEquirectangular(l,u):t.fromCubemap(l,u),u.texture.pmremVersion=l.pmremVersion,e.set(l,u),u.texture;if(u!==void 0)return u.texture;{let m=l.image;return c&&m&&m.height>0||d&&m&&s(m)?(t===null&&(t=new Kd(n)),u=c?t.fromEquirectangular(l):t.fromCubemap(l),u.texture.pmremVersion=l.pmremVersion,e.set(l,u),l.addEventListener("dispose",o),u.texture):null}}}return l}function s(l){let a=0,c=6;for(let d=0;d<c;d++)l[d]!==void 0&&a++;return a===c}function o(l){let a=l.target;a.removeEventListener("dispose",o);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function r(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:r}}function m9(n){let e={};function t(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(i)}return e[i]=s,s}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){let s=t(i);return s===null&&Ul("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function p9(n,e,t,i){let s={},o=new WeakMap;function r(u){let h=u.target;h.index!==null&&e.remove(h.index);for(let f in h.attributes)e.remove(h.attributes[f]);for(let f in h.morphAttributes){let g=h.morphAttributes[f];for(let b=0,p=g.length;b<p;b++)e.remove(g[b])}h.removeEventListener("dispose",r),delete s[h.id];let m=o.get(h);m&&(e.remove(m),o.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function l(u,h){return s[h.id]===!0||(h.addEventListener("dispose",r),s[h.id]=!0,t.memory.geometries++),h}function a(u){let h=u.attributes;for(let f in h)e.update(h[f],n.ARRAY_BUFFER);let m=u.morphAttributes;for(let f in m){let g=m[f];for(let b=0,p=g.length;b<p;b++)e.update(g[b],n.ARRAY_BUFFER)}}function c(u){let h=[],m=u.index,f=u.attributes.position,g=0;if(m!==null){let R=m.array;g=m.version;for(let V=0,I=R.length;V<I;V+=3){let w=R[V+0],W=R[V+1],C=R[V+2];h.push(w,W,W,C,C,w)}}else if(f!==void 0){let R=f.array;g=f.version;for(let V=0,I=R.length/3-1;V<I;V+=3){let w=V+0,W=V+1,C=V+2;h.push(w,W,W,C,C,w)}}else return;let b=new(MX(h)?Yd:Td)(h,1);b.version=g;let p=o.get(u);p&&e.remove(p),o.set(u,b)}function d(u){let h=o.get(u);if(h){let m=u.index;m!==null&&h.version<m.version&&c(u)}else c(u);return o.get(u)}return{get:l,update:a,getWireframeAttribute:d}}function b9(n,e,t){let i;function s(h){i=h}let o,r;function l(h){o=h.type,r=h.bytesPerElement}function a(h,m){n.drawElements(i,m,o,h*r),t.update(m,i,1)}function c(h,m,f){f!==0&&(n.drawElementsInstanced(i,m,o,h*r,f),t.update(m,i,f))}function d(h,m,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,m,0,o,h,0,f);let b=0;for(let p=0;p<f;p++)b+=m[p];t.update(b,i,1)}function u(h,m,f,g){if(f===0)return;let b=e.get("WEBGL_multi_draw");if(b===null)for(let p=0;p<h.length;p++)c(h[p]/r,m[p],g[p]);else{b.multiDrawElementsInstancedWEBGL(i,m,0,o,h,0,g,0,f);let p=0;for(let R=0;R<f;R++)p+=m[R]*g[R];t.update(p,i,1)}}this.setMode=s,this.setIndex=l,this.render=a,this.renderInstances=c,this.renderMultiDraw=d,this.renderMultiDrawInstances=u}function f9(n){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,r,l){switch(t.calls++,r){case n.TRIANGLES:t.triangles+=l*(o/3);break;case n.LINES:t.lines+=l*(o/2);break;case n.LINE_STRIP:t.lines+=l*(o-1);break;case n.LINE_LOOP:t.lines+=l*o;break;case n.POINTS:t.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:i}}function g9(n,e,t){let i=new WeakMap,s=new at;function o(r,l,a){let c=r.morphTargetInfluences,d=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,u=d!==void 0?d.length:0,h=i.get(l);if(h===void 0||h.count!==u){let G=function(){N.dispose(),i.delete(l),l.removeEventListener("dispose",G)};var m=G;h!==void 0&&h.texture.dispose();let f=l.morphAttributes.position!==void 0,g=l.morphAttributes.normal!==void 0,b=l.morphAttributes.color!==void 0,p=l.morphAttributes.position||[],R=l.morphAttributes.normal||[],V=l.morphAttributes.color||[],I=0;f===!0&&(I=1),g===!0&&(I=2),b===!0&&(I=3);let w=l.attributes.position.count*I,W=1;w>e.maxTextureSize&&(W=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);let C=new Float32Array(w*W*4*u),N=new Md(C,w,W,u);N.type=ci,N.needsUpdate=!0;let X=I*4;for(let x=0;x<u;x++){let F=p[x],U=R[x],z=V[x],j=w*W*4*x;for(let B=0;B<F.count;B++){let Q=B*X;f===!0&&(s.fromBufferAttribute(F,B),C[j+Q+0]=s.x,C[j+Q+1]=s.y,C[j+Q+2]=s.z,C[j+Q+3]=0),g===!0&&(s.fromBufferAttribute(U,B),C[j+Q+4]=s.x,C[j+Q+5]=s.y,C[j+Q+6]=s.z,C[j+Q+7]=0),b===!0&&(s.fromBufferAttribute(z,B),C[j+Q+8]=s.x,C[j+Q+9]=s.y,C[j+Q+10]=s.z,C[j+Q+11]=z.itemSize===4?s.w:1)}}h={count:u,texture:N,size:new Oe(w,W)},i.set(l,h),l.addEventListener("dispose",G)}if(r.isInstancedMesh===!0&&r.morphTexture!==null)a.getUniforms().setValue(n,"morphTexture",r.morphTexture,t);else{let f=0;for(let b=0;b<c.length;b++)f+=c[b];let g=l.morphTargetsRelative?1:1-f;a.getUniforms().setValue(n,"morphTargetBaseInfluence",g),a.getUniforms().setValue(n,"morphTargetInfluences",c)}a.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),a.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}return{update:o}}function Z9(n,e,t,i){let s=new WeakMap;function o(a){let c=i.render.frame,d=a.geometry,u=e.get(a,d);if(s.get(u)!==c&&(e.update(u),s.set(u,c)),a.isInstancedMesh&&(a.hasEventListener("dispose",l)===!1&&a.addEventListener("dispose",l),s.get(a)!==c&&(t.update(a.instanceMatrix,n.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,n.ARRAY_BUFFER),s.set(a,c))),a.isSkinnedMesh){let h=a.skeleton;s.get(h)!==c&&(h.update(),s.set(h,c))}return u}function r(){s=new WeakMap}function l(a){let c=a.target;c.removeEventListener("dispose",l),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:o,dispose:r}}var kd=class extends Pn{constructor(e,t,i,s,o,r,l,a,c,d=Xr){if(d!==Xr&&d!==vr)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===Xr&&(i=ho),i===void 0&&d===vr&&(i=xr),super(null,s,o,r,l,a,d,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:ln,this.minFilter=a!==void 0?a:ln,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},wX=new Pn,MG=new kd(1,1),HX=new Md,KX=new Gb,kX=new wd,TG=[],YG=[],NG=new Float32Array(16),wG=new Float32Array(9),HG=new Float32Array(4);function Kr(n,e,t){let i=n[0];if(i<=0||i>0)return n;let s=e*t,o=TG[s];if(o===void 0&&(o=new Float32Array(s),TG[s]=o),e!==0){i.toArray(o,0);for(let r=1,l=0;r!==e;++r)l+=t,n[r].toArray(o,l)}return o}function Ft(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Bt(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function du(n,e){let t=YG[e];t===void 0&&(t=new Int32Array(e),YG[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function y9(n,e){let t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function I9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ft(t,e))return;n.uniform2fv(this.addr,e),Bt(t,e)}}function G9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ft(t,e))return;n.uniform3fv(this.addr,e),Bt(t,e)}}function X9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ft(t,e))return;n.uniform4fv(this.addr,e),Bt(t,e)}}function V9(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ft(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Bt(t,e)}else{if(Ft(t,i))return;HG.set(i),n.uniformMatrix2fv(this.addr,!1,HG),Bt(t,i)}}function R9(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ft(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Bt(t,e)}else{if(Ft(t,i))return;wG.set(i),n.uniformMatrix3fv(this.addr,!1,wG),Bt(t,i)}}function S9(n,e){let t=this.cache,i=e.elements;if(i===void 0){if(Ft(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Bt(t,e)}else{if(Ft(t,i))return;NG.set(i),n.uniformMatrix4fv(this.addr,!1,NG),Bt(t,i)}}function C9(n,e){let t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function W9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ft(t,e))return;n.uniform2iv(this.addr,e),Bt(t,e)}}function x9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ft(t,e))return;n.uniform3iv(this.addr,e),Bt(t,e)}}function v9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ft(t,e))return;n.uniform4iv(this.addr,e),Bt(t,e)}}function L9(n,e){let t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function M9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ft(t,e))return;n.uniform2uiv(this.addr,e),Bt(t,e)}}function T9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ft(t,e))return;n.uniform3uiv(this.addr,e),Bt(t,e)}}function Y9(n,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ft(t,e))return;n.uniform4uiv(this.addr,e),Bt(t,e)}}function N9(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s);let o;this.type===n.SAMPLER_2D_SHADOW?(MG.compareFunction=vX,o=MG):o=wX,t.setTexture2D(e||o,s)}function w9(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||KX,s)}function H9(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||kX,s)}function K9(n,e,t){let i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||HX,s)}function k9(n){switch(n){case 5126:return y9;case 35664:return I9;case 35665:return G9;case 35666:return X9;case 35674:return V9;case 35675:return R9;case 35676:return S9;case 5124:case 35670:return C9;case 35667:case 35671:return W9;case 35668:case 35672:return x9;case 35669:case 35673:return v9;case 5125:return L9;case 36294:return M9;case 36295:return T9;case 36296:return Y9;case 35678:case 36198:case 36298:case 36306:case 35682:return N9;case 35679:case 36299:case 36307:return w9;case 35680:case 36300:case 36308:case 36293:return H9;case 36289:case 36303:case 36311:case 36292:return K9}}function U9(n,e){n.uniform1fv(this.addr,e)}function J9(n,e){let t=Kr(e,this.size,2);n.uniform2fv(this.addr,t)}function A9(n,e){let t=Kr(e,this.size,3);n.uniform3fv(this.addr,t)}function F9(n,e){let t=Kr(e,this.size,4);n.uniform4fv(this.addr,t)}function B9(n,e){let t=Kr(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function P9(n,e){let t=Kr(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function E9(n,e){let t=Kr(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function z9(n,e){n.uniform1iv(this.addr,e)}function D9(n,e){n.uniform2iv(this.addr,e)}function _9(n,e){n.uniform3iv(this.addr,e)}function j9(n,e){n.uniform4iv(this.addr,e)}function O9(n,e){n.uniform1uiv(this.addr,e)}function Q9(n,e){n.uniform2uiv(this.addr,e)}function q9(n,e){n.uniform3uiv(this.addr,e)}function $9(n,e){n.uniform4uiv(this.addr,e)}function eM(n,e,t){let i=this.cache,s=e.length,o=du(t,s);Ft(i,o)||(n.uniform1iv(this.addr,o),Bt(i,o));for(let r=0;r!==s;++r)t.setTexture2D(e[r]||wX,o[r])}function tM(n,e,t){let i=this.cache,s=e.length,o=du(t,s);Ft(i,o)||(n.uniform1iv(this.addr,o),Bt(i,o));for(let r=0;r!==s;++r)t.setTexture3D(e[r]||KX,o[r])}function nM(n,e,t){let i=this.cache,s=e.length,o=du(t,s);Ft(i,o)||(n.uniform1iv(this.addr,o),Bt(i,o));for(let r=0;r!==s;++r)t.setTextureCube(e[r]||kX,o[r])}function iM(n,e,t){let i=this.cache,s=e.length,o=du(t,s);Ft(i,o)||(n.uniform1iv(this.addr,o),Bt(i,o));for(let r=0;r!==s;++r)t.setTexture2DArray(e[r]||HX,o[r])}function sM(n){switch(n){case 5126:return U9;case 35664:return J9;case 35665:return A9;case 35666:return F9;case 35674:return B9;case 35675:return P9;case 35676:return E9;case 5124:case 35670:return z9;case 35667:case 35671:return D9;case 35668:case 35672:return _9;case 35669:case 35673:return j9;case 5125:return O9;case 36294:return Q9;case 36295:return q9;case 36296:return $9;case 35678:case 36198:case 36298:case 36306:case 35682:return eM;case 35679:case 36299:case 36307:return tM;case 35680:case 36300:case 36308:case 36293:return nM;case 36289:case 36303:case 36311:case 36292:return iM}}var Rb=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=k9(t.type)}},Sb=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=sM(t.type)}},Cb=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let s=this.seq;for(let o=0,r=s.length;o!==r;++o){let l=s[o];l.setValue(e,t[l.id],i)}}},vp=/(\w+)(\])?(\[|\.)?/g;function KG(n,e){n.seq.push(e),n.map[e.id]=e}function oM(n,e,t){let i=n.name,s=i.length;for(vp.lastIndex=0;;){let o=vp.exec(i),r=vp.lastIndex,l=o[1],a=o[2]==="]",c=o[3];if(a&&(l=l|0),c===void 0||c==="["&&r+2===s){KG(t,c===void 0?new Rb(l,n,e):new Sb(l,n,e));break}else{let u=t.map[l];u===void 0&&(u=new Cb(l),KG(t,u)),t=u}}}var Rr=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){let o=e.getActiveUniform(t,s),r=e.getUniformLocation(t,o.name);oM(o,r,this)}}setValue(e,t,i,s){let o=this.map[t];o!==void 0&&o.setValue(e,i,s)}setOptional(e,t,i){let s=t[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let o=0,r=t.length;o!==r;++o){let l=t[o],a=i[l.id];a.needsUpdate!==!1&&l.setValue(e,a.value,s)}}static seqWithValue(e,t){let i=[];for(let s=0,o=e.length;s!==o;++s){let r=e[s];r.id in t&&i.push(r)}return i}};function kG(n,e,t){let i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}var rM=37297,lM=0;function aM(n,e){let t=n.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let r=s;r<o;r++){let l=r+1;i.push(`${l===e?">":" "} ${l}: ${t[r]}`)}return i.join(`
`)}var UG=new Ae;function cM(n){je._getMatrix(UG,je.workingColorSpace,n);let e=`mat3( ${UG.elements.map(t=>t.toFixed(4))} )`;switch(je.getTransfer(n)){case cu:return[e,"LinearTransferOETF"];case gt:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function JG(n,e,t){let i=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(i&&s==="")return"";let o=/ERROR: 0:(\d+)/.exec(s);if(o){let r=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+aM(n.getShaderSource(e),r)}else return s}function dM(n,e){let t=cM(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function uM(n,e){let t;switch(e){case I2:t="Linear";break;case G2:t="Reinhard";break;case X2:t="Cineon";break;case V2:t="ACESFilmic";break;case S2:t="AgX";break;case C2:t="Neutral";break;case R2:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var fd=new T;function hM(){je.getLuminanceCoefficients(fd);let n=fd.x.toFixed(4),e=fd.y.toFixed(4),t=fd.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function mM(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Jl).join(`
`)}function pM(n){let e=[];for(let t in n){let i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function bM(n,e){let t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let o=n.getActiveAttrib(e,s),r=o.name,l=1;o.type===n.FLOAT_MAT2&&(l=2),o.type===n.FLOAT_MAT3&&(l=3),o.type===n.FLOAT_MAT4&&(l=4),t[r]={type:o.type,location:n.getAttribLocation(e,r),locationSize:l}}return t}function Jl(n){return n!==""}function AG(n,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function FG(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var fM=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wb(n){return n.replace(fM,ZM)}var gM=new Map;function ZM(n,e){let t=Be[e];if(t===void 0){let i=gM.get(e);if(i!==void 0)t=Be[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Wb(t)}var yM=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function BG(n){return n.replace(yM,IM)}function IM(n,e,t,i){let s="";for(let o=parseInt(e);o<parseInt(t);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function PG(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function GM(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===fX?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===$v?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Bi&&(e="SHADOWMAP_TYPE_VSM"),e}function XM(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Cr:case Wr:e="ENVMAP_TYPE_CUBE";break;case lu:e="ENVMAP_TYPE_CUBE_UV";break}return e}function VM(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Wr:e="ENVMAP_MODE_REFRACTION";break}return e}function RM(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case gX:e="ENVMAP_BLENDING_MULTIPLY";break;case Z2:e="ENVMAP_BLENDING_MIX";break;case y2:e="ENVMAP_BLENDING_ADD";break}return e}function SM(n){let e=n.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function CM(n,e,t,i){let s=n.getContext(),o=t.defines,r=t.vertexShader,l=t.fragmentShader,a=GM(t),c=XM(t),d=VM(t),u=RM(t),h=SM(t),m=mM(t),f=pM(o),g=s.createProgram(),b,p,R=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,f].filter(Jl).join(`
`),b.length>0&&(b+=`
`),p=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,f].filter(Jl).join(`
`),p.length>0&&(p+=`
`)):(b=[PG(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,f,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Jl).join(`
`),p=[PG(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,f,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ss?"#define TONE_MAPPING":"",t.toneMapping!==Ss?Be.tonemapping_pars_fragment:"",t.toneMapping!==Ss?uM("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Be.colorspace_pars_fragment,dM("linearToOutputTexel",t.outputColorSpace),hM(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Jl).join(`
`)),r=Wb(r),r=AG(r,t),r=FG(r,t),l=Wb(l),l=AG(l,t),l=FG(l,t),r=BG(r),l=BG(l),t.isRawShaderMaterial!==!0&&(R=`#version 300 es
`,b=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,p=["#define varying in",t.glslVersion===iG?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===iG?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+p);let V=R+b+r,I=R+p+l,w=kG(s,s.VERTEX_SHADER,V),W=kG(s,s.FRAGMENT_SHADER,I);s.attachShader(g,w),s.attachShader(g,W),t.index0AttributeName!==void 0?s.bindAttribLocation(g,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(g,0,"position"),s.linkProgram(g);function C(x){if(n.debug.checkShaderErrors){let F=s.getProgramInfoLog(g).trim(),U=s.getShaderInfoLog(w).trim(),z=s.getShaderInfoLog(W).trim(),j=!0,B=!0;if(s.getProgramParameter(g,s.LINK_STATUS)===!1)if(j=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,g,w,W);else{let Q=JG(s,w,"vertex"),J=JG(s,W,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(g,s.VALIDATE_STATUS)+`

Material Name: `+x.name+`
Material Type: `+x.type+`

Program Info Log: `+F+`
`+Q+`
`+J)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(U===""||z==="")&&(B=!1);B&&(x.diagnostics={runnable:j,programLog:F,vertexShader:{log:U,prefix:b},fragmentShader:{log:z,prefix:p}})}s.deleteShader(w),s.deleteShader(W),N=new Rr(s,g),X=bM(s,g)}let N;this.getUniforms=function(){return N===void 0&&C(this),N};let X;this.getAttributes=function(){return X===void 0&&C(this),X};let G=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return G===!1&&(G=s.getProgramParameter(g,rM)),G},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(g),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=lM++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=W,this}var WM=0,xb=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(t),o=this._getShaderStage(i),r=this._getShaderCacheForMaterial(e);return r.has(s)===!1&&(r.add(s),s.usedTimes++),r.has(o)===!1&&(r.add(o),o.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new vb(e),t.set(e,i)),i}},vb=class{constructor(e){this.id=WM++,this.code=e,this.usedTimes=0}};function xM(n,e,t,i,s,o,r){let l=new _l,a=new xb,c=new Set,d=[],u=s.logarithmicDepthBuffer,h=s.vertexTextures,m=s.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(X){return c.add(X),X===0?"uv":`uv${X}`}function b(X,G,x,F,U){let z=F.fog,j=U.geometry,B=X.isMeshStandardMaterial?F.environment:null,Q=(X.isMeshStandardMaterial?t:e).get(X.envMap||B),J=Q&&Q.mapping===lu?Q.image.height:null,ne=f[X.type];X.precision!==null&&(m=s.getMaxPrecision(X.precision),m!==X.precision&&console.warn("THREE.WebGLProgram.getParameters:",X.precision,"not supported, using",m,"instead."));let de=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,fe=de!==void 0?de.length:0,ze=0;j.morphAttributes.position!==void 0&&(ze=1),j.morphAttributes.normal!==void 0&&(ze=2),j.morphAttributes.color!==void 0&&(ze=3);let Zt,E,te,Ie;if(ne){let ht=Ii[ne];Zt=ht.vertexShader,E=ht.fragmentShader}else Zt=X.vertexShader,E=X.fragmentShader,a.update(X),te=a.getVertexShaderID(X),Ie=a.getFragmentShaderID(X);let re=n.getRenderTarget(),We=n.state.buffers.depth.getReversed(),He=U.isInstancedMesh===!0,De=U.isBatchedMesh===!0,xt=!!X.map,nt=!!X.matcap,Mt=!!Q,Y=!!X.aoMap,Ln=!!X.lightMap,Qe=!!X.bumpMap,qe=!!X.normalMap,Re=!!X.displacementMap,Vt=!!X.emissiveMap,Ve=!!X.metalnessMap,S=!!X.roughnessMap,Z=X.anisotropy>0,H=X.clearcoat>0,D=X.dispersion>0,q=X.iridescence>0,P=X.sheen>0,Ge=X.transmission>0,le=Z&&!!X.anisotropyMap,he=H&&!!X.clearcoatMap,it=H&&!!X.clearcoatNormalMap,$=H&&!!X.clearcoatRoughnessMap,me=q&&!!X.iridescenceMap,Ce=q&&!!X.iridescenceThicknessMap,Me=P&&!!X.sheenColorMap,pe=P&&!!X.sheenRoughnessMap,$e=!!X.specularMap,Fe=!!X.specularColorMap,Gt=!!X.specularIntensityMap,v=Ge&&!!X.transmissionMap,oe=Ge&&!!X.thicknessMap,A=!!X.gradientMap,_=!!X.alphaMap,ue=X.alphaTest>0,ae=!!X.alphaHash,Ke=!!X.extensions,Lt=Ss;X.toneMapped&&(re===null||re.isXRRenderTarget===!0)&&(Lt=n.toneMapping);let en={shaderID:ne,shaderType:X.type,shaderName:X.name,vertexShader:Zt,fragmentShader:E,defines:X.defines,customVertexShaderID:te,customFragmentShaderID:Ie,isRawShaderMaterial:X.isRawShaderMaterial===!0,glslVersion:X.glslVersion,precision:m,batching:De,batchingColor:De&&U._colorsTexture!==null,instancing:He,instancingColor:He&&U.instanceColor!==null,instancingMorph:He&&U.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:re===null?n.outputColorSpace:re.isXRRenderTarget===!0?re.texture.colorSpace:an,alphaToCoverage:!!X.alphaToCoverage,map:xt,matcap:nt,envMap:Mt,envMapMode:Mt&&Q.mapping,envMapCubeUVHeight:J,aoMap:Y,lightMap:Ln,bumpMap:Qe,normalMap:qe,displacementMap:h&&Re,emissiveMap:Vt,normalMapObjectSpace:qe&&X.normalMapType===M2,normalMapTangentSpace:qe&&X.normalMapType===xX,metalnessMap:Ve,roughnessMap:S,anisotropy:Z,anisotropyMap:le,clearcoat:H,clearcoatMap:he,clearcoatNormalMap:it,clearcoatRoughnessMap:$,dispersion:D,iridescence:q,iridescenceMap:me,iridescenceThicknessMap:Ce,sheen:P,sheenColorMap:Me,sheenRoughnessMap:pe,specularMap:$e,specularColorMap:Fe,specularIntensityMap:Gt,transmission:Ge,transmissionMap:v,thicknessMap:oe,gradientMap:A,opaque:X.transparent===!1&&X.blending===Gr&&X.alphaToCoverage===!1,alphaMap:_,alphaTest:ue,alphaHash:ae,combine:X.combine,mapUv:xt&&g(X.map.channel),aoMapUv:Y&&g(X.aoMap.channel),lightMapUv:Ln&&g(X.lightMap.channel),bumpMapUv:Qe&&g(X.bumpMap.channel),normalMapUv:qe&&g(X.normalMap.channel),displacementMapUv:Re&&g(X.displacementMap.channel),emissiveMapUv:Vt&&g(X.emissiveMap.channel),metalnessMapUv:Ve&&g(X.metalnessMap.channel),roughnessMapUv:S&&g(X.roughnessMap.channel),anisotropyMapUv:le&&g(X.anisotropyMap.channel),clearcoatMapUv:he&&g(X.clearcoatMap.channel),clearcoatNormalMapUv:it&&g(X.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$&&g(X.clearcoatRoughnessMap.channel),iridescenceMapUv:me&&g(X.iridescenceMap.channel),iridescenceThicknessMapUv:Ce&&g(X.iridescenceThicknessMap.channel),sheenColorMapUv:Me&&g(X.sheenColorMap.channel),sheenRoughnessMapUv:pe&&g(X.sheenRoughnessMap.channel),specularMapUv:$e&&g(X.specularMap.channel),specularColorMapUv:Fe&&g(X.specularColorMap.channel),specularIntensityMapUv:Gt&&g(X.specularIntensityMap.channel),transmissionMapUv:v&&g(X.transmissionMap.channel),thicknessMapUv:oe&&g(X.thicknessMap.channel),alphaMapUv:_&&g(X.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(qe||Z),vertexColors:X.vertexColors,vertexAlphas:X.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,pointsUvs:U.isPoints===!0&&!!j.attributes.uv&&(xt||_),fog:!!z,useFog:X.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:X.flatShading===!0,sizeAttenuation:X.sizeAttenuation===!0,logarithmicDepthBuffer:u,reverseDepthBuffer:We,skinning:U.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:fe,morphTextureStride:ze,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numSpotLightMaps:G.spotLightMap.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numSpotLightShadowsWithMaps:G.numSpotLightShadowsWithMaps,numLightProbes:G.numLightProbes,numClippingPlanes:r.numPlanes,numClipIntersection:r.numIntersection,dithering:X.dithering,shadowMapEnabled:n.shadowMap.enabled&&x.length>0,shadowMapType:n.shadowMap.type,toneMapping:Lt,decodeVideoTexture:xt&&X.map.isVideoTexture===!0&&je.getTransfer(X.map.colorSpace)===gt,decodeVideoTextureEmissive:Vt&&X.emissiveMap.isVideoTexture===!0&&je.getTransfer(X.emissiveMap.colorSpace)===gt,premultipliedAlpha:X.premultipliedAlpha,doubleSided:X.side===li,flipSided:X.side===Zn,useDepthPacking:X.depthPacking>=0,depthPacking:X.depthPacking||0,index0AttributeName:X.index0AttributeName,extensionClipCullDistance:Ke&&X.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ke&&X.extensions.multiDraw===!0||De)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:X.customProgramCacheKey()};return en.vertexUv1s=c.has(1),en.vertexUv2s=c.has(2),en.vertexUv3s=c.has(3),c.clear(),en}function p(X){let G=[];if(X.shaderID?G.push(X.shaderID):(G.push(X.customVertexShaderID),G.push(X.customFragmentShaderID)),X.defines!==void 0)for(let x in X.defines)G.push(x),G.push(X.defines[x]);return X.isRawShaderMaterial===!1&&(R(G,X),V(G,X),G.push(n.outputColorSpace)),G.push(X.customProgramCacheKey),G.join()}function R(X,G){X.push(G.precision),X.push(G.outputColorSpace),X.push(G.envMapMode),X.push(G.envMapCubeUVHeight),X.push(G.mapUv),X.push(G.alphaMapUv),X.push(G.lightMapUv),X.push(G.aoMapUv),X.push(G.bumpMapUv),X.push(G.normalMapUv),X.push(G.displacementMapUv),X.push(G.emissiveMapUv),X.push(G.metalnessMapUv),X.push(G.roughnessMapUv),X.push(G.anisotropyMapUv),X.push(G.clearcoatMapUv),X.push(G.clearcoatNormalMapUv),X.push(G.clearcoatRoughnessMapUv),X.push(G.iridescenceMapUv),X.push(G.iridescenceThicknessMapUv),X.push(G.sheenColorMapUv),X.push(G.sheenRoughnessMapUv),X.push(G.specularMapUv),X.push(G.specularColorMapUv),X.push(G.specularIntensityMapUv),X.push(G.transmissionMapUv),X.push(G.thicknessMapUv),X.push(G.combine),X.push(G.fogExp2),X.push(G.sizeAttenuation),X.push(G.morphTargetsCount),X.push(G.morphAttributeCount),X.push(G.numDirLights),X.push(G.numPointLights),X.push(G.numSpotLights),X.push(G.numSpotLightMaps),X.push(G.numHemiLights),X.push(G.numRectAreaLights),X.push(G.numDirLightShadows),X.push(G.numPointLightShadows),X.push(G.numSpotLightShadows),X.push(G.numSpotLightShadowsWithMaps),X.push(G.numLightProbes),X.push(G.shadowMapType),X.push(G.toneMapping),X.push(G.numClippingPlanes),X.push(G.numClipIntersection),X.push(G.depthPacking)}function V(X,G){l.disableAll(),G.supportsVertexTextures&&l.enable(0),G.instancing&&l.enable(1),G.instancingColor&&l.enable(2),G.instancingMorph&&l.enable(3),G.matcap&&l.enable(4),G.envMap&&l.enable(5),G.normalMapObjectSpace&&l.enable(6),G.normalMapTangentSpace&&l.enable(7),G.clearcoat&&l.enable(8),G.iridescence&&l.enable(9),G.alphaTest&&l.enable(10),G.vertexColors&&l.enable(11),G.vertexAlphas&&l.enable(12),G.vertexUv1s&&l.enable(13),G.vertexUv2s&&l.enable(14),G.vertexUv3s&&l.enable(15),G.vertexTangents&&l.enable(16),G.anisotropy&&l.enable(17),G.alphaHash&&l.enable(18),G.batching&&l.enable(19),G.dispersion&&l.enable(20),G.batchingColor&&l.enable(21),X.push(l.mask),l.disableAll(),G.fog&&l.enable(0),G.useFog&&l.enable(1),G.flatShading&&l.enable(2),G.logarithmicDepthBuffer&&l.enable(3),G.reverseDepthBuffer&&l.enable(4),G.skinning&&l.enable(5),G.morphTargets&&l.enable(6),G.morphNormals&&l.enable(7),G.morphColors&&l.enable(8),G.premultipliedAlpha&&l.enable(9),G.shadowMapEnabled&&l.enable(10),G.doubleSided&&l.enable(11),G.flipSided&&l.enable(12),G.useDepthPacking&&l.enable(13),G.dithering&&l.enable(14),G.transmission&&l.enable(15),G.sheen&&l.enable(16),G.opaque&&l.enable(17),G.pointsUvs&&l.enable(18),G.decodeVideoTexture&&l.enable(19),G.decodeVideoTextureEmissive&&l.enable(20),G.alphaToCoverage&&l.enable(21),X.push(l.mask)}function I(X){let G=f[X.type],x;if(G){let F=Ii[G];x=Z5.clone(F.uniforms)}else x=X.uniforms;return x}function w(X,G){let x;for(let F=0,U=d.length;F<U;F++){let z=d[F];if(z.cacheKey===G){x=z,++x.usedTimes;break}}return x===void 0&&(x=new CM(n,G,X,o),d.push(x)),x}function W(X){if(--X.usedTimes===0){let G=d.indexOf(X);d[G]=d[d.length-1],d.pop(),X.destroy()}}function C(X){a.remove(X)}function N(){a.dispose()}return{getParameters:b,getProgramCacheKey:p,getUniforms:I,acquireProgram:w,releaseProgram:W,releaseShaderCache:C,programs:d,dispose:N}}function vM(){let n=new WeakMap;function e(r){return n.has(r)}function t(r){let l=n.get(r);return l===void 0&&(l={},n.set(r,l)),l}function i(r){n.delete(r)}function s(r,l,a){n.get(r)[l]=a}function o(){n=new WeakMap}return{has:e,get:t,remove:i,update:s,dispose:o}}function LM(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function EG(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function zG(){let n=[],e=0,t=[],i=[],s=[];function o(){e=0,t.length=0,i.length=0,s.length=0}function r(u,h,m,f,g,b){let p=n[e];return p===void 0?(p={id:u.id,object:u,geometry:h,material:m,groupOrder:f,renderOrder:u.renderOrder,z:g,group:b},n[e]=p):(p.id=u.id,p.object=u,p.geometry=h,p.material=m,p.groupOrder=f,p.renderOrder=u.renderOrder,p.z=g,p.group=b),e++,p}function l(u,h,m,f,g,b){let p=r(u,h,m,f,g,b);m.transmission>0?i.push(p):m.transparent===!0?s.push(p):t.push(p)}function a(u,h,m,f,g,b){let p=r(u,h,m,f,g,b);m.transmission>0?i.unshift(p):m.transparent===!0?s.unshift(p):t.unshift(p)}function c(u,h){t.length>1&&t.sort(u||LM),i.length>1&&i.sort(h||EG),s.length>1&&s.sort(h||EG)}function d(){for(let u=e,h=n.length;u<h;u++){let m=n[u];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:s,init:o,push:l,unshift:a,finish:d,sort:c}}function MM(){let n=new WeakMap;function e(i,s){let o=n.get(i),r;return o===void 0?(r=new zG,n.set(i,[r])):s>=o.length?(r=new zG,o.push(r)):r=o[s],r}function t(){n=new WeakMap}return{get:e,dispose:t}}function TM(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new T,color:new xe};break;case"SpotLight":t={position:new T,direction:new T,color:new xe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new T,color:new xe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new T,skyColor:new xe,groundColor:new xe};break;case"RectAreaLight":t={color:new xe,position:new T,halfWidth:new T,halfHeight:new T};break}return n[e.id]=t,t}}}function YM(){let n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}var NM=0;function wM(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function HM(n){let e=new TM,t=YM(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new T);let s=new T,o=new Ye,r=new Ye;function l(c){let d=0,u=0,h=0;for(let X=0;X<9;X++)i.probe[X].set(0,0,0);let m=0,f=0,g=0,b=0,p=0,R=0,V=0,I=0,w=0,W=0,C=0;c.sort(wM);for(let X=0,G=c.length;X<G;X++){let x=c[X],F=x.color,U=x.intensity,z=x.distance,j=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)d+=F.r*U,u+=F.g*U,h+=F.b*U;else if(x.isLightProbe){for(let B=0;B<9;B++)i.probe[B].addScaledVector(x.sh.coefficients[B],U);C++}else if(x.isDirectionalLight){let B=e.get(x);if(B.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){let Q=x.shadow,J=t.get(x);J.shadowIntensity=Q.intensity,J.shadowBias=Q.bias,J.shadowNormalBias=Q.normalBias,J.shadowRadius=Q.radius,J.shadowMapSize=Q.mapSize,i.directionalShadow[m]=J,i.directionalShadowMap[m]=j,i.directionalShadowMatrix[m]=x.shadow.matrix,R++}i.directional[m]=B,m++}else if(x.isSpotLight){let B=e.get(x);B.position.setFromMatrixPosition(x.matrixWorld),B.color.copy(F).multiplyScalar(U),B.distance=z,B.coneCos=Math.cos(x.angle),B.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),B.decay=x.decay,i.spot[g]=B;let Q=x.shadow;if(x.map&&(i.spotLightMap[w]=x.map,w++,Q.updateMatrices(x),x.castShadow&&W++),i.spotLightMatrix[g]=Q.matrix,x.castShadow){let J=t.get(x);J.shadowIntensity=Q.intensity,J.shadowBias=Q.bias,J.shadowNormalBias=Q.normalBias,J.shadowRadius=Q.radius,J.shadowMapSize=Q.mapSize,i.spotShadow[g]=J,i.spotShadowMap[g]=j,I++}g++}else if(x.isRectAreaLight){let B=e.get(x);B.color.copy(F).multiplyScalar(U),B.halfWidth.set(x.width*.5,0,0),B.halfHeight.set(0,x.height*.5,0),i.rectArea[b]=B,b++}else if(x.isPointLight){let B=e.get(x);if(B.color.copy(x.color).multiplyScalar(x.intensity),B.distance=x.distance,B.decay=x.decay,x.castShadow){let Q=x.shadow,J=t.get(x);J.shadowIntensity=Q.intensity,J.shadowBias=Q.bias,J.shadowNormalBias=Q.normalBias,J.shadowRadius=Q.radius,J.shadowMapSize=Q.mapSize,J.shadowCameraNear=Q.camera.near,J.shadowCameraFar=Q.camera.far,i.pointShadow[f]=J,i.pointShadowMap[f]=j,i.pointShadowMatrix[f]=x.shadow.matrix,V++}i.point[f]=B,f++}else if(x.isHemisphereLight){let B=e.get(x);B.skyColor.copy(x.color).multiplyScalar(U),B.groundColor.copy(x.groundColor).multiplyScalar(U),i.hemi[p]=B,p++}}b>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ie.LTC_FLOAT_1,i.rectAreaLTC2=ie.LTC_FLOAT_2):(i.rectAreaLTC1=ie.LTC_HALF_1,i.rectAreaLTC2=ie.LTC_HALF_2)),i.ambient[0]=d,i.ambient[1]=u,i.ambient[2]=h;let N=i.hash;(N.directionalLength!==m||N.pointLength!==f||N.spotLength!==g||N.rectAreaLength!==b||N.hemiLength!==p||N.numDirectionalShadows!==R||N.numPointShadows!==V||N.numSpotShadows!==I||N.numSpotMaps!==w||N.numLightProbes!==C)&&(i.directional.length=m,i.spot.length=g,i.rectArea.length=b,i.point.length=f,i.hemi.length=p,i.directionalShadow.length=R,i.directionalShadowMap.length=R,i.pointShadow.length=V,i.pointShadowMap.length=V,i.spotShadow.length=I,i.spotShadowMap.length=I,i.directionalShadowMatrix.length=R,i.pointShadowMatrix.length=V,i.spotLightMatrix.length=I+w-W,i.spotLightMap.length=w,i.numSpotLightShadowsWithMaps=W,i.numLightProbes=C,N.directionalLength=m,N.pointLength=f,N.spotLength=g,N.rectAreaLength=b,N.hemiLength=p,N.numDirectionalShadows=R,N.numPointShadows=V,N.numSpotShadows=I,N.numSpotMaps=w,N.numLightProbes=C,i.version=NM++)}function a(c,d){let u=0,h=0,m=0,f=0,g=0,b=d.matrixWorldInverse;for(let p=0,R=c.length;p<R;p++){let V=c[p];if(V.isDirectionalLight){let I=i.directional[u];I.direction.setFromMatrixPosition(V.matrixWorld),s.setFromMatrixPosition(V.target.matrixWorld),I.direction.sub(s),I.direction.transformDirection(b),u++}else if(V.isSpotLight){let I=i.spot[m];I.position.setFromMatrixPosition(V.matrixWorld),I.position.applyMatrix4(b),I.direction.setFromMatrixPosition(V.matrixWorld),s.setFromMatrixPosition(V.target.matrixWorld),I.direction.sub(s),I.direction.transformDirection(b),m++}else if(V.isRectAreaLight){let I=i.rectArea[f];I.position.setFromMatrixPosition(V.matrixWorld),I.position.applyMatrix4(b),r.identity(),o.copy(V.matrixWorld),o.premultiply(b),r.extractRotation(o),I.halfWidth.set(V.width*.5,0,0),I.halfHeight.set(0,V.height*.5,0),I.halfWidth.applyMatrix4(r),I.halfHeight.applyMatrix4(r),f++}else if(V.isPointLight){let I=i.point[h];I.position.setFromMatrixPosition(V.matrixWorld),I.position.applyMatrix4(b),h++}else if(V.isHemisphereLight){let I=i.hemi[g];I.direction.setFromMatrixPosition(V.matrixWorld),I.direction.transformDirection(b),g++}}}return{setup:l,setupView:a,state:i}}function DG(n){let e=new HM(n),t=[],i=[];function s(d){c.camera=d,t.length=0,i.length=0}function o(d){t.push(d)}function r(d){i.push(d)}function l(){e.setup(t)}function a(d){e.setupView(t,d)}let c={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:c,setupLights:l,setupLightsView:a,pushLight:o,pushShadow:r}}function KM(n){let e=new WeakMap;function t(s,o=0){let r=e.get(s),l;return r===void 0?(l=new DG(n),e.set(s,[l])):o>=r.length?(l=new DG(n),r.push(l)):l=r[o],l}function i(){e=new WeakMap}return{get:t,dispose:i}}var Lb=class extends xn{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=v2,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Mb=class extends xn{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},kM=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,UM=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function JM(n,e,t){let i=new Ol,s=new Oe,o=new Oe,r=new at,l=new Lb({depthPacking:L2}),a=new Mb,c={},d=t.maxTextureSize,u={[Vi]:Zn,[Zn]:Vi,[li]:li},h=new Si({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oe},radius:{value:4}},vertexShader:kM,fragmentShader:UM}),m=h.clone();m.defines.HORIZONTAL_PASS=1;let f=new Fn;f.setAttribute("position",new At(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let g=new rn(f,h),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=fX;let p=this.type;this.render=function(W,C,N){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||W.length===0)return;let X=n.getRenderTarget(),G=n.getActiveCubeFace(),x=n.getActiveMipmapLevel(),F=n.state;F.setBlending(Rs),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);let U=p!==Bi&&this.type===Bi,z=p===Bi&&this.type!==Bi;for(let j=0,B=W.length;j<B;j++){let Q=W[j],J=Q.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",Q,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;s.copy(J.mapSize);let ne=J.getFrameExtents();if(s.multiply(ne),o.copy(J.mapSize),(s.x>d||s.y>d)&&(s.x>d&&(o.x=Math.floor(d/ne.x),s.x=o.x*ne.x,J.mapSize.x=o.x),s.y>d&&(o.y=Math.floor(d/ne.y),s.y=o.y*ne.y,J.mapSize.y=o.y)),J.map===null||U===!0||z===!0){let fe=this.type!==Bi?{minFilter:ln,magFilter:ln}:{};J.map!==null&&J.map.dispose(),J.map=new ji(s.x,s.y,fe),J.map.texture.name=Q.name+".shadowMap",J.camera.updateProjectionMatrix()}n.setRenderTarget(J.map),n.clear();let de=J.getViewportCount();for(let fe=0;fe<de;fe++){let ze=J.getViewport(fe);r.set(o.x*ze.x,o.y*ze.y,o.x*ze.z,o.y*ze.w),F.viewport(r),J.updateMatrices(Q,fe),i=J.getFrustum(),I(C,N,J.camera,Q,this.type)}J.isPointLightShadow!==!0&&this.type===Bi&&R(J,N),J.needsUpdate=!1}p=this.type,b.needsUpdate=!1,n.setRenderTarget(X,G,x)};function R(W,C){let N=e.update(g);h.defines.VSM_SAMPLES!==W.blurSamples&&(h.defines.VSM_SAMPLES=W.blurSamples,m.defines.VSM_SAMPLES=W.blurSamples,h.needsUpdate=!0,m.needsUpdate=!0),W.mapPass===null&&(W.mapPass=new ji(s.x,s.y)),h.uniforms.shadow_pass.value=W.map.texture,h.uniforms.resolution.value=W.mapSize,h.uniforms.radius.value=W.radius,n.setRenderTarget(W.mapPass),n.clear(),n.renderBufferDirect(C,null,N,h,g,null),m.uniforms.shadow_pass.value=W.mapPass.texture,m.uniforms.resolution.value=W.mapSize,m.uniforms.radius.value=W.radius,n.setRenderTarget(W.map),n.clear(),n.renderBufferDirect(C,null,N,m,g,null)}function V(W,C,N,X){let G=null,x=N.isPointLight===!0?W.customDistanceMaterial:W.customDepthMaterial;if(x!==void 0)G=x;else if(G=N.isPointLight===!0?a:l,n.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0){let F=G.uuid,U=C.uuid,z=c[F];z===void 0&&(z={},c[F]=z);let j=z[U];j===void 0&&(j=G.clone(),z[U]=j,C.addEventListener("dispose",w)),G=j}if(G.visible=C.visible,G.wireframe=C.wireframe,X===Bi?G.side=C.shadowSide!==null?C.shadowSide:C.side:G.side=C.shadowSide!==null?C.shadowSide:u[C.side],G.alphaMap=C.alphaMap,G.alphaTest=C.alphaTest,G.map=C.map,G.clipShadows=C.clipShadows,G.clippingPlanes=C.clippingPlanes,G.clipIntersection=C.clipIntersection,G.displacementMap=C.displacementMap,G.displacementScale=C.displacementScale,G.displacementBias=C.displacementBias,G.wireframeLinewidth=C.wireframeLinewidth,G.linewidth=C.linewidth,N.isPointLight===!0&&G.isMeshDistanceMaterial===!0){let F=n.properties.get(G);F.light=N}return G}function I(W,C,N,X,G){if(W.visible===!1)return;if(W.layers.test(C.layers)&&(W.isMesh||W.isLine||W.isPoints)&&(W.castShadow||W.receiveShadow&&G===Bi)&&(!W.frustumCulled||i.intersectsObject(W))){W.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,W.matrixWorld);let U=e.update(W),z=W.material;if(Array.isArray(z)){let j=U.groups;for(let B=0,Q=j.length;B<Q;B++){let J=j[B],ne=z[J.materialIndex];if(ne&&ne.visible){let de=V(W,ne,X,G);W.onBeforeShadow(n,W,C,N,U,de,J),n.renderBufferDirect(N,null,U,de,W,J),W.onAfterShadow(n,W,C,N,U,de,J)}}}else if(z.visible){let j=V(W,z,X,G);W.onBeforeShadow(n,W,C,N,U,j,null),n.renderBufferDirect(N,null,U,j,W,null),W.onAfterShadow(n,W,C,N,U,j,null)}}let F=W.children;for(let U=0,z=F.length;U<z;U++)I(F[U],C,N,X,G)}function w(W){W.target.removeEventListener("dispose",w);for(let N in c){let X=c[N],G=W.target.uuid;G in X&&(X[G].dispose(),delete X[G])}}}var AM={[Kp]:kp,[Up]:Fp,[Jp]:Bp,[Sr]:Ap,[kp]:Kp,[Fp]:Up,[Bp]:Jp,[Ap]:Sr};function FM(n,e){function t(){let v=!1,oe=new at,A=null,_=new at(0,0,0,0);return{setMask:function(ue){A!==ue&&!v&&(n.colorMask(ue,ue,ue,ue),A=ue)},setLocked:function(ue){v=ue},setClear:function(ue,ae,Ke,Lt,en){en===!0&&(ue*=Lt,ae*=Lt,Ke*=Lt),oe.set(ue,ae,Ke,Lt),_.equals(oe)===!1&&(n.clearColor(ue,ae,Ke,Lt),_.copy(oe))},reset:function(){v=!1,A=null,_.set(-1,0,0,0)}}}function i(){let v=!1,oe=!1,A=null,_=null,ue=null;return{setReversed:function(ae){if(oe!==ae){let Ke=e.get("EXT_clip_control");oe?Ke.clipControlEXT(Ke.LOWER_LEFT_EXT,Ke.ZERO_TO_ONE_EXT):Ke.clipControlEXT(Ke.LOWER_LEFT_EXT,Ke.NEGATIVE_ONE_TO_ONE_EXT);let Lt=ue;ue=null,this.setClear(Lt)}oe=ae},getReversed:function(){return oe},setTest:function(ae){ae?re(n.DEPTH_TEST):We(n.DEPTH_TEST)},setMask:function(ae){A!==ae&&!v&&(n.depthMask(ae),A=ae)},setFunc:function(ae){if(oe&&(ae=AM[ae]),_!==ae){switch(ae){case Kp:n.depthFunc(n.NEVER);break;case kp:n.depthFunc(n.ALWAYS);break;case Up:n.depthFunc(n.LESS);break;case Sr:n.depthFunc(n.LEQUAL);break;case Jp:n.depthFunc(n.EQUAL);break;case Ap:n.depthFunc(n.GEQUAL);break;case Fp:n.depthFunc(n.GREATER);break;case Bp:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}_=ae}},setLocked:function(ae){v=ae},setClear:function(ae){ue!==ae&&(oe&&(ae=1-ae),n.clearDepth(ae),ue=ae)},reset:function(){v=!1,A=null,_=null,ue=null,oe=!1}}}function s(){let v=!1,oe=null,A=null,_=null,ue=null,ae=null,Ke=null,Lt=null,en=null;return{setTest:function(ht){v||(ht?re(n.STENCIL_TEST):We(n.STENCIL_TEST))},setMask:function(ht){oe!==ht&&!v&&(n.stencilMask(ht),oe=ht)},setFunc:function(ht,Dn,Ci){(A!==ht||_!==Dn||ue!==Ci)&&(n.stencilFunc(ht,Dn,Ci),A=ht,_=Dn,ue=Ci)},setOp:function(ht,Dn,Ci){(ae!==ht||Ke!==Dn||Lt!==Ci)&&(n.stencilOp(ht,Dn,Ci),ae=ht,Ke=Dn,Lt=Ci)},setLocked:function(ht){v=ht},setClear:function(ht){en!==ht&&(n.clearStencil(ht),en=ht)},reset:function(){v=!1,oe=null,A=null,_=null,ue=null,ae=null,Ke=null,Lt=null,en=null}}}let o=new t,r=new i,l=new s,a=new WeakMap,c=new WeakMap,d={},u={},h=new WeakMap,m=[],f=null,g=!1,b=null,p=null,R=null,V=null,I=null,w=null,W=null,C=new xe(0,0,0),N=0,X=!1,G=null,x=null,F=null,U=null,z=null,j=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),B=!1,Q=0,J=n.getParameter(n.VERSION);J.indexOf("WebGL")!==-1?(Q=parseFloat(/^WebGL (\d)/.exec(J)[1]),B=Q>=1):J.indexOf("OpenGL ES")!==-1&&(Q=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),B=Q>=2);let ne=null,de={},fe=n.getParameter(n.SCISSOR_BOX),ze=n.getParameter(n.VIEWPORT),Zt=new at().fromArray(fe),E=new at().fromArray(ze);function te(v,oe,A,_){let ue=new Uint8Array(4),ae=n.createTexture();n.bindTexture(v,ae),n.texParameteri(v,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(v,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ke=0;Ke<A;Ke++)v===n.TEXTURE_3D||v===n.TEXTURE_2D_ARRAY?n.texImage3D(oe,0,n.RGBA,1,1,_,0,n.RGBA,n.UNSIGNED_BYTE,ue):n.texImage2D(oe+Ke,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ue);return ae}let Ie={};Ie[n.TEXTURE_2D]=te(n.TEXTURE_2D,n.TEXTURE_2D,1),Ie[n.TEXTURE_CUBE_MAP]=te(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ie[n.TEXTURE_2D_ARRAY]=te(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ie[n.TEXTURE_3D]=te(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),r.setClear(1),l.setClear(0),re(n.DEPTH_TEST),r.setFunc(Sr),Qe(!1),qe(DI),re(n.CULL_FACE),Y(Rs);function re(v){d[v]!==!0&&(n.enable(v),d[v]=!0)}function We(v){d[v]!==!1&&(n.disable(v),d[v]=!1)}function He(v,oe){return u[v]!==oe?(n.bindFramebuffer(v,oe),u[v]=oe,v===n.DRAW_FRAMEBUFFER&&(u[n.FRAMEBUFFER]=oe),v===n.FRAMEBUFFER&&(u[n.DRAW_FRAMEBUFFER]=oe),!0):!1}function De(v,oe){let A=m,_=!1;if(v){A=h.get(oe),A===void 0&&(A=[],h.set(oe,A));let ue=v.textures;if(A.length!==ue.length||A[0]!==n.COLOR_ATTACHMENT0){for(let ae=0,Ke=ue.length;ae<Ke;ae++)A[ae]=n.COLOR_ATTACHMENT0+ae;A.length=ue.length,_=!0}}else A[0]!==n.BACK&&(A[0]=n.BACK,_=!0);_&&n.drawBuffers(A)}function xt(v){return f!==v?(n.useProgram(v),f=v,!0):!1}let nt={[lo]:n.FUNC_ADD,[t2]:n.FUNC_SUBTRACT,[n2]:n.FUNC_REVERSE_SUBTRACT};nt[i2]=n.MIN,nt[s2]=n.MAX;let Mt={[o2]:n.ZERO,[r2]:n.ONE,[l2]:n.SRC_COLOR,[wp]:n.SRC_ALPHA,[m2]:n.SRC_ALPHA_SATURATE,[u2]:n.DST_COLOR,[c2]:n.DST_ALPHA,[a2]:n.ONE_MINUS_SRC_COLOR,[Hp]:n.ONE_MINUS_SRC_ALPHA,[h2]:n.ONE_MINUS_DST_COLOR,[d2]:n.ONE_MINUS_DST_ALPHA,[p2]:n.CONSTANT_COLOR,[b2]:n.ONE_MINUS_CONSTANT_COLOR,[f2]:n.CONSTANT_ALPHA,[g2]:n.ONE_MINUS_CONSTANT_ALPHA};function Y(v,oe,A,_,ue,ae,Ke,Lt,en,ht){if(v===Rs){g===!0&&(We(n.BLEND),g=!1);return}if(g===!1&&(re(n.BLEND),g=!0),v!==e2){if(v!==b||ht!==X){if((p!==lo||I!==lo)&&(n.blendEquation(n.FUNC_ADD),p=lo,I=lo),ht)switch(v){case Gr:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case _I:n.blendFunc(n.ONE,n.ONE);break;case jI:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case OI:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",v);break}else switch(v){case Gr:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case _I:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case jI:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case OI:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",v);break}R=null,V=null,w=null,W=null,C.set(0,0,0),N=0,b=v,X=ht}return}ue=ue||oe,ae=ae||A,Ke=Ke||_,(oe!==p||ue!==I)&&(n.blendEquationSeparate(nt[oe],nt[ue]),p=oe,I=ue),(A!==R||_!==V||ae!==w||Ke!==W)&&(n.blendFuncSeparate(Mt[A],Mt[_],Mt[ae],Mt[Ke]),R=A,V=_,w=ae,W=Ke),(Lt.equals(C)===!1||en!==N)&&(n.blendColor(Lt.r,Lt.g,Lt.b,en),C.copy(Lt),N=en),b=v,X=!1}function Ln(v,oe){v.side===li?We(n.CULL_FACE):re(n.CULL_FACE);let A=v.side===Zn;oe&&(A=!A),Qe(A),v.blending===Gr&&v.transparent===!1?Y(Rs):Y(v.blending,v.blendEquation,v.blendSrc,v.blendDst,v.blendEquationAlpha,v.blendSrcAlpha,v.blendDstAlpha,v.blendColor,v.blendAlpha,v.premultipliedAlpha),r.setFunc(v.depthFunc),r.setTest(v.depthTest),r.setMask(v.depthWrite),o.setMask(v.colorWrite);let _=v.stencilWrite;l.setTest(_),_&&(l.setMask(v.stencilWriteMask),l.setFunc(v.stencilFunc,v.stencilRef,v.stencilFuncMask),l.setOp(v.stencilFail,v.stencilZFail,v.stencilZPass)),Vt(v.polygonOffset,v.polygonOffsetFactor,v.polygonOffsetUnits),v.alphaToCoverage===!0?re(n.SAMPLE_ALPHA_TO_COVERAGE):We(n.SAMPLE_ALPHA_TO_COVERAGE)}function Qe(v){G!==v&&(v?n.frontFace(n.CW):n.frontFace(n.CCW),G=v)}function qe(v){v!==Qv?(re(n.CULL_FACE),v!==x&&(v===DI?n.cullFace(n.BACK):v===qv?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):We(n.CULL_FACE),x=v}function Re(v){v!==F&&(B&&n.lineWidth(v),F=v)}function Vt(v,oe,A){v?(re(n.POLYGON_OFFSET_FILL),(U!==oe||z!==A)&&(n.polygonOffset(oe,A),U=oe,z=A)):We(n.POLYGON_OFFSET_FILL)}function Ve(v){v?re(n.SCISSOR_TEST):We(n.SCISSOR_TEST)}function S(v){v===void 0&&(v=n.TEXTURE0+j-1),ne!==v&&(n.activeTexture(v),ne=v)}function Z(v,oe,A){A===void 0&&(ne===null?A=n.TEXTURE0+j-1:A=ne);let _=de[A];_===void 0&&(_={type:void 0,texture:void 0},de[A]=_),(_.type!==v||_.texture!==oe)&&(ne!==A&&(n.activeTexture(A),ne=A),n.bindTexture(v,oe||Ie[v]),_.type=v,_.texture=oe)}function H(){let v=de[ne];v!==void 0&&v.type!==void 0&&(n.bindTexture(v.type,null),v.type=void 0,v.texture=void 0)}function D(){try{n.compressedTexImage2D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function q(){try{n.compressedTexImage3D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function P(){try{n.texSubImage2D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function Ge(){try{n.texSubImage3D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function le(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function he(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function it(){try{n.texStorage2D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function $(){try{n.texStorage3D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function me(){try{n.texImage2D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function Ce(){try{n.texImage3D.apply(n,arguments)}catch(v){console.error("THREE.WebGLState:",v)}}function Me(v){Zt.equals(v)===!1&&(n.scissor(v.x,v.y,v.z,v.w),Zt.copy(v))}function pe(v){E.equals(v)===!1&&(n.viewport(v.x,v.y,v.z,v.w),E.copy(v))}function $e(v,oe){let A=c.get(oe);A===void 0&&(A=new WeakMap,c.set(oe,A));let _=A.get(v);_===void 0&&(_=n.getUniformBlockIndex(oe,v.name),A.set(v,_))}function Fe(v,oe){let _=c.get(oe).get(v);a.get(oe)!==_&&(n.uniformBlockBinding(oe,_,v.__bindingPointIndex),a.set(oe,_))}function Gt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),r.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},ne=null,de={},u={},h=new WeakMap,m=[],f=null,g=!1,b=null,p=null,R=null,V=null,I=null,w=null,W=null,C=new xe(0,0,0),N=0,X=!1,G=null,x=null,F=null,U=null,z=null,Zt.set(0,0,n.canvas.width,n.canvas.height),E.set(0,0,n.canvas.width,n.canvas.height),o.reset(),r.reset(),l.reset()}return{buffers:{color:o,depth:r,stencil:l},enable:re,disable:We,bindFramebuffer:He,drawBuffers:De,useProgram:xt,setBlending:Y,setMaterial:Ln,setFlipSided:Qe,setCullFace:qe,setLineWidth:Re,setPolygonOffset:Vt,setScissorTest:Ve,activeTexture:S,bindTexture:Z,unbindTexture:H,compressedTexImage2D:D,compressedTexImage3D:q,texImage2D:me,texImage3D:Ce,updateUBOMapping:$e,uniformBlockBinding:Fe,texStorage2D:it,texStorage3D:$,texSubImage2D:P,texSubImage3D:Ge,compressedTexSubImage2D:le,compressedTexSubImage3D:he,scissor:Me,viewport:pe,reset:Gt}}function _G(n,e,t,i){let s=BM(i);switch(t){case GX:return n*e;case VX:return n*e;case RX:return n*e*2;case $b:return n*e/s.components*s.byteLength;case ef:return n*e/s.components*s.byteLength;case SX:return n*e*2/s.components*s.byteLength;case tf:return n*e*2/s.components*s.byteLength;case XX:return n*e*3/s.components*s.byteLength;case Un:return n*e*4/s.components*s.byteLength;case nf:return n*e*4/s.components*s.byteLength;case Rd:case Sd:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Cd:case Wd:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Dp:case jp:return Math.max(n,16)*Math.max(e,8)/4;case zp:case _p:return Math.max(n,8)*Math.max(e,8)/2;case Op:case Qp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case qp:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case $p:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case eb:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case tb:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case nb:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case ib:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case sb:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case ob:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case rb:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case lb:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case ab:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case cb:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case db:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case ub:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case hb:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case xd:case mb:case pb:return Math.ceil(n/4)*Math.ceil(e/4)*16;case CX:case bb:return Math.ceil(n/4)*Math.ceil(e/4)*8;case fb:case gb:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function BM(n){switch(n){case _i:case ZX:return{byteLength:1,components:1};case zl:case yX:case sa:return{byteLength:2,components:1};case Qb:case qb:return{byteLength:2,components:4};case ho:case Ob:case ci:return{byteLength:4,components:1};case IX:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}function PM(n,e,t,i,s,o,r){let l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,a=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Oe,d=new WeakMap,u,h=new WeakMap,m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f(S,Z){return m?new OffscreenCanvas(S,Z):Dl("canvas")}function g(S,Z,H){let D=1,q=Ve(S);if((q.width>H||q.height>H)&&(D=H/Math.max(q.width,q.height)),D<1)if(typeof HTMLImageElement<"u"&&S instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&S instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&S instanceof ImageBitmap||typeof VideoFrame<"u"&&S instanceof VideoFrame){let P=Math.floor(D*q.width),Ge=Math.floor(D*q.height);u===void 0&&(u=f(P,Ge));let le=Z?f(P,Ge):u;return le.width=P,le.height=Ge,le.getContext("2d").drawImage(S,0,0,P,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+P+"x"+Ge+")."),le}else return"data"in S&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),S;return S}function b(S){return S.generateMipmaps}function p(S){n.generateMipmap(S)}function R(S){return S.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:S.isWebGL3DRenderTarget?n.TEXTURE_3D:S.isWebGLArrayRenderTarget||S.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function V(S,Z,H,D,q=!1){if(S!==null){if(n[S]!==void 0)return n[S];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+S+"'")}let P=Z;if(Z===n.RED&&(H===n.FLOAT&&(P=n.R32F),H===n.HALF_FLOAT&&(P=n.R16F),H===n.UNSIGNED_BYTE&&(P=n.R8)),Z===n.RED_INTEGER&&(H===n.UNSIGNED_BYTE&&(P=n.R8UI),H===n.UNSIGNED_SHORT&&(P=n.R16UI),H===n.UNSIGNED_INT&&(P=n.R32UI),H===n.BYTE&&(P=n.R8I),H===n.SHORT&&(P=n.R16I),H===n.INT&&(P=n.R32I)),Z===n.RG&&(H===n.FLOAT&&(P=n.RG32F),H===n.HALF_FLOAT&&(P=n.RG16F),H===n.UNSIGNED_BYTE&&(P=n.RG8)),Z===n.RG_INTEGER&&(H===n.UNSIGNED_BYTE&&(P=n.RG8UI),H===n.UNSIGNED_SHORT&&(P=n.RG16UI),H===n.UNSIGNED_INT&&(P=n.RG32UI),H===n.BYTE&&(P=n.RG8I),H===n.SHORT&&(P=n.RG16I),H===n.INT&&(P=n.RG32I)),Z===n.RGB_INTEGER&&(H===n.UNSIGNED_BYTE&&(P=n.RGB8UI),H===n.UNSIGNED_SHORT&&(P=n.RGB16UI),H===n.UNSIGNED_INT&&(P=n.RGB32UI),H===n.BYTE&&(P=n.RGB8I),H===n.SHORT&&(P=n.RGB16I),H===n.INT&&(P=n.RGB32I)),Z===n.RGBA_INTEGER&&(H===n.UNSIGNED_BYTE&&(P=n.RGBA8UI),H===n.UNSIGNED_SHORT&&(P=n.RGBA16UI),H===n.UNSIGNED_INT&&(P=n.RGBA32UI),H===n.BYTE&&(P=n.RGBA8I),H===n.SHORT&&(P=n.RGBA16I),H===n.INT&&(P=n.RGBA32I)),Z===n.RGB&&H===n.UNSIGNED_INT_5_9_9_9_REV&&(P=n.RGB9_E5),Z===n.RGBA){let Ge=q?cu:je.getTransfer(D);H===n.FLOAT&&(P=n.RGBA32F),H===n.HALF_FLOAT&&(P=n.RGBA16F),H===n.UNSIGNED_BYTE&&(P=Ge===gt?n.SRGB8_ALPHA8:n.RGBA8),H===n.UNSIGNED_SHORT_4_4_4_4&&(P=n.RGBA4),H===n.UNSIGNED_SHORT_5_5_5_1&&(P=n.RGB5_A1)}return(P===n.R16F||P===n.R32F||P===n.RG16F||P===n.RG32F||P===n.RGBA16F||P===n.RGBA32F)&&e.get("EXT_color_buffer_float"),P}function I(S,Z){let H;return S?Z===null||Z===ho||Z===xr?H=n.DEPTH24_STENCIL8:Z===ci?H=n.DEPTH32F_STENCIL8:Z===zl&&(H=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Z===null||Z===ho||Z===xr?H=n.DEPTH_COMPONENT24:Z===ci?H=n.DEPTH_COMPONENT32F:Z===zl&&(H=n.DEPTH_COMPONENT16),H}function w(S,Z){return b(S)===!0||S.isFramebufferTexture&&S.minFilter!==ln&&S.minFilter!==gn?Math.log2(Math.max(Z.width,Z.height))+1:S.mipmaps!==void 0&&S.mipmaps.length>0?S.mipmaps.length:S.isCompressedTexture&&Array.isArray(S.image)?Z.mipmaps.length:1}function W(S){let Z=S.target;Z.removeEventListener("dispose",W),N(Z),Z.isVideoTexture&&d.delete(Z)}function C(S){let Z=S.target;Z.removeEventListener("dispose",C),G(Z)}function N(S){let Z=i.get(S);if(Z.__webglInit===void 0)return;let H=S.source,D=h.get(H);if(D){let q=D[Z.__cacheKey];q.usedTimes--,q.usedTimes===0&&X(S),Object.keys(D).length===0&&h.delete(H)}i.remove(S)}function X(S){let Z=i.get(S);n.deleteTexture(Z.__webglTexture);let H=S.source,D=h.get(H);delete D[Z.__cacheKey],r.memory.textures--}function G(S){let Z=i.get(S);if(S.depthTexture&&(S.depthTexture.dispose(),i.remove(S.depthTexture)),S.isWebGLCubeRenderTarget)for(let D=0;D<6;D++){if(Array.isArray(Z.__webglFramebuffer[D]))for(let q=0;q<Z.__webglFramebuffer[D].length;q++)n.deleteFramebuffer(Z.__webglFramebuffer[D][q]);else n.deleteFramebuffer(Z.__webglFramebuffer[D]);Z.__webglDepthbuffer&&n.deleteRenderbuffer(Z.__webglDepthbuffer[D])}else{if(Array.isArray(Z.__webglFramebuffer))for(let D=0;D<Z.__webglFramebuffer.length;D++)n.deleteFramebuffer(Z.__webglFramebuffer[D]);else n.deleteFramebuffer(Z.__webglFramebuffer);if(Z.__webglDepthbuffer&&n.deleteRenderbuffer(Z.__webglDepthbuffer),Z.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Z.__webglMultisampledFramebuffer),Z.__webglColorRenderbuffer)for(let D=0;D<Z.__webglColorRenderbuffer.length;D++)Z.__webglColorRenderbuffer[D]&&n.deleteRenderbuffer(Z.__webglColorRenderbuffer[D]);Z.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Z.__webglDepthRenderbuffer)}let H=S.textures;for(let D=0,q=H.length;D<q;D++){let P=i.get(H[D]);P.__webglTexture&&(n.deleteTexture(P.__webglTexture),r.memory.textures--),i.remove(H[D])}i.remove(S)}let x=0;function F(){x=0}function U(){let S=x;return S>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+S+" texture units while this GPU supports only "+s.maxTextures),x+=1,S}function z(S){let Z=[];return Z.push(S.wrapS),Z.push(S.wrapT),Z.push(S.wrapR||0),Z.push(S.magFilter),Z.push(S.minFilter),Z.push(S.anisotropy),Z.push(S.internalFormat),Z.push(S.format),Z.push(S.type),Z.push(S.generateMipmaps),Z.push(S.premultiplyAlpha),Z.push(S.flipY),Z.push(S.unpackAlignment),Z.push(S.colorSpace),Z.join()}function j(S,Z){let H=i.get(S);if(S.isVideoTexture&&Re(S),S.isRenderTargetTexture===!1&&S.version>0&&H.__version!==S.version){let D=S.image;if(D===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(D.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{E(H,S,Z);return}}t.bindTexture(n.TEXTURE_2D,H.__webglTexture,n.TEXTURE0+Z)}function B(S,Z){let H=i.get(S);if(S.version>0&&H.__version!==S.version){E(H,S,Z);return}t.bindTexture(n.TEXTURE_2D_ARRAY,H.__webglTexture,n.TEXTURE0+Z)}function Q(S,Z){let H=i.get(S);if(S.version>0&&H.__version!==S.version){E(H,S,Z);return}t.bindTexture(n.TEXTURE_3D,H.__webglTexture,n.TEXTURE0+Z)}function J(S,Z){let H=i.get(S);if(S.version>0&&H.__version!==S.version){te(H,S,Z);return}t.bindTexture(n.TEXTURE_CUBE_MAP,H.__webglTexture,n.TEXTURE0+Z)}let ne={[uo]:n.REPEAT,[Ei]:n.CLAMP_TO_EDGE,[El]:n.MIRRORED_REPEAT},de={[ln]:n.NEAREST,[jb]:n.NEAREST_MIPMAP_NEAREST,[yr]:n.NEAREST_MIPMAP_LINEAR,[gn]:n.LINEAR,[Al]:n.LINEAR_MIPMAP_NEAREST,[Gi]:n.LINEAR_MIPMAP_LINEAR},fe={[T2]:n.NEVER,[k2]:n.ALWAYS,[Y2]:n.LESS,[vX]:n.LEQUAL,[N2]:n.EQUAL,[K2]:n.GEQUAL,[w2]:n.GREATER,[H2]:n.NOTEQUAL};function ze(S,Z){if(Z.type===ci&&e.has("OES_texture_float_linear")===!1&&(Z.magFilter===gn||Z.magFilter===Al||Z.magFilter===yr||Z.magFilter===Gi||Z.minFilter===gn||Z.minFilter===Al||Z.minFilter===yr||Z.minFilter===Gi)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(S,n.TEXTURE_WRAP_S,ne[Z.wrapS]),n.texParameteri(S,n.TEXTURE_WRAP_T,ne[Z.wrapT]),(S===n.TEXTURE_3D||S===n.TEXTURE_2D_ARRAY)&&n.texParameteri(S,n.TEXTURE_WRAP_R,ne[Z.wrapR]),n.texParameteri(S,n.TEXTURE_MAG_FILTER,de[Z.magFilter]),n.texParameteri(S,n.TEXTURE_MIN_FILTER,de[Z.minFilter]),Z.compareFunction&&(n.texParameteri(S,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(S,n.TEXTURE_COMPARE_FUNC,fe[Z.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Z.magFilter===ln||Z.minFilter!==yr&&Z.minFilter!==Gi||Z.type===ci&&e.has("OES_texture_float_linear")===!1)return;if(Z.anisotropy>1||i.get(Z).__currentAnisotropy){let H=e.get("EXT_texture_filter_anisotropic");n.texParameterf(S,H.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Z.anisotropy,s.getMaxAnisotropy())),i.get(Z).__currentAnisotropy=Z.anisotropy}}}function Zt(S,Z){let H=!1;S.__webglInit===void 0&&(S.__webglInit=!0,Z.addEventListener("dispose",W));let D=Z.source,q=h.get(D);q===void 0&&(q={},h.set(D,q));let P=z(Z);if(P!==S.__cacheKey){q[P]===void 0&&(q[P]={texture:n.createTexture(),usedTimes:0},r.memory.textures++,H=!0),q[P].usedTimes++;let Ge=q[S.__cacheKey];Ge!==void 0&&(q[S.__cacheKey].usedTimes--,Ge.usedTimes===0&&X(Z)),S.__cacheKey=P,S.__webglTexture=q[P].texture}return H}function E(S,Z,H){let D=n.TEXTURE_2D;(Z.isDataArrayTexture||Z.isCompressedArrayTexture)&&(D=n.TEXTURE_2D_ARRAY),Z.isData3DTexture&&(D=n.TEXTURE_3D);let q=Zt(S,Z),P=Z.source;t.bindTexture(D,S.__webglTexture,n.TEXTURE0+H);let Ge=i.get(P);if(P.version!==Ge.__version||q===!0){t.activeTexture(n.TEXTURE0+H);let le=je.getPrimaries(je.workingColorSpace),he=Z.colorSpace===Xs?null:je.getPrimaries(Z.colorSpace),it=Z.colorSpace===Xs||le===he?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Z.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Z.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,it);let $=g(Z.image,!1,s.maxTextureSize);$=Vt(Z,$);let me=o.convert(Z.format,Z.colorSpace),Ce=o.convert(Z.type),Me=V(Z.internalFormat,me,Ce,Z.colorSpace,Z.isVideoTexture);ze(D,Z);let pe,$e=Z.mipmaps,Fe=Z.isVideoTexture!==!0,Gt=Ge.__version===void 0||q===!0,v=P.dataReady,oe=w(Z,$);if(Z.isDepthTexture)Me=I(Z.format===vr,Z.type),Gt&&(Fe?t.texStorage2D(n.TEXTURE_2D,1,Me,$.width,$.height):t.texImage2D(n.TEXTURE_2D,0,Me,$.width,$.height,0,me,Ce,null));else if(Z.isDataTexture)if($e.length>0){Fe&&Gt&&t.texStorage2D(n.TEXTURE_2D,oe,Me,$e[0].width,$e[0].height);for(let A=0,_=$e.length;A<_;A++)pe=$e[A],Fe?v&&t.texSubImage2D(n.TEXTURE_2D,A,0,0,pe.width,pe.height,me,Ce,pe.data):t.texImage2D(n.TEXTURE_2D,A,Me,pe.width,pe.height,0,me,Ce,pe.data);Z.generateMipmaps=!1}else Fe?(Gt&&t.texStorage2D(n.TEXTURE_2D,oe,Me,$.width,$.height),v&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,$.width,$.height,me,Ce,$.data)):t.texImage2D(n.TEXTURE_2D,0,Me,$.width,$.height,0,me,Ce,$.data);else if(Z.isCompressedTexture)if(Z.isCompressedArrayTexture){Fe&&Gt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,oe,Me,$e[0].width,$e[0].height,$.depth);for(let A=0,_=$e.length;A<_;A++)if(pe=$e[A],Z.format!==Un)if(me!==null)if(Fe){if(v)if(Z.layerUpdates.size>0){let ue=_G(pe.width,pe.height,Z.format,Z.type);for(let ae of Z.layerUpdates){let Ke=pe.data.subarray(ae*ue/pe.data.BYTES_PER_ELEMENT,(ae+1)*ue/pe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,A,0,0,ae,pe.width,pe.height,1,me,Ke)}Z.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,A,0,0,0,pe.width,pe.height,$.depth,me,pe.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,A,Me,pe.width,pe.height,$.depth,0,pe.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Fe?v&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,A,0,0,0,pe.width,pe.height,$.depth,me,Ce,pe.data):t.texImage3D(n.TEXTURE_2D_ARRAY,A,Me,pe.width,pe.height,$.depth,0,me,Ce,pe.data)}else{Fe&&Gt&&t.texStorage2D(n.TEXTURE_2D,oe,Me,$e[0].width,$e[0].height);for(let A=0,_=$e.length;A<_;A++)pe=$e[A],Z.format!==Un?me!==null?Fe?v&&t.compressedTexSubImage2D(n.TEXTURE_2D,A,0,0,pe.width,pe.height,me,pe.data):t.compressedTexImage2D(n.TEXTURE_2D,A,Me,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Fe?v&&t.texSubImage2D(n.TEXTURE_2D,A,0,0,pe.width,pe.height,me,Ce,pe.data):t.texImage2D(n.TEXTURE_2D,A,Me,pe.width,pe.height,0,me,Ce,pe.data)}else if(Z.isDataArrayTexture)if(Fe){if(Gt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,oe,Me,$.width,$.height,$.depth),v)if(Z.layerUpdates.size>0){let A=_G($.width,$.height,Z.format,Z.type);for(let _ of Z.layerUpdates){let ue=$.data.subarray(_*A/$.data.BYTES_PER_ELEMENT,(_+1)*A/$.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,_,$.width,$.height,1,me,Ce,ue)}Z.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,$.width,$.height,$.depth,me,Ce,$.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Me,$.width,$.height,$.depth,0,me,Ce,$.data);else if(Z.isData3DTexture)Fe?(Gt&&t.texStorage3D(n.TEXTURE_3D,oe,Me,$.width,$.height,$.depth),v&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,$.width,$.height,$.depth,me,Ce,$.data)):t.texImage3D(n.TEXTURE_3D,0,Me,$.width,$.height,$.depth,0,me,Ce,$.data);else if(Z.isFramebufferTexture){if(Gt)if(Fe)t.texStorage2D(n.TEXTURE_2D,oe,Me,$.width,$.height);else{let A=$.width,_=$.height;for(let ue=0;ue<oe;ue++)t.texImage2D(n.TEXTURE_2D,ue,Me,A,_,0,me,Ce,null),A>>=1,_>>=1}}else if($e.length>0){if(Fe&&Gt){let A=Ve($e[0]);t.texStorage2D(n.TEXTURE_2D,oe,Me,A.width,A.height)}for(let A=0,_=$e.length;A<_;A++)pe=$e[A],Fe?v&&t.texSubImage2D(n.TEXTURE_2D,A,0,0,me,Ce,pe):t.texImage2D(n.TEXTURE_2D,A,Me,me,Ce,pe);Z.generateMipmaps=!1}else if(Fe){if(Gt){let A=Ve($);t.texStorage2D(n.TEXTURE_2D,oe,Me,A.width,A.height)}v&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,me,Ce,$)}else t.texImage2D(n.TEXTURE_2D,0,Me,me,Ce,$);b(Z)&&p(D),Ge.__version=P.version,Z.onUpdate&&Z.onUpdate(Z)}S.__version=Z.version}function te(S,Z,H){if(Z.image.length!==6)return;let D=Zt(S,Z),q=Z.source;t.bindTexture(n.TEXTURE_CUBE_MAP,S.__webglTexture,n.TEXTURE0+H);let P=i.get(q);if(q.version!==P.__version||D===!0){t.activeTexture(n.TEXTURE0+H);let Ge=je.getPrimaries(je.workingColorSpace),le=Z.colorSpace===Xs?null:je.getPrimaries(Z.colorSpace),he=Z.colorSpace===Xs||Ge===le?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Z.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Z.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,he);let it=Z.isCompressedTexture||Z.image[0].isCompressedTexture,$=Z.image[0]&&Z.image[0].isDataTexture,me=[];for(let _=0;_<6;_++)!it&&!$?me[_]=g(Z.image[_],!0,s.maxCubemapSize):me[_]=$?Z.image[_].image:Z.image[_],me[_]=Vt(Z,me[_]);let Ce=me[0],Me=o.convert(Z.format,Z.colorSpace),pe=o.convert(Z.type),$e=V(Z.internalFormat,Me,pe,Z.colorSpace),Fe=Z.isVideoTexture!==!0,Gt=P.__version===void 0||D===!0,v=q.dataReady,oe=w(Z,Ce);ze(n.TEXTURE_CUBE_MAP,Z);let A;if(it){Fe&&Gt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,oe,$e,Ce.width,Ce.height);for(let _=0;_<6;_++){A=me[_].mipmaps;for(let ue=0;ue<A.length;ue++){let ae=A[ue];Z.format!==Un?Me!==null?Fe?v&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue,0,0,ae.width,ae.height,Me,ae.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue,$e,ae.width,ae.height,0,ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Fe?v&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue,0,0,ae.width,ae.height,Me,pe,ae.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue,$e,ae.width,ae.height,0,Me,pe,ae.data)}}}else{if(A=Z.mipmaps,Fe&&Gt){A.length>0&&oe++;let _=Ve(me[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,oe,$e,_.width,_.height)}for(let _=0;_<6;_++)if($){Fe?v&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,0,0,me[_].width,me[_].height,Me,pe,me[_].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,$e,me[_].width,me[_].height,0,Me,pe,me[_].data);for(let ue=0;ue<A.length;ue++){let Ke=A[ue].image[_].image;Fe?v&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue+1,0,0,Ke.width,Ke.height,Me,pe,Ke.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue+1,$e,Ke.width,Ke.height,0,Me,pe,Ke.data)}}else{Fe?v&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,0,0,Me,pe,me[_]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,$e,Me,pe,me[_]);for(let ue=0;ue<A.length;ue++){let ae=A[ue];Fe?v&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue+1,0,0,Me,pe,ae.image[_]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,ue+1,$e,Me,pe,ae.image[_])}}}b(Z)&&p(n.TEXTURE_CUBE_MAP),P.__version=q.version,Z.onUpdate&&Z.onUpdate(Z)}S.__version=Z.version}function Ie(S,Z,H,D,q,P){let Ge=o.convert(H.format,H.colorSpace),le=o.convert(H.type),he=V(H.internalFormat,Ge,le,H.colorSpace),it=i.get(Z),$=i.get(H);if($.__renderTarget=Z,!it.__hasExternalTextures){let me=Math.max(1,Z.width>>P),Ce=Math.max(1,Z.height>>P);q===n.TEXTURE_3D||q===n.TEXTURE_2D_ARRAY?t.texImage3D(q,P,he,me,Ce,Z.depth,0,Ge,le,null):t.texImage2D(q,P,he,me,Ce,0,Ge,le,null)}t.bindFramebuffer(n.FRAMEBUFFER,S),qe(Z)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,D,q,$.__webglTexture,0,Qe(Z)):(q===n.TEXTURE_2D||q>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&q<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,D,q,$.__webglTexture,P),t.bindFramebuffer(n.FRAMEBUFFER,null)}function re(S,Z,H){if(n.bindRenderbuffer(n.RENDERBUFFER,S),Z.depthBuffer){let D=Z.depthTexture,q=D&&D.isDepthTexture?D.type:null,P=I(Z.stencilBuffer,q),Ge=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,le=Qe(Z);qe(Z)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,le,P,Z.width,Z.height):H?n.renderbufferStorageMultisample(n.RENDERBUFFER,le,P,Z.width,Z.height):n.renderbufferStorage(n.RENDERBUFFER,P,Z.width,Z.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ge,n.RENDERBUFFER,S)}else{let D=Z.textures;for(let q=0;q<D.length;q++){let P=D[q],Ge=o.convert(P.format,P.colorSpace),le=o.convert(P.type),he=V(P.internalFormat,Ge,le,P.colorSpace),it=Qe(Z);H&&qe(Z)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,it,he,Z.width,Z.height):qe(Z)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,it,he,Z.width,Z.height):n.renderbufferStorage(n.RENDERBUFFER,he,Z.width,Z.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function We(S,Z){if(Z&&Z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,S),!(Z.depthTexture&&Z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let D=i.get(Z.depthTexture);D.__renderTarget=Z,(!D.__webglTexture||Z.depthTexture.image.width!==Z.width||Z.depthTexture.image.height!==Z.height)&&(Z.depthTexture.image.width=Z.width,Z.depthTexture.image.height=Z.height,Z.depthTexture.needsUpdate=!0),j(Z.depthTexture,0);let q=D.__webglTexture,P=Qe(Z);if(Z.depthTexture.format===Xr)qe(Z)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,q,0,P):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,q,0);else if(Z.depthTexture.format===vr)qe(Z)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,q,0,P):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,q,0);else throw new Error("Unknown depthTexture format")}function He(S){let Z=i.get(S),H=S.isWebGLCubeRenderTarget===!0;if(Z.__boundDepthTexture!==S.depthTexture){let D=S.depthTexture;if(Z.__depthDisposeCallback&&Z.__depthDisposeCallback(),D){let q=()=>{delete Z.__boundDepthTexture,delete Z.__depthDisposeCallback,D.removeEventListener("dispose",q)};D.addEventListener("dispose",q),Z.__depthDisposeCallback=q}Z.__boundDepthTexture=D}if(S.depthTexture&&!Z.__autoAllocateDepthBuffer){if(H)throw new Error("target.depthTexture not supported in Cube render targets");We(Z.__webglFramebuffer,S)}else if(H){Z.__webglDepthbuffer=[];for(let D=0;D<6;D++)if(t.bindFramebuffer(n.FRAMEBUFFER,Z.__webglFramebuffer[D]),Z.__webglDepthbuffer[D]===void 0)Z.__webglDepthbuffer[D]=n.createRenderbuffer(),re(Z.__webglDepthbuffer[D],S,!1);else{let q=S.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,P=Z.__webglDepthbuffer[D];n.bindRenderbuffer(n.RENDERBUFFER,P),n.framebufferRenderbuffer(n.FRAMEBUFFER,q,n.RENDERBUFFER,P)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,Z.__webglFramebuffer),Z.__webglDepthbuffer===void 0)Z.__webglDepthbuffer=n.createRenderbuffer(),re(Z.__webglDepthbuffer,S,!1);else{let D=S.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,q=Z.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,q),n.framebufferRenderbuffer(n.FRAMEBUFFER,D,n.RENDERBUFFER,q)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function De(S,Z,H){let D=i.get(S);Z!==void 0&&Ie(D.__webglFramebuffer,S,S.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),H!==void 0&&He(S)}function xt(S){let Z=S.texture,H=i.get(S),D=i.get(Z);S.addEventListener("dispose",C);let q=S.textures,P=S.isWebGLCubeRenderTarget===!0,Ge=q.length>1;if(Ge||(D.__webglTexture===void 0&&(D.__webglTexture=n.createTexture()),D.__version=Z.version,r.memory.textures++),P){H.__webglFramebuffer=[];for(let le=0;le<6;le++)if(Z.mipmaps&&Z.mipmaps.length>0){H.__webglFramebuffer[le]=[];for(let he=0;he<Z.mipmaps.length;he++)H.__webglFramebuffer[le][he]=n.createFramebuffer()}else H.__webglFramebuffer[le]=n.createFramebuffer()}else{if(Z.mipmaps&&Z.mipmaps.length>0){H.__webglFramebuffer=[];for(let le=0;le<Z.mipmaps.length;le++)H.__webglFramebuffer[le]=n.createFramebuffer()}else H.__webglFramebuffer=n.createFramebuffer();if(Ge)for(let le=0,he=q.length;le<he;le++){let it=i.get(q[le]);it.__webglTexture===void 0&&(it.__webglTexture=n.createTexture(),r.memory.textures++)}if(S.samples>0&&qe(S)===!1){H.__webglMultisampledFramebuffer=n.createFramebuffer(),H.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,H.__webglMultisampledFramebuffer);for(let le=0;le<q.length;le++){let he=q[le];H.__webglColorRenderbuffer[le]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,H.__webglColorRenderbuffer[le]);let it=o.convert(he.format,he.colorSpace),$=o.convert(he.type),me=V(he.internalFormat,it,$,he.colorSpace,S.isXRRenderTarget===!0),Ce=Qe(S);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ce,me,S.width,S.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+le,n.RENDERBUFFER,H.__webglColorRenderbuffer[le])}n.bindRenderbuffer(n.RENDERBUFFER,null),S.depthBuffer&&(H.__webglDepthRenderbuffer=n.createRenderbuffer(),re(H.__webglDepthRenderbuffer,S,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(P){t.bindTexture(n.TEXTURE_CUBE_MAP,D.__webglTexture),ze(n.TEXTURE_CUBE_MAP,Z);for(let le=0;le<6;le++)if(Z.mipmaps&&Z.mipmaps.length>0)for(let he=0;he<Z.mipmaps.length;he++)Ie(H.__webglFramebuffer[le][he],S,Z,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+le,he);else Ie(H.__webglFramebuffer[le],S,Z,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+le,0);b(Z)&&p(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ge){for(let le=0,he=q.length;le<he;le++){let it=q[le],$=i.get(it);t.bindTexture(n.TEXTURE_2D,$.__webglTexture),ze(n.TEXTURE_2D,it),Ie(H.__webglFramebuffer,S,it,n.COLOR_ATTACHMENT0+le,n.TEXTURE_2D,0),b(it)&&p(n.TEXTURE_2D)}t.unbindTexture()}else{let le=n.TEXTURE_2D;if((S.isWebGL3DRenderTarget||S.isWebGLArrayRenderTarget)&&(le=S.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(le,D.__webglTexture),ze(le,Z),Z.mipmaps&&Z.mipmaps.length>0)for(let he=0;he<Z.mipmaps.length;he++)Ie(H.__webglFramebuffer[he],S,Z,n.COLOR_ATTACHMENT0,le,he);else Ie(H.__webglFramebuffer,S,Z,n.COLOR_ATTACHMENT0,le,0);b(Z)&&p(le),t.unbindTexture()}S.depthBuffer&&He(S)}function nt(S){let Z=S.textures;for(let H=0,D=Z.length;H<D;H++){let q=Z[H];if(b(q)){let P=R(S),Ge=i.get(q).__webglTexture;t.bindTexture(P,Ge),p(P),t.unbindTexture()}}}let Mt=[],Y=[];function Ln(S){if(S.samples>0){if(qe(S)===!1){let Z=S.textures,H=S.width,D=S.height,q=n.COLOR_BUFFER_BIT,P=S.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ge=i.get(S),le=Z.length>1;if(le)for(let he=0;he<Z.length;he++)t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+he,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+he,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ge.__webglFramebuffer);for(let he=0;he<Z.length;he++){if(S.resolveDepthBuffer&&(S.depthBuffer&&(q|=n.DEPTH_BUFFER_BIT),S.stencilBuffer&&S.resolveStencilBuffer&&(q|=n.STENCIL_BUFFER_BIT)),le){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[he]);let it=i.get(Z[he]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,it,0)}n.blitFramebuffer(0,0,H,D,0,0,H,D,q,n.NEAREST),a===!0&&(Mt.length=0,Y.length=0,Mt.push(n.COLOR_ATTACHMENT0+he),S.depthBuffer&&S.resolveDepthBuffer===!1&&(Mt.push(P),Y.push(P),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Y)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Mt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),le)for(let he=0;he<Z.length;he++){t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+he,n.RENDERBUFFER,Ge.__webglColorRenderbuffer[he]);let it=i.get(Z[he]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+he,n.TEXTURE_2D,it,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer)}else if(S.depthBuffer&&S.resolveDepthBuffer===!1&&a){let Z=S.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Z])}}}function Qe(S){return Math.min(s.maxSamples,S.samples)}function qe(S){let Z=i.get(S);return S.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Z.__useRenderToTexture!==!1}function Re(S){let Z=r.render.frame;d.get(S)!==Z&&(d.set(S,Z),S.update())}function Vt(S,Z){let H=S.colorSpace,D=S.format,q=S.type;return S.isCompressedTexture===!0||S.isVideoTexture===!0||H!==an&&H!==Xs&&(je.getTransfer(H)===gt?(D!==Un||q!==_i)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",H)),Z}function Ve(S){return typeof HTMLImageElement<"u"&&S instanceof HTMLImageElement?(c.width=S.naturalWidth||S.width,c.height=S.naturalHeight||S.height):typeof VideoFrame<"u"&&S instanceof VideoFrame?(c.width=S.displayWidth,c.height=S.displayHeight):(c.width=S.width,c.height=S.height),c}this.allocateTextureUnit=U,this.resetTextureUnits=F,this.setTexture2D=j,this.setTexture2DArray=B,this.setTexture3D=Q,this.setTextureCube=J,this.rebindTextures=De,this.setupRenderTarget=xt,this.updateRenderTargetMipmap=nt,this.updateMultisampleRenderTarget=Ln,this.setupDepthRenderbuffer=He,this.setupFrameBufferTexture=Ie,this.useMultisampledRTT=qe}function EM(n,e){function t(i,s=Xs){let o,r=je.getTransfer(s);if(i===_i)return n.UNSIGNED_BYTE;if(i===Qb)return n.UNSIGNED_SHORT_4_4_4_4;if(i===qb)return n.UNSIGNED_SHORT_5_5_5_1;if(i===IX)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===ZX)return n.BYTE;if(i===yX)return n.SHORT;if(i===zl)return n.UNSIGNED_SHORT;if(i===Ob)return n.INT;if(i===ho)return n.UNSIGNED_INT;if(i===ci)return n.FLOAT;if(i===sa)return n.HALF_FLOAT;if(i===GX)return n.ALPHA;if(i===XX)return n.RGB;if(i===Un)return n.RGBA;if(i===VX)return n.LUMINANCE;if(i===RX)return n.LUMINANCE_ALPHA;if(i===Xr)return n.DEPTH_COMPONENT;if(i===vr)return n.DEPTH_STENCIL;if(i===$b)return n.RED;if(i===ef)return n.RED_INTEGER;if(i===SX)return n.RG;if(i===tf)return n.RG_INTEGER;if(i===nf)return n.RGBA_INTEGER;if(i===Rd||i===Sd||i===Cd||i===Wd)if(r===gt)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===Rd)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Sd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Cd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Wd)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===Rd)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Sd)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Cd)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Wd)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===zp||i===Dp||i===_p||i===jp)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===zp)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Dp)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===_p)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===jp)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Op||i===Qp||i===qp)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===Op||i===Qp)return r===gt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===qp)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===$p||i===eb||i===tb||i===nb||i===ib||i===sb||i===ob||i===rb||i===lb||i===ab||i===cb||i===db||i===ub||i===hb)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===$p)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===eb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===tb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===nb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===ib)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===sb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===ob)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===rb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===lb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===ab)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===cb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===db)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===ub)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===hb)return r===gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===xd||i===mb||i===pb)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===xd)return r===gt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===mb)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===pb)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===CX||i===bb||i===fb||i===gb)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===xd)return o.COMPRESSED_RED_RGTC1_EXT;if(i===bb)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===fb)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===gb)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===xr?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}var Tb=class extends Jt{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Xi=class extends _t{constructor(){super(),this.isGroup=!0,this.type="Group"}},zM={type:"move"},Pl=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xi,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xi,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xi,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let s=null,o=null,r=null,l=this._targetRay,a=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){r=!0;for(let g of e.hand.values()){let b=t.getJointPose(g,i),p=this._getHandJoint(c,g);b!==null&&(p.matrix.fromArray(b.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=b.radius),p.visible=b!==null}let d=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],h=d.position.distanceTo(u.position),m=.02,f=.005;c.inputState.pinching&&h>m+f?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=m-f&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(a.matrix.fromArray(o.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,o.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(o.linearVelocity)):a.hasLinearVelocity=!1,o.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(o.angularVelocity)):a.hasAngularVelocity=!1));l!==null&&(s=t.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(zM)))}return l!==null&&(l.visible=s!==null),a!==null&&(a.visible=o!==null),c!==null&&(c.visible=r!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new Xi;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},DM=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_M=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,Yb=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){let s=new Pn,o=e.properties.get(s);o.__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,i=new Si({vertexShader:DM,fragmentShader:_M,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new rn(new Hd(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},Nb=class extends Cs{constructor(e,t){super();let i=this,s=null,o=1,r=null,l="local-floor",a=1,c=null,d=null,u=null,h=null,m=null,f=null,g=new Yb,b=t.getContextAttributes(),p=null,R=null,V=[],I=[],w=new Oe,W=null,C=new Jt;C.viewport=new at;let N=new Jt;N.viewport=new at;let X=[C,N],G=new Tb,x=null,F=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(E){let te=V[E];return te===void 0&&(te=new Pl,V[E]=te),te.getTargetRaySpace()},this.getControllerGrip=function(E){let te=V[E];return te===void 0&&(te=new Pl,V[E]=te),te.getGripSpace()},this.getHand=function(E){let te=V[E];return te===void 0&&(te=new Pl,V[E]=te),te.getHandSpace()};function U(E){let te=I.indexOf(E.inputSource);if(te===-1)return;let Ie=V[te];Ie!==void 0&&(Ie.update(E.inputSource,E.frame,c||r),Ie.dispatchEvent({type:E.type,data:E.inputSource}))}function z(){s.removeEventListener("select",U),s.removeEventListener("selectstart",U),s.removeEventListener("selectend",U),s.removeEventListener("squeeze",U),s.removeEventListener("squeezestart",U),s.removeEventListener("squeezeend",U),s.removeEventListener("end",z),s.removeEventListener("inputsourceschange",j);for(let E=0;E<V.length;E++){let te=I[E];te!==null&&(I[E]=null,V[E].disconnect(te))}x=null,F=null,g.reset(),e.setRenderTarget(p),m=null,h=null,u=null,s=null,R=null,Zt.stop(),i.isPresenting=!1,e.setPixelRatio(W),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(E){o=E,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(E){l=E,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||r},this.setReferenceSpace=function(E){c=E},this.getBaseLayer=function(){return h!==null?h:m},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return s},this.setSession=function(E){return lt(this,null,function*(){if(s=E,s!==null){if(p=e.getRenderTarget(),s.addEventListener("select",U),s.addEventListener("selectstart",U),s.addEventListener("selectend",U),s.addEventListener("squeeze",U),s.addEventListener("squeezestart",U),s.addEventListener("squeezeend",U),s.addEventListener("end",z),s.addEventListener("inputsourceschange",j),b.xrCompatible!==!0&&(yield t.makeXRCompatible()),W=e.getPixelRatio(),e.getSize(w),s.renderState.layers===void 0){let te={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:o};m=new XRWebGLLayer(s,t,te),s.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),R=new ji(m.framebufferWidth,m.framebufferHeight,{format:Un,type:_i,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil})}else{let te=null,Ie=null,re=null;b.depth&&(re=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,te=b.stencil?vr:Xr,Ie=b.stencil?xr:ho);let We={colorFormat:t.RGBA8,depthFormat:re,scaleFactor:o};u=new XRWebGLBinding(s,t),h=u.createProjectionLayer(We),s.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),R=new ji(h.textureWidth,h.textureHeight,{format:Un,type:_i,depthTexture:new kd(h.textureWidth,h.textureHeight,Ie,void 0,void 0,void 0,void 0,void 0,void 0,te),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1})}R.isXRRenderTarget=!0,this.setFoveation(a),c=null,r=yield s.requestReferenceSpace(l),Zt.setContext(s),Zt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};function j(E){for(let te=0;te<E.removed.length;te++){let Ie=E.removed[te],re=I.indexOf(Ie);re>=0&&(I[re]=null,V[re].disconnect(Ie))}for(let te=0;te<E.added.length;te++){let Ie=E.added[te],re=I.indexOf(Ie);if(re===-1){for(let He=0;He<V.length;He++)if(He>=I.length){I.push(Ie),re=He;break}else if(I[He]===null){I[He]=Ie,re=He;break}if(re===-1)break}let We=V[re];We&&We.connect(Ie)}}let B=new T,Q=new T;function J(E,te,Ie){B.setFromMatrixPosition(te.matrixWorld),Q.setFromMatrixPosition(Ie.matrixWorld);let re=B.distanceTo(Q),We=te.projectionMatrix.elements,He=Ie.projectionMatrix.elements,De=We[14]/(We[10]-1),xt=We[14]/(We[10]+1),nt=(We[9]+1)/We[5],Mt=(We[9]-1)/We[5],Y=(We[8]-1)/We[0],Ln=(He[8]+1)/He[0],Qe=De*Y,qe=De*Ln,Re=re/(-Y+Ln),Vt=Re*-Y;if(te.matrixWorld.decompose(E.position,E.quaternion,E.scale),E.translateX(Vt),E.translateZ(Re),E.matrixWorld.compose(E.position,E.quaternion,E.scale),E.matrixWorldInverse.copy(E.matrixWorld).invert(),We[10]===-1)E.projectionMatrix.copy(te.projectionMatrix),E.projectionMatrixInverse.copy(te.projectionMatrixInverse);else{let Ve=De+Re,S=xt+Re,Z=Qe-Vt,H=qe+(re-Vt),D=nt*xt/S*Ve,q=Mt*xt/S*Ve;E.projectionMatrix.makePerspective(Z,H,D,q,Ve,S),E.projectionMatrixInverse.copy(E.projectionMatrix).invert()}}function ne(E,te){te===null?E.matrixWorld.copy(E.matrix):E.matrixWorld.multiplyMatrices(te.matrixWorld,E.matrix),E.matrixWorldInverse.copy(E.matrixWorld).invert()}this.updateCamera=function(E){if(s===null)return;let te=E.near,Ie=E.far;g.texture!==null&&(g.depthNear>0&&(te=g.depthNear),g.depthFar>0&&(Ie=g.depthFar)),G.near=N.near=C.near=te,G.far=N.far=C.far=Ie,(x!==G.near||F!==G.far)&&(s.updateRenderState({depthNear:G.near,depthFar:G.far}),x=G.near,F=G.far),C.layers.mask=E.layers.mask|2,N.layers.mask=E.layers.mask|4,G.layers.mask=C.layers.mask|N.layers.mask;let re=E.parent,We=G.cameras;ne(G,re);for(let He=0;He<We.length;He++)ne(We[He],re);We.length===2?J(G,C,N):G.projectionMatrix.copy(C.projectionMatrix),de(E,G,re)};function de(E,te,Ie){Ie===null?E.matrix.copy(te.matrixWorld):(E.matrix.copy(Ie.matrixWorld),E.matrix.invert(),E.matrix.multiply(te.matrixWorld)),E.matrix.decompose(E.position,E.quaternion,E.scale),E.updateMatrixWorld(!0),E.projectionMatrix.copy(te.projectionMatrix),E.projectionMatrixInverse.copy(te.projectionMatrixInverse),E.isPerspectiveCamera&&(E.fov=Tr*2*Math.atan(1/E.projectionMatrix.elements[5]),E.zoom=1)}this.getCamera=function(){return G},this.getFoveation=function(){if(!(h===null&&m===null))return a},this.setFoveation=function(E){a=E,h!==null&&(h.fixedFoveation=E),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=E)},this.hasDepthSensing=function(){return g.texture!==null},this.getDepthSensingMesh=function(){return g.getMesh(G)};let fe=null;function ze(E,te){if(d=te.getViewerPose(c||r),f=te,d!==null){let Ie=d.views;m!==null&&(e.setRenderTargetFramebuffer(R,m.framebuffer),e.setRenderTarget(R));let re=!1;Ie.length!==G.cameras.length&&(G.cameras.length=0,re=!0);for(let He=0;He<Ie.length;He++){let De=Ie[He],xt=null;if(m!==null)xt=m.getViewport(De);else{let Mt=u.getViewSubImage(h,De);xt=Mt.viewport,He===0&&(e.setRenderTargetTextures(R,Mt.colorTexture,h.ignoreDepthValues?void 0:Mt.depthStencilTexture),e.setRenderTarget(R))}let nt=X[He];nt===void 0&&(nt=new Jt,nt.layers.enable(He),nt.viewport=new at,X[He]=nt),nt.matrix.fromArray(De.transform.matrix),nt.matrix.decompose(nt.position,nt.quaternion,nt.scale),nt.projectionMatrix.fromArray(De.projectionMatrix),nt.projectionMatrixInverse.copy(nt.projectionMatrix).invert(),nt.viewport.set(xt.x,xt.y,xt.width,xt.height),He===0&&(G.matrix.copy(nt.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale)),re===!0&&G.cameras.push(nt)}let We=s.enabledFeatures;if(We&&We.includes("depth-sensing")){let He=u.getDepthInformation(Ie[0]);He&&He.isValid&&He.texture&&g.init(e,He,s.renderState)}}for(let Ie=0;Ie<V.length;Ie++){let re=I[Ie],We=V[Ie];re!==null&&We!==void 0&&We.update(re,te,c||r)}fe&&fe(E,te),te.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:te}),f=null}let Zt=new NX;Zt.setAnimationLoop(ze),this.setAnimationLoop=function(E){fe=E},this.dispose=function(){}}},oo=new po,jM=new Ye;function OM(n,e){function t(b,p){b.matrixAutoUpdate===!0&&b.updateMatrix(),p.value.copy(b.matrix)}function i(b,p){p.color.getRGB(b.fogColor.value,YX(n)),p.isFog?(b.fogNear.value=p.near,b.fogFar.value=p.far):p.isFogExp2&&(b.fogDensity.value=p.density)}function s(b,p,R,V,I){p.isMeshBasicMaterial||p.isMeshLambertMaterial?o(b,p):p.isMeshToonMaterial?(o(b,p),u(b,p)):p.isMeshPhongMaterial?(o(b,p),d(b,p)):p.isMeshStandardMaterial?(o(b,p),h(b,p),p.isMeshPhysicalMaterial&&m(b,p,I)):p.isMeshMatcapMaterial?(o(b,p),f(b,p)):p.isMeshDepthMaterial?o(b,p):p.isMeshDistanceMaterial?(o(b,p),g(b,p)):p.isMeshNormalMaterial?o(b,p):p.isLineBasicMaterial?(r(b,p),p.isLineDashedMaterial&&l(b,p)):p.isPointsMaterial?a(b,p,R,V):p.isSpriteMaterial?c(b,p):p.isShadowMaterial?(b.color.value.copy(p.color),b.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}function o(b,p){b.opacity.value=p.opacity,p.color&&b.diffuse.value.copy(p.color),p.emissive&&b.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity),p.map&&(b.map.value=p.map,t(p.map,b.mapTransform)),p.alphaMap&&(b.alphaMap.value=p.alphaMap,t(p.alphaMap,b.alphaMapTransform)),p.bumpMap&&(b.bumpMap.value=p.bumpMap,t(p.bumpMap,b.bumpMapTransform),b.bumpScale.value=p.bumpScale,p.side===Zn&&(b.bumpScale.value*=-1)),p.normalMap&&(b.normalMap.value=p.normalMap,t(p.normalMap,b.normalMapTransform),b.normalScale.value.copy(p.normalScale),p.side===Zn&&b.normalScale.value.negate()),p.displacementMap&&(b.displacementMap.value=p.displacementMap,t(p.displacementMap,b.displacementMapTransform),b.displacementScale.value=p.displacementScale,b.displacementBias.value=p.displacementBias),p.emissiveMap&&(b.emissiveMap.value=p.emissiveMap,t(p.emissiveMap,b.emissiveMapTransform)),p.specularMap&&(b.specularMap.value=p.specularMap,t(p.specularMap,b.specularMapTransform)),p.alphaTest>0&&(b.alphaTest.value=p.alphaTest);let R=e.get(p),V=R.envMap,I=R.envMapRotation;V&&(b.envMap.value=V,oo.copy(I),oo.x*=-1,oo.y*=-1,oo.z*=-1,V.isCubeTexture&&V.isRenderTargetTexture===!1&&(oo.y*=-1,oo.z*=-1),b.envMapRotation.value.setFromMatrix4(jM.makeRotationFromEuler(oo)),b.flipEnvMap.value=V.isCubeTexture&&V.isRenderTargetTexture===!1?-1:1,b.reflectivity.value=p.reflectivity,b.ior.value=p.ior,b.refractionRatio.value=p.refractionRatio),p.lightMap&&(b.lightMap.value=p.lightMap,b.lightMapIntensity.value=p.lightMapIntensity,t(p.lightMap,b.lightMapTransform)),p.aoMap&&(b.aoMap.value=p.aoMap,b.aoMapIntensity.value=p.aoMapIntensity,t(p.aoMap,b.aoMapTransform))}function r(b,p){b.diffuse.value.copy(p.color),b.opacity.value=p.opacity,p.map&&(b.map.value=p.map,t(p.map,b.mapTransform))}function l(b,p){b.dashSize.value=p.dashSize,b.totalSize.value=p.dashSize+p.gapSize,b.scale.value=p.scale}function a(b,p,R,V){b.diffuse.value.copy(p.color),b.opacity.value=p.opacity,b.size.value=p.size*R,b.scale.value=V*.5,p.map&&(b.map.value=p.map,t(p.map,b.uvTransform)),p.alphaMap&&(b.alphaMap.value=p.alphaMap,t(p.alphaMap,b.alphaMapTransform)),p.alphaTest>0&&(b.alphaTest.value=p.alphaTest)}function c(b,p){b.diffuse.value.copy(p.color),b.opacity.value=p.opacity,b.rotation.value=p.rotation,p.map&&(b.map.value=p.map,t(p.map,b.mapTransform)),p.alphaMap&&(b.alphaMap.value=p.alphaMap,t(p.alphaMap,b.alphaMapTransform)),p.alphaTest>0&&(b.alphaTest.value=p.alphaTest)}function d(b,p){b.specular.value.copy(p.specular),b.shininess.value=Math.max(p.shininess,1e-4)}function u(b,p){p.gradientMap&&(b.gradientMap.value=p.gradientMap)}function h(b,p){b.metalness.value=p.metalness,p.metalnessMap&&(b.metalnessMap.value=p.metalnessMap,t(p.metalnessMap,b.metalnessMapTransform)),b.roughness.value=p.roughness,p.roughnessMap&&(b.roughnessMap.value=p.roughnessMap,t(p.roughnessMap,b.roughnessMapTransform)),p.envMap&&(b.envMapIntensity.value=p.envMapIntensity)}function m(b,p,R){b.ior.value=p.ior,p.sheen>0&&(b.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),b.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(b.sheenColorMap.value=p.sheenColorMap,t(p.sheenColorMap,b.sheenColorMapTransform)),p.sheenRoughnessMap&&(b.sheenRoughnessMap.value=p.sheenRoughnessMap,t(p.sheenRoughnessMap,b.sheenRoughnessMapTransform))),p.clearcoat>0&&(b.clearcoat.value=p.clearcoat,b.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(b.clearcoatMap.value=p.clearcoatMap,t(p.clearcoatMap,b.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=p.clearcoatRoughnessMap,t(p.clearcoatRoughnessMap,b.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(b.clearcoatNormalMap.value=p.clearcoatNormalMap,t(p.clearcoatNormalMap,b.clearcoatNormalMapTransform),b.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),p.side===Zn&&b.clearcoatNormalScale.value.negate())),p.dispersion>0&&(b.dispersion.value=p.dispersion),p.iridescence>0&&(b.iridescence.value=p.iridescence,b.iridescenceIOR.value=p.iridescenceIOR,b.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],b.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(b.iridescenceMap.value=p.iridescenceMap,t(p.iridescenceMap,b.iridescenceMapTransform)),p.iridescenceThicknessMap&&(b.iridescenceThicknessMap.value=p.iridescenceThicknessMap,t(p.iridescenceThicknessMap,b.iridescenceThicknessMapTransform))),p.transmission>0&&(b.transmission.value=p.transmission,b.transmissionSamplerMap.value=R.texture,b.transmissionSamplerSize.value.set(R.width,R.height),p.transmissionMap&&(b.transmissionMap.value=p.transmissionMap,t(p.transmissionMap,b.transmissionMapTransform)),b.thickness.value=p.thickness,p.thicknessMap&&(b.thicknessMap.value=p.thicknessMap,t(p.thicknessMap,b.thicknessMapTransform)),b.attenuationDistance.value=p.attenuationDistance,b.attenuationColor.value.copy(p.attenuationColor)),p.anisotropy>0&&(b.anisotropyVector.value.set(p.anisotropy*Math.cos(p.anisotropyRotation),p.anisotropy*Math.sin(p.anisotropyRotation)),p.anisotropyMap&&(b.anisotropyMap.value=p.anisotropyMap,t(p.anisotropyMap,b.anisotropyMapTransform))),b.specularIntensity.value=p.specularIntensity,b.specularColor.value.copy(p.specularColor),p.specularColorMap&&(b.specularColorMap.value=p.specularColorMap,t(p.specularColorMap,b.specularColorMapTransform)),p.specularIntensityMap&&(b.specularIntensityMap.value=p.specularIntensityMap,t(p.specularIntensityMap,b.specularIntensityMapTransform))}function f(b,p){p.matcap&&(b.matcap.value=p.matcap)}function g(b,p){let R=e.get(p).light;b.referencePosition.value.setFromMatrixPosition(R.matrixWorld),b.nearDistance.value=R.shadow.camera.near,b.farDistance.value=R.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function QM(n,e,t,i){let s={},o={},r=[],l=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function a(R,V){let I=V.program;i.uniformBlockBinding(R,I)}function c(R,V){let I=s[R.id];I===void 0&&(f(R),I=d(R),s[R.id]=I,R.addEventListener("dispose",b));let w=V.program;i.updateUBOMapping(R,w);let W=e.render.frame;o[R.id]!==W&&(h(R),o[R.id]=W)}function d(R){let V=u();R.__bindingPointIndex=V;let I=n.createBuffer(),w=R.__size,W=R.usage;return n.bindBuffer(n.UNIFORM_BUFFER,I),n.bufferData(n.UNIFORM_BUFFER,w,W),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,V,I),I}function u(){for(let R=0;R<l;R++)if(r.indexOf(R)===-1)return r.push(R),R;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(R){let V=s[R.id],I=R.uniforms,w=R.__cache;n.bindBuffer(n.UNIFORM_BUFFER,V);for(let W=0,C=I.length;W<C;W++){let N=Array.isArray(I[W])?I[W]:[I[W]];for(let X=0,G=N.length;X<G;X++){let x=N[X];if(m(x,W,X,w)===!0){let F=x.__offset,U=Array.isArray(x.value)?x.value:[x.value],z=0;for(let j=0;j<U.length;j++){let B=U[j],Q=g(B);typeof B=="number"||typeof B=="boolean"?(x.__data[0]=B,n.bufferSubData(n.UNIFORM_BUFFER,F+z,x.__data)):B.isMatrix3?(x.__data[0]=B.elements[0],x.__data[1]=B.elements[1],x.__data[2]=B.elements[2],x.__data[3]=0,x.__data[4]=B.elements[3],x.__data[5]=B.elements[4],x.__data[6]=B.elements[5],x.__data[7]=0,x.__data[8]=B.elements[6],x.__data[9]=B.elements[7],x.__data[10]=B.elements[8],x.__data[11]=0):(B.toArray(x.__data,z),z+=Q.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,F,x.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(R,V,I,w){let W=R.value,C=V+"_"+I;if(w[C]===void 0)return typeof W=="number"||typeof W=="boolean"?w[C]=W:w[C]=W.clone(),!0;{let N=w[C];if(typeof W=="number"||typeof W=="boolean"){if(N!==W)return w[C]=W,!0}else if(N.equals(W)===!1)return N.copy(W),!0}return!1}function f(R){let V=R.uniforms,I=0,w=16;for(let C=0,N=V.length;C<N;C++){let X=Array.isArray(V[C])?V[C]:[V[C]];for(let G=0,x=X.length;G<x;G++){let F=X[G],U=Array.isArray(F.value)?F.value:[F.value];for(let z=0,j=U.length;z<j;z++){let B=U[z],Q=g(B),J=I%w,ne=J%Q.boundary,de=J+ne;I+=ne,de!==0&&w-de<Q.storage&&(I+=w-de),F.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),F.__offset=I,I+=Q.storage}}}let W=I%w;return W>0&&(I+=w-W),R.__size=I,R.__cache={},this}function g(R){let V={boundary:0,storage:0};return typeof R=="number"||typeof R=="boolean"?(V.boundary=4,V.storage=4):R.isVector2?(V.boundary=8,V.storage=8):R.isVector3||R.isColor?(V.boundary=16,V.storage=12):R.isVector4?(V.boundary=16,V.storage=16):R.isMatrix3?(V.boundary=48,V.storage=48):R.isMatrix4?(V.boundary=64,V.storage=64):R.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",R),V}function b(R){let V=R.target;V.removeEventListener("dispose",b);let I=r.indexOf(V.__bindingPointIndex);r.splice(I,1),n.deleteBuffer(s[V.id]),delete s[V.id],delete o[V.id]}function p(){for(let R in s)n.deleteBuffer(s[R]);r=[],s={},o={}}return{bind:a,update:c,dispose:p}}var Ud=class{constructor(e={}){let{canvas:t=t5(),context:i=null,depth:s=!0,stencil:o=!1,alpha:r=!1,antialias:l=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:u=!1,reverseDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=r;let f=new Uint32Array(4),g=new Int32Array(4),b=null,p=null,R=[],V=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Kt,this.toneMapping=Ss,this.toneMappingExposure=1;let I=this,w=!1,W=0,C=0,N=null,X=-1,G=null,x=new at,F=new at,U=null,z=new xe(0),j=0,B=t.width,Q=t.height,J=1,ne=null,de=null,fe=new at(0,0,B,Q),ze=new at(0,0,B,Q),Zt=!1,E=new Ol,te=!1,Ie=!1,re=new Ye,We=new Ye,He=new T,De=new at,xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},nt=!1;function Mt(){return N===null?J:1}let Y=i;function Ln(y,L){return t.getContext(y,L)}try{let y={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${_b}`),t.addEventListener("webglcontextlost",_,!1),t.addEventListener("webglcontextrestored",ue,!1),t.addEventListener("webglcontextcreationerror",ae,!1),Y===null){let L="webgl2";if(Y=Ln(L,y),Y===null)throw Ln(L)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(y){throw console.error("THREE.WebGLRenderer: "+y.message),y}let Qe,qe,Re,Vt,Ve,S,Z,H,D,q,P,Ge,le,he,it,$,me,Ce,Me,pe,$e,Fe,Gt,v;function oe(){Qe=new m9(Y),Qe.init(),Fe=new EM(Y,Qe),qe=new l9(Y,Qe,e,Fe),Re=new FM(Y,Qe),qe.reverseDepthBuffer&&h&&Re.buffers.depth.setReversed(!0),Vt=new f9(Y),Ve=new vM,S=new PM(Y,Qe,Re,Ve,qe,Fe,Vt),Z=new c9(I),H=new h9(I),D=new V5(Y),Gt=new o9(Y,D),q=new p9(Y,D,Vt,Gt),P=new Z9(Y,q,D,Vt),Me=new g9(Y,qe,S),$=new a9(Ve),Ge=new xM(I,Z,H,Qe,qe,Gt,$),le=new OM(I,Ve),he=new MM,it=new KM(Qe),Ce=new s9(I,Z,H,Re,P,m,a),me=new JM(I,P,qe),v=new QM(Y,Vt,qe,Re),pe=new r9(Y,Qe,Vt),$e=new b9(Y,Qe,Vt),Vt.programs=Ge.programs,I.capabilities=qe,I.extensions=Qe,I.properties=Ve,I.renderLists=he,I.shadowMap=me,I.state=Re,I.info=Vt}oe();let A=new Nb(I,Y);this.xr=A,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){let y=Qe.get("WEBGL_lose_context");y&&y.loseContext()},this.forceContextRestore=function(){let y=Qe.get("WEBGL_lose_context");y&&y.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(y){y!==void 0&&(J=y,this.setSize(B,Q,!1))},this.getSize=function(y){return y.set(B,Q)},this.setSize=function(y,L,K=!0){if(A.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}B=y,Q=L,t.width=Math.floor(y*J),t.height=Math.floor(L*J),K===!0&&(t.style.width=y+"px",t.style.height=L+"px"),this.setViewport(0,0,y,L)},this.getDrawingBufferSize=function(y){return y.set(B*J,Q*J).floor()},this.setDrawingBufferSize=function(y,L,K){B=y,Q=L,J=K,t.width=Math.floor(y*K),t.height=Math.floor(L*K),this.setViewport(0,0,y,L)},this.getCurrentViewport=function(y){return y.copy(x)},this.getViewport=function(y){return y.copy(fe)},this.setViewport=function(y,L,K,k){y.isVector4?fe.set(y.x,y.y,y.z,y.w):fe.set(y,L,K,k),Re.viewport(x.copy(fe).multiplyScalar(J).round())},this.getScissor=function(y){return y.copy(ze)},this.setScissor=function(y,L,K,k){y.isVector4?ze.set(y.x,y.y,y.z,y.w):ze.set(y,L,K,k),Re.scissor(F.copy(ze).multiplyScalar(J).round())},this.getScissorTest=function(){return Zt},this.setScissorTest=function(y){Re.setScissorTest(Zt=y)},this.setOpaqueSort=function(y){ne=y},this.setTransparentSort=function(y){de=y},this.getClearColor=function(y){return y.copy(Ce.getClearColor())},this.setClearColor=function(){Ce.setClearColor.apply(Ce,arguments)},this.getClearAlpha=function(){return Ce.getClearAlpha()},this.setClearAlpha=function(){Ce.setClearAlpha.apply(Ce,arguments)},this.clear=function(y=!0,L=!0,K=!0){let k=0;if(y){let M=!1;if(N!==null){let ee=N.texture.format;M=ee===nf||ee===tf||ee===ef}if(M){let ee=N.texture.type,ce=ee===_i||ee===ho||ee===zl||ee===xr||ee===Qb||ee===qb,ge=Ce.getClearColor(),Ze=Ce.getClearAlpha(),Te=ge.r,ke=ge.g,ye=ge.b;ce?(f[0]=Te,f[1]=ke,f[2]=ye,f[3]=Ze,Y.clearBufferuiv(Y.COLOR,0,f)):(g[0]=Te,g[1]=ke,g[2]=ye,g[3]=Ze,Y.clearBufferiv(Y.COLOR,0,g))}else k|=Y.COLOR_BUFFER_BIT}L&&(k|=Y.DEPTH_BUFFER_BIT),K&&(k|=Y.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Y.clear(k)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",_,!1),t.removeEventListener("webglcontextrestored",ue,!1),t.removeEventListener("webglcontextcreationerror",ae,!1),he.dispose(),it.dispose(),Ve.dispose(),Z.dispose(),H.dispose(),P.dispose(),Gt.dispose(),v.dispose(),Ge.dispose(),A.dispose(),A.removeEventListener("sessionstart",Df),A.removeEventListener("sessionend",_f),ws.stop()};function _(y){y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function ue(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;let y=Vt.autoReset,L=me.enabled,K=me.autoUpdate,k=me.needsUpdate,M=me.type;oe(),Vt.autoReset=y,me.enabled=L,me.autoUpdate=K,me.needsUpdate=k,me.type=M}function ae(y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",y.statusMessage)}function Ke(y){let L=y.target;L.removeEventListener("dispose",Ke),Lt(L)}function Lt(y){en(y),Ve.remove(y)}function en(y){let L=Ve.get(y).programs;L!==void 0&&(L.forEach(function(K){Ge.releaseProgram(K)}),y.isShaderMaterial&&Ge.releaseShaderCache(y))}this.renderBufferDirect=function(y,L,K,k,M,ee){L===null&&(L=xt);let ce=M.isMesh&&M.matrixWorld.determinant()<0,ge=_X(y,L,K,k,M);Re.setMaterial(k,ce);let Ze=K.index,Te=1;if(k.wireframe===!0){if(Ze=q.getWireframeAttribute(K),Ze===void 0)return;Te=2}let ke=K.drawRange,ye=K.attributes.position,ot=ke.start*Te,Xt=(ke.start+ke.count)*Te;ee!==null&&(ot=Math.max(ot,ee.start*Te),Xt=Math.min(Xt,(ee.start+ee.count)*Te)),Ze!==null?(ot=Math.max(ot,0),Xt=Math.min(Xt,Ze.count)):ye!=null&&(ot=Math.max(ot,0),Xt=Math.min(Xt,ye.count));let Rt=Xt-ot;if(Rt<0||Rt===1/0)return;Gt.setup(M,k,ge,K,Ze);let mn,ct=pe;if(Ze!==null&&(mn=D.get(Ze),ct=$e,ct.setIndex(mn)),M.isMesh)k.wireframe===!0?(Re.setLineWidth(k.wireframeLinewidth*Mt()),ct.setMode(Y.LINES)):ct.setMode(Y.TRIANGLES);else if(M.isLine){let Xe=k.linewidth;Xe===void 0&&(Xe=1),Re.setLineWidth(Xe*Mt()),M.isLineSegments?ct.setMode(Y.LINES):M.isLineLoop?ct.setMode(Y.LINE_LOOP):ct.setMode(Y.LINE_STRIP)}else M.isPoints?ct.setMode(Y.POINTS):M.isSprite&&ct.setMode(Y.TRIANGLES);if(M.isBatchedMesh)if(M._multiDrawInstances!==null)ct.renderMultiDrawInstances(M._multiDrawStarts,M._multiDrawCounts,M._multiDrawCount,M._multiDrawInstances);else if(Qe.get("WEBGL_multi_draw"))ct.renderMultiDraw(M._multiDrawStarts,M._multiDrawCounts,M._multiDrawCount);else{let Xe=M._multiDrawStarts,Wi=M._multiDrawCounts,dt=M._multiDrawCount,_n=Ze?D.get(Ze).bytesPerElement:1,Io=Ve.get(k).currentProgram.getUniforms();for(let In=0;In<dt;In++)Io.setValue(Y,"_gl_DrawID",In),ct.render(Xe[In]/_n,Wi[In])}else if(M.isInstancedMesh)ct.renderInstances(ot,Rt,M.count);else if(K.isInstancedBufferGeometry){let Xe=K._maxInstanceCount!==void 0?K._maxInstanceCount:1/0,Wi=Math.min(K.instanceCount,Xe);ct.renderInstances(ot,Rt,Wi)}else ct.render(ot,Rt)};function ht(y,L,K){y.transparent===!0&&y.side===li&&y.forceSinglePass===!1?(y.side=Zn,y.needsUpdate=!0,ca(y,L,K),y.side=Vi,y.needsUpdate=!0,ca(y,L,K),y.side=li):ca(y,L,K)}this.compile=function(y,L,K=null){K===null&&(K=y),p=it.get(K),p.init(L),V.push(p),K.traverseVisible(function(M){M.isLight&&M.layers.test(L.layers)&&(p.pushLight(M),M.castShadow&&p.pushShadow(M))}),y!==K&&y.traverseVisible(function(M){M.isLight&&M.layers.test(L.layers)&&(p.pushLight(M),M.castShadow&&p.pushShadow(M))}),p.setupLights();let k=new Set;return y.traverse(function(M){if(!(M.isMesh||M.isPoints||M.isLine||M.isSprite))return;let ee=M.material;if(ee)if(Array.isArray(ee))for(let ce=0;ce<ee.length;ce++){let ge=ee[ce];ht(ge,K,M),k.add(ge)}else ht(ee,K,M),k.add(ee)}),V.pop(),p=null,k},this.compileAsync=function(y,L,K=null){let k=this.compile(y,L,K);return new Promise(M=>{function ee(){if(k.forEach(function(ce){Ve.get(ce).currentProgram.isReady()&&k.delete(ce)}),k.size===0){M(y);return}setTimeout(ee,10)}Qe.get("KHR_parallel_shader_compile")!==null?ee():setTimeout(ee,10)})};let Dn=null;function Ci(y){Dn&&Dn(y)}function Df(){ws.stop()}function _f(){ws.start()}let ws=new NX;ws.setAnimationLoop(Ci),typeof self<"u"&&ws.setContext(self),this.setAnimationLoop=function(y){Dn=y,A.setAnimationLoop(y),y===null?ws.stop():ws.start()},A.addEventListener("sessionstart",Df),A.addEventListener("sessionend",_f),this.render=function(y,L){if(L!==void 0&&L.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(w===!0)return;if(y.matrixWorldAutoUpdate===!0&&y.updateMatrixWorld(),L.parent===null&&L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),A.enabled===!0&&A.isPresenting===!0&&(A.cameraAutoUpdate===!0&&A.updateCamera(L),L=A.getCamera()),y.isScene===!0&&y.onBeforeRender(I,y,L,N),p=it.get(y,V.length),p.init(L),V.push(p),We.multiplyMatrices(L.projectionMatrix,L.matrixWorldInverse),E.setFromProjectionMatrix(We),Ie=this.localClippingEnabled,te=$.init(this.clippingPlanes,Ie),b=he.get(y,R.length),b.init(),R.push(b),A.enabled===!0&&A.isPresenting===!0){let ee=I.xr.getDepthSensingMesh();ee!==null&&Vu(ee,L,-1/0,I.sortObjects)}Vu(y,L,0,I.sortObjects),b.finish(),I.sortObjects===!0&&b.sort(ne,de),nt=A.enabled===!1||A.isPresenting===!1||A.hasDepthSensing()===!1,nt&&Ce.addToRenderList(b,y),this.info.render.frame++,te===!0&&$.beginShadows();let K=p.state.shadowsArray;me.render(K,y,L),te===!0&&$.endShadows(),this.info.autoReset===!0&&this.info.reset();let k=b.opaque,M=b.transmissive;if(p.setupLights(),L.isArrayCamera){let ee=L.cameras;if(M.length>0)for(let ce=0,ge=ee.length;ce<ge;ce++){let Ze=ee[ce];Of(k,M,y,Ze)}nt&&Ce.render(y);for(let ce=0,ge=ee.length;ce<ge;ce++){let Ze=ee[ce];jf(b,y,Ze,Ze.viewport)}}else M.length>0&&Of(k,M,y,L),nt&&Ce.render(y),jf(b,y,L);N!==null&&(S.updateMultisampleRenderTarget(N),S.updateRenderTargetMipmap(N)),y.isScene===!0&&y.onAfterRender(I,y,L),Gt.resetDefaultState(),X=-1,G=null,V.pop(),V.length>0?(p=V[V.length-1],te===!0&&$.setGlobalState(I.clippingPlanes,p.state.camera)):p=null,R.pop(),R.length>0?b=R[R.length-1]:b=null};function Vu(y,L,K,k){if(y.visible===!1)return;if(y.layers.test(L.layers)){if(y.isGroup)K=y.renderOrder;else if(y.isLOD)y.autoUpdate===!0&&y.update(L);else if(y.isLight)p.pushLight(y),y.castShadow&&p.pushShadow(y);else if(y.isSprite){if(!y.frustumCulled||E.intersectsSprite(y)){k&&De.setFromMatrixPosition(y.matrixWorld).applyMatrix4(We);let ce=P.update(y),ge=y.material;ge.visible&&b.push(y,ce,ge,K,De.z,null)}}else if((y.isMesh||y.isLine||y.isPoints)&&(!y.frustumCulled||E.intersectsObject(y))){let ce=P.update(y),ge=y.material;if(k&&(y.boundingSphere!==void 0?(y.boundingSphere===null&&y.computeBoundingSphere(),De.copy(y.boundingSphere.center)):(ce.boundingSphere===null&&ce.computeBoundingSphere(),De.copy(ce.boundingSphere.center)),De.applyMatrix4(y.matrixWorld).applyMatrix4(We)),Array.isArray(ge)){let Ze=ce.groups;for(let Te=0,ke=Ze.length;Te<ke;Te++){let ye=Ze[Te],ot=ge[ye.materialIndex];ot&&ot.visible&&b.push(y,ce,ot,K,De.z,ye)}}else ge.visible&&b.push(y,ce,ge,K,De.z,null)}}let ee=y.children;for(let ce=0,ge=ee.length;ce<ge;ce++)Vu(ee[ce],L,K,k)}function jf(y,L,K,k){let M=y.opaque,ee=y.transmissive,ce=y.transparent;p.setupLightsView(K),te===!0&&$.setGlobalState(I.clippingPlanes,K),k&&Re.viewport(x.copy(k)),M.length>0&&aa(M,L,K),ee.length>0&&aa(ee,L,K),ce.length>0&&aa(ce,L,K),Re.buffers.depth.setTest(!0),Re.buffers.depth.setMask(!0),Re.buffers.color.setMask(!0),Re.setPolygonOffset(!1)}function Of(y,L,K,k){if((K.isScene===!0?K.overrideMaterial:null)!==null)return;p.state.transmissionRenderTarget[k.id]===void 0&&(p.state.transmissionRenderTarget[k.id]=new ji(1,1,{generateMipmaps:!0,type:Qe.has("EXT_color_buffer_half_float")||Qe.has("EXT_color_buffer_float")?sa:_i,minFilter:Gi,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:je.workingColorSpace}));let ee=p.state.transmissionRenderTarget[k.id],ce=k.viewport||x;ee.setSize(ce.z,ce.w);let ge=I.getRenderTarget();I.setRenderTarget(ee),I.getClearColor(z),j=I.getClearAlpha(),j<1&&I.setClearColor(16777215,.5),I.clear(),nt&&Ce.render(K);let Ze=I.toneMapping;I.toneMapping=Ss;let Te=k.viewport;if(k.viewport!==void 0&&(k.viewport=void 0),p.setupLightsView(k),te===!0&&$.setGlobalState(I.clippingPlanes,k),aa(y,K,k),S.updateMultisampleRenderTarget(ee),S.updateRenderTargetMipmap(ee),Qe.has("WEBGL_multisampled_render_to_texture")===!1){let ke=!1;for(let ye=0,ot=L.length;ye<ot;ye++){let Xt=L[ye],Rt=Xt.object,mn=Xt.geometry,ct=Xt.material,Xe=Xt.group;if(ct.side===li&&Rt.layers.test(k.layers)){let Wi=ct.side;ct.side=Zn,ct.needsUpdate=!0,Qf(Rt,K,k,mn,ct,Xe),ct.side=Wi,ct.needsUpdate=!0,ke=!0}}ke===!0&&(S.updateMultisampleRenderTarget(ee),S.updateRenderTargetMipmap(ee))}I.setRenderTarget(ge),I.setClearColor(z,j),Te!==void 0&&(k.viewport=Te),I.toneMapping=Ze}function aa(y,L,K){let k=L.isScene===!0?L.overrideMaterial:null;for(let M=0,ee=y.length;M<ee;M++){let ce=y[M],ge=ce.object,Ze=ce.geometry,Te=k===null?ce.material:k,ke=ce.group;ge.layers.test(K.layers)&&Qf(ge,L,K,Ze,Te,ke)}}function Qf(y,L,K,k,M,ee){y.onBeforeRender(I,L,K,k,M,ee),y.modelViewMatrix.multiplyMatrices(K.matrixWorldInverse,y.matrixWorld),y.normalMatrix.getNormalMatrix(y.modelViewMatrix),M.onBeforeRender(I,L,K,k,y,ee),M.transparent===!0&&M.side===li&&M.forceSinglePass===!1?(M.side=Zn,M.needsUpdate=!0,I.renderBufferDirect(K,L,k,M,y,ee),M.side=Vi,M.needsUpdate=!0,I.renderBufferDirect(K,L,k,M,y,ee),M.side=li):I.renderBufferDirect(K,L,k,M,y,ee),y.onAfterRender(I,L,K,k,M,ee)}function ca(y,L,K){L.isScene!==!0&&(L=xt);let k=Ve.get(y),M=p.state.lights,ee=p.state.shadowsArray,ce=M.state.version,ge=Ge.getParameters(y,M.state,ee,L,K),Ze=Ge.getProgramCacheKey(ge),Te=k.programs;k.environment=y.isMeshStandardMaterial?L.environment:null,k.fog=L.fog,k.envMap=(y.isMeshStandardMaterial?H:Z).get(y.envMap||k.environment),k.envMapRotation=k.environment!==null&&y.envMap===null?L.environmentRotation:y.envMapRotation,Te===void 0&&(y.addEventListener("dispose",Ke),Te=new Map,k.programs=Te);let ke=Te.get(Ze);if(ke!==void 0){if(k.currentProgram===ke&&k.lightsStateVersion===ce)return $f(y,ge),ke}else ge.uniforms=Ge.getUniforms(y),y.onBeforeCompile(ge,I),ke=Ge.acquireProgram(ge,Ze),Te.set(Ze,ke),k.uniforms=ge.uniforms;let ye=k.uniforms;return(!y.isShaderMaterial&&!y.isRawShaderMaterial||y.clipping===!0)&&(ye.clippingPlanes=$.uniform),$f(y,ge),k.needsLights=OX(y),k.lightsStateVersion=ce,k.needsLights&&(ye.ambientLightColor.value=M.state.ambient,ye.lightProbe.value=M.state.probe,ye.directionalLights.value=M.state.directional,ye.directionalLightShadows.value=M.state.directionalShadow,ye.spotLights.value=M.state.spot,ye.spotLightShadows.value=M.state.spotShadow,ye.rectAreaLights.value=M.state.rectArea,ye.ltc_1.value=M.state.rectAreaLTC1,ye.ltc_2.value=M.state.rectAreaLTC2,ye.pointLights.value=M.state.point,ye.pointLightShadows.value=M.state.pointShadow,ye.hemisphereLights.value=M.state.hemi,ye.directionalShadowMap.value=M.state.directionalShadowMap,ye.directionalShadowMatrix.value=M.state.directionalShadowMatrix,ye.spotShadowMap.value=M.state.spotShadowMap,ye.spotLightMatrix.value=M.state.spotLightMatrix,ye.spotLightMap.value=M.state.spotLightMap,ye.pointShadowMap.value=M.state.pointShadowMap,ye.pointShadowMatrix.value=M.state.pointShadowMatrix),k.currentProgram=ke,k.uniformsList=null,ke}function qf(y){if(y.uniformsList===null){let L=y.currentProgram.getUniforms();y.uniformsList=Rr.seqWithValue(L.seq,y.uniforms)}return y.uniformsList}function $f(y,L){let K=Ve.get(y);K.outputColorSpace=L.outputColorSpace,K.batching=L.batching,K.batchingColor=L.batchingColor,K.instancing=L.instancing,K.instancingColor=L.instancingColor,K.instancingMorph=L.instancingMorph,K.skinning=L.skinning,K.morphTargets=L.morphTargets,K.morphNormals=L.morphNormals,K.morphColors=L.morphColors,K.morphTargetsCount=L.morphTargetsCount,K.numClippingPlanes=L.numClippingPlanes,K.numIntersection=L.numClipIntersection,K.vertexAlphas=L.vertexAlphas,K.vertexTangents=L.vertexTangents,K.toneMapping=L.toneMapping}function _X(y,L,K,k,M){L.isScene!==!0&&(L=xt),S.resetTextureUnits();let ee=L.fog,ce=k.isMeshStandardMaterial?L.environment:null,ge=N===null?I.outputColorSpace:N.isXRRenderTarget===!0?N.texture.colorSpace:an,Ze=(k.isMeshStandardMaterial?H:Z).get(k.envMap||ce),Te=k.vertexColors===!0&&!!K.attributes.color&&K.attributes.color.itemSize===4,ke=!!K.attributes.tangent&&(!!k.normalMap||k.anisotropy>0),ye=!!K.morphAttributes.position,ot=!!K.morphAttributes.normal,Xt=!!K.morphAttributes.color,Rt=Ss;k.toneMapped&&(N===null||N.isXRRenderTarget===!0)&&(Rt=I.toneMapping);let mn=K.morphAttributes.position||K.morphAttributes.normal||K.morphAttributes.color,ct=mn!==void 0?mn.length:0,Xe=Ve.get(k),Wi=p.state.lights;if(te===!0&&(Ie===!0||y!==G)){let Mn=y===G&&k.id===X;$.setState(k,y,Mn)}let dt=!1;k.version===Xe.__version?(Xe.needsLights&&Xe.lightsStateVersion!==Wi.state.version||Xe.outputColorSpace!==ge||M.isBatchedMesh&&Xe.batching===!1||!M.isBatchedMesh&&Xe.batching===!0||M.isBatchedMesh&&Xe.batchingColor===!0&&M.colorTexture===null||M.isBatchedMesh&&Xe.batchingColor===!1&&M.colorTexture!==null||M.isInstancedMesh&&Xe.instancing===!1||!M.isInstancedMesh&&Xe.instancing===!0||M.isSkinnedMesh&&Xe.skinning===!1||!M.isSkinnedMesh&&Xe.skinning===!0||M.isInstancedMesh&&Xe.instancingColor===!0&&M.instanceColor===null||M.isInstancedMesh&&Xe.instancingColor===!1&&M.instanceColor!==null||M.isInstancedMesh&&Xe.instancingMorph===!0&&M.morphTexture===null||M.isInstancedMesh&&Xe.instancingMorph===!1&&M.morphTexture!==null||Xe.envMap!==Ze||k.fog===!0&&Xe.fog!==ee||Xe.numClippingPlanes!==void 0&&(Xe.numClippingPlanes!==$.numPlanes||Xe.numIntersection!==$.numIntersection)||Xe.vertexAlphas!==Te||Xe.vertexTangents!==ke||Xe.morphTargets!==ye||Xe.morphNormals!==ot||Xe.morphColors!==Xt||Xe.toneMapping!==Rt||Xe.morphTargetsCount!==ct)&&(dt=!0):(dt=!0,Xe.__version=k.version);let _n=Xe.currentProgram;dt===!0&&(_n=ca(k,L,M));let Io=!1,In=!1,Fr=!1,St=_n.getUniforms(),mi=Xe.uniforms;if(Re.useProgram(_n.program)&&(Io=!0,In=!0,Fr=!0),k.id!==X&&(X=k.id,In=!0),Io||G!==y){Re.buffers.depth.getReversed()?(re.copy(y.projectionMatrix),i5(re),s5(re),St.setValue(Y,"projectionMatrix",re)):St.setValue(Y,"projectionMatrix",y.projectionMatrix),St.setValue(Y,"viewMatrix",y.matrixWorldInverse);let ts=St.map.cameraPosition;ts!==void 0&&ts.setValue(Y,He.setFromMatrixPosition(y.matrixWorld)),qe.logarithmicDepthBuffer&&St.setValue(Y,"logDepthBufFC",2/(Math.log(y.far+1)/Math.LN2)),(k.isMeshPhongMaterial||k.isMeshToonMaterial||k.isMeshLambertMaterial||k.isMeshBasicMaterial||k.isMeshStandardMaterial||k.isShaderMaterial)&&St.setValue(Y,"isOrthographic",y.isOrthographicCamera===!0),G!==y&&(G=y,In=!0,Fr=!0)}if(M.isSkinnedMesh){St.setOptional(Y,M,"bindMatrix"),St.setOptional(Y,M,"bindMatrixInverse");let Mn=M.skeleton;Mn&&(Mn.boneTexture===null&&Mn.computeBoneTexture(),St.setValue(Y,"boneTexture",Mn.boneTexture,S))}M.isBatchedMesh&&(St.setOptional(Y,M,"batchingTexture"),St.setValue(Y,"batchingTexture",M._matricesTexture,S),St.setOptional(Y,M,"batchingIdTexture"),St.setValue(Y,"batchingIdTexture",M._indirectTexture,S),St.setOptional(Y,M,"batchingColorTexture"),M._colorsTexture!==null&&St.setValue(Y,"batchingColorTexture",M._colorsTexture,S));let Br=K.morphAttributes;if((Br.position!==void 0||Br.normal!==void 0||Br.color!==void 0)&&Me.update(M,K,_n),(In||Xe.receiveShadow!==M.receiveShadow)&&(Xe.receiveShadow=M.receiveShadow,St.setValue(Y,"receiveShadow",M.receiveShadow)),k.isMeshGouraudMaterial&&k.envMap!==null&&(mi.envMap.value=Ze,mi.flipEnvMap.value=Ze.isCubeTexture&&Ze.isRenderTargetTexture===!1?-1:1),k.isMeshStandardMaterial&&k.envMap===null&&L.environment!==null&&(mi.envMapIntensity.value=L.environmentIntensity),In&&(St.setValue(Y,"toneMappingExposure",I.toneMappingExposure),Xe.needsLights&&jX(mi,Fr),ee&&k.fog===!0&&le.refreshFogUniforms(mi,ee),le.refreshMaterialUniforms(mi,k,J,Q,p.state.transmissionRenderTarget[y.id]),Rr.upload(Y,qf(Xe),mi,S)),k.isShaderMaterial&&k.uniformsNeedUpdate===!0&&(Rr.upload(Y,qf(Xe),mi,S),k.uniformsNeedUpdate=!1),k.isSpriteMaterial&&St.setValue(Y,"center",M.center),St.setValue(Y,"modelViewMatrix",M.modelViewMatrix),St.setValue(Y,"normalMatrix",M.normalMatrix),St.setValue(Y,"modelMatrix",M.matrixWorld),k.isShaderMaterial||k.isRawShaderMaterial){let Mn=k.uniformsGroups;for(let ts=0,ns=Mn.length;ts<ns;ts++){let eg=Mn[ts];v.update(eg,_n),v.bind(eg,_n)}}return _n}function jX(y,L){y.ambientLightColor.needsUpdate=L,y.lightProbe.needsUpdate=L,y.directionalLights.needsUpdate=L,y.directionalLightShadows.needsUpdate=L,y.pointLights.needsUpdate=L,y.pointLightShadows.needsUpdate=L,y.spotLights.needsUpdate=L,y.spotLightShadows.needsUpdate=L,y.rectAreaLights.needsUpdate=L,y.hemisphereLights.needsUpdate=L}function OX(y){return y.isMeshLambertMaterial||y.isMeshToonMaterial||y.isMeshPhongMaterial||y.isMeshStandardMaterial||y.isShadowMaterial||y.isShaderMaterial&&y.lights===!0}this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(y,L,K){Ve.get(y.texture).__webglTexture=L,Ve.get(y.depthTexture).__webglTexture=K;let k=Ve.get(y);k.__hasExternalTextures=!0,k.__autoAllocateDepthBuffer=K===void 0,k.__autoAllocateDepthBuffer||Qe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),k.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(y,L){let K=Ve.get(y);K.__webglFramebuffer=L,K.__useDefaultFramebuffer=L===void 0},this.setRenderTarget=function(y,L=0,K=0){N=y,W=L,C=K;let k=!0,M=null,ee=!1,ce=!1;if(y){let Ze=Ve.get(y);if(Ze.__useDefaultFramebuffer!==void 0)Re.bindFramebuffer(Y.FRAMEBUFFER,null),k=!1;else if(Ze.__webglFramebuffer===void 0)S.setupRenderTarget(y);else if(Ze.__hasExternalTextures)S.rebindTextures(y,Ve.get(y.texture).__webglTexture,Ve.get(y.depthTexture).__webglTexture);else if(y.depthBuffer){let ye=y.depthTexture;if(Ze.__boundDepthTexture!==ye){if(ye!==null&&Ve.has(ye)&&(y.width!==ye.image.width||y.height!==ye.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");S.setupDepthRenderbuffer(y)}}let Te=y.texture;(Te.isData3DTexture||Te.isDataArrayTexture||Te.isCompressedArrayTexture)&&(ce=!0);let ke=Ve.get(y).__webglFramebuffer;y.isWebGLCubeRenderTarget?(Array.isArray(ke[L])?M=ke[L][K]:M=ke[L],ee=!0):y.samples>0&&S.useMultisampledRTT(y)===!1?M=Ve.get(y).__webglMultisampledFramebuffer:Array.isArray(ke)?M=ke[K]:M=ke,x.copy(y.viewport),F.copy(y.scissor),U=y.scissorTest}else x.copy(fe).multiplyScalar(J).floor(),F.copy(ze).multiplyScalar(J).floor(),U=Zt;if(Re.bindFramebuffer(Y.FRAMEBUFFER,M)&&k&&Re.drawBuffers(y,M),Re.viewport(x),Re.scissor(F),Re.setScissorTest(U),ee){let Ze=Ve.get(y.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+L,Ze.__webglTexture,K)}else if(ce){let Ze=Ve.get(y.texture),Te=L||0;Y.framebufferTextureLayer(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Ze.__webglTexture,K||0,Te)}X=-1},this.readRenderTargetPixels=function(y,L,K,k,M,ee,ce){if(!(y&&y.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ge=Ve.get(y).__webglFramebuffer;if(y.isWebGLCubeRenderTarget&&ce!==void 0&&(ge=ge[ce]),ge){Re.bindFramebuffer(Y.FRAMEBUFFER,ge);try{let Ze=y.texture,Te=Ze.format,ke=Ze.type;if(!qe.textureFormatReadable(Te)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!qe.textureTypeReadable(ke)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}L>=0&&L<=y.width-k&&K>=0&&K<=y.height-M&&Y.readPixels(L,K,k,M,Fe.convert(Te),Fe.convert(ke),ee)}finally{let Ze=N!==null?Ve.get(N).__webglFramebuffer:null;Re.bindFramebuffer(Y.FRAMEBUFFER,Ze)}}},this.readRenderTargetPixelsAsync=function(y,L,K,k,M,ee,ce){return lt(this,null,function*(){if(!(y&&y.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ge=Ve.get(y).__webglFramebuffer;if(y.isWebGLCubeRenderTarget&&ce!==void 0&&(ge=ge[ce]),ge){let Ze=y.texture,Te=Ze.format,ke=Ze.type;if(!qe.textureFormatReadable(Te))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!qe.textureTypeReadable(ke))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(L>=0&&L<=y.width-k&&K>=0&&K<=y.height-M){Re.bindFramebuffer(Y.FRAMEBUFFER,ge);let ye=Y.createBuffer();Y.bindBuffer(Y.PIXEL_PACK_BUFFER,ye),Y.bufferData(Y.PIXEL_PACK_BUFFER,ee.byteLength,Y.STREAM_READ),Y.readPixels(L,K,k,M,Fe.convert(Te),Fe.convert(ke),0);let ot=N!==null?Ve.get(N).__webglFramebuffer:null;Re.bindFramebuffer(Y.FRAMEBUFFER,ot);let Xt=Y.fenceSync(Y.SYNC_GPU_COMMANDS_COMPLETE,0);return Y.flush(),yield n5(Y,Xt,4),Y.bindBuffer(Y.PIXEL_PACK_BUFFER,ye),Y.getBufferSubData(Y.PIXEL_PACK_BUFFER,0,ee),Y.deleteBuffer(ye),Y.deleteSync(Xt),ee}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}})},this.copyFramebufferToTexture=function(y,L=null,K=0){y.isTexture!==!0&&(Ul("WebGLRenderer: copyFramebufferToTexture function signature has changed."),L=arguments[0]||null,y=arguments[1]);let k=Math.pow(2,-K),M=Math.floor(y.image.width*k),ee=Math.floor(y.image.height*k),ce=L!==null?L.x:0,ge=L!==null?L.y:0;S.setTexture2D(y,0),Y.copyTexSubImage2D(Y.TEXTURE_2D,K,0,0,ce,ge,M,ee),Re.unbindTexture()},this.copyTextureToTexture=function(y,L,K=null,k=null,M=0){y.isTexture!==!0&&(Ul("WebGLRenderer: copyTextureToTexture function signature has changed."),k=arguments[0]||null,y=arguments[1],L=arguments[2],M=arguments[3]||0,K=null);let ee,ce,ge,Ze,Te,ke,ye,ot,Xt,Rt=y.isCompressedTexture?y.mipmaps[M]:y.image;K!==null?(ee=K.max.x-K.min.x,ce=K.max.y-K.min.y,ge=K.isBox3?K.max.z-K.min.z:1,Ze=K.min.x,Te=K.min.y,ke=K.isBox3?K.min.z:0):(ee=Rt.width,ce=Rt.height,ge=Rt.depth||1,Ze=0,Te=0,ke=0),k!==null?(ye=k.x,ot=k.y,Xt=k.z):(ye=0,ot=0,Xt=0);let mn=Fe.convert(L.format),ct=Fe.convert(L.type),Xe;L.isData3DTexture?(S.setTexture3D(L,0),Xe=Y.TEXTURE_3D):L.isDataArrayTexture||L.isCompressedArrayTexture?(S.setTexture2DArray(L,0),Xe=Y.TEXTURE_2D_ARRAY):(S.setTexture2D(L,0),Xe=Y.TEXTURE_2D),Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,L.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,L.unpackAlignment);let Wi=Y.getParameter(Y.UNPACK_ROW_LENGTH),dt=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),_n=Y.getParameter(Y.UNPACK_SKIP_PIXELS),Io=Y.getParameter(Y.UNPACK_SKIP_ROWS),In=Y.getParameter(Y.UNPACK_SKIP_IMAGES);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,Rt.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,Rt.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,Ze),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Te),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,ke);let Fr=y.isDataArrayTexture||y.isData3DTexture,St=L.isDataArrayTexture||L.isData3DTexture;if(y.isRenderTargetTexture||y.isDepthTexture){let mi=Ve.get(y),Br=Ve.get(L),Mn=Ve.get(mi.__renderTarget),ts=Ve.get(Br.__renderTarget);Re.bindFramebuffer(Y.READ_FRAMEBUFFER,Mn.__webglFramebuffer),Re.bindFramebuffer(Y.DRAW_FRAMEBUFFER,ts.__webglFramebuffer);for(let ns=0;ns<ge;ns++)Fr&&Y.framebufferTextureLayer(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Ve.get(y).__webglTexture,M,ke+ns),y.isDepthTexture?(St&&Y.framebufferTextureLayer(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Ve.get(L).__webglTexture,M,Xt+ns),Y.blitFramebuffer(Ze,Te,ee,ce,ye,ot,ee,ce,Y.DEPTH_BUFFER_BIT,Y.NEAREST)):St?Y.copyTexSubImage3D(Xe,M,ye,ot,Xt+ns,Ze,Te,ee,ce):Y.copyTexSubImage2D(Xe,M,ye,ot,Xt+ns,Ze,Te,ee,ce);Re.bindFramebuffer(Y.READ_FRAMEBUFFER,null),Re.bindFramebuffer(Y.DRAW_FRAMEBUFFER,null)}else St?y.isDataTexture||y.isData3DTexture?Y.texSubImage3D(Xe,M,ye,ot,Xt,ee,ce,ge,mn,ct,Rt.data):L.isCompressedArrayTexture?Y.compressedTexSubImage3D(Xe,M,ye,ot,Xt,ee,ce,ge,mn,Rt.data):Y.texSubImage3D(Xe,M,ye,ot,Xt,ee,ce,ge,mn,ct,Rt):y.isDataTexture?Y.texSubImage2D(Y.TEXTURE_2D,M,ye,ot,ee,ce,mn,ct,Rt.data):y.isCompressedTexture?Y.compressedTexSubImage2D(Y.TEXTURE_2D,M,ye,ot,Rt.width,Rt.height,mn,Rt.data):Y.texSubImage2D(Y.TEXTURE_2D,M,ye,ot,ee,ce,mn,ct,Rt);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,Wi),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,dt),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,_n),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Io),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,In),M===0&&L.generateMipmaps&&Y.generateMipmap(Xe),Re.unbindTexture()},this.copyTextureToTexture3D=function(y,L,K=null,k=null,M=0){return y.isTexture!==!0&&(Ul("WebGLRenderer: copyTextureToTexture3D function signature has changed."),K=arguments[0]||null,k=arguments[1]||null,y=arguments[2],L=arguments[3],M=arguments[4]||0),Ul('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(y,L,K,k,M)},this.initRenderTarget=function(y){Ve.get(y).__webglFramebuffer===void 0&&S.setupRenderTarget(y)},this.initTexture=function(y){y.isCubeTexture?S.setTextureCube(y,0):y.isData3DTexture?S.setTexture3D(y,0):y.isDataArrayTexture||y.isCompressedArrayTexture?S.setTexture2DArray(y,0):S.setTexture2D(y,0),Re.unbindTexture()},this.resetState=function(){W=0,C=0,N=null,Re.reset(),Gt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return zi}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=je._getDrawingBufferColorSpace(e),t.unpackColorSpace=je._getUnpackColorSpace()}};var Jd=class extends _t{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new po,this.environmentIntensity=1,this.environmentRotation=new po,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},Ql=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Zb,this.updateRanges=[],this.version=0,this.uuid=di()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=di()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=di()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},dn=new T,ql=class n{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)dn.fromBufferAttribute(this,t),dn.applyMatrix4(e),this.setXYZ(t,dn.x,dn.y,dn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)dn.fromBufferAttribute(this,t),dn.applyNormalMatrix(e),this.setXYZ(t,dn.x,dn.y,dn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)dn.fromBufferAttribute(this,t),dn.transformDirection(e),this.setXYZ(t,dn.x,dn.y,dn.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=ai(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=pt(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=pt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=pt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=pt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=pt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ai(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ai(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ai(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ai(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array),s=pt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=pt(t,this.array),i=pt(i,this.array),s=pt(s,this.array),o=pt(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return new At(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new n(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};var jG=new T,OG=new at,QG=new at,qM=new T,qG=new Ye,gd=new T,Lp=new Wn,$G=new Ye,Mp=new mo,Ad=class extends rn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=QI,this.bindMatrix=new Ye,this.bindMatrixInverse=new Ye,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new An),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,gd),this.boundingBox.expandByPoint(gd)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Wn),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,gd),this.boundingSphere.expandByPoint(gd)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Lp.copy(this.boundingSphere),Lp.applyMatrix4(s),e.ray.intersectsSphere(Lp)!==!1&&($G.copy(s).invert(),Mp.copy(e.ray).applyMatrix4($G),!(this.boundingBox!==null&&Mp.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Mp)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new at,t=this.geometry.attributes.skinWeight;for(let i=0,s=t.count;i<s;i++){e.fromBufferAttribute(t,i);let o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===QI?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===W2?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let i=this.skeleton,s=this.geometry;OG.fromBufferAttribute(s.attributes.skinIndex,e),QG.fromBufferAttribute(s.attributes.skinWeight,e),jG.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){let r=QG.getComponent(o);if(r!==0){let l=OG.getComponent(o);qG.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),t.addScaledVector(qM.copy(jG).applyMatrix4(qG),r)}}return t.applyMatrix4(this.bindMatrixInverse)}},$l=class extends _t{constructor(){super(),this.isBone=!0,this.type="Bone"}},Fd=class extends Pn{constructor(e=null,t=1,i=1,s,o,r,l,a,c=ln,d=ln,u,h){super(null,r,l,a,c,d,s,o,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},eX=new Ye,$M=new Ye,Bd=class n{constructor(e=[],t=[]){this.uuid=di(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new Ye)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new Ye;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let o=0,r=e.length;o<r;o++){let l=e[o]?e[o].matrixWorld:$M;eX.multiplyMatrices(l,t[o]),eX.toArray(i,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new n(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new Fd(t,e,e,Un,ci);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){let o=e.bones[i],r=t[o];r===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),r=new $l),this.bones.push(r),this.boneInverses.push(new Ye().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let s=0,o=t.length;s<o;s++){let r=t[s];e.bones.push(r.uuid);let l=i[s];e.boneInverses.push(l.toArray())}return e}},bo=class extends At{constructor(e,t,i,s=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Zr=new Ye,tX=new Ye,Zd=[],nX=new An,eT=new Ye,wl=new rn,Hl=new Wn,Pd=class extends rn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new bo(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,eT)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new An),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Zr),nX.copy(e.boundingBox).applyMatrix4(Zr),this.boundingBox.union(nX)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Wn),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Zr),Hl.copy(e.boundingSphere).applyMatrix4(Zr),this.boundingSphere.union(Hl)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let i=t.morphTargetInfluences,s=this.morphTexture.source.data.data,o=i.length+1,r=e*o+1;for(let l=0;l<i.length;l++)i[l]=s[r+l]}raycast(e,t){let i=this.matrixWorld,s=this.count;if(wl.geometry=this.geometry,wl.material=this.material,wl.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Hl.copy(this.boundingSphere),Hl.applyMatrix4(i),e.ray.intersectsSphere(Hl)!==!1))for(let o=0;o<s;o++){this.getMatrixAt(o,Zr),tX.multiplyMatrices(i,Zr),wl.matrixWorld=tX,wl.raycast(e,Zd);for(let r=0,l=Zd.length;r<l;r++){let a=Zd[r];a.instanceId=o,a.object=this,t.push(a)}Zd.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new bo(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let i=t.morphTargetInfluences,s=i.length+1;this.morphTexture===null&&(this.morphTexture=new Fd(new Float32Array(s*this.count),s,this.count,$b,ci));let o=this.morphTexture.source.data.data,r=0;for(let c=0;c<i.length;c++)r+=i[c];let l=this.geometry.morphTargetsRelative?1:1-r,a=s*e;o[a]=l,o.set(i,a+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};var ea=class extends xn{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new xe(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Ed=new T,zd=new T,iX=new Ye,Kl=new mo,yd=new Wn,Tp=new T,sX=new T,wr=class extends _t{constructor(e=new Fn,t=new ea){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let s=1,o=t.count;s<o;s++)Ed.fromBufferAttribute(t,s-1),zd.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=Ed.distanceTo(zd);e.setAttribute("lineDistance",new Jn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,r=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),yd.copy(i.boundingSphere),yd.applyMatrix4(s),yd.radius+=o,e.ray.intersectsSphere(yd)===!1)return;iX.copy(s).invert(),Kl.copy(e.ray).applyMatrix4(iX);let l=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=l*l,c=this.isLineSegments?2:1,d=i.index,h=i.attributes.position;if(d!==null){let m=Math.max(0,r.start),f=Math.min(d.count,r.start+r.count);for(let g=m,b=f-1;g<b;g+=c){let p=d.getX(g),R=d.getX(g+1),V=Id(this,e,Kl,a,p,R);V&&t.push(V)}if(this.isLineLoop){let g=d.getX(f-1),b=d.getX(m),p=Id(this,e,Kl,a,g,b);p&&t.push(p)}}else{let m=Math.max(0,r.start),f=Math.min(h.count,r.start+r.count);for(let g=m,b=f-1;g<b;g+=c){let p=Id(this,e,Kl,a,g,g+1);p&&t.push(p)}if(this.isLineLoop){let g=Id(this,e,Kl,a,f-1,m);g&&t.push(g)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=s.length;o<r;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function Id(n,e,t,i,s,o){let r=n.geometry.attributes.position;if(Ed.fromBufferAttribute(r,s),zd.fromBufferAttribute(r,o),t.distanceSqToSegment(Ed,zd,Tp,sX)>i)return;Tp.applyMatrix4(n.matrixWorld);let a=e.ray.origin.distanceTo(Tp);if(!(a<e.near||a>e.far))return{distance:a,point:sX.clone().applyMatrix4(n.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:n}}var oX=new T,rX=new T,Dd=class extends wr{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let s=0,o=t.count;s<o;s+=2)oX.fromBufferAttribute(t,s),rX.fromBufferAttribute(t,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+oX.distanceTo(rX);e.setAttribute("lineDistance",new Jn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},_d=class extends wr{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},ta=class extends xn{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new xe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},lX=new Ye,wb=new mo,Gd=new Wn,Xd=new T,jd=class extends _t{constructor(e=new Fn,t=new ta){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let i=this.geometry,s=this.matrixWorld,o=e.params.Points.threshold,r=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Gd.copy(i.boundingSphere),Gd.applyMatrix4(s),Gd.radius+=o,e.ray.intersectsSphere(Gd)===!1)return;lX.copy(s).invert(),wb.copy(e.ray).applyMatrix4(lX);let l=o/((this.scale.x+this.scale.y+this.scale.z)/3),a=l*l,c=i.index,u=i.attributes.position;if(c!==null){let h=Math.max(0,r.start),m=Math.min(c.count,r.start+r.count);for(let f=h,g=m;f<g;f++){let b=c.getX(f);Xd.fromBufferAttribute(u,b),aX(Xd,b,a,s,e,t,this)}}else{let h=Math.max(0,r.start),m=Math.min(u.count,r.start+r.count);for(let f=h,g=m;f<g;f++)Xd.fromBufferAttribute(u,f),aX(Xd,f,a,s,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){let s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,r=s.length;o<r;o++){let l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function aX(n,e,t,i,s,o,r){let l=wb.distanceSqToPoint(n);if(l<t){let a=new T;wb.closestPointToPoint(n,a),a.applyMatrix4(i);let c=s.ray.origin.distanceTo(a);if(c<s.near||c>s.far)return;o.push({distance:c,distanceToRay:Math.sqrt(l),point:a,index:e,face:null,faceIndex:null,barycoord:null,object:r})}}var Hr=class extends xn{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new xe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xX,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new po,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},vn=class extends Hr{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return on(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xe(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};function Vd(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function tT(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function nT(n){function e(s,o){return n[s]-n[o]}let t=n.length,i=new Array(t);for(let s=0;s!==t;++s)i[s]=s;return i.sort(e),i}function cX(n,e,t){let i=n.length,s=new n.constructor(i);for(let o=0,r=0;r!==i;++o){let l=t[o]*e;for(let a=0;a!==e;++a)s[r++]=n[l+a]}return s}function UX(n,e,t,i){let s=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[s++];if(o===void 0)return;let r=o[i];if(r!==void 0)if(Array.isArray(r))do r=o[i],r!==void 0&&(e.push(o.time),t.push.apply(t,r)),o=n[s++];while(o!==void 0);else if(r.toArray!==void 0)do r=o[i],r!==void 0&&(e.push(o.time),r.toArray(t,t.length)),o=n[s++];while(o!==void 0);else do r=o[i],r!==void 0&&(e.push(o.time),t.push(r)),o=n[s++];while(o!==void 0)}var Ws=class{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,s=t[i],o=t[i-1];n:{e:{let r;t:{i:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(o=s,s=t[++i],e<s)break e}r=t.length;break t}if(!(e>=o)){let l=t[1];e<l&&(i=2,o=l);for(let a=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(s=o,o=t[--i-1],e>=o)break e}r=i,i=0;break t}break n}for(;i<r;){let l=i+r>>>1;e<t[l]?r=l:i=l+1}if(s=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let r=0;r!==s;++r)t[r]=i[o+r];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Hb=class extends Ws{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$I,endingEnd:$I}}intervalChanged_(e,t,i){let s=this.parameterPositions,o=e-2,r=e+1,l=s[o],a=s[r];if(l===void 0)switch(this.getSettings_().endingStart){case eG:o=e,l=2*t-i;break;case tG:o=s.length-2,l=t+s[o]-s[o+1];break;default:o=e,l=i}if(a===void 0)switch(this.getSettings_().endingEnd){case eG:r=e,a=2*i-t;break;case tG:r=1,a=i+s[1]-s[0];break;default:r=e-1,a=t}let c=(i-t)*.5,d=this.valueSize;this._weightPrev=c/(t-l),this._weightNext=c/(a-i),this._offsetPrev=o*d,this._offsetNext=r*d}interpolate_(e,t,i,s){let o=this.resultBuffer,r=this.sampleValues,l=this.valueSize,a=e*l,c=a-l,d=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,m=this._weightNext,f=(i-t)/(s-t),g=f*f,b=g*f,p=-h*b+2*h*g-h*f,R=(1+h)*b+(-1.5-2*h)*g+(-.5+h)*f+1,V=(-1-m)*b+(1.5+m)*g+.5*f,I=m*b-m*g;for(let w=0;w!==l;++w)o[w]=p*r[d+w]+R*r[c+w]+V*r[a+w]+I*r[u+w];return o}},Kb=class extends Ws{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,r=this.sampleValues,l=this.valueSize,a=e*l,c=a-l,d=(i-t)/(s-t),u=1-d;for(let h=0;h!==l;++h)o[h]=r[c+h]*u+r[a+h]*d;return o}},kb=class extends Ws{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}},Bn=class{constructor(e,t,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Vd(t,this.TimeBufferType),this.values=Vd(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Vd(e.times,Array),values:Vd(e.values,Array)};let s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new kb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Kb(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Hb(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Lr:t=this.InterpolantFactoryMethodDiscrete;break;case Mr:t=this.InterpolantFactoryMethodLinear;break;case ip:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lr;case this.InterpolantFactoryMethodLinear:return Mr;case this.InterpolantFactoryMethodSmooth:return ip}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){let i=this.times,s=i.length,o=0,r=s-1;for(;o!==s&&i[o]<e;)++o;for(;r!==-1&&i[r]>t;)--r;if(++r,o!==0||r!==s){o>=r&&(r=Math.max(r,1),o=r-1);let l=this.getValueSize();this.times=i.slice(o,r),this.values=this.values.slice(o*l,r*l)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let r=null;for(let l=0;l!==o;l++){let a=i[l];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,a),e=!1;break}if(r!==null&&r>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,a,r),e=!1;break}r=a}if(s!==void 0&&tT(s))for(let l=0,a=s.length;l!==a;++l){let c=s[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===ip,o=e.length-1,r=1;for(let l=1;l<o;++l){let a=!1,c=e[l],d=e[l+1];if(c!==d&&(l!==1||c!==e[0]))if(s)a=!0;else{let u=l*i,h=u-i,m=u+i;for(let f=0;f!==i;++f){let g=t[u+f];if(g!==t[h+f]||g!==t[m+f]){a=!0;break}}}if(a){if(l!==r){e[r]=e[l];let u=l*i,h=r*i;for(let m=0;m!==i;++m)t[h+m]=t[u+m]}++r}}if(o>0){e[r]=e[o];for(let l=o*i,a=r*i,c=0;c!==i;++c)t[a+c]=t[l+c];++r}return r!==e.length?(this.times=e.slice(0,r),this.values=t.slice(0,r*i)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),i=this.constructor,s=new i(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}};Bn.prototype.TimeBufferType=Float32Array;Bn.prototype.ValueBufferType=Float32Array;Bn.prototype.DefaultInterpolation=Mr;var xs=class extends Bn{constructor(e,t,i){super(e,t,i)}};xs.prototype.ValueTypeName="bool";xs.prototype.ValueBufferType=Array;xs.prototype.DefaultInterpolation=Lr;xs.prototype.InterpolantFactoryMethodLinear=void 0;xs.prototype.InterpolantFactoryMethodSmooth=void 0;var Od=class extends Bn{};Od.prototype.ValueTypeName="color";var Oi=class extends Bn{};Oi.prototype.ValueTypeName="number";var Ub=class extends Ws{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){let o=this.resultBuffer,r=this.sampleValues,l=this.valueSize,a=(i-t)/(s-t),c=e*l;for(let d=c+l;c!==d;c+=4)ui.slerpFlat(o,0,r,c-l,r,c,a);return o}},Qi=class extends Bn{InterpolantFactoryMethodLinear(e){return new Ub(this.times,this.values,this.getValueSize(),e)}};Qi.prototype.ValueTypeName="quaternion";Qi.prototype.InterpolantFactoryMethodSmooth=void 0;var vs=class extends Bn{constructor(e,t,i){super(e,t,i)}};vs.prototype.ValueTypeName="string";vs.prototype.ValueBufferType=Array;vs.prototype.DefaultInterpolation=Lr;vs.prototype.InterpolantFactoryMethodLinear=void 0;vs.prototype.InterpolantFactoryMethodSmooth=void 0;var qi=class extends Bn{};qi.prototype.ValueTypeName="vector";var Qd=class{constructor(e="",t=-1,i=[],s=x2){this.name=e,this.tracks=i,this.duration=t,this.blendMode=s,this.uuid=di(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,s=1/(e.fps||1);for(let r=0,l=i.length;r!==l;++r)t.push(sT(i[r]).scale(s));let o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){let t=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,r=i.length;o!==r;++o)t.push(Bn.toJSON(i[o]));return s}static CreateFromMorphTargetSequence(e,t,i,s){let o=t.length,r=[];for(let l=0;l<o;l++){let a=[],c=[];a.push((l+o-1)%o,l,(l+1)%o),c.push(0,1,0);let d=nT(a);a=cX(a,1,d),c=cX(c,1,d),!s&&a[0]===0&&(a.push(o),c.push(c[0])),r.push(new Oi(".morphTargetInfluences["+t[l].name+"]",a,c).scale(1/i))}return new this(e,-1,r)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===t)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let s={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,a=e.length;l<a;l++){let c=e[l],d=c.name.match(o);if(d&&d.length>1){let u=d[1],h=s[u];h||(s[u]=h=[]),h.push(c)}}let r=[];for(let l in s)r.push(this.CreateFromMorphTargetSequence(l,s[l],t,i));return r}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(u,h,m,f,g){if(m.length!==0){let b=[],p=[];UX(m,b,p,f),b.length!==0&&g.push(new u(h,b,p))}},s=[],o=e.name||"default",r=e.fps||30,l=e.blendMode,a=e.length||-1,c=e.hierarchy||[];for(let u=0;u<c.length;u++){let h=c[u].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let m={},f;for(f=0;f<h.length;f++)if(h[f].morphTargets)for(let g=0;g<h[f].morphTargets.length;g++)m[h[f].morphTargets[g]]=-1;for(let g in m){let b=[],p=[];for(let R=0;R!==h[f].morphTargets.length;++R){let V=h[f];b.push(V.time),p.push(V.morphTarget===g?1:0)}s.push(new Oi(".morphTargetInfluence["+g+"]",b,p))}a=m.length*r}else{let m=".bones["+t[u].name+"]";i(qi,m+".position",h,"pos",s),i(Qi,m+".quaternion",h,"rot",s),i(qi,m+".scale",h,"scl",s)}}return s.length===0?null:new this(o,a,s,l)}resetDuration(){let e=this.tracks,t=0;for(let i=0,s=e.length;i!==s;++i){let o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function iT(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Oi;case"vector":case"vector2":case"vector3":case"vector4":return qi;case"color":return Od;case"quaternion":return Qi;case"bool":case"boolean":return xs;case"string":return vs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function sT(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=iT(n.type);if(n.times===void 0){let t=[],i=[];UX(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}var Vs={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}},Jb=class{constructor(e,t,i){let s=this,o=!1,r=0,l=0,a,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){l++,o===!1&&s.onStart!==void 0&&s.onStart(d,r,l),o=!0},this.itemEnd=function(d){r++,s.onProgress!==void 0&&s.onProgress(d,r,l),r===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(d){s.onError!==void 0&&s.onError(d)},this.resolveURL=function(d){return a?a(d):d},this.setURLModifier=function(d){return a=d,this},this.addHandler=function(d,u){return c.push(d,u),this},this.removeHandler=function(d){let u=c.indexOf(d);return u!==-1&&c.splice(u,2),this},this.getHandler=function(d){for(let u=0,h=c.length;u<h;u+=2){let m=c[u],f=c[u+1];if(m.global&&(m.lastIndex=0),m.test(d))return f}return null}}},oT=new Jb,kr=(()=>{class n{constructor(t){this.manager=t!==void 0?t:oT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){let s=this;return new Promise(function(o,r){s.load(t,o,i,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})(),Fi={},Ab=class extends Error{constructor(e,t){super(e),this.response=t}},na=class extends kr{constructor(e){super(e)}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=Vs.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(Fi[e]!==void 0){Fi[e].push({onLoad:t,onProgress:i,onError:s});return}Fi[e]=[],Fi[e].push({onLoad:t,onProgress:i,onError:s});let r=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,a=this.responseType;fetch(r).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;let d=Fi[e],u=c.body.getReader(),h=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),m=h?parseInt(h):0,f=m!==0,g=0,b=new ReadableStream({start(p){R();function R(){u.read().then(({done:V,value:I})=>{if(V)p.close();else{g+=I.byteLength;let w=new ProgressEvent("progress",{lengthComputable:f,loaded:g,total:m});for(let W=0,C=d.length;W<C;W++){let N=d[W];N.onProgress&&N.onProgress(w)}p.enqueue(I),R()}},V=>{p.error(V)})}}});return new Response(b)}else throw new Ab(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(a){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>new DOMParser().parseFromString(d,l));case"json":return c.json();default:if(l===void 0)return c.text();{let u=/charset="?([^;"\s]*)"?/i.exec(l),h=u&&u[1]?u[1].toLowerCase():void 0,m=new TextDecoder(h);return c.arrayBuffer().then(f=>m.decode(f))}}}).then(c=>{Vs.add(e,c);let d=Fi[e];delete Fi[e];for(let u=0,h=d.length;u<h;u++){let m=d[u];m.onLoad&&m.onLoad(c)}}).catch(c=>{let d=Fi[e];if(d===void 0)throw this.manager.itemError(e),c;delete Fi[e];for(let u=0,h=d.length;u<h;u++){let m=d[u];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};var Fb=class extends kr{constructor(e){super(e)}load(e,t,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=this,r=Vs.get(e);if(r!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(r),o.manager.itemEnd(e)},0),r;let l=Dl("img");function a(){d(),Vs.add(e,this),t&&t(this),o.manager.itemEnd(e)}function c(u){d(),s&&s(u),o.manager.itemError(e),o.manager.itemEnd(e)}function d(){l.removeEventListener("load",a,!1),l.removeEventListener("error",c,!1)}return l.addEventListener("load",a,!1),l.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}};var qd=class extends kr{constructor(e){super(e)}load(e,t,i,s){let o=new Pn,r=new Fb(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(e,function(l){o.image=l,o.needsUpdate=!0,t!==void 0&&t(o)},i,s),o}},fo=class extends _t{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new xe(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}},$d=class extends fo{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.groundColor=new xe(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},Yp=new Ye,dX=new T,uX=new T,ia=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ye,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ol,this._frameExtents=new Oe(1,1),this._viewportCount=1,this._viewports=[new at(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;dX.setFromMatrixPosition(e.matrixWorld),t.position.copy(dX),uX.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(uX),t.updateMatrixWorld(),Yp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yp),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Yp)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Bb=class extends ia{constructor(){super(new Jt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=Tr*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||s!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=s,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},eu=class extends fo{constructor(e,t,i=0,s=Math.PI/3,o=0,r=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.target=new _t,this.distance=i,this.angle=s,this.penumbra=o,this.decay=r,this.map=null,this.shadow=new Bb}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},hX=new Ye,kl=new T,Np=new T,Pb=class extends ia{constructor(){super(new Jt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Oe(4,2),this._viewportCount=6,this._viewports=[new at(2,1,1,1),new at(0,1,1,1),new at(3,1,1,1),new at(1,1,1,1),new at(3,0,1,1),new at(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,s=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),kl.setFromMatrixPosition(e.matrixWorld),i.position.copy(kl),Np.copy(i.position),Np.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Np),i.updateMatrixWorld(),s.makeTranslation(-kl.x,-kl.y,-kl.z),hX.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hX)}},tu=class extends fo{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new Pb}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Eb=class extends ia{constructor(){super(new Nr(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},nu=class extends fo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.target=new _t,this.shadow=new Eb}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},iu=class extends fo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};var Ls=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,s=e.length;i<s;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var su=class extends kr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=this,r=Vs.get(e);if(r!==void 0){if(o.manager.itemStart(e),r.then){r.then(c=>{t&&t(c),o.manager.itemEnd(e)}).catch(c=>{s&&s(c)});return}return setTimeout(function(){t&&t(r),o.manager.itemEnd(e)},0),r}let l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;let a=fetch(e,l).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(c){return Vs.add(e,c),t&&t(c),o.manager.itemEnd(e),c}).catch(function(c){s&&s(c),Vs.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});Vs.add(e,a),o.manager.itemStart(e)}};var ou=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=mX(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=mX();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function mX(){return performance.now()}var rf="\\[\\]\\.:\\/",rT=new RegExp("["+rf+"]","g"),lf="[^"+rf+"]",lT="[^"+rf.replace("\\.","")+"]",aT=/((?:WC+[\/:])*)/.source.replace("WC",lf),cT=/(WCOD+)?/.source.replace("WCOD",lT),dT=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lf),uT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lf),hT=new RegExp("^"+aT+cT+dT+uT+"$"),mT=["material","materials","bones","map"],zb=class{constructor(e,t,i){let s=i||vt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},vt=(()=>{class n{constructor(t,i,s){this.path=i,this.parsedPath=s||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,s){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,s):new n(t,i,s)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(rT,"")}static parseTrackName(t){let i=hT.exec(t);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let s={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=s.nodeName&&s.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let r=s.nodeName.substring(o+1);mT.indexOf(r)!==-1&&(s.nodeName=s.nodeName.substring(0,o),s.objectName=r)}if(s.propertyName===null||s.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return s}static findNode(t,i){if(i===void 0||i===""||i==="."||i===-1||i===t.name||i===t.uuid)return t;if(t.skeleton){let s=t.skeleton.getBoneByName(i);if(s!==void 0)return s}if(t.children){let s=function(r){for(let l=0;l<r.length;l++){let a=r[l];if(a.name===i||a.uuid===i)return a;let c=s(a.children);if(c)return c}return null},o=s(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){let s=this.resolvedProperty;for(let o=0,r=s.length;o!==r;++o)t[i++]=s[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){let s=this.resolvedProperty;for(let o=0,r=s.length;o!==r;++o)s[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,r=s.length;o!==r;++o)s[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){let s=this.resolvedProperty;for(let o=0,r=s.length;o!==r;++o)s[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node,i=this.parsedPath,s=i.objectName,o=i.propertyName,r=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(s){let d=i.objectIndex;switch(s){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===d){d=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[s]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[s]}if(d!==void 0){if(t[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[d]}}let l=t[o];if(l===void 0){let d=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+o+" but it wasn't found.",t);return}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(r!==void 0){if(o==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[r]!==void 0&&(r=t.morphTargetDictionary[r])}c=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=r}else l.fromArray!==void 0&&l.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(c=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=o;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=zb,n})();vt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};vt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};vt.prototype.GetterByBindingType=[vt.prototype._getValue_direct,vt.prototype._getValue_array,vt.prototype._getValue_arrayElement,vt.prototype._getValue_toArray];vt.prototype.SetterByBindingTypeAndVersioning=[[vt.prototype._setValue_direct,vt.prototype._setValue_direct_setNeedsUpdate,vt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[vt.prototype._setValue_array,vt.prototype._setValue_array_setNeedsUpdate,vt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[vt.prototype._setValue_arrayElement,vt.prototype._setValue_arrayElement_setNeedsUpdate,vt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[vt.prototype._setValue_fromArray,vt.prototype._setValue_fromArray_setNeedsUpdate,vt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var wJ=new Float32Array(1);var pX=new Ye,ru=class{constructor(e,t,i=0,s=1/0){this.ray=new mo(e,t),this.near=i,this.far=s,this.camera=null,this.layers=new _l,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return pX.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(pX),this}intersectObject(e,t=!0,i=[]){return Db(e,this,i,t),i.sort(bX),i}intersectObjects(e,t=!0,i=[]){for(let s=0,o=e.length;s<o;s++)Db(e[s],this,i,t);return i.sort(bX),i}};function bX(n,e){return n.distance-e.distance}function Db(n,e,t,i){let s=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(s=!1),s===!0&&i===!0){let o=n.children;for(let r=0,l=o.length;r<l;r++)Db(o[r],e,t,!0)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_b}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_b);function af(n,e){if(e===WX)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===oa||e===au){let t=n.getIndex();if(t===null){let r=[],l=n.getAttribute("position");if(l!==void 0){for(let a=0;a<l.count;a++)r.push(a);n.setIndex(r),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}let i=t.count-2,s=[];if(e===oa)for(let r=1;r<=i;r++)s.push(t.getX(0)),s.push(t.getX(r)),s.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(s.push(t.getX(r)),s.push(t.getX(r+1)),s.push(t.getX(r+2))):(s.push(t.getX(r+2)),s.push(t.getX(r+1)),s.push(t.getX(r)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=n.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var uu=class extends kr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new bf(t)}),this.register(function(t){return new ff(t)}),this.register(function(t){return new Sf(t)}),this.register(function(t){return new Cf(t)}),this.register(function(t){return new Wf(t)}),this.register(function(t){return new Zf(t)}),this.register(function(t){return new yf(t)}),this.register(function(t){return new If(t)}),this.register(function(t){return new Gf(t)}),this.register(function(t){return new pf(t)}),this.register(function(t){return new Xf(t)}),this.register(function(t){return new gf(t)}),this.register(function(t){return new Rf(t)}),this.register(function(t){return new Vf(t)}),this.register(function(t){return new hf(t)}),this.register(function(t){return new xf(t)}),this.register(function(t){return new vf(t)})}load(e,t,i,s){let o=this,r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){let c=Ls.extractUrlBase(e);r=Ls.resolveURL(c,this.path)}else r=Ls.extractUrlBase(e);this.manager.itemStart(e);let l=function(c){s?s(c):console.error(c),o.manager.itemError(e),o.manager.itemEnd(e)},a=new na(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{o.parse(c,r,function(d){t(d),o.manager.itemEnd(e)},l)}catch(d){l(d)}},i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){let o,r={},l={},a=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===PX){try{r[_e.KHR_BINARY_GLTF]=new Lf(e)}catch(u){s&&s(u);return}o=JSON.parse(r[_e.KHR_BINARY_GLTF].content)}else o=JSON.parse(a.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let c=new Kf(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){let u=this.pluginCallbacks[d](c);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[u.name]=u,r[u.name]=!0}if(o.extensionsUsed)for(let d=0;d<o.extensionsUsed.length;++d){let u=o.extensionsUsed[d],h=o.extensionsRequired||[];switch(u){case _e.KHR_MATERIALS_UNLIT:r[u]=new mf;break;case _e.KHR_DRACO_MESH_COMPRESSION:r[u]=new Mf(o,this.dracoLoader);break;case _e.KHR_TEXTURE_TRANSFORM:r[u]=new Tf;break;case _e.KHR_MESH_QUANTIZATION:r[u]=new Yf;break;default:h.indexOf(u)>=0&&l[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(r),c.setPlugins(l),c.parse(i,s)}parseAsync(e,t){let i=this;return new Promise(function(s,o){i.parse(e,t,s,o)})}};function bT(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}var _e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},hf=class{constructor(e){this.parser=e,this.name=_e.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){let o=t[i];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){let t=this.parser,i="light:"+e,s=t.cache.get(i);if(s)return s;let o=t.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],c,d=new xe(16777215);a.color!==void 0&&d.setRGB(a.color[0],a.color[1],a.color[2],an);let u=a.range!==void 0?a.range:0;switch(a.type){case"directional":c=new nu(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new tu(d),c.distance=u;break;case"spot":c=new eu(d),c.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,c.angle=a.spot.outerConeAngle,c.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return c.position.set(0,0,0),c.decay=2,$i(c,a),a.intensity!==void 0&&(c.intensity=a.intensity),c.name=t.createUniqueName(a.name||"light_"+e),s=Promise.resolve(c),t.cache.add(i,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,i=this.parser,o=i.json.nodes[e],l=(o.extensions&&o.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(a){return i._getNodeRef(t.cache,l,a)})}},mf=class{constructor(){this.name=_e.KHR_MATERIALS_UNLIT}getMaterialType(){return Ri}extendParams(e,t,i){let s=[];e.color=new xe(1,1,1),e.opacity=1;let o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){let r=o.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],an),e.opacity=r[3]}o.baseColorTexture!==void 0&&s.push(i.assignTexture(e,"map",o.baseColorTexture,Kt))}return Promise.all(s)}},pf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}},bf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(o.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){let l=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Oe(l,l)}return Promise.all(o)}},ff=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_DISPERSION}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=s.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}},gf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(o)}},Zf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_SHEEN}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[];t.sheenColor=new xe(0,0,0),t.sheenRoughness=0,t.sheen=1;let r=s.extensions[this.name];if(r.sheenColorFactor!==void 0){let l=r.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],an)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&o.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,Kt)),r.sheenRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(o)}},yf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&o.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(o)}},If=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_VOLUME}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&o.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;let l=r.attenuationColor||[1,1,1];return t.attenuationColor=new xe().setRGB(l[0],l[1],l[2],an),Promise.all(o)}},Gf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_IOR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=s.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}},Xf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_SPECULAR}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&o.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));let l=r.specularColorFactor||[1,1,1];return t.specularColor=new xe().setRGB(l[0],l[1],l[2],an),r.specularColorTexture!==void 0&&o.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,Kt)),Promise.all(o)}},Vf=class{constructor(e){this.parser=e,this.name=_e.EXT_MATERIALS_BUMP}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&o.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(o)}},Rf=class{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:vn}extendMaterialParams(e,t){let i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let o=[],r=s.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&o.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(o)}},Sf=class{constructor(e){this.parser=e,this.name=_e.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;let o=s.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,r)}},Cf=class{constructor(e){this.parser=e,this.name=_e.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;let r=o.extensions[t],l=s.images[r.source],a=i.textureLoader;if(l.uri){let c=i.options.manager.getHandler(l.uri);c!==null&&(a=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,r.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},Wf=class{constructor(e){this.parser=e,this.name=_e.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[t])return null;let r=o.extensions[t],l=s.images[r.source],a=i.textureLoader;if(l.uri){let c=i.options.manager.getHandler(l.uri);c!==null&&(a=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,r.source,a);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},xf=class{constructor(e){this.name=_e.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){let s=i.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(l){let a=s.byteOffset||0,c=s.byteLength||0,d=s.count,u=s.byteStride,h=new Uint8Array(l,a,c);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(d,u,h,s.mode,s.filter).then(function(m){return m.buffer}):r.ready.then(function(){let m=new ArrayBuffer(d*u);return r.decodeGltfBuffer(new Uint8Array(m),d,u,h,s.mode,s.filter),m})})}else return null}},vf=class{constructor(e){this.name=_e.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;let s=t.meshes[i.mesh];for(let c of s.primitives)if(c.mode!==En.TRIANGLES&&c.mode!==En.TRIANGLE_STRIP&&c.mode!==En.TRIANGLE_FAN&&c.mode!==void 0)return null;let r=i.extensions[this.name].attributes,l=[],a={};for(let c in r)l.push(this.parser.getDependency("accessor",r[c]).then(d=>(a[c]=d,a[c])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(c=>{let d=c.pop(),u=d.isGroup?d.children:[d],h=c[0].count,m=[];for(let f of u){let g=new Ye,b=new T,p=new ui,R=new T(1,1,1),V=new Pd(f.geometry,f.material,h);for(let I=0;I<h;I++)a.TRANSLATION&&b.fromBufferAttribute(a.TRANSLATION,I),a.ROTATION&&p.fromBufferAttribute(a.ROTATION,I),a.SCALE&&R.fromBufferAttribute(a.SCALE,I),V.setMatrixAt(I,g.compose(b,p,R));for(let I in a)if(I==="_COLOR_0"){let w=a[I];V.instanceColor=new bo(w.array,w.itemSize,w.normalized)}else I!=="TRANSLATION"&&I!=="ROTATION"&&I!=="SCALE"&&f.geometry.setAttribute(I,a[I]);_t.prototype.copy.call(V,f),this.parser.assignFinalMaterial(V),m.push(V)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}},PX="glTF",ra=12,JX={JSON:1313821514,BIN:5130562},Lf=class{constructor(e){this.name=_e.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,ra),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==PX)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let s=this.header.length-ra,o=new DataView(e,ra),r=0;for(;r<s;){let l=o.getUint32(r,!0);r+=4;let a=o.getUint32(r,!0);if(r+=4,a===JX.JSON){let c=new Uint8Array(e,ra+r,l);this.content=i.decode(c)}else if(a===JX.BIN){let c=ra+r;this.body=e.slice(c,c+l)}r+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Mf=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=_e.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let i=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,l={},a={},c={};for(let d in r){let u=wf[d]||d.toLowerCase();l[u]=r[d]}for(let d in e.attributes){let u=wf[d]||d.toLowerCase();if(r[d]!==void 0){let h=i.accessors[e.attributes[d]],m=Ur[h.componentType];c[u]=m.name,a[u]=h.normalized===!0}}return t.getDependency("bufferView",o).then(function(d){return new Promise(function(u,h){s.decodeDracoFile(d,function(m){for(let f in m.attributes){let g=m.attributes[f],b=a[f];b!==void 0&&(g.normalized=b)}u(m)},l,c,an,h)})})}},Tf=class{constructor(){this.name=_e.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},Yf=class{constructor(){this.name=_e.KHR_MESH_QUANTIZATION}},hu=class extends Ws{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let r=0;r!==s;r++)t[r]=i[o+r];return t}interpolate_(e,t,i,s){let o=this.resultBuffer,r=this.sampleValues,l=this.valueSize,a=l*2,c=l*3,d=s-t,u=(i-t)/d,h=u*u,m=h*u,f=e*c,g=f-c,b=-2*m+3*h,p=m-h,R=1-b,V=p-h+u;for(let I=0;I!==l;I++){let w=r[g+I+l],W=r[g+I+a]*d,C=r[f+I+l],N=r[f+I]*d;o[I]=R*w+V*W+b*C+p*N}return o}},fT=new ui,Nf=class extends hu{interpolate_(e,t,i,s){let o=super.interpolate_(e,t,i,s);return fT.fromArray(o).normalize().toArray(o),o}},En={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ur={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},AX={9728:ln,9729:gn,9984:jb,9985:Al,9986:yr,9987:Gi},FX={33071:Ei,33648:El,10497:uo},cf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wf={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ms={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gT={CUBICSPLINE:void 0,LINEAR:Mr,STEP:Lr},df={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ZT(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new Hr({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Vi})),n.DefaultMaterial}function go(n,e,t){for(let i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function $i(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function yT(n,e,t){let i=!1,s=!1,o=!1;for(let c=0,d=e.length;c<d;c++){let u=e[c];if(u.POSITION!==void 0&&(i=!0),u.NORMAL!==void 0&&(s=!0),u.COLOR_0!==void 0&&(o=!0),i&&s&&o)break}if(!i&&!s&&!o)return Promise.resolve(n);let r=[],l=[],a=[];for(let c=0,d=e.length;c<d;c++){let u=e[c];if(i){let h=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):n.attributes.position;r.push(h)}if(s){let h=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):n.attributes.normal;l.push(h)}if(o){let h=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):n.attributes.color;a.push(h)}}return Promise.all([Promise.all(r),Promise.all(l),Promise.all(a)]).then(function(c){let d=c[0],u=c[1],h=c[2];return i&&(n.morphAttributes.position=d),s&&(n.morphAttributes.normal=u),o&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}function IT(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,s=t.length;i<s;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function GT(n){let e,t=n.extensions&&n.extensions[_e.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+uf(t.attributes):e=n.indices+":"+uf(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,s=n.targets.length;i<s;i++)e+=":"+uf(n.targets[i]);return e}function uf(n){let e="",t=Object.keys(n).sort();for(let i=0,s=t.length;i<s;i++)e+=t[i]+":"+n[t[i]]+";";return e}function Hf(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function XT(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":n.search(/\.ktx2($|\?)/i)>0||n.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}var VT=new Ye,Kf=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new bT,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=-1,o=!1,r=-1;if(typeof navigator<"u"){let l=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(l)===!0;let a=l.match(/Version\/(\d+)/);s=i&&a?parseInt(a[1],10):-1,o=l.indexOf("Firefox")>-1,r=o?l.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&s<17||o&&r<98?this.textureLoader=new qd(this.options.manager):this.textureLoader=new su(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new na(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let i=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){let l={scene:r[0][s.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:s.asset,parser:i,userData:{}};return go(o,l,s),$i(l,s),Promise.all(i._invokeAll(function(a){return a.afterRoot&&a.afterRoot(l)})).then(function(){for(let a of l.scenes)a.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let s=0,o=t.length;s<o;s++){let r=t[s].joints;for(let l=0,a=r.length;l<a;l++)e[r[l]].isBone=!0}for(let s=0,o=e.length;s<o;s++){let r=e[s];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;let s=i.clone(),o=(r,l)=>{let a=this.associations.get(r);a!=null&&this.associations.set(l,a);for(let[c,d]of r.children.entries())o(d,l.children[c])};return o(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){let s=e(t[i]);if(s)return s}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let i=[];for(let s=0;s<t.length;s++){let o=e(t[s]);o&&i.push(o)}return i}getDependency(e,t){let i=e+":"+t,s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){let i=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(o,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[_e.KHR_BINARY_GLTF].body);let s=this.options;return new Promise(function(o,r){i.load(Ls.resolveURL(t.uri,s.path),o,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){let s=t.byteLength||0,o=t.byteOffset||0;return i.slice(o,o+s)})}loadAccessor(e){let t=this,i=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){let r=cf[s.type],l=Ur[s.componentType],a=s.normalized===!0,c=new l(s.count*r);return Promise.resolve(new At(c,r,a))}let o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(r){let l=r[0],a=cf[s.type],c=Ur[s.componentType],d=c.BYTES_PER_ELEMENT,u=d*a,h=s.byteOffset||0,m=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,f=s.normalized===!0,g,b;if(m&&m!==u){let p=Math.floor(h/m),R="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+p+":"+s.count,V=t.cache.get(R);V||(g=new c(l,p*m,s.count*m/d),V=new Ql(g,m/d),t.cache.add(R,V)),b=new ql(V,a,h%m/d,f)}else l===null?g=new c(s.count*a):g=new c(l,h,s.count*a),b=new At(g,a,f);if(s.sparse!==void 0){let p=cf.SCALAR,R=Ur[s.sparse.indices.componentType],V=s.sparse.indices.byteOffset||0,I=s.sparse.values.byteOffset||0,w=new R(r[1],V,s.sparse.count*p),W=new c(r[2],I,s.sparse.count*a);l!==null&&(b=new At(b.array.slice(),b.itemSize,b.normalized)),b.normalized=!1;for(let C=0,N=w.length;C<N;C++){let X=w[C];if(b.setX(X,W[C*a]),a>=2&&b.setY(X,W[C*a+1]),a>=3&&b.setZ(X,W[C*a+2]),a>=4&&b.setW(X,W[C*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}b.normalized=f}return b})}loadTexture(e){let t=this.json,i=this.options,o=t.textures[e].source,r=t.images[o],l=this.textureLoader;if(r.uri){let a=i.manager.getHandler(r.uri);a!==null&&(l=a)}return this.loadTextureImage(e,o,l)}loadTextureImage(e,t,i){let s=this,o=this.json,r=o.textures[e],l=o.images[t],a=(l.uri||l.bufferView)+":"+r.sampler;if(this.textureCache[a])return this.textureCache[a];let c=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=r.name||l.name||"",d.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(d.name=l.uri);let h=(o.samplers||{})[r.sampler]||{};return d.magFilter=AX[h.magFilter]||gn,d.minFilter=AX[h.minFilter]||Gi,d.wrapS=FX[h.wrapS]||uo,d.wrapT=FX[h.wrapT]||uo,d.generateMipmaps=!d.isCompressedTexture&&d.minFilter!==ln&&d.minFilter!==gn,s.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[a]=c,c}loadImageSource(e,t){let i=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());let r=s.images[e],l=self.URL||self.webkitURL,a=r.uri||"",c=!1;if(r.bufferView!==void 0)a=i.getDependency("bufferView",r.bufferView).then(function(u){c=!0;let h=new Blob([u],{type:r.mimeType});return a=l.createObjectURL(h),a});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let d=Promise.resolve(a).then(function(u){return new Promise(function(h,m){let f=h;t.isImageBitmapLoader===!0&&(f=function(g){let b=new Pn(g);b.needsUpdate=!0,h(b)}),t.load(Ls.resolveURL(u,o.path),f,void 0,m)})}).then(function(u){return c===!0&&l.revokeObjectURL(a),$i(u,r),u.userData.mimeType=r.mimeType||XT(r.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),u});return this.sourceCache[e]=d,d}assignTexture(e,t,i,s){let o=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),o.extensions[_e.KHR_TEXTURE_TRANSFORM]){let l=i.extensions!==void 0?i.extensions[_e.KHR_TEXTURE_TRANSFORM]:void 0;if(l){let a=o.associations.get(r);r=o.extensions[_e.KHR_TEXTURE_TRANSFORM].extendTexture(r,l),o.associations.set(r,a)}}return s!==void 0&&(r.colorSpace=s),e[t]=r,r})}assignFinalMaterial(e){let t=e.geometry,i=e.material,s=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){let l="PointsMaterial:"+i.uuid,a=this.cache.get(l);a||(a=new ta,xn.prototype.copy.call(a,i),a.color.copy(i.color),a.map=i.map,a.sizeAttenuation=!1,this.cache.add(l,a)),i=a}else if(e.isLine){let l="LineBasicMaterial:"+i.uuid,a=this.cache.get(l);a||(a=new ea,xn.prototype.copy.call(a,i),a.color.copy(i.color),a.map=i.map,this.cache.add(l,a)),i=a}if(s||o||r){let l="ClonedMaterial:"+i.uuid+":";s&&(l+="derivative-tangents:"),o&&(l+="vertex-colors:"),r&&(l+="flat-shading:");let a=this.cache.get(l);a||(a=i.clone(),o&&(a.vertexColors=!0),r&&(a.flatShading=!0),s&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(l,a),this.associations.set(a,this.associations.get(i))),i=a}e.material=i}getMaterialType(){return Hr}loadMaterial(e){let t=this,i=this.json,s=this.extensions,o=i.materials[e],r,l={},a=o.extensions||{},c=[];if(a[_e.KHR_MATERIALS_UNLIT]){let u=s[_e.KHR_MATERIALS_UNLIT];r=u.getMaterialType(),c.push(u.extendParams(l,o,t))}else{let u=o.pbrMetallicRoughness||{};if(l.color=new xe(1,1,1),l.opacity=1,Array.isArray(u.baseColorFactor)){let h=u.baseColorFactor;l.color.setRGB(h[0],h[1],h[2],an),l.opacity=h[3]}u.baseColorTexture!==void 0&&c.push(t.assignTexture(l,"map",u.baseColorTexture,Kt)),l.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,l.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(l,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(l,"roughnessMap",u.metallicRoughnessTexture))),r=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,l)})))}o.doubleSided===!0&&(l.side=li);let d=o.alphaMode||df.OPAQUE;if(d===df.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,d===df.MASK&&(l.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&r!==Ri&&(c.push(t.assignTexture(l,"normalMap",o.normalTexture)),l.normalScale=new Oe(1,1),o.normalTexture.scale!==void 0)){let u=o.normalTexture.scale;l.normalScale.set(u,u)}if(o.occlusionTexture!==void 0&&r!==Ri&&(c.push(t.assignTexture(l,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&r!==Ri){let u=o.emissiveFactor;l.emissive=new xe().setRGB(u[0],u[1],u[2],an)}return o.emissiveTexture!==void 0&&r!==Ri&&c.push(t.assignTexture(l,"emissiveMap",o.emissiveTexture,Kt)),Promise.all(c).then(function(){let u=new r(l);return o.name&&(u.name=o.name),$i(u,o),t.associations.set(u,{materials:e}),o.extensions&&go(s,u,o),u})}createUniqueName(e){let t=vt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,i=this.extensions,s=this.primitiveCache;function o(l){return i[_e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(a){return BX(a,l,t)})}let r=[];for(let l=0,a=e.length;l<a;l++){let c=e[l],d=GT(c),u=s[d];if(u)r.push(u.promise);else{let h;c.extensions&&c.extensions[_e.KHR_DRACO_MESH_COMPRESSION]?h=o(c):h=BX(new Fn,c,t),s[d]={primitive:c,promise:h},r.push(h)}}return Promise.all(r)}loadMesh(e){let t=this,i=this.json,s=this.extensions,o=i.meshes[e],r=o.primitives,l=[];for(let a=0,c=r.length;a<c;a++){let d=r[a].material===void 0?ZT(this.cache):this.getDependency("material",r[a].material);l.push(d)}return l.push(t.loadGeometries(r)),Promise.all(l).then(function(a){let c=a.slice(0,a.length-1),d=a[a.length-1],u=[];for(let m=0,f=d.length;m<f;m++){let g=d[m],b=r[m],p,R=c[m];if(b.mode===En.TRIANGLES||b.mode===En.TRIANGLE_STRIP||b.mode===En.TRIANGLE_FAN||b.mode===void 0)p=o.isSkinnedMesh===!0?new Ad(g,R):new rn(g,R),p.isSkinnedMesh===!0&&p.normalizeSkinWeights(),b.mode===En.TRIANGLE_STRIP?p.geometry=af(p.geometry,au):b.mode===En.TRIANGLE_FAN&&(p.geometry=af(p.geometry,oa));else if(b.mode===En.LINES)p=new Dd(g,R);else if(b.mode===En.LINE_STRIP)p=new wr(g,R);else if(b.mode===En.LINE_LOOP)p=new _d(g,R);else if(b.mode===En.POINTS)p=new jd(g,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);Object.keys(p.geometry.morphAttributes).length>0&&IT(p,o),p.name=t.createUniqueName(o.name||"mesh_"+e),$i(p,o),b.extensions&&go(s,p,b),t.assignFinalMaterial(p),u.push(p)}for(let m=0,f=u.length;m<f;m++)t.associations.set(u[m],{meshes:e,primitives:m});if(u.length===1)return o.extensions&&go(s,u[0],o),u[0];let h=new Xi;o.extensions&&go(s,h,o),t.associations.set(h,{meshes:e});for(let m=0,f=u.length;m<f;m++)h.add(u[m]);return h})}loadCamera(e){let t,i=this.json.cameras[e],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Jt(LX.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(t=new Nr(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),$i(t,i),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],i=[];for(let s=0,o=t.joints.length;s<o;s++)i.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){let o=s.pop(),r=s,l=[],a=[];for(let c=0,d=r.length;c<d;c++){let u=r[c];if(u){l.push(u);let h=new Ye;o!==null&&h.fromArray(o.array,c*16),a.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Bd(l,a)})}loadAnimation(e){let t=this.json,i=this,s=t.animations[e],o=s.name?s.name:"animation_"+e,r=[],l=[],a=[],c=[],d=[];for(let u=0,h=s.channels.length;u<h;u++){let m=s.channels[u],f=s.samplers[m.sampler],g=m.target,b=g.node,p=s.parameters!==void 0?s.parameters[f.input]:f.input,R=s.parameters!==void 0?s.parameters[f.output]:f.output;g.node!==void 0&&(r.push(this.getDependency("node",b)),l.push(this.getDependency("accessor",p)),a.push(this.getDependency("accessor",R)),c.push(f),d.push(g))}return Promise.all([Promise.all(r),Promise.all(l),Promise.all(a),Promise.all(c),Promise.all(d)]).then(function(u){let h=u[0],m=u[1],f=u[2],g=u[3],b=u[4],p=[];for(let R=0,V=h.length;R<V;R++){let I=h[R],w=m[R],W=f[R],C=g[R],N=b[R];if(I===void 0)continue;I.updateMatrix&&I.updateMatrix();let X=i._createAnimationTracks(I,w,W,C,N);if(X)for(let G=0;G<X.length;G++)p.push(X[G])}return new Qd(o,void 0,p)})}createNodeMesh(e){let t=this.json,i=this,s=t.nodes[e];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(o){let r=i._getNodeRef(i.meshCache,s.mesh,o);return s.weights!==void 0&&r.traverse(function(l){if(l.isMesh)for(let a=0,c=s.weights.length;a<c;a++)l.morphTargetInfluences[a]=s.weights[a]}),r})}loadNode(e){let t=this.json,i=this,s=t.nodes[e],o=i._loadNodeShallow(e),r=[],l=s.children||[];for(let c=0,d=l.length;c<d;c++)r.push(i.getDependency("node",l[c]));let a=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([o,Promise.all(r),a]).then(function(c){let d=c[0],u=c[1],h=c[2];h!==null&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(h,VT)});for(let m=0,f=u.length;m<f;m++)d.add(u[m]);return d})}_loadNodeShallow(e){let t=this.json,i=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let o=t.nodes[e],r=o.name?s.createUniqueName(o.name):"",l=[],a=s._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return a&&l.push(a),o.camera!==void 0&&l.push(s.getDependency("camera",o.camera).then(function(c){return s._getNodeRef(s.cameraCache,o.camera,c)})),s._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){l.push(c)}),this.nodeCache[e]=Promise.all(l).then(function(c){let d;if(o.isBone===!0?d=new $l:c.length>1?d=new Xi:c.length===1?d=c[0]:d=new _t,d!==c[0])for(let u=0,h=c.length;u<h;u++)d.add(c[u]);if(o.name&&(d.userData.name=o.name,d.name=r),$i(d,o),o.extensions&&go(i,d,o),o.matrix!==void 0){let u=new Ye;u.fromArray(o.matrix),d.applyMatrix4(u)}else o.translation!==void 0&&d.position.fromArray(o.translation),o.rotation!==void 0&&d.quaternion.fromArray(o.rotation),o.scale!==void 0&&d.scale.fromArray(o.scale);return s.associations.has(d)||s.associations.set(d,{}),s.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){let t=this.extensions,i=this.json.scenes[e],s=this,o=new Xi;i.name&&(o.name=s.createUniqueName(i.name)),$i(o,i),i.extensions&&go(t,o,i);let r=i.nodes||[],l=[];for(let a=0,c=r.length;a<c;a++)l.push(s.getDependency("node",r[a]));return Promise.all(l).then(function(a){for(let d=0,u=a.length;d<u;d++)o.add(a[d]);let c=d=>{let u=new Map;for(let[h,m]of s.associations)(h instanceof xn||h instanceof Pn)&&u.set(h,m);return d.traverse(h=>{let m=s.associations.get(h);m!=null&&u.set(h,m)}),u};return s.associations=c(o),o})}_createAnimationTracks(e,t,i,s,o){let r=[],l=e.name?e.name:e.uuid,a=[];Ms[o.path]===Ms.weights?e.traverse(function(h){h.morphTargetInfluences&&a.push(h.name?h.name:h.uuid)}):a.push(l);let c;switch(Ms[o.path]){case Ms.weights:c=Oi;break;case Ms.rotation:c=Qi;break;case Ms.position:case Ms.scale:c=qi;break;default:switch(i.itemSize){case 1:c=Oi;break;case 2:case 3:default:c=qi;break}break}let d=s.interpolation!==void 0?gT[s.interpolation]:Mr,u=this._getArrayFromAccessor(i);for(let h=0,m=a.length;h<m;h++){let f=new c(a[h]+"."+Ms[o.path],t.array,u,d);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(f),r.push(f)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let i=Hf(t.constructor),s=new Float32Array(t.length);for(let o=0,r=t.length;o<r;o++)s[o]=t[o]*i;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){let s=this instanceof Qi?Nf:hu;return new s(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function RT(n,e,t){let i=e.attributes,s=new An;if(i.POSITION!==void 0){let l=t.json.accessors[i.POSITION],a=l.min,c=l.max;if(a!==void 0&&c!==void 0){if(s.set(new T(a[0],a[1],a[2]),new T(c[0],c[1],c[2])),l.normalized){let d=Hf(Ur[l.componentType]);s.min.multiplyScalar(d),s.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let o=e.targets;if(o!==void 0){let l=new T,a=new T;for(let c=0,d=o.length;c<d;c++){let u=o[c];if(u.POSITION!==void 0){let h=t.json.accessors[u.POSITION],m=h.min,f=h.max;if(m!==void 0&&f!==void 0){if(a.setX(Math.max(Math.abs(m[0]),Math.abs(f[0]))),a.setY(Math.max(Math.abs(m[1]),Math.abs(f[1]))),a.setZ(Math.max(Math.abs(m[2]),Math.abs(f[2]))),h.normalized){let g=Hf(Ur[h.componentType]);a.multiplyScalar(g)}l.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(l)}n.boundingBox=s;let r=new Wn;s.getCenter(r.center),r.radius=s.min.distanceTo(s.max)/2,n.boundingSphere=r}function BX(n,e,t){let i=e.attributes,s=[];function o(r,l){return t.getDependency("accessor",r).then(function(a){n.setAttribute(l,a)})}for(let r in i){let l=wf[r]||r.toLowerCase();l in n.attributes||s.push(o(i[r],l))}if(e.indices!==void 0&&!n.index){let r=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});s.push(r)}return je.workingColorSpace!==an&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${je.workingColorSpace}" not supported.`),$i(n,e),RT(n,e,t),Promise.all(s).then(function(){return e.targets!==void 0?yT(n,e.targets,t):n})}!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(n){let e=performance.now(),t=this.getVideoPlaybackQuality(),i=this.mozPresentedFrames||this.mozPaintedFrames||t.totalVideoFrames-t.droppedVideoFrames,s=(o,r)=>{let l=this.getVideoPlaybackQuality(),a=this.mozPresentedFrames||this.mozPaintedFrames||l.totalVideoFrames-l.droppedVideoFrames;if(a>i){let c=this.mozFrameDelay||l.totalFrameDelay-t.totalFrameDelay||0,d=r-o;n(r,{presentationTime:r+1e3*c,expectedDisplayTime:r+d,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+d/1e3,presentedFrames:a,processingDuration:c}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame(c=>s(r,c))};return this._rvfcpolyfillmap[e]=requestAnimationFrame(o=>s(e,o)),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(n){cancelAnimationFrame(this._rvfcpolyfillmap[n]),delete this._rvfcpolyfillmap[n]});var Yt={Image:1,QRCode:2,Surface:3,Spatial:4},$t={WebXR:1,SLAM:2,Gyroscope:3},yn={OnDetected:1,OnPose:2,OnLost:3,OnResize:4,OnTouch:5,OnHitTestResult:6,OnKeyFrame:7,OnStatusChange:8,OnSessionEnd:9,OnFrame:10},ST={useVocabulary:!1,forceCompatWorldTracking:!1,forceRotationOnlyTracking:!1,debug:!1,cameraAccess:!1,highResolutionCamera:!1},Ar=class extends Error{constructor(e){super(e),this.name="INTERNAL_ERROR"}},bu=class extends Error{constructor(e){super(e),this.name="LICENSE_ERROR"}},kf=class extends Error{constructor(e){super(e),this.name="CAMERA_ERROR"}},Zo=class extends Error{constructor(e){super(e),this.name="SENSORS_ERROR"}},fu=class extends Error{constructor(e){super(e),this.name="RECONSTRUCTION_PENDING_ERROR"}},CT={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},zX={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Tt={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},hn={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Ts={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"},O=class n{static getFirstMatch(e,t){let i=t.match(e);return i&&i.length>0&&i[1]||""}static getSecondMatch(e,t){let i=t.match(e);return i&&i.length>1&&i[2]||""}static matchAndReturnConst(e,t,i){if(e.test(t))return i}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){let t=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){let t=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?"Cupcake":t[0]===1&&t[1]>=6?"Donut":t[0]===2&&t[1]<2?"Eclair":t[0]===2&&t[1]===2?"Froyo":t[0]===2&&t[1]>2?"Gingerbread":t[0]===3?"Honeycomb":t[0]===4&&t[1]<1?"Ice Cream Sandwich":t[0]===4&&t[1]<4?"Jelly Bean":t[0]===4&&t[1]>=4?"KitKat":t[0]===5?"Lollipop":t[0]===6?"Marshmallow":t[0]===7?"Nougat":t[0]===8?"Oreo":t[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,i=!1){let s=n.getVersionPrecision(e),o=n.getVersionPrecision(t),r=Math.max(s,o),l=0,a=n.map([e,t],c=>{let d=r-n.getVersionPrecision(c),u=c+new Array(d+1).join(".0");return n.map(u.split("."),h=>new Array(20-h.length).join("0")+h).reverse()});for(i&&(l=r-Math.min(s,o)),r-=1;r>=l;){if(a[0][r]>a[1][r])return 1;if(a[0][r]===a[1][r]){if(r===l)return 0;r-=1}else if(a[0][r]<a[1][r])return-1}}static map(e,t){let i=[],s;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(s=0;s<e.length;s+=1)i.push(t(e[s]));return i}static find(e,t){let i,s;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(i=0,s=e.length;i<s;i+=1){let o=e[i];if(t(o,i))return o}}static assign(e,...t){let i=e,s,o;if(Object.assign)return Object.assign(e,...t);for(s=0,o=t.length;s<o;s+=1){let r=t[s];typeof r=="object"&&r!==null&&Object.keys(r).forEach(l=>{i[l]=r[l]})}return e}static getBrowserAlias(e){return CT[e]}static getBrowserTypeByAlias(e){return zX[e]||""}},It=/version\/(\d+(\.?_?\d+)+)/i,WT=[{test:[/googlebot/i],describe(n){let e={name:"Googlebot"},t=O.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/opera/i],describe(n){let e={name:"Opera"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(n){let e={name:"Opera"},t=O.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(n){let e={name:"Samsung Internet for Android"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/Whale/i],describe(n){let e={name:"NAVER Whale Browser"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(n){let e={name:"MZ Browser"},t=O.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/focus/i],describe(n){let e={name:"Focus"},t=O.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/swing/i],describe(n){let e={name:"Swing"},t=O.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/coast/i],describe(n){let e={name:"Opera Coast"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(n){let e={name:"Opera Touch"},t=O.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(n){let e={name:"Yandex Browser"},t=O.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(n){let e={name:"UC Browser"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(n){let e={name:"Maxthon"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(n){let e={name:"Epiphany"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/puffin/i],describe(n){let e={name:"Puffin"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(n){let e={name:"Sleipnir"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(n){let e={name:"K-Meleon"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(n){let e={name:"WeChat"},t=O.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(n){let e={name:/qqbrowserlite/i.test(n)?"QQ Browser Lite":"QQ Browser"},t=O.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(n){let e={name:"Internet Explorer"},t=O.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(n){let e={name:"Microsoft Edge"},t=O.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(n){let e={name:"Microsoft Edge"},t=O.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(n){let e={name:"Vivaldi"},t=O.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(n){let e={name:"SeaMonkey"},t=O.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(n){let e={name:"Sailfish"},t=O.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,n);return t&&(e.version=t),e}},{test:[/silk/i],describe(n){let e={name:"Amazon Silk"},t=O.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/phantom/i],describe(n){let e={name:"PhantomJS"},t=O.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(n){let e={name:"SlimerJS"},t=O.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(n){let e={name:"BlackBerry"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(n){let e={name:"WebOS Browser"},t=O.getFirstMatch(It,n)||O.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/bada/i],describe(n){let e={name:"Bada"},t=O.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/tizen/i],describe(n){let e={name:"Tizen"},t=O.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(n){let e={name:"QupZilla"},t=O.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(n){let e={name:"Firefox"},t=O.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/electron/i],describe(n){let e={name:"Electron"},t=O.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(n){let e={name:"Miui"},t=O.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/chromium/i],describe(n){let e={name:"Chromium"},t=O.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,n)||O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(n){let e={name:"Chrome"},t=O.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/GSA/i],describe(n){let e={name:"Google Search"},t=O.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test(n){let e=!n.test(/like android/i),t=n.test(/android/i);return e&&t},describe(n){let e={name:"Android Browser"},t=O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(n){let e={name:"PlayStation 4"},t=O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(n){let e={name:"Safari"},t=O.getFirstMatch(It,n);return t&&(e.version=t),e}},{test:[/.*/i],describe(n){let e=n.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:O.getFirstMatch(e,n),version:O.getSecondMatch(e,n)}}}],xT=[{test:[/Roku\/DVP/],describe(n){let e=O.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,n);return{name:hn.Roku,version:e}}},{test:[/windows phone/i],describe(n){let e=O.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,n);return{name:hn.WindowsPhone,version:e}}},{test:[/windows /i],describe(n){let e=O.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,n),t=O.getWindowsVersionName(e);return{name:hn.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(n){let e={name:hn.iOS},t=O.getSecondMatch(/(Version\/)(\d[\d.]+)/,n);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(n){let e=O.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,n).replace(/[_\s]/g,"."),t=O.getMacOSVersionName(e),i={name:hn.MacOS,version:e};return t&&(i.versionName=t),i}},{test:[/(ipod|iphone|ipad)/i],describe(n){let e=O.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,n).replace(/[_\s]/g,".");return{name:hn.iOS,version:e}}},{test(n){let e=!n.test(/like android/i),t=n.test(/android/i);return e&&t},describe(n){let e=O.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,n),t=O.getAndroidVersionName(e),i={name:hn.Android,version:e};return t&&(i.versionName=t),i}},{test:[/(web|hpw)[o0]s/i],describe(n){let e=O.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,n),t={name:hn.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(n){let e=O.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,n)||O.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,n)||O.getFirstMatch(/\bbb(\d+)/i,n);return{name:hn.BlackBerry,version:e}}},{test:[/bada/i],describe(n){let e=O.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,n);return{name:hn.Bada,version:e}}},{test:[/tizen/i],describe(n){let e=O.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,n);return{name:hn.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:hn.Linux})},{test:[/CrOS/],describe:()=>({name:hn.ChromeOS})},{test:[/PlayStation 4/],describe(n){let e=O.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,n);return{name:hn.PlayStation4,version:e}}}],vT=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(n){let e=O.getFirstMatch(/(can-l01)/i,n)&&"Nova",t={type:Tt.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:Tt.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:Tt.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:Tt.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:Tt.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:Tt.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:Tt.tablet})},{test(n){let e=n.test(/ipod|iphone/i),t=n.test(/like (ipod|iphone)/i);return e&&!t},describe(n){let e=O.getFirstMatch(/(ipod|iphone)/i,n);return{type:Tt.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:Tt.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:Tt.mobile})},{test:n=>n.getBrowserName(!0)==="blackberry",describe:()=>({type:Tt.mobile,vendor:"BlackBerry"})},{test:n=>n.getBrowserName(!0)==="bada",describe:()=>({type:Tt.mobile})},{test:n=>n.getBrowserName()==="windows phone",describe:()=>({type:Tt.mobile,vendor:"Microsoft"})},{test(n){let e=Number(String(n.getOSVersion()).split(".")[0]);return n.getOSName(!0)==="android"&&e>=3},describe:()=>({type:Tt.tablet})},{test:n=>n.getOSName(!0)==="android",describe:()=>({type:Tt.mobile})},{test:n=>n.getOSName(!0)==="macos",describe:()=>({type:Tt.desktop,vendor:"Apple"})},{test:n=>n.getOSName(!0)==="windows",describe:()=>({type:Tt.desktop})},{test:n=>n.getOSName(!0)==="linux",describe:()=>({type:Tt.desktop})},{test:n=>n.getOSName(!0)==="playstation 4",describe:()=>({type:Tt.tv})},{test:n=>n.getOSName(!0)==="roku",describe:()=>({type:Tt.tv})}],LT=[{test:n=>n.getBrowserName(!0)==="microsoft edge",describe(n){if(/\sedg\//i.test(n))return{name:Ts.Blink};let e=O.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,n);return{name:Ts.EdgeHTML,version:e}}},{test:[/trident/i],describe(n){let e={name:Ts.Trident},t=O.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:n=>n.test(/presto/i),describe(n){let e={name:Ts.Presto},t=O.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test(n){let e=n.test(/gecko/i),t=n.test(/like gecko/i);return e&&!t},describe(n){let e={name:Ts.Gecko},t=O.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Ts.Blink})},{test:[/(apple)?webkit/i],describe(n){let e={name:Ts.WebKit},t=O.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,n);return t&&(e.version=t),e}}],gu=class{constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};let e=O.find(WT,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};let e=O.find(xT,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){let{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){let{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};let e=O.find(vT,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};let e=O.find(LT,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return O.assign({},this.parsedResult)}satisfies(e){let t={},i=0,s={},o=0;if(Object.keys(e).forEach(r=>{let l=e[r];typeof l=="string"?(s[r]=l,o+=1):typeof l=="object"&&(t[r]=l,i+=1)}),i>0){let r=Object.keys(t),l=O.find(r,c=>this.isOS(c));if(l){let c=this.satisfies(t[l]);if(c!==void 0)return c}let a=O.find(r,c=>this.isPlatform(c));if(a){let c=this.satisfies(t[a]);if(c!==void 0)return c}}if(o>0){let r=Object.keys(s),l=O.find(r,a=>this.isBrowser(a,!0));if(l!==void 0)return this.compareVersion(s[l])}}isBrowser(e,t=!1){let i=this.getBrowserName().toLowerCase(),s=e.toLowerCase(),o=O.getBrowserTypeByAlias(s);return t&&o&&(s=o.toLowerCase()),s===i}compareVersion(e){let t=[0],i=e,s=!1,o=this.getBrowserVersion();if(typeof o=="string")return e[0]===">"||e[0]==="<"?(i=e.substr(1),e[1]==="="?(s=!0,i=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?i=e.substr(1):e[0]==="~"&&(s=!0,i=e.substr(1)),t.indexOf(O.compareVersions(o,i,s))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(t=>this.is(t))}},es=class{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new gu(e,t)}static parse(e){return new gu(e).getResult()}static get BROWSER_MAP(){return zX}static get ENGINE_MAP(){return Ts}static get OS_MAP(){return hn}static get PLATFORMS_MAP(){return Tt}},yo=class n{constructor(){let e=es.getParser(window.navigator.userAgent);this.setupDeviceId(),this.setupPlatform(e),this.parseOS(e),this.parseType(e)}setupDeviceId(){this.device=localStorage.getItem("_deviceId"),this.device||(this.device="10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),localStorage.setItem("_deviceId",this.device))}setupPlatform(e){this.platform=`${e.getBrowser().name}-${e.getOS().name}`}parseOS(e){e.getOS().name===es.OS_MAP.iOS||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1?this.os=n.OS.iOS:e.getOS().name===es.OS_MAP.Android?this.os=n.OS.Android:e.getOS().name===es.OS_MAP.MacOS?this.os=n.OS.Mac:e.getOS().name===es.OS_MAP.Windows?this.os=n.OS.PC:this.os=n.OS.Other}parseType(e){e.getPlatform().type===es.PLATFORMS_MAP.tablet||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1?this.type=n.Type.Tablet:e.getPlatform().type===es.PLATFORMS_MAP.mobile?this.type=n.Type.Mobile:this.type=n.Type.Desktop}};yo.OS={Android:0,iOS:1,PC:2,Mac:3,Other:4},yo.Type={Mobile:0,Tablet:1,Desktop:2};var hi=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.x/=e,this.y/=e,this.z/=e,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){let t=this.x,i=this.y,s=this.z,o=e.x,r=e.y,l=e.z;return this.x=i*l-s*r,this.y=s*o-t*l,this.z=t*r-i*o,this}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.divideScalar(this.length()||1)}toArray(){let e=[];return e[0]=this.x,e[1]=this.y,e[2]=this.z,e}clone(){return new this.constructor(this.x,this.y,this.z)}},Ns=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,s,o,r,l,a,c){let d=this.elements;return d[0]=e,d[1]=s,d[2]=l,d[3]=t,d[4]=o,d[5]=a,d[6]=i,d[7]=r,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,r=i[0],l=i[3],a=i[6],c=i[1],d=i[4],u=i[7],h=i[2],m=i[5],f=i[8],g=s[0],b=s[3],p=s[6],R=s[1],V=s[4],I=s[7],w=s[2],W=s[5],C=s[8];return o[0]=r*g+l*R+a*w,o[3]=r*b+l*V+a*W,o[6]=r*p+l*I+a*C,o[1]=c*g+d*R+u*w,o[4]=c*b+d*V+u*W,o[7]=c*p+d*I+u*C,o[2]=h*g+m*R+f*w,o[5]=h*b+m*V+f*W,o[8]=h*p+m*I+f*C,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8];return t*r*d-t*l*c-i*o*d+i*l*a+s*o*c-s*r*a}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8],u=d*r-l*c,h=l*a-d*o,m=c*o-r*a,f=t*u+i*h+s*m;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let g=1/f;return e[0]=u*g,e[1]=(s*c-d*i)*g,e[2]=(l*i-s*r)*g,e[3]=h*g,e[4]=(d*t-s*a)*g,e[5]=(s*o-l*t)*g,e[6]=m*g,e[7]=(i*a-c*t)*g,e[8]=(r*t-i*o)*g,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,s=e.y,o=e.z,r=Math.cos(i),l=Math.sin(i),a=Math.cos(s),c=Math.sin(s),d=Math.cos(o),u=Math.sin(o);switch(e.order){case"XYZ":{let h=r*d,m=r*u,f=l*d,g=l*u;t[0]=a*d,t[3]=-a*u,t[6]=c,t[1]=m+f*c,t[4]=h-g*c,t[7]=-l*a,t[2]=g-h*c,t[5]=f+m*c,t[8]=r*a;break}case"YXZ":{let h=a*d,m=a*u,f=c*d,g=c*u;t[0]=h+g*l,t[3]=f*l-m,t[6]=r*c,t[1]=r*u,t[4]=r*d,t[7]=-l,t[2]=m*l-f,t[5]=g+h*l,t[8]=r*a;break}case"ZXY":{let h=a*d,m=a*u,f=c*d,g=c*u;t[0]=h-g*l,t[3]=-r*u,t[6]=f+m*l,t[1]=m+f*l,t[4]=r*d,t[7]=g-h*l,t[2]=-r*c,t[5]=l,t[8]=r*a;break}case"ZYX":{let h=r*d,m=r*u,f=l*d,g=l*u;t[0]=a*d,t[3]=f*c-m,t[6]=h*c+g,t[1]=a*u,t[4]=g*c+h,t[7]=m*c-f,t[2]=-c,t[5]=l*a,t[8]=r*a;break}case"YZX":{let h=r*a,m=r*c,f=l*a,g=l*c;t[0]=a*d,t[3]=g-h*u,t[6]=f*u+m,t[1]=u,t[4]=r*d,t[7]=-l*d,t[2]=-c*d,t[5]=m*u+f,t[8]=h-g*u;break}case"XZY":{let h=r*a,m=r*c,f=l*a,g=l*c;t[0]=a*d,t[3]=-u,t[6]=c*d,t[1]=h*u+g,t[4]=r*d,t[7]=m*u-f,t[2]=f*u-m,t[5]=l*d,t[8]=g*u+h;break}}return this}makeRotationFromQuaternion(e){let t=this.elements,i=e.x,s=e.y,o=e.z,r=e.w,l=i+i,a=s+s,c=o+o,d=i*l,u=i*a,h=i*c,m=s*a,f=s*c,g=o*c,b=r*l,p=r*a,R=r*c;return t[0]=1-(m+g),t[1]=u+R,t[2]=h-p,t[3]=u-R,t[4]=1-(d+g),t[5]=f+b,t[6]=h+p,t[7]=f-b,t[8]=1-(d+m),this}fromArray(e){for(let t=0;t<9;t++)this.elements[t]=e[t];return this}toArray(){let e=[],t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}clone(){return new this.constructor().fromArray(this.elements)}},Pt=class n{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,s,o,r,l,a,c,d,u,h,m,f,g,b){let p=this.elements;return p[0]=e,p[4]=t,p[8]=i,p[12]=s,p[1]=o,p[5]=r,p[9]=l,p[13]=a,p[2]=c,p[6]=d,p[10]=u,p[14]=h,p[3]=m,p[7]=f,p[11]=g,p[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,s=t.elements,o=this.elements,r=i[0],l=i[4],a=i[8],c=i[12],d=i[1],u=i[5],h=i[9],m=i[13],f=i[2],g=i[6],b=i[10],p=i[14],R=i[3],V=i[7],I=i[11],w=i[15],W=s[0],C=s[4],N=s[8],X=s[12],G=s[1],x=s[5],F=s[9],U=s[13],z=s[2],j=s[6],B=s[10],Q=s[14],J=s[3],ne=s[7],de=s[11],fe=s[15];return o[0]=r*W+l*G+a*z+c*J,o[4]=r*C+l*x+a*j+c*ne,o[8]=r*N+l*F+a*B+c*de,o[12]=r*X+l*U+a*Q+c*fe,o[1]=d*W+u*G+h*z+m*J,o[5]=d*C+u*x+h*j+m*ne,o[9]=d*N+u*F+h*B+m*de,o[13]=d*X+u*U+h*Q+m*fe,o[2]=f*W+g*G+b*z+p*J,o[6]=f*C+g*x+b*j+p*ne,o[10]=f*N+g*F+b*B+p*de,o[14]=f*X+g*U+b*Q+p*fe,o[3]=R*W+V*G+I*z+w*J,o[7]=R*C+V*x+I*j+w*ne,o[11]=R*N+V*F+I*B+w*de,o[15]=R*X+V*U+I*Q+w*fe,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],s=e[8],o=e[12],r=e[1],l=e[5],a=e[9],c=e[13],d=e[2],u=e[6],h=e[10],m=e[14];return e[3]*(+o*a*u-s*c*u-o*l*h+i*c*h+s*l*m-i*a*m)+e[7]*(+t*a*m-t*c*h+o*r*h-s*r*m+s*c*d-o*a*d)+e[11]*(+t*c*u-t*l*m-o*r*u+i*r*m+o*l*d-i*c*d)+e[15]*(-s*l*d-t*a*u+t*l*h+s*r*u-i*r*h+i*a*d)}invert(){let e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],r=e[4],l=e[5],a=e[6],c=e[7],d=e[8],u=e[9],h=e[10],m=e[11],f=e[12],g=e[13],b=e[14],p=e[15],R=u*b*c-g*h*c+g*a*m-l*b*m-u*a*p+l*h*p,V=f*h*c-d*b*c-f*a*m+r*b*m+d*a*p-r*h*p,I=d*g*c-f*u*c+f*l*m-r*g*m-d*l*p+r*u*p,w=f*u*a-d*g*a-f*l*h+r*g*h+d*l*b-r*u*b,W=t*R+i*V+s*I+o*w;if(W===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let C=1/W;return e[0]=R*C,e[1]=(g*h*o-u*b*o-g*s*m+i*b*m+u*s*p-i*h*p)*C,e[2]=(l*b*o-g*a*o+g*s*c-i*b*c-l*s*p+i*a*p)*C,e[3]=(u*a*o-l*h*o-u*s*c+i*h*c+l*s*m-i*a*m)*C,e[4]=V*C,e[5]=(d*b*o-f*h*o+f*s*m-t*b*m-d*s*p+t*h*p)*C,e[6]=(f*a*o-r*b*o-f*s*c+t*b*c+r*s*p-t*a*p)*C,e[7]=(r*h*o-d*a*o+d*s*c-t*h*c-r*s*m+t*a*m)*C,e[8]=I*C,e[9]=(f*u*o-d*g*o-f*i*m+t*g*m+d*i*p-t*u*p)*C,e[10]=(r*g*o-f*l*o+f*i*c-t*g*c-r*i*p+t*l*p)*C,e[11]=(d*l*o-r*u*o-d*i*c+t*u*c+r*i*m-t*l*m)*C,e[12]=w*C,e[13]=(d*g*s-f*u*s+f*i*h-t*g*h-d*i*b+t*u*b)*C,e[14]=(f*l*s-r*g*s-f*i*a+t*g*a+r*i*b-t*l*b)*C,e[15]=(r*u*s-d*l*s+d*i*a-t*u*a-r*i*h+t*l*h)*C,this}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e){let t=this.elements;return t[3]=e.x,t[7]=e.y,t[11]=e.z,this}setRotation(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[4]=i[3],t[5]=i[4],t[6]=i[5],t[8]=i[6],t[9]=i[7],t[10]=i[8],this}extractPosition(){let e=this.elements;return new hi(e[12],e[13],e[14])}extractRotation(){let e=this.elements;return new Ns().set(e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10])}lookAt(e,t,i){let s=this.elements,o=e.clone().sub(t);o.length()===0&&(o.z=1),o.normalize();let r=i.clone().cross(o);r.length()===0&&(Math.abs(i.z)===1?o.x+=1e-4:o.z+=1e-4,o.normalize(),r=i.clone().cross(o)),r.normalize();let l=o.clone().cross(r);return s[0]=r.x,s[4]=l.x,s[8]=o.x,s[1]=r.y,s[5]=l.y,s[9]=o.y,s[2]=r.z,s[6]=l.z,s[10]=o.z,this}fromArray(e){for(let t=0;t<16;t++)this.elements[t]=e[t];return this}toArray(){let e=[],t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}clone(){return new n().fromArray(this.elements)}},la=class{constructor(e=0,t=0){this.x=e,this.y=t}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.x/=e,this.y/=e,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}clone(){return new this.constructor(this.x,this.y)}};function Jr(n,e,t){return Math.max(e,Math.min(t,n))}function mu(n){return .01745329252*n}function DX(n){return 57.2957795131*n}var Zu=class{constructor(e=0,t=0,i=0,s="XYZ"){this.x=e,this.y=t,this.z=i,this.order=s}setFromQuaternion(e,t){let i=new Ns().makeRotationFromQuaternion(e);return this.setFromRotationMatrix(i,t)}setFromRotationMatrix(e,t){let i=e.elements,s=i[0],o=i[3],r=i[6],l=i[1],a=i[4],c=i[7],d=i[2],u=i[5],h=i[8];switch(t=t||this.order){case"XYZ":this.y=Math.asin(Jr(r,-1,1)),Math.abs(r)<.9999999?(this.x=Math.atan2(-c,h),this.z=Math.atan2(-o,s)):(this.x=Math.atan2(u,a),this.z=0);break;case"YXZ":this.x=Math.asin(-Jr(c,-1,1)),Math.abs(c)<.9999999?(this.y=Math.atan2(r,h),this.z=Math.atan2(l,a)):(this.y=Math.atan2(-d,s),this.z=0);break;case"ZXY":this.x=Math.asin(Jr(u,-1,1)),Math.abs(u)<.9999999?(this.y=Math.atan2(-d,h),this.z=Math.atan2(-o,a)):(this.y=0,this.z=Math.atan2(l,s));break;case"ZYX":this.y=Math.asin(-Jr(d,-1,1)),Math.abs(d)<.9999999?(this.x=Math.atan2(u,h),this.z=Math.atan2(l,s)):(this.x=0,this.z=Math.atan2(-o,a));break;case"YZX":this.z=Math.asin(Jr(l,-1,1)),Math.abs(l)<.9999999?(this.x=Math.atan2(-c,a),this.y=Math.atan2(-d,s)):(this.x=0,this.y=Math.atan2(r,h));break;case"XZY":this.z=Math.asin(-Jr(o,-1,1)),Math.abs(o)<.9999999?(this.x=Math.atan2(u,a),this.y=Math.atan2(r,s)):(this.x=Math.atan2(-c,h),this.y=0)}return this.order=t,this}clone(){return new this.constructor(this.x,this.y,this.z,this.order)}},Ys=class{constructor(e=0,t=0,i=0,s=1){this.x=e,this.y=t,this.z=i,this.w=s}setFromEuler(e){let t=e.x,i=e.y,s=e.z,o=e.order,r=Math.cos,l=Math.sin,a=r(t/2),c=r(i/2),d=r(s/2),u=l(t/2),h=l(i/2),m=l(s/2);switch(o){case"XYZ":this.x=u*c*d+a*h*m,this.y=a*h*d-u*c*m,this.z=a*c*m+u*h*d,this.w=a*c*d-u*h*m;break;case"YXZ":this.x=u*c*d+a*h*m,this.y=a*h*d-u*c*m,this.z=a*c*m-u*h*d,this.w=a*c*d+u*h*m;break;case"ZXY":this.x=u*c*d-a*h*m,this.y=a*h*d+u*c*m,this.z=a*c*m+u*h*d,this.w=a*c*d-u*h*m;break;case"ZYX":this.x=u*c*d-a*h*m,this.y=a*h*d+u*c*m,this.z=a*c*m-u*h*d,this.w=a*c*d+u*h*m;break;case"YZX":this.x=u*c*d+a*h*m,this.y=a*h*d+u*c*m,this.z=a*c*m-u*h*d,this.w=a*c*d-u*h*m;break;case"XZY":this.x=u*c*d-a*h*m,this.y=a*h*d-u*c*m,this.z=a*c*m+u*h*d,this.w=a*c*d+u*h*m}return this}setFromAxisAngle(e,t){let i=t/2,s=Math.sin(i);return this.x=e.x*s,this.y=e.y*s,this.z=e.z*s,this.w=Math.cos(i),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],s=t[4],o=t[8],r=t[1],l=t[5],a=t[9],c=t[2],d=t[6],u=t[10],h=i+l+u;if(h>0){let m=.5/Math.sqrt(h+1);this.w=.25/m,this.x=(d-a)*m,this.y=(o-c)*m,this.z=(r-s)*m}else if(i>l&&i>u){let m=2*Math.sqrt(1+i-l-u);this.w=(d-a)/m,this.x=.25*m,this.y=(s+r)/m,this.z=(o+c)/m}else if(l>u){let m=2*Math.sqrt(1+l-i-u);this.w=(o-c)/m,this.x=(s+r)/m,this.y=.25*m,this.z=(a+d)/m}else{let m=2*Math.sqrt(1+u-i-l);this.w=(r-s)/m,this.x=(o+c)/m,this.y=(a+d)/m,this.z=.25*m}return this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e.x,s=e.y,o=e.z,r=e.w,l=t.x,a=t.y,c=t.z,d=t.w;return this.x=i*d+r*l+s*c-o*a,this.y=s*d+r*a+o*l-i*c,this.z=o*d+r*c+i*a-s*l,this.w=r*d-i*l-s*a-o*c,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}},pu=new Pt().set(0,1,0,0,-1,0,0,0,0,0,1,0,0,0,0,1),MT=new Pt().set(0,-1,0,0,1,0,0,0,0,0,1,0,0,0,0,1),EX=new Pt().set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),TT=new Ns().set(1,0,0,0,0,1,0,-1,0),YT=new Ns().set(0,-1,0,1,0,0,0,0,1),Uf=class{constructor(e,t,i,s){this.uiManager=e,this.deviceManager=t,this.workerManager=i,this.indexedDBManager=s}init(e,t){return lt(this,null,function*(){try{let i;try{i=yield getFileFromIndexedDB("SDK_1.6.5")}catch{i=yield(yield fetch(new URL("./onirix_native_sdk.js",import.meta.url).href)).text(),yield this.indexedDBManager.saveFileToIndexedDB("SDK_1.6.5",i)}let s=URL.createObjectURL(new Blob([i],{type:"text/javascript"})),{default:o}=yield import(s),r,l,a;if(this.useVocabulary=t.useVocabulary,this.host=t.host??"https://studio.onirix.com",this.useVocabulary&&(r=yield this.indexedDBManager.getFromCacheOrFetch("orb.fbow","https://sdk.onirix.com/common/orb.fbow")),t.mode===Yt.Spatial){if(l=yield fetch(`${this.host}/api/projects/self/targets/${t.sceneOid}/osf?token=${e}`),!l.ok)throw new fu(`Could not get Onirix Spatial File. Server responded with ${l.status}`);let c=yield l.arrayBuffer();a=new Uint8Array(c),yield this.workerManager.createWorkers()}this.nativeSDK=yield o({preRun:c=>{t.mode==Yt.Spatial?c.FS_createDataFile("/","scene.osf",a,!0,!0,!0):t.mode===Yt.Image?(this.useVocabulary&&c.FS_createDataFile("/","orb.fbow",r,!0,!0,!0),c.FS_createPreloadedFile("/","classifier.otf",`${this.host}/api/projects/self/targets/otf?token=${e}`,!0,!1)):t.mode===Yt.Surface&&this.useVocabulary&&c.FS_createDataFile("/","orb.fbow",r,!0,!0,!0)}}),this.buffer=this.nativeSDK._malloc(1228800),this.imageBuffer=this.nativeSDK._malloc(1228800),this.imuAccData=this.nativeSDK._malloc(32),this.imuRotData=this.nativeSDK._malloc(72),this.cameraParamsStruct=this.nativeSDK._malloc(40),this.frameLayoutStruct=this.nativeSDK._malloc(28),this.nativeSDK.HEAPU32[this.cameraParamsStruct/4+0]=640,this.nativeSDK.HEAPU32[this.cameraParamsStruct/4+1]=480,this.nativeSDK.HEAPF64[this.cameraParamsStruct/8+1]=468,this.nativeSDK.HEAPF64[this.cameraParamsStruct/8+2]=468,this.nativeSDK.HEAPF64[this.cameraParamsStruct/8+3]=320,this.nativeSDK.HEAPF64[this.cameraParamsStruct/8+4]=240,t.debug&&this.nativeSDK._OX_SetLogCallback(this.nativeSDK.addFunction(c=>{console.log(this.nativeSDK.UTF8ToString(c))},"vi"))}catch(i){throw i instanceof fu?i:new Ar(i)}yield this.checkLicense(e)})}checkLicense(e){return lt(this,null,function*(){try{let t=this.getStringBuffer(this.host),i=this.getStringBuffer(e),s=this.getStringBuffer(window.location.hostname),o=this.getStringBuffer(this.deviceManager.platform),r=this.getStringBuffer(this.deviceManager.device),l=yield new Promise((a,c)=>{this.nativeSDK._OX_SetLicense([t],[i],[s],[o],[r],this.nativeSDK.addFunction(d=>a(d),"vi"))});if(this.releaseStringBuffer(t),this.releaseStringBuffer(i),this.releaseStringBuffer(s),this.releaseStringBuffer(o),this.releaseStringBuffer(r),!l)throw new bu("Invalid license")}catch(t){throw new bu(t)}})}startImageTracking(e,t,i){if(this.onDetected=e,this.onPose=t,this.onLost=i,this.useVocabulary){let o=this.getStringBuffer("orb.fbow");this.nativeSDK._OX_Initialize(this.cameraParamsStruct,[o]),this.releaseStringBuffer(o)}else this.nativeSDK._OX_Initialize(this.cameraParamsStruct,"");let s=this.getStringBuffer("classifier.otf");this.nativeSDK._OX_LoadImageClassifier([s]),this.releaseStringBuffer(s),this.nativeSDK._OX_StartImageDetection(2,this.nativeSDK.addFunction(o=>this.onDetected(this.nativeSDK.UTF8ToString(o)),"vi"),this.nativeSDK.addFunction(o=>{let r=this.nativeSDK.HEAPF64.subarray(o/8,o/8+16),l=new Pt().fromArray(r);l.multiply(EX),l.invert(),this.uiManager.isPortrait()?(l.multiply(pu),this.onPose(l.toArray())):this.onPose(l.toArray())},"vi"),this.nativeSDK.addFunction(o=>this.onLost(this.nativeSDK.UTF8ToString(o)),"vi"))}startQRCodeTracking(e,t,i){this.onDetected=e,this.onPose=t,this.onLost=i,this.nativeSDK._OX_Initialize(this.cameraParamsStruct,""),this.nativeSDK._OX_StartQRCodeDetection(2,this.nativeSDK.addFunction(s=>this.onDetected(this.nativeSDK.UTF8ToString(s)),"vi"),this.nativeSDK.addFunction(s=>{let o=this.nativeSDK.HEAPF64.subarray(s/8,s/8+16),r=new Pt().fromArray(o);r.multiply(EX),r.invert(),this.uiManager.isPortrait()?(r.multiply(pu),this.onPose(r.toArray())):this.onPose(r.toArray())},"vi"),this.nativeSDK.addFunction(s=>this.onLost(this.nativeSDK.UTF8ToString(s)),"vi"))}startSLAM(e,t,i){if(this.onPose=e,this.onKeyFrame=t,this.onStatusChange=i,this.useVocabulary){let s=this.getStringBuffer("orb.fbow");this.nativeSDK._OX_Initialize(this.cameraParamsStruct,[s]),this.releaseStringBuffer(s)}else this.nativeSDK._OX_Initialize(this.cameraParamsStruct,"");this.nativeSDK._OX_StartSLAM(this.nativeSDK.addFunction(s=>{let o=this.nativeSDK.HEAPF64.subarray(s/8,s/8+16),r=new Pt().fromArray(o);r.invert(),this.uiManager.isPortrait()?(r.multiply(pu),this.onPose(r.toArray())):this.onPose(r.toArray())},"vi"),this.onKeyFrame!=null?this.nativeSDK.addFunction(()=>this.onKeyFrame(),"v"):null,this.nativeSDK.addFunction((s,o)=>{this.onStatusChange([this.nativeSDK.UTF8ToString(s),this.nativeSDK.UTF8ToString(o)])},"vii"))}xrRelocation(e){if(this.lastXrPose){let t=new Pt().fromArray(this.lastXrPose),i=new Pt().fromArray(e.elements);this.xrTransform=i.multiply(t.invert())}}slamRelocation(e){if(this.lastSlamPose){let t=new Pt().fromArray(this.lastSlamPose),i=new Pt().fromArray(e.elements);this.slamTransform=i.multiply(t.invert())}}startSpatialTracking(e,t,i){this.onDetected=e,i||(this.onPose=t),this.nativeSDK._OX_Initialize(this.cameraParamsStruct,""),this.nativeSDK._OX_StartSpatialTracking(this.nativeSDK.addFunction(o=>{i||(this.spatialLocated=!0),this.onDetected("")},"vi"),this.nativeSDK.addFunction(o=>{let r=this.nativeSDK.HEAPF64.subarray(o/8,o/8+16),l=new Pt().fromArray(r);l.invert(),this.uiManager.isPortrait()&&l.multiply(i?MT:pu),i?(this.xrRelocation(l),this.onDetected("")):this.onPose(l.toArray())},"vi"),!i);let s=this.getStringBuffer("scene.osf");this.nativeSDK._OX_LoadOSF(s),this.releaseStringBuffer(s)}processFrame(e,t=null,i=480,s=640,o=0,r=0){let l=t||this.buffer;this.nativeSDK.HEAPU8.set(e,l),this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+0]=s,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+1]=i,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+2]=4*s,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+3]=!1,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+4]=5,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+5]=r,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+6]=o,this.nativeSDK._OX_ProcessFrame(l,this.frameLayoutStruct)}loadExtractionData(e,t=-1){return this.siftBuffer&&this.netvladBuffer?(this.nativeSDK.HEAPF32.set(e.extraction,this.siftBuffer/4),this.nativeSDK.HEAPF32.set(e.descriptor,this.netvladBuffer/4),this.nativeSDK._OX_LoadExtractionData(this.siftBuffer,this.netvladBuffer,t)):0}getCandidateData(e){let t=this.nativeSDK._OX_GetCandidateData(e),i=[];for(let s=0;s<55e4;s++)i.push(this.nativeSDK.HEAPF32[t/4+s]);return new Float32Array(i)}loadMatch(e){this.matchBuffer&&(this.nativeSDK.HEAPF32.set(e,this.matchBuffer/4),this.nativeSDK._OX_LoadMatch(this.matchBuffer))}spatialLocate(){this.nativeSDK._OX_SpatialLocate()}loadKeyframePose(e){this.nativeSDK._OX_LoadKfPose(e)}numSLAMKeyframes(){return this.nativeSDK._OX_GetSLAMNumKfs()}getSLAMKeyframe(e){let t=this.nativeSDK._OX_GetSLAMKf(e),i=[];for(let s=0;s<1228800;s++)i.push(this.nativeSDK.HEAPU8[t+s]);return new Uint8Array(i)}stopImageTracking(){this.nativeSDK._OX_StopImageDetection()}stopQRCodeTracking(){this.nativeSDK._OX_StopQRCodeDetection()}stopSLAM(){this.nativeSDK._OX_StopSLAM()}stopSLAM(){this.nativeSDK._OX_StopSLAM()}addImage(e,t){this.nativeSDK.HEAPU8.set(t,this.imageBuffer),this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+0]=640,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+1]=480,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+2]=2560,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+3]=!1,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+4]=5,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+5]=0,this.nativeSDK.HEAPU32[this.frameLayoutStruct/4+6]=0;let i=this.getStringBuffer(e);this.nativeSDK._OX_AddImage([i],this.imageBuffer,this.frameLayoutStruct),this.releaseStringBuffer(i)}destroy(){this.nativeSDK._OX_Destroy()}extractionType(){return this.nativeSDK._OX_ExtractionType()}getStringBuffer(e){let t=this.nativeSDK.lengthBytesUTF8(e)+1,i=this.nativeSDK._malloc(t);return this.nativeSDK.stringToUTF8(e,i,t),i}releaseStringBuffer(e){this.nativeSDK._free(e)}getSLAMMap(){let e=this.nativeSDK.UTF8ToString(this.nativeSDK._OX_GetSLAMMap()),t;try{t=JSON.parse(e)}catch{console.error(`Could not parse ${e}`)}return t}getSLAMTrackingPoints(){let e=this.nativeSDK.UTF8ToString(this.nativeSDK._OX_GetSLAMTrackingPoints()),t;try{t=JSON.parse(e)}catch{console.error(`Could not parse ${e}`)}return t}raycast(e,t,i,s,o,r){let l=this.nativeSDK.UTF8ToString(this.nativeSDK._OX_Raycast(e,t,i,s,o,r)),a;try{a=JSON.parse(l)}catch{console.error(`Could not parse ${l}`)}return a}},Jf=class{constructor(){this.onFocus=this.onFocus.bind(this)}createRenderCanvas(){this.renderCanvas=document.createElement("canvas"),this.renderCanvas.id="renderer",this.renderCanvas.style.position="absolute",document.body.prepend(this.renderCanvas),this.addTouchListeners()}setRenderCanvas(e){this.renderCanvas=e,this.addTouchListeners()}addTouchListeners(){this.renderCanvas.addEventListener("click",e=>{this.onCanvasTouch(e)}),this.renderCanvas.addEventListener("touchstart",e=>{this.onCanvasTouchStart(e)}),this.renderCanvas.addEventListener("touchmove",e=>{this.onCanvasTouchMove(e)}),this.renderCanvas.addEventListener("touchend",e=>{this.onCanvasTouchEnd(e)})}removeRenderCanvas(){this.renderCanvas&&(this.renderCanvas.remove(),this.renderCanvas=null)}createVideoElement(e,t,i){let s=document.createElement("video");s.setAttribute("playsinline","true"),s.setAttribute("autoplay","true"),s.setAttribute("muted",""),this.videoCanvas=document.createElement("canvas"),this.videoCanvas.width=t,this.videoCanvas.height=i,this.videoContext=this.videoCanvas.getContext("2d"),s.srcObject=e,document.body.appendChild(s),this.videoElement=s;let o=this.videoElement.srcObject.getVideoTracks()[0].getSettings();this.videoSizeHorizontal=[Math.max(o.width,o.height),Math.min(o.width,o.height)],this.videoSizeVertical=[Math.min(o.width,o.height),Math.max(o.width,o.height)],window.addEventListener("focus",this.onFocus)}onFocus(){this.videoElement.play()}removeVideoElement(){this.videoElement&&(window.removeEventListener("focus",this.onFocus),this.videoElement.remove(),this.videoElement=null)}fitVideoToScreen(){this.videoSize=window.innerWidth>window.innerHeight?this.videoSizeHorizontal:this.videoSizeVertical;let e=[],t=[];this.videoSize[0]/this.videoSize[1]>window.innerWidth/window.innerHeight?(t=[Math.floor(this.videoSize[0]*(window.innerHeight/this.videoSize[1])),window.innerHeight],e=[-(t[0]-window.innerWidth)/2,0]):(t=[window.innerWidth,Math.floor(this.videoSize[1]*(window.innerWidth/this.videoSize[0]))],e=[0,-(t[1]-window.innerHeight)/2]),document.body.style.setProperty("overflow","hidden"),this.videoElement.width=t[0],this.videoElement.height=t[1],this.videoElement.style.setProperty("position","absolute"),this.videoElement.style.setProperty("z-index","-1"),this.videoElement.style.setProperty("width",`${t[0]}px`),this.videoElement.style.setProperty("height",`${t[1]}px`),this.videoElement.style.setProperty("left",`${e[0]}px`),this.videoElement.style.setProperty("top",`${e[1]}px`),this.videoElement.style.setProperty("touch-action","none"),this.renderCanvas.width=t[0],this.renderCanvas.height=t[1],this.renderCanvas.style.setProperty("position","absolute","important"),this.renderCanvas.style.setProperty("width",`${t[0]}px`,"important"),this.renderCanvas.style.setProperty("height",`${t[1]}px`,"important"),this.renderCanvas.style.setProperty("left",`${e[0]}px`,"important"),this.renderCanvas.style.setProperty("top",`${e[1]}px`,"important"),this.renderCanvas.style.setProperty("touch-action","none","important")}displayPermissionsDialog(e){return lt(this,null,function*(){return new Promise((t,i)=>{let s,o,r,l;s=document.createElement("div"),s.id="ox-permissions-dialog",s.style.setProperty("position","fixed"),s.style.setProperty("z-index","999999"),s.style.setProperty("max-width","360px"),s.style.setProperty("width","calc(100% - 140px"),s.style.setProperty("left","50vw"),s.style.setProperty("top","50vh"),s.style.setProperty("transform","translate(-50%, -50%)"),s.style.setProperty("background-color","#FFFFFF"),s.style.setProperty("border-radius","10px"),s.style.setProperty("font-family","'Open Sans', Arial, sans-serif"),s.style.setProperty("text-align","center"),s.style.setProperty("padding","30px"),document.body.appendChild(s),o=document.createElement("h1"),o.id="ox-permissions-dialog-title",o.innerText="Access to motion sensors required",o.style.setProperty("font-size","20px"),s.appendChild(o),r=document.createElement("span"),r.id="ox-permissions-dialog-message",r.innerText="This augmented reality experience requires access to your phone motion sensors. The browser may ask you for permissions.",r.style.setProperty("display","block"),r.style.setProperty("padding","10px 0"),s.appendChild(r),l=document.createElement("button"),l.id="ox-permissions-dialog-ok-button",l.innerText="Okay!",l.style.setProperty("display","block"),l.style.setProperty("margin","auto"),l.style.setProperty("background","#000000"),l.style.setProperty("color","#FFFFFF"),l.style.setProperty("border","none"),l.style.setProperty("border-radius","12px"),l.style.setProperty("padding","20px 0"),l.style.setProperty("width","100%"),l.style.setProperty("font-size","18px"),l.style.setProperty("font-weight","bold"),l.style.setProperty("margin-top","20px"),l.style.setProperty("background-image","linear-gradient(to left, #f6414b, #ee0979)"),s.appendChild(l),l.addEventListener("click",a=>lt(null,null,function*(){a.stopPropagation(),s.remove();try{yield e(),t()}catch(c){i(c)}}))})})}getVideoData(){let e;if(this.videoElement){if(this.isPortrait()){let[i,s]=this.videoSizeVertical;var t=Math.PI/2;this.videoContext.translate(480,0),this.videoContext.rotate(t),this.videoContext.drawImage(this.videoElement,0,0,s,s,0,-160,640,640),this.videoContext.rotate(-t),this.videoContext.translate(-480,0)}else this.videoContext.drawImage(this.videoElement,0,0,640,480);e=this.videoContext.getImageData(0,0,640,480).data}return e}getVideoElement(){return this.videoElement}getCameraParameters(){let e=640,t=480;return this.isPortrait()||([e,t]=[t,e]),{fov:DX(2*Math.atan(e/936)),aspect:t/e}}isPortrait(){return window.innerWidth<window.innerHeight}setTouchListener(e){this.onTouch=e}setTouchStartListener(e){this.onTouchStart=e}setTouchMoveListener(e){this.onTouchMove=e}setTouchEndListener(e){this.onTouchEnd=e}getNormalizedTouchCoords(e){let t=new la,i=this.renderCanvas.getBoundingClientRect();return e.clientX!=null?(t.x=(e.clientX-i.left)/i.width*2-1,t.y=-(e.clientY-i.top)/i.height*2+1):e.touches[0]?(t.x=e.touches[0].clientX/window.innerWidth*2-1,t.y=-e.touches[0].clientY/window.innerHeight*2+1):(t.x=e.changedTouches[0].clientX/window.innerWidth*2-1,t.y=-e.changedTouches[0].clientY/window.innerHeight*2+1),t}onCanvasTouch(e){let t=this.getNormalizedTouchCoords(e);this.onTouch&&this.onTouch(t)}onCanvasTouchStart(e){let t=this.getNormalizedTouchCoords(e);this.onTouchStart&&this.onTouchStart(t)}onCanvasTouchMove(e){let t=this.getNormalizedTouchCoords(e);this.onTouchMove&&this.onTouchMove(t)}onCanvasTouchEnd(e){let t=this.getNormalizedTouchCoords(e);this.onTouchEnd&&this.onTouchEnd(t)}},Af=class{constructor(e){this.uiManager=e}startCamera(e){return lt(this,null,function*(){try{let t=yield navigator.mediaDevices.enumerateDevices();t=t.filter(a=>!a.label.includes("Telephoto")),t=t.filter(a=>!a.label.includes("Wide"));let i,s=t[t.length-1];t.forEach(a=>{a.kind==="videoinput"&&(s=a)}),i=e?{facingMode:{exact:"environment"},width:{min:640,ideal:1280,max:1280},height:{min:480,ideal:960,max:960},aspectRatio:{exact:640/480}}:{facingMode:"environment",width:640,height:480},s&&s.deviceId&&s.deviceId!==""&&(i.deviceId={exact:s.deviceId});let o=yield navigator.mediaDevices.getUserMedia({video:i,audio:!1}),{width:r,height:l}=o.getTracks()[0].getSettings();this.stream=o,this.uiManager.createVideoElement(this.stream,r,l)}catch(t){throw new kf(t)}})}stopCamera(){this.stream&&(this.stream.getTracks().forEach(e=>{e.stop()}),this.uiManager.removeVideoElement())}},Ff=class{constructor(e,t){this.uiManager=e,this.deviceManager=t,this.started=!1}init(e,t,i){return lt(this,null,function*(){this.onRotation=e,this.onAcceleration=t,this.onEmulatedHitTest=i;let s=()=>lt(this,null,function*(){if(this.onDeviceOrientationChange=this.onDeviceOrientationChange.bind(this),this.onDeviceMotionChange=this.onDeviceMotionChange.bind(this),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"){let o;try{o=yield window.DeviceOrientationEvent.requestPermission()}catch{throw new Zo("DeviceOrientation API is not supported")}if(o!="granted")throw new Zo("DeviceOrientation permissions were rejected");try{o=yield window.DeviceMotionEvent.requestPermission()}catch{throw new Zo("DeviceMotion API is not supported")}if(o!="granted")throw new Zo("DeviceMotion permissions were rejected");window.addEventListener("deviceorientation",this.onDeviceOrientationChange),window.addEventListener("devicemotion",this.onDeviceMotionChange)}else window.addEventListener("deviceorientation",this.onDeviceOrientationChange),window.addEventListener("devicemotion",this.onDeviceMotionChange)});this.deviceManager.os===yo.OS.iOS?yield this.uiManager.displayPermissionsDialog(s):yield s()})}start(){this.started=!0}stop(){this.started=!1}destroy(){this.stop(),window.removeEventListener("deviceorientation",this.onDeviceOrientationChange),window.removeEventListener("devicemotion",this.onDeviceMotionChange)}onDeviceMotionChange(e){this.started&&e.acceleration&&e.acceleration.x&&e.acceleration.y&&e.acceleration.z&&(this.acceleration=new hi(e.acceleration.x,e.acceleration.y,e.acceleration.z),this.onAcceleration(this.acceleration))}onDeviceOrientationChange(e){if(this.started&&e.alpha&&e.beta&&e.gamma){let t=mu(e.alpha),i=mu(e.beta),s=mu(e.gamma),o=new Zu(i,t,-s,"YXZ"),r=new Ns().makeRotationFromEuler(o);r.multiply(TT);let l=mu(window.orientation||0);if(l!==0&&r.multiply(new Ns().makeRotationFromQuaternion(new Ys().setFromAxisAngle(new hi(0,0,1),-l))),this.rotation=r,this.onRotation(this.rotation),this.onEmulatedHitTest){let a=this.emulatedHitTest();this.onEmulatedHitTest(a)}}}emulatedHitTest(){let e=new hi(0,0,0),t=new hi(-this.rotation.elements[6],-this.rotation.elements[7],-this.rotation.elements[8]),i=new hi(0,1,0),s=new hi(0,-1,0),o=t.dot(i);if(Math.abs(o)>1e-6){let r=s.sub(e).dot(i)/o,l=e.add(t.multiplyScalar(r)),a=new Pt().lookAt(new hi(0,-1,0),l,new hi(0,1,0));return{position:l,rotation:new Ys().setFromRotationMatrix(a)}}return null}},yu=class{constructor(e,t,i,s,o,r,l=5){this.data=e,this.width=t,this.height=i,this.rotate=s,this.flip=o,this.colorSpace=l,this.dtype=r}},Iu=class{constructor(e,t,i,s){this.idx=e,this.from=t,this.to=i,this.dtype=s}},Bf=class{constructor(){this.workers={},this.callbacks={}}workerExists(e){return this.workers[e]!==void 0&&this.callbacks[e]!==void 0}createExtractionWorker(e,t){if(!this.workerExists(e)){let i=atob("Y2xhc3MgSW5kZXhlZERCTWFuYWdlcntjb25zdHJ1Y3RvcihlLHIpe3RoaXMuZGJOYW1lPWUsdGhpcy5zdG9yZU5hbWU9cjt9YXN5bmMgZ2V0RnJvbUNhY2hlT3JGZXRjaChlLHIpe2xldCB0PW51bGw7dHJ5e3Q9YXdhaXQgdGhpcy5nZXRGaWxlRnJvbUluZGV4ZWREQihlKTt9Y2F0Y2goZSl7Y29uc29sZS5sb2coIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgZWxlbWVudCBmcm9tIGluZGV4ZWREQi4iKTt9cmV0dXJuIHR8fCh0PWF3YWl0IHRoaXMuZmV0Y2hBbmRDYWNoZUZpbGUocixlKSksbmV3IFVpbnQ4QXJyYXkodCl9YXN5bmMgZ2V0RmlsZUZyb21JbmRleGVkREIoZSl7cmV0dXJuIG5ldyBQcm9taXNlKCgocix0KT0+e2NvbnN0IG89aW5kZXhlZERCLm9wZW4odGhpcy5kYk5hbWUpO28ub25lcnJvcj0oKT0+dChvLmVycm9yKSxvLm9uc3VjY2Vzcz0oKT0+e2NvbnN0IHM9by5yZXN1bHQudHJhbnNhY3Rpb24odGhpcy5zdG9yZU5hbWUsInJlYWRvbmx5Iikub2JqZWN0U3RvcmUodGhpcy5zdG9yZU5hbWUpLmdldChlKTtzLm9uc3VjY2Vzcz0oKT0+cihzLnJlc3VsdCkscy5vbmVycm9yPSgpPT50KHMuZXJyb3IpO30sby5vbnVwZ3JhZGVuZWVkZWQ9ZT0+e2UudGFyZ2V0LnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZSh0aGlzLnN0b3JlTmFtZSk7fTt9KSl9YXN5bmMgc2F2ZUZpbGVUb0luZGV4ZWREQihlLHIpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsbyk9Pntjb25zdCBzPWluZGV4ZWREQi5vcGVuKHRoaXMuZGJOYW1lKTtzLm9uZXJyb3I9KCk9Pm8ocy5lcnJvcikscy5vbnVwZ3JhZGVuZWVkZWQ9ZT0+e2UudGFyZ2V0LnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZSh0aGlzLnN0b3JlTmFtZSk7fSxzLm9uc3VjY2Vzcz0oKT0+e3RyeXtjb25zdCBuPXMucmVzdWx0LnRyYW5zYWN0aW9uKHRoaXMuc3RvcmVOYW1lLCJyZWFkd3JpdGUiKSxhPW4ub2JqZWN0U3RvcmUodGhpcy5zdG9yZU5hbWUpLnB1dChyLGUpO2Eub25zdWNjZXNzPSgpPT50KGEucmVzdWx0KSxhLm9uZXJyb3I9KCk9Pm8oYS5lcnJvcik7fWNhdGNoKGUpe28oZSk7fX07fSkpfWFzeW5jIGZldGNoQW5kQ2FjaGVGaWxlKGUscil7Y29uc3QgdD1hd2FpdCBmZXRjaChlKSxvPWF3YWl0IHQuYXJyYXlCdWZmZXIoKTtyZXR1cm4gYXdhaXQgdGhpcy5zYXZlRmlsZVRvSW5kZXhlZERCKHIsbyksb319Cgp2YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTsKCmZ1bmN0aW9uIGdldERlZmF1bHRFeHBvcnRGcm9tQ2pzICh4KSB7CglyZXR1cm4geCAmJiB4Ll9fZXNNb2R1bGUgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdkZWZhdWx0JykgPyB4WydkZWZhdWx0J10gOiB4Owp9Cgp2YXIgb3J0X21pbiA9IHtleHBvcnRzOiB7fX07CgpvcnRfbWluLmV4cG9ydHM7KGZ1bmN0aW9uKG1vZHVsZSxleHBvcnRzKXt2YXIgdDt0PSgpPT4oKCk9Pnt2YXIgX193ZWJwYWNrX21vZHVsZXNfXz17NTcxNjooZSx0LG4pPT57dC5SPXZvaWQgMDtjb25zdCByPW4oNjAyNyksbz1uKDE3MjMpO3QuUj1uZXcgY2xhc3N7YXN5bmMgaW5pdCgpe31hc3luYyBjcmVhdGVTZXNzaW9uSGFuZGxlcihlLHQpe2NvbnN0IG49bmV3IHIuU2Vzc2lvbih0KTtyZXR1cm4gYXdhaXQgbi5sb2FkTW9kZWwoZSksbmV3IG8uT25ueGpzU2Vzc2lvbkhhbmRsZXIobil9fTt9LDI4MTg6KGUsdCxuKT0+e3QuYzg9dC5yWD12b2lkIDA7Y29uc3Qgcj1uKDIyMzUpLG89big1MzgxKSxpPW4oOTU0NCkscz1uKDY2NDApO3Quclg9KCk9PntpZigoIm51bWJlciIhPXR5cGVvZiByLmVudi53YXNtLmluaXRUaW1lb3V0fHxyLmVudi53YXNtLmluaXRUaW1lb3V0PDApJiYoci5lbnYud2FzbS5pbml0VGltZW91dD0wKSwiYm9vbGVhbiIhPXR5cGVvZiByLmVudi53YXNtLnNpbWQmJihyLmVudi53YXNtLnNpbWQ9ITApLCJib29sZWFuIiE9dHlwZW9mIHIuZW52Lndhc20ucHJveHkmJihyLmVudi53YXNtLnByb3h5PSExKSwibnVtYmVyIiE9dHlwZW9mIHIuZW52Lndhc20ubnVtVGhyZWFkc3x8IU51bWJlci5pc0ludGVnZXIoci5lbnYud2FzbS5udW1UaHJlYWRzKXx8ci5lbnYud2FzbS5udW1UaHJlYWRzPD0wKXtjb25zdCBlPSJ1bmRlZmluZWQiPT10eXBlb2YgbmF2aWdhdG9yPygwLCBvLmNwdXMpKCkubGVuZ3RoOm5hdmlnYXRvci5oYXJkd2FyZUNvbmN1cnJlbmN5O3IuZW52Lndhc20ubnVtVGhyZWFkcz1NYXRoLm1pbig0LE1hdGguY2VpbCgoZXx8MSkvMikpO319LHQuYzg9bmV3IGNsYXNze2FzeW5jIGluaXQoKXsoMCwgdC5yWCkoKSxhd2FpdCgwLCBpLmluaXRpYWxpemVXZWJBc3NlbWJseUluc3RhbmNlKSgpO31hc3luYyBjcmVhdGVTZXNzaW9uSGFuZGxlcihlLHQpe2NvbnN0IG49bmV3IHMuT25ueHJ1bnRpbWVXZWJBc3NlbWJseVNlc3Npb25IYW5kbGVyO3JldHVybiBhd2FpdCBuLmxvYWRNb2RlbChlLHQpLFByb21pc2UucmVzb2x2ZShuKX19O30sMTA1NzpmdW5jdGlvbihlLHQsbil7dmFyIHI9dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pO3ZhciBvPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTtvJiYhKCJnZXQiaW4gbz8hdC5fX2VzTW9kdWxlOm8ud3JpdGFibGV8fG8uY29uZmlndXJhYmxlKXx8KG89e2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRbbl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscixvKTt9OmZ1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pLGVbcl09dFtuXTt9KSxvPXRoaXMmJnRoaXMuX19leHBvcnRTdGFyfHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiBlKSJkZWZhdWx0Ij09PW58fE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pfHxyKHQsZSxuKTt9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxvKG4oMjIzNSksdCk7Y29uc3QgaT1uKDIyMzUpLHM9big4NDA4KTt7Y29uc3QgZT1uKDU3MTYpLlI7KDAsIGkucmVnaXN0ZXJCYWNrZW5kKSgid2ViZ2wiLGUsLTEwKTt9e2NvbnN0IGU9bigyODE4KS5jODsoMCwgaS5yZWdpc3RlckJhY2tlbmQpKCJjcHUiLGUsMTApLCgwLCBpLnJlZ2lzdGVyQmFja2VuZCkoIndhc20iLGUsMTApLCgwLCBpLnJlZ2lzdGVyQmFja2VuZCkoInhubnBhY2siLGUsOSksKDAsIGkucmVnaXN0ZXJCYWNrZW5kKSgid2Vibm4iLGUsOSk7fWkuZW52LnZlcnNpb25zLndlYj1zLnZlcnNpb247fSw0OTEwOihlLHQpPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuY3JlYXRlQXR0cmlidXRlV2l0aENhY2hlS2V5PXZvaWQgMDtjbGFzcyBue2NvbnN0cnVjdG9yKGUpe09iamVjdC5hc3NpZ24odGhpcyxlKTt9Z2V0IGNhY2hlS2V5KCl7cmV0dXJuIHRoaXMuX2NhY2hlS2V5fHwodGhpcy5fY2FjaGVLZXk9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykuc29ydCgpLm1hcCgoZT0+YCR7dGhpc1tlXX1gKSkuam9pbigiOyIpKSx0aGlzLl9jYWNoZUtleX19dC5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXk9ZT0+bmV3IG4oZSk7fSw2ODc0OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5BdHRyaWJ1dGU9dm9pZCAwO2NvbnN0IHI9big1MTI3KSxvPW4oMjQ0NiksaT1uKDkyNDApLHM9big3MjczKTt2YXIgYT1yLm9ubnhydW50aW1lLmV4cGVyaW1lbnRhbC5mYnM7Y2xhc3MgdXtjb25zdHJ1Y3RvcihlKXtpZih0aGlzLl9hdHRyaWJ1dGVzPW5ldyBNYXAsbnVsbCE9ZSl7Zm9yKGNvbnN0IHQgb2YgZSl0IGluc3RhbmNlb2Ygby5vbm54LkF0dHJpYnV0ZVByb3RvP3RoaXMuX2F0dHJpYnV0ZXMuc2V0KHQubmFtZSxbdS5nZXRWYWx1ZSh0KSx1LmdldFR5cGUodCldKTp0IGluc3RhbmNlb2YgYS5BdHRyaWJ1dGUmJnRoaXMuX2F0dHJpYnV0ZXMuc2V0KHQubmFtZSgpLFt1LmdldFZhbHVlKHQpLHUuZ2V0VHlwZSh0KV0pO2lmKHRoaXMuX2F0dHJpYnV0ZXMuc2l6ZTxlLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImR1cGxpY2F0ZWQgYXR0cmlidXRlIG5hbWVzIil9fXNldChlLHQsbil7dGhpcy5fYXR0cmlidXRlcy5zZXQoZSxbbix0XSk7fWRlbGV0ZShlKXt0aGlzLl9hdHRyaWJ1dGVzLmRlbGV0ZShlKTt9Z2V0RmxvYXQoZSx0KXtyZXR1cm4gdGhpcy5nZXQoZSwiZmxvYXQiLHQpfWdldEludChlLHQpe3JldHVybiB0aGlzLmdldChlLCJpbnQiLHQpfWdldFN0cmluZyhlLHQpe3JldHVybiB0aGlzLmdldChlLCJzdHJpbmciLHQpfWdldFRlbnNvcihlLHQpe3JldHVybiB0aGlzLmdldChlLCJ0ZW5zb3IiLHQpfWdldEZsb2F0cyhlLHQpe3JldHVybiB0aGlzLmdldChlLCJmbG9hdHMiLHQpfWdldEludHMoZSx0KXtyZXR1cm4gdGhpcy5nZXQoZSwiaW50cyIsdCl9Z2V0U3RyaW5ncyhlLHQpe3JldHVybiB0aGlzLmdldChlLCJzdHJpbmdzIix0KX1nZXRUZW5zb3JzKGUsdCl7cmV0dXJuIHRoaXMuZ2V0KGUsInRlbnNvcnMiLHQpfWdldChlLHQsbil7Y29uc3Qgcj10aGlzLl9hdHRyaWJ1dGVzLmdldChlKTtpZih2b2lkIDA9PT1yKXtpZih2b2lkIDAhPT1uKXJldHVybiBuO3Rocm93IG5ldyBFcnJvcihgcmVxdWlyZWQgYXR0cmlidXRlIG5vdCBmb3VuZDogJHtlfWApfWlmKHJbMV0hPT10KXRocm93IG5ldyBFcnJvcihgdHlwZSBtaXNtYXRjaDogZXhwZWN0ZWQgJHt0fSBidXQgZ290ICR7clsxXX1gKTtyZXR1cm4gclswXX1zdGF0aWMgZ2V0VHlwZShlKXtjb25zdCB0PWUgaW5zdGFuY2VvZiBvLm9ubnguQXR0cmlidXRlUHJvdG8/ZS50eXBlOmUudHlwZSgpO3N3aXRjaCh0KXtjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLkZMT0FUOnJldHVybiAiZmxvYXQiO2Nhc2Ugby5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuSU5UOnJldHVybiAiaW50IjtjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLlNUUklORzpyZXR1cm4gInN0cmluZyI7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5URU5TT1I6cmV0dXJuICJ0ZW5zb3IiO2Nhc2Ugby5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuRkxPQVRTOnJldHVybiAiZmxvYXRzIjtjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLklOVFM6cmV0dXJuICJpbnRzIjtjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLlNUUklOR1M6cmV0dXJuICJzdHJpbmdzIjtjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLlRFTlNPUlM6cmV0dXJuICJ0ZW5zb3JzIjtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgYXR0cmlidXRlIHR5cGUgaXMgbm90IHN1cHBvcnRlZCB5ZXQ6ICR7by5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGVbdF19YCl9fXN0YXRpYyBnZXRWYWx1ZShlKXtjb25zdCB0PWUgaW5zdGFuY2VvZiBvLm9ubnguQXR0cmlidXRlUHJvdG8/ZS50eXBlOmUudHlwZSgpO2lmKHQ9PT1vLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5HUkFQSHx8dD09PW8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLkdSQVBIUyl0aHJvdyBuZXcgRXJyb3IoImdyYXBoIGF0dHJpYnV0ZSBpcyBub3Qgc3VwcG9ydGVkIHlldCIpO2NvbnN0IG49dGhpcy5nZXRWYWx1ZU5vQ2hlY2soZSk7aWYodD09PW8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLklOVCYmcy5Mb25nVXRpbC5pc0xvbmcobikpcmV0dXJuIHMuTG9uZ1V0aWwubG9uZ1RvTnVtYmVyKG4pO2lmKHQ9PT1vLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5JTlRTKXtjb25zdCBlPW4sdD1uZXcgQXJyYXkoZS5sZW5ndGgpO2ZvcihsZXQgbj0wO248ZS5sZW5ndGg7bisrKXtjb25zdCByPWVbbl07dFtuXT1zLkxvbmdVdGlsLmxvbmdUb051bWJlcihyKTt9cmV0dXJuIHR9aWYodD09PW8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLlRFTlNPUilyZXR1cm4gZSBpbnN0YW5jZW9mIG8ub25ueC5BdHRyaWJ1dGVQcm90bz9pLlRlbnNvci5mcm9tUHJvdG8obik6aS5UZW5zb3IuZnJvbU9ydFRlbnNvcihuKTtpZih0PT09by5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuVEVOU09SUyl7aWYoZSBpbnN0YW5jZW9mIG8ub25ueC5BdHRyaWJ1dGVQcm90bylyZXR1cm4gbi5tYXAoKGU9PmkuVGVuc29yLmZyb21Qcm90byhlKSkpO2lmKGUgaW5zdGFuY2VvZiBhLkF0dHJpYnV0ZSlyZXR1cm4gbi5tYXAoKGU9PmkuVGVuc29yLmZyb21PcnRUZW5zb3IoZSkpKX1pZih0PT09by5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuU1RSSU5HJiZlIGluc3RhbmNlb2Ygby5vbm54LkF0dHJpYnV0ZVByb3RvKXtjb25zdCBlPW47cmV0dXJuICgwLCBzLmRlY29kZVV0ZjhTdHJpbmcpKGUpfXJldHVybiB0PT09by5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuU1RSSU5HUyYmZSBpbnN0YW5jZW9mIG8ub25ueC5BdHRyaWJ1dGVQcm90bz9uLm1hcChzLmRlY29kZVV0ZjhTdHJpbmcpOm59c3RhdGljIGdldFZhbHVlTm9DaGVjayhlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIG8ub25ueC5BdHRyaWJ1dGVQcm90bz90aGlzLmdldFZhbHVlTm9DaGVja0Zyb21Pbm54Rm9ybWF0KGUpOnRoaXMuZ2V0VmFsdWVOb0NoZWNrRnJvbU9ydEZvcm1hdChlKX1zdGF0aWMgZ2V0VmFsdWVOb0NoZWNrRnJvbU9ubnhGb3JtYXQoZSl7c3dpdGNoKGUudHlwZSl7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5GTE9BVDpyZXR1cm4gZS5mO2Nhc2Ugby5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuSU5UOnJldHVybiBlLmk7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5TVFJJTkc6cmV0dXJuIGUucztjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLlRFTlNPUjpyZXR1cm4gZS50O2Nhc2Ugby5vbm54LkF0dHJpYnV0ZVByb3RvLkF0dHJpYnV0ZVR5cGUuR1JBUEg6cmV0dXJuIGUuZztjYXNlIG8ub25ueC5BdHRyaWJ1dGVQcm90by5BdHRyaWJ1dGVUeXBlLkZMT0FUUzpyZXR1cm4gZS5mbG9hdHM7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5JTlRTOnJldHVybiBlLmludHM7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5TVFJJTkdTOnJldHVybiBlLnN0cmluZ3M7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5URU5TT1JTOnJldHVybiBlLnRlbnNvcnM7Y2FzZSBvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZS5HUkFQSFM6cmV0dXJuIGUuZ3JhcGhzO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBhdHRyaWJ1dGUgdHlwZTogJHtvLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZVtlLnR5cGVdfWApfX1zdGF0aWMgZ2V0VmFsdWVOb0NoZWNrRnJvbU9ydEZvcm1hdChlKXtzd2l0Y2goZS50eXBlKCkpe2Nhc2UgYS5BdHRyaWJ1dGVUeXBlLkZMT0FUOnJldHVybiBlLmYoKTtjYXNlIGEuQXR0cmlidXRlVHlwZS5JTlQ6cmV0dXJuIGUuaSgpO2Nhc2UgYS5BdHRyaWJ1dGVUeXBlLlNUUklORzpyZXR1cm4gZS5zKCk7Y2FzZSBhLkF0dHJpYnV0ZVR5cGUuVEVOU09SOnJldHVybiBlLnQoKTtjYXNlIGEuQXR0cmlidXRlVHlwZS5HUkFQSDpyZXR1cm4gZS5nKCk7Y2FzZSBhLkF0dHJpYnV0ZVR5cGUuRkxPQVRTOnJldHVybiBlLmZsb2F0c0FycmF5KCk7Y2FzZSBhLkF0dHJpYnV0ZVR5cGUuSU5UUzp7Y29uc3QgdD1bXTtmb3IobGV0IG49MDtuPGUuaW50c0xlbmd0aCgpO24rKyl0LnB1c2goZS5pbnRzKG4pKTtyZXR1cm4gdH1jYXNlIGEuQXR0cmlidXRlVHlwZS5TVFJJTkdTOntjb25zdCB0PVtdO2ZvcihsZXQgbj0wO248ZS5zdHJpbmdzTGVuZ3RoKCk7bisrKXQucHVzaChlLnN0cmluZ3MobikpO3JldHVybiB0fWNhc2UgYS5BdHRyaWJ1dGVUeXBlLlRFTlNPUlM6e2NvbnN0IHQ9W107Zm9yKGxldCBuPTA7bjxlLnRlbnNvcnNMZW5ndGgoKTtuKyspdC5wdXNoKGUudGVuc29ycyhuKSk7cmV0dXJuIHR9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVuc3VwcG9ydGVkIGF0dHJpYnV0ZSB0eXBlOiAke2EuQXR0cmlidXRlVHlwZVtlLnR5cGUoKV19YCl9fX10LkF0dHJpYnV0ZT11O30sMTk3NTooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQucmVzb2x2ZUJhY2tlbmQ9dC5iYWNrZW5kPXZvaWQgMDtjb25zdCByPW4oNDQxOCksbz1uZXcgTWFwO2FzeW5jIGZ1bmN0aW9uIGkoZSl7Y29uc3Qgbj10LmJhY2tlbmQ7aWYodm9pZCAwIT09bltlXSYmZnVuY3Rpb24oZSl7Y29uc3QgdD1lO3JldHVybiAiaW5pdGlhbGl6ZSJpbiB0JiYiZnVuY3Rpb24iPT10eXBlb2YgdC5pbml0aWFsaXplJiYiY3JlYXRlU2Vzc2lvbkhhbmRsZXIiaW4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIHQuY3JlYXRlU2Vzc2lvbkhhbmRsZXImJiJkaXNwb3NlImluIHQmJiJmdW5jdGlvbiI9PXR5cGVvZiB0LmRpc3Bvc2V9KG5bZV0pKXtjb25zdCB0PW5bZV07bGV0IHI9dC5pbml0aWFsaXplKCk7aWYoIm9iamVjdCI9PXR5cGVvZiByJiYidGhlbiJpbiByJiYocj1hd2FpdCByKSxyKXJldHVybiBvLnNldChlLHQpLHR9fXQuYmFja2VuZD17d2ViZ2w6bmV3IHIuV2ViR0xCYWNrZW5kfSx0LnJlc29sdmVCYWNrZW5kPWFzeW5jIGZ1bmN0aW9uIGUodCl7aWYoIXQpcmV0dXJuIGUoWyJ3ZWJnbCJdKTt7Y29uc3QgZT0ic3RyaW5nIj09dHlwZW9mIHQ/W3RdOnQ7Zm9yKGNvbnN0IHQgb2YgZSl7Y29uc3QgZT1vLmdldCh0KTtpZihlKXJldHVybiBlO2NvbnN0IG49YXdhaXQgaSh0KTtpZihuKXJldHVybiBufX10aHJvdyBuZXcgRXJyb3IoIm5vIGF2YWlsYWJsZSBiYWNrZW5kIHRvIHVzZSIpfTt9LDQ0MTg6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LldlYkdMQmFja2VuZD12b2lkIDA7Y29uc3Qgcj1uKDIyMzUpLG89bigxMzE1KSxpPW4oMjE3MSkscz1uKDMzODkpO3QuV2ViR0xCYWNrZW5kPWNsYXNze2dldCBjb250ZXh0SWQoKXtyZXR1cm4gci5lbnYud2ViZ2wuY29udGV4dElkfXNldCBjb250ZXh0SWQoZSl7ci5lbnYud2ViZ2wuY29udGV4dElkPWU7fWdldCBtYXRtdWxNYXhCYXRjaFNpemUoKXtyZXR1cm4gci5lbnYud2ViZ2wubWF0bXVsTWF4QmF0Y2hTaXplfXNldCBtYXRtdWxNYXhCYXRjaFNpemUoZSl7ci5lbnYud2ViZ2wubWF0bXVsTWF4QmF0Y2hTaXplPWU7fWdldCB0ZXh0dXJlQ2FjaGVNb2RlKCl7cmV0dXJuIHIuZW52LndlYmdsLnRleHR1cmVDYWNoZU1vZGV9c2V0IHRleHR1cmVDYWNoZU1vZGUoZSl7ci5lbnYud2ViZ2wudGV4dHVyZUNhY2hlTW9kZT1lO31nZXQgcGFjaygpe3JldHVybiByLmVudi53ZWJnbC5wYWNrfXNldCBwYWNrKGUpe3IuZW52LndlYmdsLnBhY2s9ZTt9Z2V0IGFzeW5jKCl7cmV0dXJuIHIuZW52LndlYmdsLmFzeW5jfXNldCBhc3luYyhlKXtyLmVudi53ZWJnbC5hc3luYz1lO31pbml0aWFsaXplKCl7dHJ5e3JldHVybiB0aGlzLmdsQ29udGV4dD0oMCxzLmNyZWF0ZVdlYkdMQ29udGV4dCkodGhpcy5jb250ZXh0SWQpLCJudW1iZXIiIT10eXBlb2YgdGhpcy5tYXRtdWxNYXhCYXRjaFNpemUmJih0aGlzLm1hdG11bE1heEJhdGNoU2l6ZT0xNiksInN0cmluZyIhPXR5cGVvZiB0aGlzLnRleHR1cmVDYWNoZU1vZGUmJih0aGlzLnRleHR1cmVDYWNoZU1vZGU9ImZ1bGwiKSwiYm9vbGVhbiIhPXR5cGVvZiB0aGlzLnBhY2smJih0aGlzLnBhY2s9ITEpLCJib29sZWFuIiE9dHlwZW9mIHRoaXMuYXN5bmMmJih0aGlzLmFzeW5jPSExKSxvLkxvZ2dlci5zZXRXaXRoRW52KHIuZW52KSxvLkxvZ2dlci52ZXJib3NlKCJXZWJHTEJhY2tlbmQiLGBDcmVhdGVkIFdlYkdMQ29udGV4dDogJHt0eXBlb2YgdGhpcy5nbENvbnRleHR9IHdpdGggbWF0bXVsTWF4QmF0Y2hTaXplOiAke3RoaXMubWF0bXVsTWF4QmF0Y2hTaXplfTsgdGV4dHVyZUNhY2hlTW9kZTogJHt0aGlzLnRleHR1cmVDYWNoZU1vZGV9OyBwYWNrOiAke3RoaXMucGFja307IGFzeW5jOiAke3RoaXMuYXN5bmN9LmApLCEwfWNhdGNoKGUpe3JldHVybiBvLkxvZ2dlci53YXJuaW5nKCJXZWJHTEJhY2tlbmQiLGBVbmFibGUgdG8gaW5pdGlhbGl6ZSBXZWJHTEJhY2tlbmQuICR7ZX1gKSwhMX19Y3JlYXRlU2Vzc2lvbkhhbmRsZXIoZSl7cmV0dXJuIG5ldyBpLldlYkdMU2Vzc2lvbkhhbmRsZXIodGhpcyxlKX1kaXNwb3NlKCl7dGhpcy5nbENvbnRleHQuZGlzcG9zZSgpO319O30sNjg1OTooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuQ29vcmRzR2xzbExpYj12b2lkIDA7Y29uc3Qgcj1uKDcyNzMpLG89bigxOTk3KSxpPW4oNjc1Nykscz1uKDc2MTgpLGE9big0MzIpO2NsYXNzIHUgZXh0ZW5kcyBvLkdsc2xMaWJ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSk7fWdldEZ1bmN0aW9ucygpe3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHRoaXMub2Zmc2V0VG9Db29yZHMoKSksdGhpcy5jb29yZHNUb09mZnNldCgpKSx0aGlzLnRvVmVjKCkpLHRoaXMudmFsdWVGcm9tKCkpLHRoaXMuZ2V0Q29tbW9uVXRpbEZ1bmNzKCkpLHRoaXMuZ2V0SW5wdXRzU2FtcGxpbmdTbmlwcGV0cygpKSx0aGlzLmdldE91dHB1dFNhbXBsaW5nU25pcHBldCgpKX1nZXRDdXN0b21UeXBlcygpe3JldHVybiB7fX1vZmZzZXRUb0Nvb3Jkcygpe3JldHVybiB7b2Zmc2V0VG9Db29yZHM6bmV3IG8uR2xzbExpYlJvdXRpbmUoIlxuICAgICAgdmVjMiBvZmZzZXRUb0Nvb3JkcyhpbnQgb2Zmc2V0LCBpbnQgd2lkdGgsIGludCBoZWlnaHQpIHtcbiAgICAgICAgaW50IHQgPSBvZmZzZXQgLyB3aWR0aDtcbiAgICAgICAgaW50IHMgPSBvZmZzZXQgLSB0KndpZHRoO1xuICAgICAgICB2ZWMyIGNvb3JkcyA9ICh2ZWMyKHMsdCkgKyB2ZWMyKDAuNSwwLjUpKSAvIHZlYzIod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHJldHVybiBjb29yZHM7XG4gICAgICB9XG4gICAgICAiKX19Y29vcmRzVG9PZmZzZXQoKXtyZXR1cm4ge2Nvb3Jkc1RvT2Zmc2V0Om5ldyBvLkdsc2xMaWJSb3V0aW5lKCJcbiAgICAgIGludCBjb29yZHNUb09mZnNldCh2ZWMyIGNvb3JkcywgaW50IHdpZHRoLCBpbnQgaGVpZ2h0KSB7XG4gICAgICAgIGZsb2F0IHMgPSBjb29yZHMucyAqIGZsb2F0KHdpZHRoKTtcbiAgICAgICAgZmxvYXQgdCA9IGNvb3Jkcy50ICogZmxvYXQoaGVpZ2h0KTtcbiAgICAgICAgaW50IG9mZnNldCA9IGludCh0KSAqIHdpZHRoICsgaW50KHMpO1xuICAgICAgICByZXR1cm4gb2Zmc2V0O1xuICAgICAgfVxuICAgICAgIil9fWdldE91dHB1dFNhbXBsaW5nU25pcHBldCgpe2NvbnN0IGU9dGhpcy5jb250ZXh0Lm91dHB1dFRleHR1cmVMYXlvdXQ7cmV0dXJuIGUuaXNQYWNrZWQ/dGhpcy5nZXRQYWNrZWRPdXRwdXRTYW1wbGluZ1NuaXBwZXQoZSk6dGhpcy5nZXRVbnBhY2tlZE91dHB1dFNhbXBsaW5nU25pcHBldChlKX1nZXRQYWNrZWRPdXRwdXRTYW1wbGluZ1NuaXBwZXQoZSl7Y29uc3QgdD1lLnVucGFja2VkU2hhcGUsbj1bZS53aWR0aCxlLmhlaWdodF0scj17fSxzPSJnZXRPdXRwdXRDb29yZHMiO3N3aXRjaCh0Lmxlbmd0aCl7Y2FzZSAwOnJbc109dGhpcy5nZXRPdXRwdXRTY2FsYXJDb29yZHMoKTticmVhaztjYXNlIDE6cltzXT10aGlzLmdldE91dHB1dFBhY2tlZDFEQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSAyOnJbc109dGhpcy5nZXRPdXRwdXRQYWNrZWQyRENvb3Jkcyh0LG4pO2JyZWFrO2Nhc2UgMzpyW3NdPXRoaXMuZ2V0T3V0cHV0UGFja2VkM0RDb29yZHModCxuKTticmVhaztkZWZhdWx0OnJbc109dGhpcy5nZXRPdXRwdXRQYWNrZWRORENvb3Jkcyh0LG4pO31jb25zdCBhPWBcbiAgICAgIHZvaWQgc2V0T3V0cHV0KHZlYzQgdmFsKSB7XG4gICAgICAgICR7KDAsIGkuZ2V0R2xzbCkodGhpcy5jb250ZXh0LmdsQ29udGV4dC52ZXJzaW9uKS5vdXRwdXR9ID0gdmFsO1xuICAgICAgfVxuICAgIGA7cmV0dXJuIHIuZmxvYXRUZXh0dXJlU2V0UkdCQT1uZXcgby5HbHNsTGliUm91dGluZShhKSxyfWdldFVucGFja2VkT3V0cHV0U2FtcGxpbmdTbmlwcGV0KGUpe2NvbnN0IHQ9ZS51bnBhY2tlZFNoYXBlLG49W2Uud2lkdGgsZS5oZWlnaHRdLHI9e30scz0iZ2V0T3V0cHV0Q29vcmRzIjtzd2l0Y2godC5sZW5ndGgpe2Nhc2UgMDpyW3NdPXRoaXMuZ2V0T3V0cHV0U2NhbGFyQ29vcmRzKCk7YnJlYWs7Y2FzZSAxOnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDFEQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSAyOnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDJEQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSAzOnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDNEQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSA0OnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDREQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSA1OnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDVEQ29vcmRzKHQsbik7YnJlYWs7Y2FzZSA2OnJbc109dGhpcy5nZXRPdXRwdXRVbnBhY2tlZDZEQ29vcmRzKHQsbik7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG91dHB1dCBkaW1lbnNpb25hbGl0eTogJHt0Lmxlbmd0aH1gKX1jb25zdCBhPWBcbiAgICAgICAgdm9pZCBzZXRPdXRwdXQoZmxvYXQgdmFsKSB7XG4gICAgICAgICAgJHsoMCwgaS5nZXRHbHNsKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pLm91dHB1dH0gPSB2ZWM0KHZhbCwgMCwgMCwgMCk7XG4gICAgICAgIH1cbiAgICBgO3JldHVybiByLmZsb2F0VGV4dHVyZVNldFI9bmV3IG8uR2xzbExpYlJvdXRpbmUoYSkscn1nZXRPdXRwdXRTY2FsYXJDb29yZHMoKXtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUoIlxuICAgICAgaW50IGdldE91dHB1dENvb3JkcygpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgIil9Z2V0T3V0cHV0UGFja2VkMURDb29yZHMoZSx0KXtjb25zdCBuPXQ7bGV0IHI9IiI7cmV0dXJuIDE9PT1uWzBdPyhyPWBcbiAgICAgICAgICBpbnQgZ2V0T3V0cHV0Q29vcmRzKCkge1xuICAgICAgICAgICAgcmV0dXJuIDIgKiBpbnQoVGV4Q29vcmRzLnkgKiAke25bMV19LjApO1xuICAgICAgICAgIH1cbiAgICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShyKSk6MT09PW5bMV0/KHI9YFxuICAgICAgICAgIGludCBnZXRPdXRwdXRDb29yZHMoKSB7XG4gICAgICAgICAgICByZXR1cm4gMiAqIGludChUZXhDb29yZHMueCAqICR7blswXX0uMCk7XG4gICAgICAgICAgfVxuICAgICAgICBgLG5ldyBvLkdsc2xMaWJSb3V0aW5lKHIpKToocj1gXG4gICAgICAgIGludCBnZXRPdXRwdXRDb29yZHMoKSB7XG4gICAgICAgICAgaXZlYzIgcmVzVGV4UkMgPSBpdmVjMihUZXhDb29yZHMueHkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVjMigke25bMF19LCAke25bMV19KSk7XG4gICAgICAgICAgcmV0dXJuIDIgKiAocmVzVGV4UkMueSAqICR7blswXX0gKyByZXNUZXhSQy54KTtcbiAgICAgICAgfVxuICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShyKSl9Z2V0T3V0cHV0UGFja2VkMkRDb29yZHMoZSx0KXtsZXQgbj0iIjtpZihyLkFycmF5VXRpbC5hcnJheXNFcXVhbChlLHQpKXJldHVybiBuPWBcbiAgICAgICAgaXZlYzIgZ2V0T3V0cHV0Q29vcmRzKCkge1xuICAgICAgICAgIHJldHVybiAyICogaXZlYzIoVGV4Q29vcmRzLnh5ICogdmVjMigke3RbMF19LCAke3RbMV19KSk7XG4gICAgICAgIH1cbiAgICAgIGAsbmV3IG8uR2xzbExpYlJvdXRpbmUobik7Y29uc3QgaT10LHM9TWF0aC5jZWlsKGVbMV0vMik7cmV0dXJuIG49YFxuICAgICAgICBpdmVjMiBnZXRPdXRwdXRDb29yZHMoKSB7XG4gICAgICAgICAgaXZlYzIgcmVzVGV4UkMgPSBpdmVjMihUZXhDb29yZHMueHkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWMyKCR7aVswXX0sICR7aVsxXX0pKTtcblxuICAgICAgICAgIGludCBpbmRleCA9IHJlc1RleFJDLnkgKiAke2lbMF19ICsgcmVzVGV4UkMueDtcblxuICAgICAgICAgIC8vIHJldmVyc2UgciBhbmQgYyBvcmRlciBmb3IgcGFja2VkIHRleHR1cmVcbiAgICAgICAgICBpbnQgciA9IGltb2QoaW5kZXgsICR7c30pICogMjtcbiAgICAgICAgICBpbnQgYyA9IDIgKiAoaW5kZXggLyAke3N9KTtcblxuICAgICAgICAgIHJldHVybiBpdmVjMihyLCBjKTtcbiAgICAgICAgfVxuICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShuKX1nZXRPdXRwdXRQYWNrZWQzRENvb3JkcyhlLHQpe2NvbnN0IG49W3RbMF0sdFsxXV0scj1NYXRoLmNlaWwoZVsyXS8yKSxpPXIqTWF0aC5jZWlsKGVbMV0vMikscz1gXG4gICAgICAgIGl2ZWMzIGdldE91dHB1dENvb3JkcygpIHtcbiAgICAgICAgICBpdmVjMiByZXNUZXhSQyA9IGl2ZWMyKFRleENvb3Jkcy54eSAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlYzIoJHtuWzBdfSwgJHtuWzFdfSkpO1xuICAgICAgICAgIGludCBpbmRleCA9IHJlc1RleFJDLnkgKiAke25bMF19ICsgcmVzVGV4UkMueDtcblxuICAgICAgICAgIGludCBiID0gaW5kZXggLyAke2l9O1xuICAgICAgICAgIGluZGV4IC09IGIgKiAke2l9O1xuXG4gICAgICAgICAgLy8gcmV2ZXJzZSByIGFuZCBjIG9yZGVyIGZvciBwYWNrZWQgdGV4dHVyZVxuICAgICAgICAgIGludCByID0gaW1vZChpbmRleCwgJHtyfSkgKiAyO1xuICAgICAgICAgIGludCBjID0gMiAqIChpbmRleCAvICR7cn0pO1xuXG4gICAgICAgICAgcmV0dXJuIGl2ZWMzKGIsIHIsIGMpO1xuICAgICAgICB9XG4gICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShzKX1nZXRPdXRwdXRQYWNrZWRORENvb3JkcyhlLHQpe2NvbnN0IG49W3RbMF0sdFsxXV0scj1NYXRoLmNlaWwoZVtlLmxlbmd0aC0xXS8yKSxpPXIqTWF0aC5jZWlsKGVbZS5sZW5ndGgtMl0vMik7bGV0IHM9aSxhPSIiLHU9ImIsIHIsIGMiO2ZvcihsZXQgdD0yO3Q8ZS5sZW5ndGgtMTt0Kyspcyo9ZVtlLmxlbmd0aC10LTFdLGE9YFxuICAgICAgaW50IGIke3R9ID0gaW5kZXggLyAke3N9O1xuICAgICAgaW5kZXggLT0gYiR7dH0gKiAke3N9O1xuICAgIGArYSx1PWBiJHt0fSwgYCt1O2NvbnN0IGw9YFxuICAgICAgaXZlYyR7ZS5sZW5ndGh9IGdldE91dHB1dENvb3JkcygpIHtcbiAgICAgICAgaXZlYzIgcmVzVGV4UkMgPSBpdmVjMihUZXhDb29yZHMueHkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVjMigke25bMF19LCAke25bMV19KSk7XG4gICAgICAgIGludCBpbmRleCA9IHJlc1RleFJDLnkgKiAke25bMF19ICsgcmVzVGV4UkMueDtcblxuICAgICAgICAke2F9XG5cbiAgICAgICAgaW50IGIgPSBpbmRleCAvICR7aX07XG4gICAgICAgIGluZGV4IC09IGIgKiAke2l9O1xuXG4gICAgICAgIC8vIHJldmVyc2UgciBhbmQgYyBvcmRlciBmb3IgcGFja2VkIHRleHR1cmVcbiAgICAgICAgaW50IHIgPSBpbW9kKGluZGV4LCAke3J9KSAqIDI7XG4gICAgICAgIGludCBjID0gMiAqIChpbmRleCAvICR7cn0pO1xuXG4gICAgICAgIHJldHVybiBpdmVjJHtlLmxlbmd0aH0oJHt1fSk7XG4gICAgICB9XG4gICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobCl9Z2V0T3V0cHV0VW5wYWNrZWQxRENvb3JkcyhlLHQpe2NvbnN0IG49YFxuICAgICAgICBpbnQgZ2V0T3V0cHV0Q29vcmRzKCkge1xuICAgICAgICAgIGl2ZWMyIHJlc1RleFJDID0gaXZlYzIoVGV4Q29vcmRzLnh5ICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVjMigke3RbMF19LCAke3RbMV19KSk7XG4gICAgICAgICAgcmV0dXJuIHJlc1RleFJDLnkgKiAke3RbMF19ICsgcmVzVGV4UkMueDtcbiAgICAgICAgfVxuICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobil9Z2V0T3V0cHV0VW5wYWNrZWQyRENvb3JkcyhlLHQpe2NvbnN0IG49YFxuICAgICAgICBpdmVjMiBnZXRPdXRwdXRDb29yZHMoKSB7XG4gICAgICAgICAgaXZlYzIgcmVzVGV4UkMgPSBpdmVjMihUZXhDb29yZHMueHkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWMyKCR7dFswXX0sICR7dFsxXX0pKTtcbiAgICAgICAgICBpbnQgaW5kZXggPSByZXNUZXhSQy55ICogJHt0WzBdfSArIHJlc1RleFJDLng7XG4gICAgICAgICAgaW50IHIgPSBpbmRleCAvICR7ZVsxXX07XG4gICAgICAgICAgaW50IGMgPSBpbmRleCAtIHIgKiAke2VbMV19O1xuICAgICAgICAgIHJldHVybiBpdmVjMihyLCBjKTtcbiAgICAgICAgfVxuICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobil9Z2V0T3V0cHV0VW5wYWNrZWQzRENvb3JkcyhlLHQpe2xldCBuPSIiO2NvbnN0IHI9ZS5sZW5ndGg7bGV0IGk9bnVsbDtyPDImJihpPVtdKSxpPW5ldyBBcnJheShyLTEpLGlbci0yXT1lW3ItMV07Zm9yKGxldCB0PXItMzt0Pj0wOy0tdClpW3RdPWlbdCsxXSplW3QrMV07Y29uc3Qgcz1bInIiLCJjIiwiZCJdLGE9aS5tYXAoKChlLHQpPT5gaW50ICR7c1t0XX0gPSBpbmRleCAvICR7ZX07ICR7dD09PWkubGVuZ3RoLTE/YGludCAke3NbdCsxXX0gPSBpbmRleCAtICR7c1t0XX0gKiAke2V9YDpgaW5kZXggLT0gJHtzW3RdfSAqICR7ZX1gfTtgKSkuam9pbigiIik7cmV0dXJuIG49YFxuICAgICAgICBpdmVjMyBnZXRPdXRwdXRDb29yZHMoKSB7XG4gICAgICAgICAgaXZlYzIgcmVzVGV4UkMgPSBpdmVjMihUZXhDb29yZHMueHkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWMyKCR7dFswXX0sICR7dFsxXX0pKTtcbiAgICAgICAgICBpbnQgaW5kZXggPSByZXNUZXhSQy55ICogJHt0WzBdfSArIHJlc1RleFJDLng7XG4gICAgICAgICAgJHthfVxuICAgICAgICAgIHJldHVybiBpdmVjMyhyLCBjLCBkKTtcbiAgICAgICAgfVxuICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShuKX1nZXRPdXRwdXRVbnBhY2tlZDREQ29vcmRzKGUsdCl7bGV0IG49IiI7Y29uc3Qgcj1lLmxlbmd0aDtsZXQgaT1udWxsO3I8MiYmKGk9W10pLGk9bmV3IEFycmF5KHItMSksaVtyLTJdPWVbci0xXTtmb3IobGV0IHQ9ci0zO3Q+PTA7LS10KWlbdF09aVt0KzFdKmVbdCsxXTtjb25zdCBzPVsiciIsImMiLCJkIiwiZDIiXSxhPWkubWFwKCgoZSx0KT0+YGludCAke3NbdF19ID0gaW5kZXggLyAke2V9OyAke3Q9PT1pLmxlbmd0aC0xP2BpbnQgJHtzW3QrMV19ID0gaW5kZXggLSAke3NbdF19ICogJHtlfWA6YGluZGV4IC09ICR7c1t0XX0gKiAke2V9YH07YCkpLmpvaW4oIiIpO3JldHVybiBuPWBcbiAgICAgIGl2ZWM0IGdldE91dHB1dENvb3JkcygpIHtcbiAgICAgICAgICBpdmVjMiByZXNUZXhSQyA9IGl2ZWMyKFRleENvb3Jkcy54eSAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlYzIoJHt0WzBdfSwgJHt0WzFdfSkpO1xuICAgICAgICAgIGludCBpbmRleCA9IHJlc1RleFJDLnkgKiAke3RbMF19ICsgcmVzVGV4UkMueDtcbiAgICAgICAgICAke2F9XG4gICAgICAgICAgcmV0dXJuIGl2ZWM0KHIsIGMsIGQsIGQyKTtcbiAgICAgICAgfVxuICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShuKX1nZXRPdXRwdXRVbnBhY2tlZDVEQ29vcmRzKGUsdCl7bGV0IG49IiI7Y29uc3Qgcj1lLmxlbmd0aDtsZXQgaT1udWxsO3I8MiYmKGk9W10pLGk9bmV3IEFycmF5KHItMSksaVtyLTJdPWVbci0xXTtmb3IobGV0IHQ9ci0zO3Q+PTA7LS10KWlbdF09aVt0KzFdKmVbdCsxXTtjb25zdCBzPVsiciIsImMiLCJkIiwiZDIiLCJkMyJdLGE9aS5tYXAoKChlLHQpPT5gaW50ICR7c1t0XX0gPSBpbmRleCAvICR7ZX07ICR7dD09PWkubGVuZ3RoLTE/YGludCAke3NbdCsxXX0gPSBpbmRleCAtICR7c1t0XX0gKiAke2V9YDpgaW5kZXggLT0gJHtzW3RdfSAqICR7ZX1gfTtgKSkuam9pbigiIik7cmV0dXJuIG49YFxuICAgICAgaXZlYzUgZ2V0T3V0cHV0Q29vcmRzKCkge1xuICAgICAgICAgIGl2ZWMyIHJlc1RleFJDID0gaXZlYzIoVGV4Q29vcmRzLnh5ICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVjMigke3RbMF19LCAke3RbMV19KSk7XG4gICAgICAgICAgaW50IGluZGV4ID0gcmVzVGV4UkMueSAqICR7dFswXX0gKyByZXNUZXhSQy54O1xuICAgICAgICAgICR7YX1cbiAgICAgICAgICByZXR1cm4gaXZlYzUociwgYywgZCwgZDIsIGQzKTtcbiAgICAgICAgfVxuICAgICAgYCxuZXcgby5HbHNsTGliUm91dGluZShuKX1nZXRPdXRwdXRVbnBhY2tlZDZEQ29vcmRzKGUsdCl7bGV0IG49IiI7Y29uc3Qgcj1lLmxlbmd0aDtsZXQgaT1udWxsO3I8MiYmKGk9W10pLGk9bmV3IEFycmF5KHItMSksaVtyLTJdPWVbci0xXTtmb3IobGV0IHQ9ci0zO3Q+PTA7LS10KWlbdF09aVt0KzFdKmVbdCsxXTtjb25zdCBzPVsiciIsImMiLCJkIiwiZDIiLCJkMyIsImQ0Il0sYT1pLm1hcCgoKGUsdCk9PmBpbnQgJHtzW3RdfSA9IGluZGV4IC8gJHtlfTsgJHt0PT09aS5sZW5ndGgtMT9gaW50ICR7c1t0KzFdfSA9IGluZGV4IC0gJHtzW3RdfSAqICR7ZX1gOmBpbmRleCAtPSAke3NbdF19ICogJHtlfWB9O2ApKS5qb2luKCIiKTtyZXR1cm4gbj1gXG4gICAgIGl2ZWM2IGdldE91dHB1dENvb3JkcygpIHtcbiAgICAgICAgIGl2ZWMyIHJlc1RleFJDID0gaXZlYzIoVGV4Q29vcmRzLnh5ICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWMyKCR7dFswXX0sICR7dFsxXX0pKTtcbiAgICAgICAgIGludCBpbmRleCA9IHJlc1RleFJDLnkgKiAke3RbMF19ICsgcmVzVGV4UkMueDtcbiAgICAgICAgICR7YX1cbiAgICAgICAgIHJldHVybiBpdmVjNihyLCBjLCBkLCBkMiwgZDMsIGQ0KTtcbiAgICAgICB9XG4gICAgIGAsbmV3IG8uR2xzbExpYlJvdXRpbmUobil9Z2V0Q29tbW9uVXRpbEZ1bmNzKCl7Y29uc3QgZT17fTtsZXQgdD0idXZGcm9tRmxhdCI7ZVt0XT1uZXcgby5HbHNsTGliUm91dGluZSgiXG4gICAgdmVjMiB1dkZyb21GbGF0KGludCB0ZXhOdW1SLCBpbnQgdGV4TnVtQywgaW50IGluZGV4KSB7XG4gICAgICBpbnQgdGV4QyA9IGluZGV4IC8gdGV4TnVtUjtcbiAgICAgIGludCB0ZXhSID0gaW5kZXggLSB0ZXhDICogdGV4TnVtUjtcbiAgICAgIC8vIFRPRE86IHN3YXAgdGV4UiwgdGV4QyBvcmRlciBpbiBmb2xsb3dpbmcgZnVuY3Rpb24gc28gcm93IGlzIGNvcnJlc3BvbmRpbmcgdG8gdSBhbmQgY29sdW1uIGlzIGNvcnJlc3BvbmRpbmcgdG9cbiAgICAgIC8vICAgICAgIHYuXG4gICAgICByZXR1cm4gKHZlYzIodGV4UiwgdGV4QykgKyBoYWxmQ1IpIC8gdmVjMih0ZXhOdW1SLCB0ZXhOdW1DKTtcbiAgICB9XG4gICAgIiksdD0icGFja2VkVVZmcm9tMUQiLGVbdF09bmV3IG8uR2xzbExpYlJvdXRpbmUoIlxuICAgICAgdmVjMiBwYWNrZWRVVmZyb20xRChpbnQgdGV4TnVtUiwgaW50IHRleE51bUMsIGludCBpbmRleCkge1xuICAgICAgICBpbnQgdGV4ZWxJbmRleCA9IGluZGV4IC8gMjtcbiAgICAgICAgaW50IHRleFIgPSB0ZXhlbEluZGV4IC8gdGV4TnVtQztcbiAgICAgICAgaW50IHRleEMgPSB0ZXhlbEluZGV4IC0gdGV4UiAqIHRleE51bUM7XG4gICAgICAgIHJldHVybiAodmVjMih0ZXhDLCB0ZXhSKSArIGhhbGZDUikgLyB2ZWMyKHRleE51bUMsIHRleE51bVIpO1xuICAgICAgfVxuICAgICAgIiksdD0icGFja2VkVVZmcm9tMkQiLGVbdF09bmV3IG8uR2xzbExpYlJvdXRpbmUoIlxuICAgICAgdmVjMiBwYWNrZWRVVmZyb20yRChpbnQgdGV4TnVtUiwgaW50IHRleE51bUMsIGludCB0ZXhlbHNJbkxvZ2ljYWxSb3csIGludCByb3csIGludCBjb2wpIHtcbiAgICAgICAgaW50IHRleGVsSW5kZXggPSAocm93IC8gMikgKiB0ZXhlbHNJbkxvZ2ljYWxSb3cgKyAoY29sIC8gMik7XG4gICAgICAgIGludCB0ZXhSID0gdGV4ZWxJbmRleCAvIHRleE51bUM7XG4gICAgICAgIGludCB0ZXhDID0gdGV4ZWxJbmRleCAtIHRleFIgKiB0ZXhOdW1DO1xuICAgICAgICByZXR1cm4gKHZlYzIodGV4QywgdGV4UikgKyBoYWxmQ1IpIC8gdmVjMih0ZXhOdW1DLCB0ZXhOdW1SKTtcbiAgICAgIH1cbiAgICAgICIpLHQ9InBhY2tlZFVWZnJvbTNEIixlW3RdPW5ldyBvLkdsc2xMaWJSb3V0aW5lKCJcbiAgICAgIHZlYzIgcGFja2VkVVZmcm9tM0QoaW50IHRleE51bVIsIGludCB0ZXhOdW1DLFxuICAgICAgICAgIGludCB0ZXhlbHNJbkJhdGNoLCBpbnQgdGV4ZWxzSW5Mb2dpY2FsUm93LCBpbnQgYixcbiAgICAgICAgICBpbnQgcm93LCBpbnQgY29sKSB7XG4gICAgICAgIGludCBpbmRleCA9IGIgKiB0ZXhlbHNJbkJhdGNoICsgKHJvdyAvIDIpICogdGV4ZWxzSW5Mb2dpY2FsUm93ICsgKGNvbCAvIDIpO1xuICAgICAgICBpbnQgdGV4UiA9IGluZGV4IC8gdGV4TnVtQztcbiAgICAgICAgaW50IHRleEMgPSBpbmRleCAtIHRleFIgKiB0ZXhOdW1DO1xuICAgICAgICByZXR1cm4gKHZlYzIodGV4QywgdGV4UikgKyBoYWxmQ1IpIC8gdmVjMih0ZXhOdW1DLCB0ZXhOdW1SKTtcbiAgICAgIH1cbiAgICAgICIpLHQ9InNhbXBsZVRleHR1cmUiO2NvbnN0IG49KDAsIGkuZ2V0R2xzbCkodGhpcy5jb250ZXh0LmdsQ29udGV4dC52ZXJzaW9uKTtyZXR1cm4gZVt0XT1uZXcgby5HbHNsTGliUm91dGluZShgXG4gICAgICAgIGZsb2F0IHNhbXBsZVRleHR1cmUoc2FtcGxlcjJEIHRleHR1cmVTYW1wbGVyLCB2ZWMyIHV2KSB7XG4gICAgICAgICAgICByZXR1cm4gJHtuLnRleHR1cmUyRH0odGV4dHVyZVNhbXBsZXIsIHV2KS5yO1xuICAgICAgICB9YCksZX1nZXRJbnB1dHNTYW1wbGluZ1NuaXBwZXRzKCl7Y29uc3QgZT17fSx0PXRoaXMuY29udGV4dC5vdXRwdXRUZXh0dXJlTGF5b3V0O3JldHVybiB0aGlzLmNvbnRleHQucHJvZ3JhbUluZm8uaW5wdXROYW1lcy5mb3JFYWNoKCgobixyKT0+e2NvbnN0IG89dGhpcy5jb250ZXh0LmlucHV0VGV4dHVyZUxheW91dHNbcl0saT0oMCwgYS5nZW5lcmF0ZVNoYWRlckZ1bmNOYW1lRnJvbUlucHV0U2FtcGxlck5hbWUpKG4pO28uaXNQYWNrZWQ/ZVtpXT10aGlzLmdldFBhY2tlZFNhbXBsZXJGcm9tSW5wdXQoaSxuLG8pOmVbaV09dGhpcy5nZXRVbnBhY2tlZFNhbXBsZXJGcm9tSW5wdXQoaSxuLG8pO2NvbnN0IHM9KDAsIGEuZ2VuZXJhdGVTaGFkZXJGdW5jTmFtZUZyb21JbnB1dFNhbXBsZXJOYW1lQXRPdXRDb29yZHMpKG4pO28udW5wYWNrZWRTaGFwZS5sZW5ndGg8PXQudW5wYWNrZWRTaGFwZS5sZW5ndGgmJihvLmlzUGFja2VkP2Vbc109dGhpcy5nZXRQYWNrZWRTYW1wbGVyQXRPdXRwdXRDb29yZHMocyxvLHQsbik6ZVtzXT10aGlzLmdldFVucGFja2VkU2FtcGxlckF0T3V0cHV0Q29vcmRzKHMsbyx0LG4pKTt9KSksZX1nZXRQYWNrZWRTYW1wbGVyQXRPdXRwdXRDb29yZHMoZSx0LG4saSl7Y29uc3Qgcz10LnVucGFja2VkU2hhcGUsdT1uLnVucGFja2VkU2hhcGUsbD1pLGM9KDAsIGEuZ2VuZXJhdGVTaGFkZXJGdW5jTmFtZUZyb21JbnB1dFNhbXBsZXJOYW1lKShsKSxwPXMubGVuZ3RoLGQ9dS5sZW5ndGgsZj1yLkJyb2FkY2FzdFV0aWwuZ2V0QnJvYWRjYXN0RGltcyhzLHUpLGg9KDAsIGEuZ2V0Q29vcmRzRGF0YVR5cGUpKGQpLGc9ZC1wO2xldCBiO2NvbnN0IG09KDAsIGEuZ2V0R2xDaGFubmVscykoKTtiPTA9PT1wPyIiOmQ8MiYmZi5sZW5ndGg+PTE/ImNvb3JkcyA9IDA7IjpmLm1hcCgoZT0+YGNvb3Jkcy4ke21bZStnXX0gPSAwO2ApKS5qb2luKCJcbiIpO2xldCB5PSIiO3k9ZDwyJiZwPjA/ImNvb3JkcyI6cy5tYXAoKChlLHQpPT5gY29vcmRzLiR7bVt0K2ddfWApKS5qb2luKCIsICIpO2xldCB2PSJyZXR1cm4gb3V0cHV0VmFsdWU7Ijtjb25zdCBfPTE9PT1yLlNoYXBlVXRpbC5zaXplKHMpLHc9MT09PXIuU2hhcGVVdGlsLnNpemUodSk7aWYoMSE9PXB8fF98fHcpe2lmKF8mJiF3KXY9MT09PWQ/IlxuICAgICAgICAgIHJldHVybiB2ZWM0KG91dHB1dFZhbHVlLngsIG91dHB1dFZhbHVlLngsIDAuLCAwLik7XG4gICAgICAgICI6IlxuICAgICAgICAgIHJldHVybiB2ZWM0KG91dHB1dFZhbHVlLngpO1xuICAgICAgICAiO2Vsc2UgaWYoZi5sZW5ndGgpe2NvbnN0IGU9cC0yLHQ9cC0xO2YuaW5kZXhPZihlKT4tMSYmZi5pbmRleE9mKHQpPi0xP3Y9InJldHVybiB2ZWM0KG91dHB1dFZhbHVlLngpOyI6Zi5pbmRleE9mKGUpPi0xP3Y9InJldHVybiB2ZWM0KG91dHB1dFZhbHVlLngsIG91dHB1dFZhbHVlLnksIG91dHB1dFZhbHVlLngsIG91dHB1dFZhbHVlLnkpOyI6Zi5pbmRleE9mKHQpPi0xJiYodj0icmV0dXJuIHZlYzQob3V0cHV0VmFsdWUueHgsIG91dHB1dFZhbHVlLnp6KTsiKTt9fWVsc2Ugdj0iXG4gICAgICAgIHJldHVybiB2ZWM0KG91dHB1dFZhbHVlLnh5LCBvdXRwdXRWYWx1ZS54eSk7XG4gICAgICAiO2NvbnN0IFQ9YFxuICAgICAgdmVjNCAke2V9KCkge1xuICAgICAgICAke2h9IGNvb3JkcyA9IGdldE91dHB1dENvb3JkcygpO1xuICAgICAgICBcbiAgICAgICAgaW50IGxhc3REaW0gPSBjb29yZHMuJHttW2QtMV19O1xuICAgICAgICBjb29yZHMuJHttW2QtMV19ID0gY29vcmRzLiR7bVtkLTJdfTtcbiAgICAgICAgY29vcmRzLiR7bVtkLTJdfSA9IGxhc3REaW07XG4gICAgICBcbiAgICAgICAgJHtifVxuICAgICAgICB2ZWM0IG91dHB1dFZhbHVlID0gJHtjfSgke3l9KTtcbiAgICAgICAgJHt2fVxuICAgICAgfVxuICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKFQsWyJjb29yZGluYXRlcy5nZXRPdXRwdXRDb29yZHMiXSl9Z2V0VW5wYWNrZWRTYW1wbGVyQXRPdXRwdXRDb29yZHMoZSx0LG4saSl7Y29uc3Qgcz1bbi53aWR0aCxuLmhlaWdodF0sdT1bdC53aWR0aCx0LmhlaWdodF0sbD10LnVucGFja2VkU2hhcGUubGVuZ3RoLGM9bi51bnBhY2tlZFNoYXBlLmxlbmd0aCxwPXQudW5wYWNrZWRTaGFwZSxkPW4udW5wYWNrZWRTaGFwZSxmPSgwLCBhLmdlbmVyYXRlU2hhZGVyRnVuY05hbWVGcm9tSW5wdXRTYW1wbGVyTmFtZSkoaSk7aWYobD09PWMmJnIuQXJyYXlVdGlsLmFycmF5c0VxdWFsKHUscykpe2NvbnN0IHQ9YFxuICAgICAgICAgIGZsb2F0ICR7ZX0oKSB7XG4gICAgICAgICAgICByZXR1cm4gc2FtcGxlVGV4dHVyZSgke2l9LCBUZXhDb29yZHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUodCxbImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiXSl9Y29uc3QgaD0oMCwgYS5nZXRDb29yZHNEYXRhVHlwZSkoYyksZz1yLkJyb2FkY2FzdFV0aWwuZ2V0QnJvYWRjYXN0RGltcyhwLGQpLGI9Yy1sO2xldCBtO2NvbnN0IHk9KDAsIGEuZ2V0R2xDaGFubmVscykoKTttPTA9PT1sPyIiOmM8MiYmZy5sZW5ndGg+PTE/ImNvb3JkcyA9IDA7IjpnLm1hcCgoZT0+YGNvb3Jkcy4ke3lbZStiXX0gPSAwO2ApKS5qb2luKCJcbiIpO2xldCB2PSIiO3Y9YzwyJiZsPjA/ImNvb3JkcyI6dC51bnBhY2tlZFNoYXBlLm1hcCgoKGUsdCk9PmBjb29yZHMuJHt5W3QrYl19YCkpLmpvaW4oIiwgIik7Y29uc3QgXz1gXG4gICAgICAgIGZsb2F0ICR7ZX0oKSB7XG4gICAgICAgICAgJHtofSBjb29yZHMgPSBnZXRPdXRwdXRDb29yZHMoKTtcbiAgICAgICAgICAke219XG4gICAgICAgICAgcmV0dXJuICR7Zn0oJHt2fSk7XG4gICAgICAgIH1cbiAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKF8sWyJjb29yZGluYXRlcy5nZXRPdXRwdXRDb29yZHMiXSl9Z2V0UGFja2VkU2FtcGxlckZyb21JbnB1dChlLHQsbil7c3dpdGNoKG4udW5wYWNrZWRTaGFwZS5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gdGhpcy5nZXRQYWNrZWRTYW1wbGVyU2NhbGFyKGUsdCk7Y2FzZSAxOnJldHVybiB0aGlzLmdldFBhY2tlZFNhbXBsZXIxRChlLHQsbik7Y2FzZSAyOnJldHVybiB0aGlzLmdldFBhY2tlZFNhbXBsZXIyRChlLHQsbik7Y2FzZSAzOnJldHVybiB0aGlzLmdldFBhY2tlZFNhbXBsZXIzRChlLHQsbik7ZGVmYXVsdDpyZXR1cm4gdGhpcy5nZXRQYWNrZWRTYW1wbGVyTkQoZSx0LG4pfX1nZXRVbnBhY2tlZFNhbXBsZXJGcm9tSW5wdXQoZSx0LG4pe2NvbnN0IHI9bi51bnBhY2tlZFNoYXBlO3N3aXRjaChyLmxlbmd0aCl7Y2FzZSAwOnJldHVybiB0aGlzLmdldFVucGFja2VkU2FtcGxlclNjYWxhcihlLHQsbik7Y2FzZSAxOnJldHVybiB0aGlzLmdldFVucGFja2VkU2FtcGxlcjFEKGUsdCxuKTtjYXNlIDI6cmV0dXJuIHRoaXMuZ2V0VW5wYWNrZWRTYW1wbGVyMkQoZSx0LG4pO2Nhc2UgMzpyZXR1cm4gdGhpcy5nZXRVbnBhY2tlZFNhbXBsZXIzRChlLHQsbik7Y2FzZSA0OnJldHVybiB0aGlzLmdldFVucGFja2VkU2FtcGxlcjREKGUsdCxuKTtjYXNlIDU6cmV0dXJuIHRoaXMuZ2V0VW5wYWNrZWRTYW1wbGVyNUQoZSx0LG4pO2Nhc2UgNjpyZXR1cm4gdGhpcy5nZXRVbnBhY2tlZFNhbXBsZXI2RChlLHQsbik7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGRpbWVuc2lvbiAke3IubGVuZ3RofS1EYCl9fWdldFBhY2tlZFNhbXBsZXJTY2FsYXIoZSx0KXtjb25zdCBuPWBcbiAgICAgICAgICB2ZWM0ICR7ZX0oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHsoMCwgaS5nZXRHbHNsKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pLnRleHR1cmUyRH0oJHt0fSwgaGFsZkNSKTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKG4pfWdldFBhY2tlZFNhbXBsZXIxRChlLHQsbil7Y29uc3Qgcj1bbi53aWR0aCxuLmhlaWdodF0scz1bclsxXSxyWzBdXSxhPSgwLCBpLmdldEdsc2wpKHRoaXMuY29udGV4dC5nbENvbnRleHQudmVyc2lvbiksdT1gdmVjNCAke2V9KGludCBpbmRleCkge1xuICAgICAgdmVjMiB1diA9IHBhY2tlZFVWZnJvbTFEKFxuICAgICAgJHtzWzBdfSwgJHtzWzFdfSwgaW5kZXgpO1xuICAgICAgcmV0dXJuICR7YS50ZXh0dXJlMkR9KCR7dH0sIHV2KTtcbiAgICB9YDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUodSxbImNvb3JkaW5hdGVzLnBhY2tlZFVWZnJvbTFEIl0pfWdldFBhY2tlZFNhbXBsZXIyRChlLHQsbil7Y29uc3Qgcz1uLnVucGFja2VkU2hhcGUsYT1bbi53aWR0aCxuLmhlaWdodF0sdT0oMCwgaS5nZXRHbHNsKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pLGw9YVswXSxjPWFbMV07aWYobnVsbCE9YSYmci5BcnJheVV0aWwuYXJyYXlzRXF1YWwocyxhKSl7Y29uc3Qgbj1gdmVjNCAke2V9KGludCByb3csIGludCBjb2wpIHtcbiAgICAgICAgdmVjMiB1diA9ICh2ZWMyKGNvbCwgcm93KSArIGhhbGZDUikgLyB2ZWMyKCR7Y30uMCwgJHtsfS4wKTtcbiAgICAgICAgcmV0dXJuICR7dS50ZXh0dXJlMkR9KCR7dH0sIHV2KTtcbiAgICAgIH1gO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShuKX1jb25zdCBwPWEsZD1NYXRoLmNlaWwoc1sxXS8yKSxmPWB2ZWM0ICR7ZX0oaW50IHJvdywgaW50IGNvbCkge1xuICAgICAgdmVjMiB1diA9IHBhY2tlZFVWZnJvbTJEKCR7cFsxXX0sICR7cFswXX0sICR7ZH0sIHJvdywgY29sKTtcbiAgICAgIHJldHVybiAke3UudGV4dHVyZTJEfSgke3R9LCB1dik7XG4gICAgfWA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKGYsWyJjb29yZGluYXRlcy5wYWNrZWRVVmZyb20yRCJdKX1nZXRQYWNrZWRTYW1wbGVyM0QoZSx0LG4pe2NvbnN0IHI9bi51bnBhY2tlZFNoYXBlLHM9W24ud2lkdGgsbi5oZWlnaHRdLHU9W3NbMF0sc1sxXV0sbD0oMCwgaS5nZXRHbHNsKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pO2lmKDE9PT1yWzBdKXtjb25zdCBpPXIuc2xpY2UoMSkscz1bMSwyXSx1PSgwLCBhLnNxdWVlemVJbnB1dFNoYXBlKShyLGkpLGw9WyJiIiwicm93IiwiY29sIl0sYz1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG4pKTtjLnVucGFja2VkU2hhcGU9dTtjb25zdCBwPXRoaXMuZ2V0UGFja2VkU2FtcGxlckZyb21JbnB1dChlLHQsYyksZD1gJHtwLnJvdXRpbmVCb2R5fVxuICAgICAgdmVjNCAke2V9KGludCBiLCBpbnQgcm93LCBpbnQgY29sKSB7XG4gICAgICAgIHJldHVybiAke2V9KCR7KDAsIGEuZ2V0U3F1ZWV6ZWRQYXJhbXMpKGwscyl9KTtcbiAgICAgIH0gYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUoZCxwLmRlcGVuZGVuY2llcyl9Y29uc3QgYz11WzBdLHA9dVsxXSxkPU1hdGguY2VpbChyWzJdLzIpLGY9YHZlYzQgJHtlfShpbnQgYiwgaW50IHJvdywgaW50IGNvbCkge1xuICAgICAgdmVjMiB1diA9IHBhY2tlZFVWZnJvbTNEKFxuICAgICAgICAke3B9LCAke2N9LCAke2QqTWF0aC5jZWlsKHJbMV0vMil9LCAke2R9LCBiLCByb3csIGNvbCk7XG4gICAgICByZXR1cm4gJHtsLnRleHR1cmUyRH0oJHt0fSwgdXYpO31gO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShmLFsiY29vcmRpbmF0ZXMucGFja2VkVVZmcm9tM0QiXSl9Z2V0UGFja2VkU2FtcGxlck5EKGUsdCxuKXtjb25zdCByPW4udW5wYWNrZWRTaGFwZSxzPXIubGVuZ3RoLGE9W24ud2lkdGgsbi5oZWlnaHRdLHU9KDAsIGkuZ2V0R2xzbCkodGhpcy5jb250ZXh0LmdsQ29udGV4dC52ZXJzaW9uKSxsPVthWzBdLGFbMV1dLGM9bFsxXSxwPWxbMF0sZD1NYXRoLmNlaWwocltzLTFdLzIpO2xldCBmPWQqTWF0aC5jZWlsKHJbcy0yXS8yKSxoPSJpbnQgYiwgaW50IHJvdywgaW50IGNvbCIsZz1gYiAqICR7Zn0gKyAocm93IC8gMikgKiAke2R9ICsgKGNvbCAvIDIpYDtmb3IobGV0IGU9MjtlPHMtMTtlKyspaD1gaW50IGIke2V9LCBgK2gsZio9cltzLWUtMV0sZz1gYiR7ZX0gKiAke2Z9ICsgYCtnO2NvbnN0IGI9YHZlYzQgJHtlfSgke2h9KSB7XG4gICAgICBpbnQgaW5kZXggPSAke2d9O1xuICAgICAgaW50IHRleFIgPSBpbmRleCAvICR7cH07XG4gICAgICBpbnQgdGV4QyA9IGluZGV4IC0gdGV4UiAqICR7cH07XG4gICAgICB2ZWMyIHV2ID0gKHZlYzIodGV4QywgdGV4UikgKyBoYWxmQ1IpIC8gdmVjMigke3B9LCAke2N9KTtcbiAgICAgIHJldHVybiAke3UudGV4dHVyZTJEfSgke3R9LCB1dik7XG4gICAgfWA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKGIpfWdldFVucGFja2VkU2FtcGxlclNjYWxhcihlLHQsbil7Y29uc3RbcixpXT1bbi53aWR0aCxuLmhlaWdodF07aWYoMT09PXImJjE9PT1pKXtjb25zdCBuPWBcbiAgICAgICAgICBmbG9hdCAke2V9KCkge1xuICAgICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgaGFsZkNSKTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKG4sWyJjb29yZGluYXRlcy5zYW1wbGVUZXh0dXJlIl0pfWNvbnN0IHM9YFxuICAgICAgICBmbG9hdCAke2V9KCkge1xuICAgICAgICAgIGludCBvZmZzZXRfJHt0fSA9IGNvb3Jkc1RvT2Zmc2V0KFRleENvb3JkcywgJHtyfSwgJHtpfSk7XG4gICAgICAgICAgdmVjMiB1diA9IHV2RnJvbUZsYXQoJHtyfSwgJHtpfSwgb2Zmc2V0XyR7dH0pO1xuICAgICAgICAgIHJldHVybiBzYW1wbGVUZXh0dXJlKCR7dH0sIHV2KTtcbiAgICAgICAgfVxuICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUocyxbImNvb3JkaW5hdGVzLnV2RnJvbUZsYXQiLCJjb29yZGluYXRlcy5zYW1wbGVUZXh0dXJlIiwiY29vcmRpbmF0ZXMuY29vcmRzVG9PZmZzZXQiXSl9Z2V0VW5wYWNrZWRTYW1wbGVyMUQoZSx0LG4pe2NvbnN0IHI9bi53aWR0aCxpPW4uaGVpZ2h0O2lmKDE9PT1pJiYxPT09cil7Y29uc3Qgbj1gXG4gICAgICAgIGZsb2F0ICR7ZX0oaW50IGluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgaGFsZkNSKTtcbiAgICAgICAgfVxuICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobixbImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiXSl9aWYoMT09PWkpe2NvbnN0IG49YFxuICAgICAgICAgIGZsb2F0ICR7ZX0oaW50IGluZGV4KSB7XG4gICAgICAgICAgICB2ZWMyIHV2ID0gdmVjMigoZmxvYXQoaW5kZXgpICsgMC41KSAvICR7cn0uMCwgMC41KTtcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVUZXh0dXJlKCR7dH0sIHV2KTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKG4sWyJjb29yZGluYXRlcy5zYW1wbGVUZXh0dXJlIl0pfWlmKDE9PT1yKXtjb25zdCBuPWBcbiAgICAgICAgICBmbG9hdCAke2V9KGludCBpbmRleCkge1xuICAgICAgICAgICAgdmVjMiB1diA9IHZlYzIoMC41LCAoZmxvYXQoaW5kZXgpICsgMC41KSAvICR7aX0uMCk7XG4gICAgICAgICAgICByZXR1cm4gc2FtcGxlVGV4dHVyZSgke3R9LCB1dik7XG4gICAgICAgICAgfVxuICAgICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShuLFsiY29vcmRpbmF0ZXMuc2FtcGxlVGV4dHVyZSJdKX1jb25zdCBzPWBcbiAgICAgICAgZmxvYXQgJHtlfShpbnQgaW5kZXgpIHtcbiAgICAgICAgICB2ZWMyIHV2ID0gdXZGcm9tRmxhdCgke3J9LCAke2l9LCBpbmRleCk7XG4gICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgdXYpO1xuICAgICAgICB9XG4gICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShzLFsiY29vcmRpbmF0ZXMudXZGcm9tRmxhdCIsImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiXSl9Z2V0VW5wYWNrZWRTYW1wbGVyMkQoZSx0LG4pe2NvbnN0IGk9bi51bnBhY2tlZFNoYXBlLHU9W24uaGVpZ2h0LG4ud2lkdGhdO2lmKG51bGwhPXUmJnIuQXJyYXlVdGlsLmFycmF5c0VxdWFsKGksdSkpe2NvbnN0IG49YFxuICAgICAgICAgIGZsb2F0ICR7ZX0oaW50IHJvdywgaW50IGNvbCkge1xuICAgICAgICAgICAgdmVjMiB1diA9ICh2ZWMyKHJvdywgY29sKSArIGhhbGZDUikgLyB2ZWMyKCR7dVsxXX0uMCwgJHt1WzBdfS4wKTtcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVUZXh0dXJlKCR7dH0sIHV2KTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKG4sWyJjb29yZGluYXRlcy5zYW1wbGVUZXh0dXJlIl0pfWNvbnN0e25ld1NoYXBlOmwsa2VwdERpbXM6Y309KDAsIHMuc3F1ZWV6ZVNoYXBlKShpKSxwPWw7aWYocC5sZW5ndGg8aS5sZW5ndGgpe2NvbnN0IHI9KDAsIGEuc3F1ZWV6ZUlucHV0U2hhcGUpKGkscCkscz1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG4pKTtzLnVucGFja2VkU2hhcGU9cjtjb25zdCB1PVsiY29sIiwicm93Il0sbD1gXG4gICAgICAgICAgJHt0aGlzLmdldFVucGFja2VkU2FtcGxlckZyb21JbnB1dChlLHQscykucm91dGluZUJvZHl9XG4gICAgICAgICAgZmxvYXQgJHtlfShpbnQgcm93LCBpbnQgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJHtlfSgkeygwLCBhLmdldFNxdWVlemVkUGFyYW1zKSh1LGMpfSk7XG4gICAgICAgICAgfVxuICAgICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShsLFsiY29vcmRpbmF0ZXMuc2FtcGxlVGV4dHVyZSJdKX1jb25zdCBkPXVbMV0sZj11WzBdO2lmKDE9PT1mKXtjb25zdCBuPWBcbiAgICAgICAgICBmbG9hdCAke2V9KGludCByb3csIGludCBjb2wpIHtcbiAgICAgICAgICAgIGludCBvZmZzZXRfJHt0fSA9IGNvb3Jkc1RvT2Zmc2V0KFRleENvb3JkcywgJHtkfSwgJHtmfSk7XG4gICAgICAgICAgICBmbG9hdCBpbmRleCA9IGRvdCh2ZWMzKHJvdywgY29sLCBvZmZzZXRfJHt0fSksIHZlYzMoJHtpWzFdfSwgMSwgMSkpO1xuICAgICAgICAgICAgdmVjMiB1diA9IHZlYzIoMC41LCAoaW5kZXggKyAwLjUpIC8gJHtkfS4wKTtcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVUZXh0dXJlKCR7dH0sIHV2KTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKG4sWyJjb29yZGluYXRlcy5zYW1wbGVUZXh0dXJlIiwiY29vcmRpbmF0ZXMuY29vcmRzVG9PZmZzZXQiXSl9aWYoMT09PWQpe2NvbnN0IG49YFxuICAgICAgICAgIGZsb2F0ICR7ZX0oaW50IHJvdywgaW50IGNvbCkge1xuICAgICAgICAgICAgaW50IG9mZnNldF8ke3R9ID0gY29vcmRzVG9PZmZzZXQoVGV4Q29vcmRzLCAke2R9LCAke2Z9KTtcbiAgICAgICAgICAgIGZsb2F0IGluZGV4ID0gZG90KHZlYzMocm93LCBjb2wsIG9mZnNldF8ke3R9KSwgdmVjMygke2lbMV19LCAxLCAxKSk7XG4gICAgICAgICAgICB2ZWMyIHV2ID0gdmVjMigoaW5kZXggKyAwLjUpIC8gJHtmfS4wLCAwLjUpO1xuICAgICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgdXYpO1xuICAgICAgICAgIH1cbiAgICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobixbImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiLCJjb29yZGluYXRlcy5jb29yZHNUb09mZnNldCJdKX1jb25zdCBoPWBcbiAgICAgICAgZmxvYXQgJHtlfShpbnQgcm93LCBpbnQgY29sKSB7XG4gICAgICAgICAgaW50IGluZGV4ID0gY29sICogJHtpWzFdfSArIHJvdztcbiAgICAgICAgICB2ZWMyIHV2ID0gdXZGcm9tRmxhdCgke2R9LCAke2Z9LCBpbmRleCk7XG4gICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgdXYpO1xuICAgICAgICB9XG4gICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShoLFsiY29vcmRpbmF0ZXMudXZGcm9tRmxhdCIsImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiLCJjb29yZGluYXRlcy5jb29yZHNUb09mZnNldCJdKX1nZXRVbnBhY2tlZFNhbXBsZXIzRChlLHQsbil7Y29uc3Qgcj1uLnVucGFja2VkU2hhcGUsaT1yWzFdKnJbMl0sdT1yWzJdLHtuZXdTaGFwZTpsLGtlcHREaW1zOmN9PSgwLCBzLnNxdWVlemVTaGFwZSkocikscD1sO2lmKHAubGVuZ3RoPHIubGVuZ3RoKXtjb25zdCBpPSgwLCBhLnNxdWVlemVJbnB1dFNoYXBlKShyLHApLHM9WyJiYXRjaCIsImNvbCIsInJvdyJdLHU9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShuKSk7dS51bnBhY2tlZFNoYXBlPWk7Y29uc3QgbD10aGlzLmdldFVucGFja2VkU2FtcGxlckZyb21JbnB1dChlLHQsdSksZD1jLnJldmVyc2UoKSxmPWBcbiAgICAgICAgICAke2wucm91dGluZUJvZHl9XG4gICAgICAgICAgZmxvYXQgJHtlfShpbnQgYmF0Y2gsIGludCByb3csIGludCBjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiAke2V9KCR7KDAsIGEuZ2V0U3F1ZWV6ZWRQYXJhbXMpKHMsZCl9KTtcbiAgICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKGYsbC5kZXBlbmRlbmNpZXMpfWNvbnN0IGQ9YFxuICAgICAgICAgIGZsb2F0ICR7ZX0oaW50IGRlcHRoLCBpbnQgcm93LCBpbnQgY29sKSB7XG4gICAgICAgICAgICAvLyBFeHBsaWNpdGx5IHVzZSBpbnRlZ2VyIG9wZXJhdGlvbnMgYXMgZG90KCkgb25seSB3b3JrcyBvbiBmbG9hdHMuXG4gICAgICAgICAgICBpbnQgaW5kZXggPSBkZXB0aCAqICR7aX0gKyBjb2wgKiAke3V9ICsgcm93O1xuICAgICAgICAgICAgdmVjMiB1diA9IHV2RnJvbUZsYXQoJHtuLndpZHRofSwgJHtuLmhlaWdodH0sIGluZGV4KTtcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVUZXh0dXJlKCR7dH0sIHV2KTtcbiAgICAgICAgICB9XG4gICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShkLFsiY29vcmRpbmF0ZXMudXZGcm9tRmxhdCIsImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiLCJjb29yZGluYXRlcy5jb29yZHNUb09mZnNldCJdKX1nZXRVbnBhY2tlZFNhbXBsZXI0RChlLHQsbil7Y29uc3Qgcj1uLnVucGFja2VkU2hhcGUsaT1yWzNdLHM9clsyXSppLGE9YFxuICAgICAgICBmbG9hdCAke2V9KGludCByb3csIGludCBjb2wsIGludCBkZXB0aCwgaW50IGRlcHRoMikge1xuICAgICAgICAgIGludCBpbmRleCA9IHJvdyAqICR7clsxXSpzfSArIGNvbCAqICR7c30gK1xuICAgICAgICAgICAgICBkZXB0aDIgKiAke2l9ICsgZGVwdGg7XG4gICAgICAgICAgdmVjMiB1diA9IHV2RnJvbUZsYXQoJHtuLndpZHRofSwgJHtuLmhlaWdodH0sIGluZGV4KTtcbiAgICAgICAgICByZXR1cm4gc2FtcGxlVGV4dHVyZSgke3R9LCB1dik7XG4gICAgICAgIH1cbiAgICAgIGA7cmV0dXJuIG5ldyBvLkdsc2xMaWJSb3V0aW5lKGEsWyJjb29yZGluYXRlcy51dkZyb21GbGF0IiwiY29vcmRpbmF0ZXMuc2FtcGxlVGV4dHVyZSJdKX1nZXRVbnBhY2tlZFNhbXBsZXI1RChlLHQsbil7Y29uc3Qgcj1uLnVucGFja2VkU2hhcGUsaT1yWzRdLHU9clszXSppLGw9clsyXSp1LGM9clsxXSpsLHtuZXdTaGFwZTpwLGtlcHREaW1zOmR9PSgwLCBzLnNxdWVlemVTaGFwZSkocik7aWYocC5sZW5ndGg8ci5sZW5ndGgpe2NvbnN0IGk9KDAsIGEuc3F1ZWV6ZUlucHV0U2hhcGUpKHIscCkscz1bInJvdyIsImNvbCIsImRlcHRoIiwiZGVwdGgyIiwiZGVwdGgzIl0sdT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG4pKTt1LnVucGFja2VkU2hhcGU9aTtjb25zdCBsPWBcbiAgICAgICAgICAke3RoaXMuZ2V0VW5wYWNrZWRTYW1wbGVyRnJvbUlucHV0KGUsdCx1KS5yb3V0aW5lQm9keX1cbiAgICAgICAgICBmbG9hdCAke2V9KGludCByb3csIGludCBjb2wsIGludCBkZXB0aCwgaW50IGRlcHRoMiwgaW50IGRlcHRoMykge1xuICAgICAgICAgICAgcmV0dXJuICR7ZX0oJHsoMCwgYS5nZXRTcXVlZXplZFBhcmFtcykocyxkKX0pO1xuICAgICAgICAgIH1cbiAgICAgICAgYDtyZXR1cm4gbmV3IG8uR2xzbExpYlJvdXRpbmUobCxbImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiLCJjb29yZGluYXRlcy51dkZyb21GbGF0Il0pfWNvbnN0IGY9YFxuICAgICAgICBmbG9hdCAke2V9KGludCByb3csIGludCBjb2wsIGludCBkZXB0aCwgaW50IGRlcHRoMiwgaW50IGRlcHRoMykge1xuICAgICAgICAgIGludCBpbmRleCA9IHJvdyAqICR7Y30gKyBjb2wgKiAke2x9ICsgZGVwdGggKiAke3V9ICtcbiAgICAgICAgICBkZXB0aDMgKiAke2l9ICsgZGVwdGgyO1xuICAgICAgICAgIHZlYzIgdXYgPSB1dkZyb21GbGF0KCR7bi53aWR0aH0sICR7bi5oZWlnaHR9LCBpbmRleCk7XG4gICAgICAgICAgcmV0dXJuIHNhbXBsZVRleHR1cmUoJHt0fSwgdXYpO1xuICAgICAgICB9XG4gICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShmLFsiY29vcmRpbmF0ZXMuc2FtcGxlVGV4dHVyZSIsImNvb3JkaW5hdGVzLnV2RnJvbUZsYXQiXSl9Z2V0VW5wYWNrZWRTYW1wbGVyNkQoZSx0LG4pe2NvbnN0IHI9bi51bnBhY2tlZFNoYXBlLGk9cls1XSx1PXJbNF0qaSxsPXJbM10qdSxjPXJbMl0qbCxwPXJbMV0qYyx7bmV3U2hhcGU6ZCxrZXB0RGltczpmfT0oMCwgcy5zcXVlZXplU2hhcGUpKHIpO2lmKGQubGVuZ3RoPHIubGVuZ3RoKXtjb25zdCBpPSgwLCBhLnNxdWVlemVJbnB1dFNoYXBlKShyLGQpLHM9WyJyb3ciLCJjb2wiLCJkZXB0aCIsImRlcHRoMiIsImRlcHRoMyIsImRlcHRoNCJdLHU9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShuKSk7dS51bnBhY2tlZFNoYXBlPWk7Y29uc3QgbD1gXG4gICAgICAgICAgICAke3RoaXMuZ2V0VW5wYWNrZWRTYW1wbGVyRnJvbUlucHV0KGUsdCx1KS5yb3V0aW5lQm9keX1cbiAgICAgICAgICAgIGZsb2F0ICR7ZX0oaW50IHJvdywgaW50IGNvbCwgaW50IGRlcHRoLFxuICAgICAgICAgICAgICBpbnQgZGVwdGgyLCBpbnQgZGVwdGgzLCBpbnQgZGVwdGg0KSB7XG4gICAgICAgICAgICAgIHJldHVybiAke2V9KCR7KDAsIGEuZ2V0U3F1ZWV6ZWRQYXJhbXMpKHMsZil9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShsLFsiY29vcmRpbmF0ZXMuc2FtcGxlVGV4dHVyZSIsImNvb3JkaW5hdGVzLnV2RnJvbUZsYXQiXSl9Y29uc3QgaD1gXG4gICAgICAgICAgZmxvYXQgJHtlfShpbnQgcm93LCBpbnQgY29sLCBpbnQgZGVwdGgsXG4gICAgICAgICAgICBpbnQgZGVwdGgyLCBpbnQgZGVwdGgzLCBpbnQgZGVwdGg0KSB7XG4gICAgICAgICAgICBpbnQgaW5kZXggPSByb3cgKiAke3B9ICsgY29sICogJHtjfSArIGRlcHRoICogJHtsfSArXG4gICAgICAgICAgICBkZXB0aDIgKiAke3V9ICsgZGVwdGgzICogJHtpfSArIGRlcHRoNDtcbiAgICAgICAgICAgIHZlYzIgdXYgPSB1dkZyb21GbGF0KCR7bi53aWR0aH0sICR7bi5oZWlnaHR9LCBpbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gc2FtcGxlVGV4dHVyZSgke3R9LCB1dik7XG4gICAgICAgICAgfVxuICAgICAgICBgO3JldHVybiBuZXcgby5HbHNsTGliUm91dGluZShoLFsiY29vcmRpbmF0ZXMudXZGcm9tRmxhdCIsImNvb3JkaW5hdGVzLnNhbXBsZVRleHR1cmUiLCJjb29yZGluYXRlcy5jb29yZHNUb09mZnNldCJdKX10b1ZlYygpe2NvbnN0IGU9dGhpcy5jb250ZXh0Lm91dHB1dFRleHR1cmVMYXlvdXQsdD1lLnNoYXBlLmxlbmd0aCxuPWUuc3RyaWRlcyxyPWUud2lkdGgsaT1lLmhlaWdodCxzPVtdO2ZvcihsZXQgZT0wO2U8dC0xOysrZSlzLnB1c2goYFxuICAgICAgICBjWyR7ZX1dID0gb2Zmc2V0IC8gJHtuW2VdfTtgKSxzLnB1c2goYFxuICAgICAgICBvZmZzZXQgLT0gY1ske2V9XSAqICR7bltlXX07YCk7cy5wdXNoKGBcbiAgICAgICAgY1ske3QtMX1dID0gb2Zmc2V0O2ApO2NvbnN0IGE9YFxuICAgICAgdm9pZCB0b1ZlYyh2ZWMyIHRleENvb3Jkcywgb3V0IGludCBjWyR7dH1dKSB7XG4gICAgICAgIGludCBvZmZzZXQgPSBjb29yZHNUb09mZnNldCh0ZXhDb29yZHMsICR7cn0sICR7aX0pO1xuICAgICAgICAke3Muam9pbigiIil9XG4gICAgICB9XG4gICAgICB2b2lkIHRvVmVjKGludCBvZmZzZXQsIG91dCBpbnQgY1ske3R9XSkge1xuICAgICAgICAke3Muam9pbigiIil9XG4gICAgICB9XG4gICAgYDtyZXR1cm4ge3RvVmVjOm5ldyBvLkdsc2xMaWJSb3V0aW5lKGEsWyJjb29yZGluYXRlcy5jb29yZHNUb09mZnNldCJdKX19dmFsdWVGcm9tKCl7Y29uc3QgZT17fTtyZXR1cm4gdGhpcy5jb250ZXh0LnByb2dyYW1JbmZvLmlucHV0TmFtZXMuZm9yRWFjaCgoKHQsbik9Pntjb25zdCByPXRoaXMuY29udGV4dC5pbnB1dFRleHR1cmVMYXlvdXRzW25dLGk9KHIudW5wYWNrZWRTaGFwZS5sZW5ndGg+MD9yLnVucGFja2VkU2hhcGU6ci5zaGFwZSkubGVuZ3RoO2xldCBzPWBfJHt0fWA7ZVtzXT1uZXcgby5HbHNsTGliUm91dGluZSh0aGlzLmdldFZhbHVlRnJvbVNpbmdsZSh0LGksci53aWR0aCxyLmhlaWdodCwhMSksW2BzaGFwZVV0aWxzLmluZGljZXNUb09mZnNldCR7c31gLCJjb29yZGluYXRlcy5vZmZzZXRUb0Nvb3JkcyIsImZyYWdjb2xvci5nZXRDb2xvckFzRmxvYXQiXSkscys9Il9UIixlW3NdPW5ldyBvLkdsc2xMaWJSb3V0aW5lKHRoaXMuZ2V0VmFsdWVGcm9tU2luZ2xlKHQsaSxyLndpZHRoLHIuaGVpZ2h0LCEwKSxbYHNoYXBlVXRpbHMuaW5kaWNlc1RvT2Zmc2V0JHtzfWAsImNvb3JkaW5hdGVzLm9mZnNldFRvQ29vcmRzIiwiZnJhZ2NvbG9yLmdldENvbG9yQXNGbG9hdCJdKTt9KSksZX1nZXRWYWx1ZUZyb21TaW5nbGUoZSx0LG4scixvKXtsZXQgcz1gXyR7ZX1gO3JldHVybiBvJiYocys9Il9UIiksYFxuICAgICAgICBmbG9hdCAke3N9KGludCBtWyR7dH1dKSB7XG4gICAgICAgICAgaW50IG9mZnNldCA9IGluZGljZXNUb09mZnNldCR7c30obSk7XG4gICAgICAgICAgdmVjMiBjb29yZHMgPSBvZmZzZXRUb0Nvb3JkcyhvZmZzZXQsICR7bn0sICR7cn0pO1xuICAgICAgICAgIGZsb2F0IHZhbHVlID0gZ2V0Q29sb3JBc0Zsb2F0KCR7KDAsIGkuZ2V0R2xzbCkodGhpcy5jb250ZXh0LmdsQ29udGV4dC52ZXJzaW9uKS50ZXh0dXJlMkR9KCR7ZX0sIGNvb3JkcykpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBgfWdldFBhY2tlZFZhbHVlRnJvbShlLHQsbixyLG8pe2xldCBzPWBfJHtlfV9QYWNrYDtyZXR1cm4gbyYmKHMrPSJfVCIpLGBcbiAgICAgICAgdmVjNCAke3N9KGludCBtWyR7dH1dKSB7XG4gICAgICAgICAgaW50IG9mZnNldCA9IGluZGljZXNUb09mZnNldF8ke2V9KG0pO1xuICAgICAgICAgIHZlYzIgY29vcmRzID0gb2Zmc2V0VG9Db29yZHMob2Zmc2V0LCAke259LCAke3J9KTtcbiAgICAgICAgICByZXR1cm4gJHsoMCwgaS5nZXRHbHNsKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pLnRleHR1cmUyRH0oJHtlfSwgY29vcmRzKTtcbiAgICAgICAgfVxuICAgICAgICBgfX10LkNvb3Jkc0dsc2xMaWI9dTt9LDE5OTc6KGUsdCk9Pnt2YXIgbjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5Ub3BvbG9naWNhbFNvcnRHbHNsUm91dGluZXM9dC5HbHNsTGliUm91dGluZU5vZGU9dC5HbHNsTGliUm91dGluZT10Lkdsc2xMaWI9dC5HbHNsQ29udGV4dD10LkZ1bmN0aW9uVHlwZT12b2lkIDAsKG49dC5GdW5jdGlvblR5cGV8fCh0LkZ1bmN0aW9uVHlwZT17fSkpW24uVmFsdWVCYXNlZD0wXT0iVmFsdWVCYXNlZCIsbltuLlBvc2l0aW9uYWw9MV09IlBvc2l0aW9uYWwiLHQuR2xzbENvbnRleHQ9Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4scil7dGhpcy5nbENvbnRleHQ9ZSx0aGlzLnByb2dyYW1JbmZvPXQsdGhpcy5pbnB1dFRleHR1cmVMYXlvdXRzPW4sdGhpcy5vdXRwdXRUZXh0dXJlTGF5b3V0PXI7fX0sdC5HbHNsTGliPWNsYXNze2NvbnN0cnVjdG9yKGUpe3RoaXMuY29udGV4dD1lO319LHQuR2xzbExpYlJvdXRpbmU9Y2xhc3N7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnJvdXRpbmVCb2R5PWUsdGhpcy5kZXBlbmRlbmNpZXM9dDt9fSx0Lkdsc2xMaWJSb3V0aW5lTm9kZT1jbGFzc3tjb25zdHJ1Y3RvcihlLHQsbil7dGhpcy5uYW1lPWUsdGhpcy5kZXBlbmRlbmNpZXM9bnx8W10sdCYmKHRoaXMucm91dGluZUJvZHk9dCk7fWFkZERlcGVuZGVuY3koZSl7ZSYmdGhpcy5kZXBlbmRlbmNpZXMucHVzaChlKTt9fSx0LlRvcG9sb2dpY2FsU29ydEdsc2xSb3V0aW5lcz1jbGFzc3tzdGF0aWMgcmV0dXJuT3JkZXJlZE5vZGVzKGUpe2lmKCFlfHwwPT09ZS5sZW5ndGgpcmV0dXJuIFtdO2lmKDE9PT1lLmxlbmd0aClyZXR1cm4gZTtjb25zdCB0PW5ldyBTZXQsbj1uZXcgU2V0LHI9bmV3IEFycmF5O3JldHVybiB0aGlzLmNyZWF0ZU9yZGVyZWROb2RlcyhlLHQsbixyKSxyfXN0YXRpYyBjcmVhdGVPcmRlcmVkTm9kZXMoZSx0LG4scil7Zm9yKGxldCBvPTA7bzxlLmxlbmd0aDsrK28pdGhpcy5kZnNUcmF2ZXJzZShlW29dLHQsbixyKTt9c3RhdGljIGRmc1RyYXZlcnNlKGUsdCxuLHIpe2lmKCFlfHxuLmhhcyhlLm5hbWUpKXJldHVybjtpZih0LmhhcyhlLm5hbWUpKXRocm93IG5ldyBFcnJvcigiQ3ljbGljIGRlcGVuZGVuY3kgZGV0ZWN0ZWQuIENhbid0IHRvcG9sb2dpY2FsbHkgc29ydCByb3V0aW5lcyBuZWVkZWQgZm9yIHNoYWRlci4iKTt0LmFkZChlLm5hbWUpO2NvbnN0IG89ZS5kZXBlbmRlbmNpZXM7aWYobyYmby5sZW5ndGg+MClmb3IobGV0IGU9MDtlPG8ubGVuZ3RoOysrZSl0aGlzLmRmc1RyYXZlcnNlKG9bZV0sdCxuLHIpO3IucHVzaChlKSxuLmFkZChlLm5hbWUpLHQuZGVsZXRlKGUubmFtZSk7fX07fSwxMzcxOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5FbmNvZGluZ0dsc2xMaWI9dm9pZCAwO2NvbnN0IHI9bigxOTk3KTtjbGFzcyBvIGV4dGVuZHMgci5HbHNsTGlie2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUpO31nZXRGdW5jdGlvbnMoKXtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHRoaXMuZW5jb2RlRmxvYXQzMigpKSx0aGlzLmRlY29kZUZsb2F0MzIoKSl9Z2V0Q3VzdG9tVHlwZXMoKXtyZXR1cm4ge319ZW5jb2RlRmxvYXQzMigpe3JldHVybiB7ZW5jb2RlOm5ldyByLkdsc2xMaWJSb3V0aW5lKCJoaWdocCB2ZWM0IGVuY29kZShoaWdocCBmbG9hdCBmKSB7XG4gICAgICAgIHJldHVybiB2ZWM0KGYsIDAuMCwgMC4wLCAwLjApO1xuICAgICAgfVxuICAgICAgICAiKX19ZGVjb2RlRmxvYXQzMigpe3JldHVybiB7ZGVjb2RlOm5ldyByLkdsc2xMaWJSb3V0aW5lKCJoaWdocCBmbG9hdCBkZWNvZGUoaGlnaHAgdmVjNCByZ2JhKSB7XG4gICAgICAgIHJldHVybiByZ2JhLnI7XG4gICAgICB9XG4gICAgICAgICIpfX1lbmNvZGVVaW50OCgpe2NvbnN0IGU9by5pc0xpdHRsZUVuZGlhbigpPyJyZ2JhLnJnYmE9cmdiYS5hYmdyOyI6IiI7cmV0dXJuIHtlbmNvZGU6bmV3IHIuR2xzbExpYlJvdXRpbmUoYFxuICAgICAgaGlnaHAgdmVjNCBlbmNvZGUoaGlnaHAgZmxvYXQgZikge1xuICAgICAgICBoaWdocCBmbG9hdCBGID0gYWJzKGYpO1xuICAgICAgICBoaWdocCBmbG9hdCBTaWduID0gc3RlcCgwLjAsLWYpO1xuICAgICAgICBoaWdocCBmbG9hdCBFeHBvbmVudCA9IGZsb29yKGxvZzIoRikpO1xuICAgICAgICBoaWdocCBmbG9hdCBNYW50aXNzYSA9IChleHAyKC0gRXhwb25lbnQpICogRik7XG4gICAgICAgIEV4cG9uZW50ID0gZmxvb3IobG9nMihGKSArIDEyNy4wKSArIGZsb29yKGxvZzIoTWFudGlzc2EpKTtcbiAgICAgICAgaGlnaHAgdmVjNCByZ2JhO1xuICAgICAgICByZ2JhWzBdID0gMTI4LjAgKiBTaWduICArIGZsb29yKEV4cG9uZW50KmV4cDIoLTEuMCkpO1xuICAgICAgICByZ2JhWzFdID0gMTI4LjAgKiBtb2QoRXhwb25lbnQsMi4wKSArIG1vZChmbG9vcihNYW50aXNzYSoxMjguMCksMTI4LjApO1xuICAgICAgICByZ2JhWzJdID0gZmxvb3IobW9kKGZsb29yKE1hbnRpc3NhKmV4cDIoMjMuMCAtOC4wKSksZXhwMig4LjApKSk7XG4gICAgICAgIHJnYmFbM10gPSBmbG9vcihleHAyKDIzLjApKm1vZChNYW50aXNzYSxleHAyKC0xNS4wKSkpO1xuICAgICAgICAke2V9XG4gICAgICAgIHJnYmEgPSByZ2JhIC8gMjU1LjA7IC8vIHZhbHVlcyBuZWVkIHRvIGJlIG5vcm1hbGl6ZWQgdG8gWzAsMV1cbiAgICAgICAgcmV0dXJuIHJnYmE7XG4gICAgfVxuICAgICAgICBgKX19ZGVjb2RlVWludDgoKXtjb25zdCBlPW8uaXNMaXR0bGVFbmRpYW4oKT8icmdiYS5yZ2JhPXJnYmEuYWJncjsiOiIiO3JldHVybiB7ZGVjb2RlOm5ldyByLkdsc2xMaWJSb3V0aW5lKGBcbiAgICAgICAgaGlnaHAgZmxvYXQgZGVjb2RlKGhpZ2hwIHZlYzQgcmdiYSkge1xuICAgICAgICAgIHJnYmEgPSByZ2JhICogMjU1LjA7IC8vIHZhbHVlcyBuZWVkIHRvIGJlIGRlLW5vcm1hbGl6ZWQgZnJvbSBbMCwxXSB0byBbMCwyNTVdXG4gICAgICAgICAgJHtlfVxuICAgICAgICAgIGhpZ2hwIGZsb2F0IFNpZ24gPSAxLjAgLSBzdGVwKDEyOC4wLHJnYmFbMF0pKjIuMDtcbiAgICAgICAgICBoaWdocCBmbG9hdCBFeHBvbmVudCA9IDIuMCAqIG1vZChyZ2JhWzBdLDEyOC4wKSArIHN0ZXAoMTI4LjAscmdiYVsxXSkgLSAxMjcuMDtcbiAgICAgICAgICBoaWdocCBmbG9hdCBNYW50aXNzYSA9IG1vZChyZ2JhWzFdLDEyOC4wKSo2NTUzNi4wICsgcmdiYVsyXSoyNTYuMCArcmdiYVszXSArIGZsb2F0KDB4ODAwMDAwKTtcbiAgICAgICAgICBoaWdocCBmbG9hdCBSZXN1bHQgPSAgU2lnbiAqIGV4cDIoRXhwb25lbnQpICogKE1hbnRpc3NhICogZXhwMigtMjMuMCApKTtcbiAgICAgICAgICByZXR1cm4gUmVzdWx0O1xuICAgICAgfVxuICAgICAgICBgKX19c3RhdGljIGlzTGl0dGxlRW5kaWFuKCl7Y29uc3QgZT1uZXcgQXJyYXlCdWZmZXIoNCksdD1uZXcgVWludDMyQXJyYXkoZSksbj1uZXcgVWludDhBcnJheShlKTtpZih0WzBdPTM3MzU5Mjg1NTksMjM5PT09blswXSlyZXR1cm4gITA7aWYoMjIyPT09blswXSlyZXR1cm4gITE7dGhyb3cgbmV3IEVycm9yKCJ1bmtub3duIGVuZGlhbm5lc3MiKX19dC5FbmNvZGluZ0dsc2xMaWI9bzt9LDI2OTE6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LkZyYWdDb2xvckdsc2xMaWI9dm9pZCAwO2NvbnN0IHI9bigxOTk3KSxvPW4oNjc1Nyk7Y2xhc3MgaSBleHRlbmRzIHIuR2xzbExpYntjb25zdHJ1Y3RvcihlKXtzdXBlcihlKTt9Z2V0RnVuY3Rpb25zKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0aGlzLnNldEZyYWdDb2xvcigpKSx0aGlzLmdldENvbG9yQXNGbG9hdCgpKX1nZXRDdXN0b21UeXBlcygpe3JldHVybiB7fX1zZXRGcmFnQ29sb3IoKXtjb25zdCBlPSgwLCBvLmdldEdsc2wpKHRoaXMuY29udGV4dC5nbENvbnRleHQudmVyc2lvbik7cmV0dXJuIHtzZXRGcmFnQ29sb3I6bmV3IHIuR2xzbExpYlJvdXRpbmUoYFxuICAgICAgICB2b2lkIHNldEZyYWdDb2xvcihmbG9hdCB2YWx1ZSkge1xuICAgICAgICAgICAgJHtlLm91dHB1dH0gPSBlbmNvZGUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGAsWyJlbmNvZGluZy5lbmNvZGUiXSl9fWdldENvbG9yQXNGbG9hdCgpe3JldHVybiB7Z2V0Q29sb3JBc0Zsb2F0Om5ldyByLkdsc2xMaWJSb3V0aW5lKCJcbiAgICAgICAgZmxvYXQgZ2V0Q29sb3JBc0Zsb2F0KHZlYzQgY29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWNvZGUoY29sb3IpO1xuICAgICAgICB9XG4gICAgICAgICIsWyJlbmNvZGluZy5kZWNvZGUiXSl9fX10LkZyYWdDb2xvckdsc2xMaWI9aTt9LDM4Nzg6KGUsdCk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5yZXBsYWNlSW5saW5lcz12b2lkIDA7Y29uc3Qgbj0vQGlubGluZVtcc1xuXHJdKyhcdyspW1xzXG5ccl0rKFswLTlhLXpBLVpfXSspXHMqXCgoW14pXSopXClccyp7KChbXn1dfFtcblxyXSkqKX0vZ207dC5yZXBsYWNlSW5saW5lcz1mdW5jdGlvbihlKXtjb25zdCB0PXt9O2xldCByO2Zvcig7bnVsbCE9PShyPW4uZXhlYyhlKSk7KXtjb25zdCBlPXJbM10uc3BsaXQoIiwiKS5tYXAoKGU9Pntjb25zdCB0PWUudHJpbSgpLnNwbGl0KCIgIik7cmV0dXJuIHQmJjI9PT10Lmxlbmd0aD97dHlwZTp0WzBdLG5hbWU6dFsxXX06bnVsbH0pKS5maWx0ZXIoKGU9Pm51bGwhPT1lKSk7dFtyWzJdXT17cGFyYW1zOmUsYm9keTpyWzRdfTt9Zm9yKGNvbnN0IG4gaW4gdCl7Y29uc3Qgbz0iKFxcdyspP1xccysoW18wLTlhLXpBLVpdKylcXHMrPVxccytfX0ZVTkNfX1xcKCguKilcXClcXHMqOyIucmVwbGFjZSgiX19GVU5DX18iLG4pLGk9bmV3IFJlZ0V4cChvLCJnbSIpO2Zvcig7bnVsbCE9PShyPWkuZXhlYyhlKSk7KXtjb25zdCBvPXJbMV0saT1yWzJdLHM9clszXS5zcGxpdCgiLCIpLGE9bz9gJHtvfSAke2l9O2A6IiI7bGV0IHU9dFtuXS5ib2R5LGw9IiI7dFtuXS5wYXJhbXMuZm9yRWFjaCgoKGUsdCk9PntlJiYobCs9YCR7ZS50eXBlfSAke2UubmFtZX0gPSAke3NbdF19O1xuYCk7fSkpLHU9YCR7bH1cbiAke3V9YCx1PXUucmVwbGFjZSgicmV0dXJuIixgJHtpfSA9IGApO2NvbnN0IGM9YFxuICAgICAgJHthfVxuICAgICAge1xuICAgICAgICAke3V9XG4gICAgICB9XG4gICAgICBgO2U9ZS5yZXBsYWNlKHJbMF0sYyk7fX1yZXR1cm4gZS5yZXBsYWNlKG4sIiIpfTt9LDg4OTc6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0Lkdsc2xQcmVwcm9jZXNzb3I9dm9pZCAwO2NvbnN0IHI9bigxOTk3KSxvPW4oMzg3OCksaT1uKDEyNDgpLHM9big2NzU3KTt0Lkdsc2xQcmVwcm9jZXNzb3I9Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4sbyl7dGhpcy5saWJzPXt9LHRoaXMuZ2xzbExpYlJvdXRpbmVEZXBlbmRlbmN5R3JhcGg9e30sdGhpcy5jb250ZXh0PW5ldyByLkdsc2xDb250ZXh0KGUsdCxuLG8pLE9iamVjdC5rZXlzKGkuZ2xzbFJlZ2lzdHJ5KS5mb3JFYWNoKChlPT57Y29uc3QgdD1uZXcgaS5nbHNsUmVnaXN0cnlbZV0odGhpcy5jb250ZXh0KTt0aGlzLmxpYnNbZV09dDt9KSk7Y29uc3Qgcz10aGlzLmdsc2xMaWJSb3V0aW5lRGVwZW5kZW5jeUdyYXBoO2Zvcihjb25zdCBlIGluIHRoaXMubGlicyl7Y29uc3QgdD10aGlzLmxpYnNbZV0uZ2V0RnVuY3Rpb25zKCk7Zm9yKGNvbnN0IG4gaW4gdCl7Y29uc3Qgbz1lKyIuIituO2xldCBpO3Nbb10/KGk9c1tvXSxpLnJvdXRpbmVCb2R5PXRbbl0ucm91dGluZUJvZHkpOihpPW5ldyByLkdsc2xMaWJSb3V0aW5lTm9kZShvLHRbbl0ucm91dGluZUJvZHkpLHNbb109aSk7Y29uc3QgYT10W25dLmRlcGVuZGVuY2llcztpZihhKWZvcihsZXQgZT0wO2U8YS5sZW5ndGg7KytlKWlmKHNbYVtlXV0paS5hZGREZXBlbmRlbmN5KHNbYVtlXV0pO2Vsc2Uge2NvbnN0IHQ9bmV3IHIuR2xzbExpYlJvdXRpbmVOb2RlKGFbZV0pO3NbYVtlXV09dCxpLmFkZERlcGVuZGVuY3kodCk7fX19fXByZXByb2Nlc3MoKXtjb25zdCBlPXRoaXMuY29udGV4dC5wcm9ncmFtSW5mbztsZXQgdD1lLnNoYWRlclNvdXJjZTtyZXR1cm4gdGhpcy5jb250ZXh0LnByb2dyYW1JbmZvLmhhc01haW58fCh0PWAke3R9XG4gICAgICAkeygwLCBzLmdldERlZmF1bHRGcmFnU2hhZGVyTWFpbikodGhpcy5jb250ZXh0LmdsQ29udGV4dC52ZXJzaW9uLHRoaXMuY29udGV4dC5vdXRwdXRUZXh0dXJlTGF5b3V0LnNoYXBlLmxlbmd0aCl9YCksdD0oMCwgby5yZXBsYWNlSW5saW5lcykodCksYCR7KDAsIHMuZ2V0RnJhZ1NoYWRlclByZWFtYmxlKSh0aGlzLmNvbnRleHQuZ2xDb250ZXh0LnZlcnNpb24pfVxuICAgICR7dGhpcy5nZXRVbmlmb3JtcyhlLmlucHV0TmFtZXMsZS52YXJpYWJsZXMpfVxuICAgICR7dGhpcy5nZXRJbXBvcnRzKHQpfVxuICAgICR7dH1gfWdldEltcG9ydHMoZSl7Y29uc3QgdD10aGlzLnNlbGVjdEdsc2xMaWJSb3V0aW5lc1RvQmVJbmNsdWRlZChlKTtpZigwPT09dC5sZW5ndGgpcmV0dXJuICIiO2xldCBuPSIiO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7KytlKXtpZighdFtlXS5yb3V0aW5lQm9keSl0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgYm9keSBmb3IgdGhlIEdsc2wgTGlicmFyeSByb3V0aW5lOiAke3RbZV0ubmFtZX1gKTtuKz10W2VdLnJvdXRpbmVCb2R5KyJcbiI7fXJldHVybiBufXNlbGVjdEdsc2xMaWJSb3V0aW5lc1RvQmVJbmNsdWRlZChlKXtjb25zdCB0PVtdO3JldHVybiBPYmplY3Qua2V5cyh0aGlzLmdsc2xMaWJSb3V0aW5lRGVwZW5kZW5jeUdyYXBoKS5mb3JFYWNoKChuPT57Y29uc3Qgcj1uLnNwbGl0KCIuIilbMV07LTEhPT1lLmluZGV4T2YocikmJnQucHVzaCh0aGlzLmdsc2xMaWJSb3V0aW5lRGVwZW5kZW5jeUdyYXBoW25dKTt9KSksci5Ub3BvbG9naWNhbFNvcnRHbHNsUm91dGluZXMucmV0dXJuT3JkZXJlZE5vZGVzKHQpfWdldFVuaWZvcm1zKGUsdCl7Y29uc3Qgbj1bXTtpZihlKWZvcihjb25zdCB0IG9mIGUpbi5wdXNoKGB1bmlmb3JtIHNhbXBsZXIyRCAke3R9O2ApO2lmKHQpZm9yKGNvbnN0IGUgb2YgdCluLnB1c2goYHVuaWZvcm0gJHtlLnR5cGV9ICR7ZS5uYW1lfSR7ZS5hcnJheUxlbmd0aD9gWyR7ZS5hcnJheUxlbmd0aH1dYDoiIn07YCk7cmV0dXJuIG4uam9pbigiXG4iKX19O30sMTI0ODooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZ2xzbFJlZ2lzdHJ5PXZvaWQgMDtjb25zdCByPW4oNjg1OSksbz1uKDEzNzEpLGk9bigyNjkxKSxzPW4oOTE4MyksYT1uKDkzMTQpO3QuZ2xzbFJlZ2lzdHJ5PXtlbmNvZGluZzpvLkVuY29kaW5nR2xzbExpYixmcmFnY29sb3I6aS5GcmFnQ29sb3JHbHNsTGliLHZlYzphLlZlY0dsc2xMaWIsc2hhcGVVdGlsczpzLlNoYXBlVXRpbHNHbHNsTGliLGNvb3JkaW5hdGVzOnIuQ29vcmRzR2xzbExpYn07fSw5MTgzOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5TaGFwZVV0aWxzR2xzbExpYj12b2lkIDA7Y29uc3Qgcj1uKDE5OTcpO2NsYXNzIG8gZXh0ZW5kcyByLkdsc2xMaWJ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSk7fWdldEZ1bmN0aW9ucygpe3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdGhpcy5iY2FzdEluZGV4KCkpLHRoaXMuYmNhc3RNYXRtdWxJbmRleCgpKSx0aGlzLm9mZnNldFRvSW5kaWNlcygpKSx0aGlzLmluZGljZXNUb09mZnNldCgpKSx0aGlzLmluY3JlbWVudEluZGljZXMoKSl9Z2V0Q3VzdG9tVHlwZXMoKXtyZXR1cm4ge319YmNhc3RJbmRleCgpe2NvbnN0IGU9dGhpcy5jb250ZXh0Lm91dHB1dFRleHR1cmVMYXlvdXQuc2hhcGUubGVuZ3RoLHQ9e307cmV0dXJuIHRoaXMuY29udGV4dC5wcm9ncmFtSW5mby5pbnB1dE5hbWVzLmZvckVhY2goKChuLG8pPT57Y29uc3QgaT10aGlzLmNvbnRleHQuaW5wdXRUZXh0dXJlTGF5b3V0c1tvXS51bnBhY2tlZFNoYXBlO2lmKGkubGVuZ3RoPD1lKXtjb25zdCBvPWkubGVuZ3RoLHM9ZS1vLGE9YGJjYXN0SW5kaWNlc18ke259YDtsZXQgdT0iIjtmb3IobGV0IGU9MDtlPG87KytlKXUrPWBcbiAgICAgICAgICByZWFsSW5kaWNlc1ske2V9XSA9IGludCggbW9kKGZsb2F0KGJjYXN0ZWRJbmRpY2VzWyR7cytlfV0pLCAke2lbZV19LjApICk7XG4gICAgICAgICAgYDtjb25zdCBsPWBcbiAgICAgICAgdm9pZCAke2F9IChpbnQgYmNhc3RlZEluZGljZXNbJHtlfV0sIG91dCBpbnQgcmVhbEluZGljZXNbJHtvfV0pIHtcbiAgICAgICAgICAke3V9XG4gICAgICAgIH1cbiAgICAgICAgYDt0W2FdPW5ldyByLkdsc2xMaWJSb3V0aW5lKGwpO319KSksdH1iY2FzdE1hdG11bEluZGV4KCl7Y29uc3QgZT10aGlzLmNvbnRleHQub3V0cHV0VGV4dHVyZUxheW91dC5zaGFwZS5sZW5ndGgsdD17fTtyZXR1cm4gdGhpcy5jb250ZXh0LnByb2dyYW1JbmZvLmlucHV0TmFtZXMuZm9yRWFjaCgoKG4sbyk9Pntjb25zdCBpPXRoaXMuY29udGV4dC5pbnB1dFRleHR1cmVMYXlvdXRzW29dLnNoYXBlO2lmKCEoaS5sZW5ndGg8Mnx8aS5sZW5ndGg+ZSkpe2NvbnN0IG89aS5sZW5ndGgscz1lLW8sYT1gYmNhc3RNYXRtdWxJbmRpY2VzXyR7bn1gO2xldCB1PSIiO2ZvcihsZXQgZT0wO2U8by0yOysrZSl1Kz1gXG4gICAgICAgICAgcmVhbEluZGljZXNbJHtlfV0gPSBpbnQoIG1vZChmbG9hdChiY2FzdGVkSW5kaWNlc1ske3MrZX1dKSwgJHtpW2VdfS4wKSApO1xuICAgICAgICAgIGA7Y29uc3QgbD1gXG4gICAgICAgIHZvaWQgJHthfShpbnQgYmNhc3RlZEluZGljZXNbJHtlfV0sIG91dCBpbnQgcmVhbEluZGljZXNbJHtvfV0pIHtcbiAgICAgICAgICAke3V9XG4gICAgICAgICAgcmVhbEluZGljZXNbJHtvLTF9XSA9IGJjYXN0ZWRJbmRpY2VzWyR7ZS0xfV07XG4gICAgICAgICAgcmVhbEluZGljZXNbJHtvLTJ9XSA9IGJjYXN0ZWRJbmRpY2VzWyR7ZS0yfV07XG4gICAgICAgIH1cbiAgICAgICAgYDt0W2FdPW5ldyByLkdsc2xMaWJSb3V0aW5lKGwpO319KSksdH1pbmRpY2VzVG9PZmZzZXQoKXtjb25zdCBlPXt9O3JldHVybiB0aGlzLmNvbnRleHQucHJvZ3JhbUluZm8uaW5wdXROYW1lcy5mb3JFYWNoKCgodCxuKT0+e2NvbnN0IGk9dGhpcy5jb250ZXh0LmlucHV0VGV4dHVyZUxheW91dHNbbl0uc2hhcGUscz10aGlzLmNvbnRleHQuaW5wdXRUZXh0dXJlTGF5b3V0c1tuXS5zdHJpZGVzLGE9aS5sZW5ndGg7bGV0IHU9YGluZGljZXNUb09mZnNldF8ke3R9YDtlW3VdPW5ldyByLkdsc2xMaWJSb3V0aW5lKG8uaW5kZXhUb09mZnNldFNpbmdsZSh1LGEscykpLHU9YGluZGljZXNUb09mZnNldF8ke3R9X1RgLGVbdV09bmV3IHIuR2xzbExpYlJvdXRpbmUoby5pbmRleFRvT2Zmc2V0U2luZ2xlKHUsYSxzLnNsaWNlKCkucmV2ZXJzZSgpKSk7fSkpLGV9c3RhdGljIGluZGV4VG9PZmZzZXRTaW5nbGUoZSx0LG4pe2xldCByPSIiO2ZvcihsZXQgZT10LTE7ZT49MDstLWUpcis9YFxuICAgICAgICBvZmZzZXQgKz0gaW5kaWNlc1ske2V9XSAqICR7bltlXX07XG4gICAgICAgIGA7cmV0dXJuIGBcbiAgICAgIGludCAke2V9KGludCBpbmRpY2VzWyR7dH1dKSB7XG4gICAgICAgIGludCBvZmZzZXQgPSAwO1xuICAgICAgICAke3J9XG4gICAgICAgIHJldHVybiBvZmZzZXQ7XG4gICAgICB9XG4gICAgICBgfW9mZnNldFRvSW5kaWNlcygpe2NvbnN0IGU9e307cmV0dXJuIHRoaXMuY29udGV4dC5wcm9ncmFtSW5mby5pbnB1dE5hbWVzLmZvckVhY2goKCh0LG4pPT57Y29uc3QgaT10aGlzLmNvbnRleHQuaW5wdXRUZXh0dXJlTGF5b3V0c1tuXS5zaGFwZSxzPXRoaXMuY29udGV4dC5pbnB1dFRleHR1cmVMYXlvdXRzW25dLnN0cmlkZXMsYT1pLmxlbmd0aDtsZXQgdT1gb2Zmc2V0VG9JbmRpY2VzXyR7dH1gO2VbdV09bmV3IHIuR2xzbExpYlJvdXRpbmUoby5vZmZzZXRUb0luZGljZXNTaW5nbGUodSxhLHMpKSx1PWBvZmZzZXRUb0luZGljZXNfJHt0fV9UYCxlW3VdPW5ldyByLkdsc2xMaWJSb3V0aW5lKG8ub2Zmc2V0VG9JbmRpY2VzU2luZ2xlKHUsYSxzLnNsaWNlKCkucmV2ZXJzZSgpKSk7fSkpLGV9c3RhdGljIG9mZnNldFRvSW5kaWNlc1NpbmdsZShlLHQsbil7Y29uc3Qgcj1bXTtmb3IobGV0IGU9MDtlPHQtMTsrK2Upci5wdXNoKGBcbiAgICAgIGluZGljZXNbJHtlfV0gPSBvZmZzZXQgLyAke25bZV19O2ApLHIucHVzaChgXG4gICAgICAgIG9mZnNldCAtPSBpbmRpY2VzWyR7ZX1dICogJHtuW2VdfTtgKTtyZXR1cm4gci5wdXNoKGBcbiAgICAgIGluZGljZXNbJHt0LTF9XSA9IG9mZnNldDtgKSxgXG4gICAgICB2b2lkICR7ZX0oaW50IG9mZnNldCwgb3V0IGludCBpbmRpY2VzWyR7dH1dKSB7XG4gICAgICAgICR7ci5qb2luKCIiKX1cbiAgICAgIH1cbiAgICAgIGB9aW5jcmVtZW50SW5kaWNlcygpe2NvbnN0IGU9e307cmV0dXJuIHRoaXMuY29udGV4dC5wcm9ncmFtSW5mby5pbnB1dE5hbWVzLmZvckVhY2goKCh0LG4pPT57Y29uc3Qgbz10aGlzLmNvbnRleHQuaW5wdXRUZXh0dXJlTGF5b3V0c1tuXS5zaGFwZSxpPW8ubGVuZ3RoLHM9YGluY3JlbWVudEluZGljZXNfJHt0fWA7bGV0IGE9IiI7Zm9yKGxldCBlPTA7ZTxpOysrZSlhKz1gXG4gICAgICAgIHNoYXBlWyR7ZX1dID0gJHtvW2VdfTtgO2NvbnN0IHU9YFxuICAgICAgICB2b2lkICR7c30oaW50IGF4aXMsIG91dCBpbnQgaW5kaWNlc1ske2l9XSkge1xuICAgICAgICAgIGludCBzaGFwZVske2l9XTtcbiAgICAgICAgICAke2F9O1xuICAgICAgICAgIGZvcihpbnQgaSA9ICR7aX0gLTEgOyBpID49IDA7IC0taSkge1xuICAgICAgICAgICAgaWYoaSA+IGF4aXMpIGNvbnRpbnVlO1xuICAgICAgICAgICAgaW5kaWNlc1tpXSArPSAxO1xuICAgICAgICAgICAgaWYoaW5kaWNlc1tpXSA8IHNoYXBlW2ldKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kaWNlc1tpXSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGA7ZVtzXT1uZXcgci5HbHNsTGliUm91dGluZSh1KTt9KSksZX19dC5TaGFwZVV0aWxzR2xzbExpYj1vO30sNjc1NzooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmdldERlZmF1bHRGcmFnU2hhZGVyTWFpbj10LmdldEZyYWdTaGFkZXJQcmVhbWJsZT10LmdldFZlcnRleFNoYWRlclNvdXJjZT10LmdldEdsc2w9dm9pZCAwO2NvbnN0IG49e3ZlcnNpb246IiIsYXR0cmlidXRlOiJhdHRyaWJ1dGUiLHZhcnlpbmdWZXJ0ZXg6InZhcnlpbmciLHZhcnlpbmdGcmFnOiJ2YXJ5aW5nIix0ZXh0dXJlMkQ6InRleHR1cmUyRCIsb3V0cHV0OiJnbF9GcmFnQ29sb3IiLG91dHB1dERlY2xhcmF0aW9uOiIifSxyPXt2ZXJzaW9uOiIjdmVyc2lvbiAzMDAgZXMiLGF0dHJpYnV0ZToiaW4iLHZhcnlpbmdWZXJ0ZXg6Im91dCIsdmFyeWluZ0ZyYWc6ImluIix0ZXh0dXJlMkQ6InRleHR1cmUiLG91dHB1dDoib3V0cHV0Q29sb3IiLG91dHB1dERlY2xhcmF0aW9uOiJvdXQgdmVjNCBvdXRwdXRDb2xvcjsifTtmdW5jdGlvbiBvKGUpe3JldHVybiAxPT09ZT9uOnJ9dC5nZXRHbHNsPW8sdC5nZXRWZXJ0ZXhTaGFkZXJTb3VyY2U9ZnVuY3Rpb24oZSl7Y29uc3QgdD1vKGUpO3JldHVybiBgJHt0LnZlcnNpb259XG4gICAgICBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7XG4gICAgICAke3QuYXR0cmlidXRlfSB2ZWMzIHBvc2l0aW9uO1xuICAgICAgJHt0LmF0dHJpYnV0ZX0gdmVjMiB0ZXh0dXJlQ29vcmQ7XG5cbiAgICAgICR7dC52YXJ5aW5nVmVydGV4fSB2ZWMyIFRleENvb3JkcztcblxuICAgICAgdm9pZCBtYWluKClcbiAgICAgIHtcbiAgICAgICAgICBnbF9Qb3NpdGlvbiA9IHZlYzQocG9zaXRpb24sIDEuMCk7XG4gICAgICAgICAgVGV4Q29vcmRzID0gdGV4dHVyZUNvb3JkO1xuICAgICAgfWB9LHQuZ2V0RnJhZ1NoYWRlclByZWFtYmxlPWZ1bmN0aW9uKGUpe2NvbnN0IHQ9byhlKTtyZXR1cm4gYCR7dC52ZXJzaW9ufVxuICAgIHByZWNpc2lvbiBoaWdocCBmbG9hdDtcbiAgICBwcmVjaXNpb24gaGlnaHAgaW50O1xuICAgIHByZWNpc2lvbiBoaWdocCBzYW1wbGVyMkQ7XG4gICAgJHt0LnZhcnlpbmdGcmFnfSB2ZWMyIFRleENvb3JkcztcbiAgICAke3Qub3V0cHV0RGVjbGFyYXRpb259XG4gICAgY29uc3QgdmVjMiBoYWxmQ1IgPSB2ZWMyKDAuNSwgMC41KTtcblxuICAgIC8vIEN1c3RvbSB2ZWN0b3IgdHlwZXMgdG8gaGFuZGxlIGhpZ2hlciBkaW1lbmFsaXRpZXMuXG4gICAgc3RydWN0IGl2ZWM1XG4gICAge1xuICAgICAgaW50IHg7XG4gICAgICBpbnQgeTtcbiAgICAgIGludCB6O1xuICAgICAgaW50IHc7XG4gICAgICBpbnQgdTtcbiAgICB9O1xuXG4gICAgc3RydWN0IGl2ZWM2XG4gICAge1xuICAgICAgaW50IHg7XG4gICAgICBpbnQgeTtcbiAgICAgIGludCB6O1xuICAgICAgaW50IHc7XG4gICAgICBpbnQgdTtcbiAgICAgIGludCB2O1xuICAgIH07XG5cbiAgICBpbnQgaW1vZChpbnQgeCwgaW50IHkpIHtcbiAgICAgIHJldHVybiB4IC0geSAqICh4IC8geSk7XG4gICAgfVxuXG4gICAgYH0sdC5nZXREZWZhdWx0RnJhZ1NoYWRlck1haW49ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYFxuICB2b2lkIG1haW4oKSB7XG4gICAgaW50IGluZGljZXNbJHt0fV07XG4gICAgdG9WZWMoVGV4Q29vcmRzLCBpbmRpY2VzKTtcbiAgICB2ZWM0IHJlc3VsdCA9IHZlYzQocHJvY2VzcyhpbmRpY2VzKSk7XG4gICAgJHtvKGUpLm91dHB1dH0gPSByZXN1bHQ7XG4gIH1cbiAgYH07fSw5MzE0OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5WZWNHbHNsTGliPXZvaWQgMDtjb25zdCByPW4oMTk5Nyk7Y2xhc3MgbyBleHRlbmRzIHIuR2xzbExpYntjb25zdHJ1Y3RvcihlKXtzdXBlcihlKTt9Z2V0Q3VzdG9tVHlwZXMoKXtyZXR1cm4ge319Z2V0RnVuY3Rpb25zKCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdGhpcy5iaW5hcnlWZWNGdW5jdGlvbnMoKSksdGhpcy5jb3B5VmVjKCkpLHRoaXMuc2V0VmVjSXRlbSgpKSx0aGlzLmdldFZlY0l0ZW0oKSl9YmluYXJ5VmVjRnVuY3Rpb25zKCl7Y29uc3QgZT10aGlzLmNvbnRleHQub3V0cHV0VGV4dHVyZUxheW91dC5zaGFwZS5sZW5ndGgsdD17YWRkOiIrPSIsc3ViOiItPSIsbXVsOiIqPSIsZGl2OiIvPSJ9LG49e307Zm9yKGNvbnN0IG8gaW4gdCl7Y29uc3QgaT1gJHtvfVZlY2A7bGV0IHM9IiI7Zm9yKGxldCBuPTA7bjxlOysrbilzKz1gXG4gICAgICAgICAgZGVzdFske259XSAke3Rbb119IHNyY1ske259XTtcbiAgICAgICAgICBgO2NvbnN0IGE9YFxuICAgICAgICB2b2lkICR7aX0oaW50IHNyY1ske2V9XSwgb3V0IGludCBkZXN0WyR7ZX1dKSB7XG4gICAgICAgICAgJHtzfVxuICAgICAgICB9XG4gICAgICAgIGA7bltpXT1uZXcgci5HbHNsTGliUm91dGluZShhKTt9cmV0dXJuIG59Y29weVZlYygpe2NvbnN0IGU9dGhpcy5jb250ZXh0Lm91dHB1dFRleHR1cmVMYXlvdXQuc2hhcGUubGVuZ3RoO2xldCB0PSIiO2ZvcihsZXQgbj0wO248ZTsrK24pdCs9YFxuICAgICAgICBkZXN0WyR7bn1dID0gc3JjWyR7bn1dO1xuICAgICAgICBgO2NvbnN0IG49YFxuICAgICAgdm9pZCBjb3B5VmVjKGludCBzcmNbJHtlfV0sIG91dCBpbnQgZGVzdFske2V9XSkge1xuICAgICAgICAke3R9XG4gICAgICB9XG4gICAgICBgO3JldHVybiB7Y29weVZlYzpuZXcgci5HbHNsTGliUm91dGluZShuKX19c2V0VmVjSXRlbSgpe2NvbnN0IGU9dGhpcy5jb250ZXh0Lm91dHB1dFRleHR1cmVMYXlvdXQuc2hhcGUubGVuZ3RoO2xldCB0PWBcbiAgICAgICAgaWYoaW5kZXggPCAwKVxuICAgICAgICAgICAgaW5kZXggPSR7ZX0gKyBpbmRleDtcbiAgICAgICAgaWYgKGluZGV4ID09IDApXG4gICAgICAgICAgICBtWzBdID0gdmFsdWU7XG4gICAgICAgIGA7Zm9yKGxldCBuPTE7bjxlLTE7KytuKXQrPWBcbiAgICAgICAgZWxzZSBpZiAoaW5kZXggPT0gJHtufSlcbiAgICAgICAgICAgIG1bJHtufV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGA7dCs9YFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBtWyR7ZS0xfV0gPSB2YWx1ZTtcbiAgICAgICAgYDtjb25zdCBuPWBcbiAgICAgIHZvaWQgc2V0VmVjSXRlbShvdXQgaW50IG1bJHtlfV0sIGludCBpbmRleCwgaW50IHZhbHVlKSB7XG4gICAgICAgICR7dH1cbiAgICAgIH1cbiAgICAgICAgYDtyZXR1cm4ge3NldFZlY0l0ZW06bmV3IHIuR2xzbExpYlJvdXRpbmUobil9fWdldFZlY0l0ZW0oKXtjb25zdCBlPXRoaXMuY29udGV4dC5vdXRwdXRUZXh0dXJlTGF5b3V0LnNoYXBlLmxlbmd0aDtsZXQgdD1gXG4gICAgICAgIGlmKGluZGV4IDwgMClcbiAgICAgICAgICAgIGluZGV4ID0gJHtlfSArIGluZGV4O1xuICAgICAgICBpZiAoaW5kZXggPT0gMClcbiAgICAgICAgICAgIHJldHVybiBtWzBdO1xuICAgICAgYDtmb3IobGV0IG49MTtuPGUtMTsrK24pdCs9YFxuICAgICAgICBlbHNlIGlmIChpbmRleCA9PSAke259KVxuICAgICAgICAgICAgcmV0dXJuIG1bJHtufV07XG4gICAgICBgO3QrPWBcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIG1bJHtlLTF9XTtcbiAgICAgICAgYDtjb25zdCBuPWBcbiAgICAgIGludCBnZXRWZWNJdGVtKGludCBtWyR7ZX1dLCBpbnQgaW5kZXgpIHtcbiAgICAgICAgJHt0fVxuICAgICAgfVxuICAgIGA7cmV0dXJuIHtnZXRWZWNJdGVtOm5ldyByLkdsc2xMaWJSb3V0aW5lKG4pfX19dC5WZWNHbHNsTGliPW87fSw3ODYwOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5XZWJHTEluZmVyZW5jZUhhbmRsZXI9dm9pZCAwO2NvbnN0IHI9bigxMzE1KSxvPW4oOTI0MCksaT1uKDcyNzMpLHM9big5KSxhPW4oNzM3OSksdT1uKDI0ODgpLGw9big1NDApLGM9bigzMzE0KSxwPW4oNTYzOSk7dC5XZWJHTEluZmVyZW5jZUhhbmRsZXI9Y2xhc3N7Y29uc3RydWN0b3IoZSl7dGhpcy5zZXNzaW9uPWUsdGhpcy5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlPW5ldyBNYXAsdGhpcy51bnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU9bmV3IE1hcDt9Y2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0KGUsdCl7cmV0dXJuICgwLCBjLmNhbGN1bGF0ZVRleHR1cmVXaWR0aEFuZEhlaWdodCkodGhpcy5zZXNzaW9uLmxheW91dFN0cmF0ZWd5LGUsdCl9ZXhlY3V0ZVByb2dyYW0oZSx0KXtpZih0Lmxlbmd0aDxlLmlucHV0TmFtZXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcihgSW5wdXQgc2l6ZSBtdXN0bid0IGJlIGxlc3MgdGhhbiAke2UuaW5wdXROYW1lcy5sZW5ndGh9LmApO2lmKGUuaW5wdXROYW1lcy5sZW5ndGghPT1lLmlucHV0VHlwZXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiaW5wdXQgbmFtZXMgc2l6ZSBkb2VzIG5vdCBtYXRjaCBpbnB1dCB0eXBlcyIpO2NvbnN0IG49W107Zm9yKGxldCByPTA7cjxlLmlucHV0TmFtZXMubGVuZ3RoOysrciluW3JdPXRoaXMuZ2V0T3JDcmVhdGVUZXh0dXJlRGF0YSh0W3JdLGUuaW5wdXRUeXBlc1tyXSk7Y29uc3Qgcj0oKGUsdCk9Pntjb25zdCBuPXQubWFwKChlPT5gJHtlLnVucGFja2VkU2hhcGUuam9pbigiLCIpfTske2Uud2lkdGh9eCR7ZS5oZWlnaHR9YCkpLmpvaW4oIl8iKTtsZXQgcj1lLm5hbWU7cmV0dXJuIGUuY2FjaGVIaW50JiYocis9IlsiK2UuY2FjaGVIaW50KyJdIikscis9IjoiK24scn0pKGUsbik7bGV0IG89dGhpcy5zZXNzaW9uLnByb2dyYW1NYW5hZ2VyLmdldEFydGlmYWN0KHIpO2NvbnN0IGk9bz9vLnByb2dyYW1JbmZvOiJmdW5jdGlvbiI9PXR5cGVvZiBlLmdldD9lLmdldCgpOmUscz0oMCwgYy5jcmVhdGVUZXh0dXJlTGF5b3V0RnJvbVRleHR1cmVUeXBlKSh0aGlzLnNlc3Npb24ubGF5b3V0U3RyYXRlZ3ksaS5vdXRwdXQuZGltcyxpLm91dHB1dC50ZXh0dXJlVHlwZSksYT10aGlzLmNyZWF0ZVRleHR1cmVEYXRhKHMsaS5vdXRwdXQudHlwZSk7cmV0dXJuIG98fChvPXRoaXMuc2Vzc2lvbi5wcm9ncmFtTWFuYWdlci5idWlsZChpLG4sYSksdGhpcy5zZXNzaW9uLnByb2dyYW1NYW5hZ2VyLnNldEFydGlmYWN0KHIsbykpLHRoaXMucnVuUHJvZ3JhbShvLG4sYSksYX1ydW4oZSx0KXtyZXR1cm4gdGhpcy5leGVjdXRlUHJvZ3JhbShlLHQpLnRlbnNvcn1ydW5Qcm9ncmFtKGUsdCxuKXtmb3IobGV0IG49MDtuPHQubGVuZ3RoOysrbilpZighIXRbbl0uaXNQYWNrZWQhPShlLnByb2dyYW1JbmZvLmlucHV0VHlwZXNbbl09PT1wLlRleHR1cmVUeXBlLnBhY2tlZCkpdGhyb3cgbmV3IEVycm9yKGBpbnB1dFske259XSBwcm9wZXJ0eSBwYWNrZWQgaW5jb25zaXN0ZW50YCk7aWYoISFuLmlzUGFja2VkIT0oZS5wcm9ncmFtSW5mby5vdXRwdXQudGV4dHVyZVR5cGU9PT1wLlRleHR1cmVUeXBlLnBhY2tlZCkpdGhyb3cgbmV3IEVycm9yKCJvdXRwdXQgcHJvcGVydHkgcGFja2VkIGluY29uc2lzdGVudCIpO3RoaXMuc2Vzc2lvbi5wcm9ncmFtTWFuYWdlci5ydW4oZSx0LG4pO31nZXRPckNyZWF0ZVRleHR1cmVEYXRhKGUsdCl7bGV0IG49dGhpcy5nZXRUZXh0dXJlRGF0YShlLmRhdGFJZCx0PT09cC5UZXh0dXJlVHlwZS5wYWNrZWQpO2lmKCFuJiYobj10aGlzLmdldFRleHR1cmVEYXRhKGUuZGF0YUlkLHQhPT1wLlRleHR1cmVUeXBlLnBhY2tlZCksbikpcmV0dXJuIHQ9PT1wLlRleHR1cmVUeXBlLnBhY2tlZD90aGlzLnBhY2sobik6dGhpcy51bnBhY2sobik7aWYoIW4pe2NvbnN0IHI9KDAsIGMuY3JlYXRlVGV4dHVyZUxheW91dEZyb21UZXh0dXJlVHlwZSkodGhpcy5zZXNzaW9uLmxheW91dFN0cmF0ZWd5LGUuZGltcyx0KTtpZih0PT09cC5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uKXtjb25zdCBuPTEscj00LG89ZS5kaW1zO2lmKDQ9PT1vLmxlbmd0aCl7Y29uc3QgaT1bb1swXSxNYXRoLmNlaWwob1sxXSpvWzJdKm9bM10vcildLHM9KDAsIGMuY3JlYXRlVGV4dHVyZUxheW91dEZyb21UZXh0dXJlVHlwZSkodGhpcy5zZXNzaW9uLmxheW91dFN0cmF0ZWd5LGksdCk7bGV0IGE9ZS5udW1iZXJEYXRhO2lmKG9bMV0qb1syXSpvWzNdJXIhPTApe2NvbnN0IHQ9b1swXSxpPW9bMV0qb1syXSpvWzNdLHM9TWF0aC5jZWlsKGkqbi9yKSpyO2E9bmV3IEZsb2F0MzJBcnJheSh0KnMpO2ZvcihsZXQgcj0wO3I8dDsrK3Ipe2NvbnN0IHQ9cippLG89cipzK3IlbippO2Euc2V0KGUubnVtYmVyRGF0YS5zdWJhcnJheSh0LHQraSksbyk7fX1yZXR1cm4gdGhpcy5jcmVhdGVUZXh0dXJlRGF0YShzLGUudHlwZSxhLGUsMSl9fWlmKHQ9PT1wLlRleHR1cmVUeXBlLnBhY2tlZCl7Y29uc3QgdD0oMCwgYy5jcmVhdGVUZXh0dXJlTGF5b3V0RnJvbVNoYXBlKSh0aGlzLnNlc3Npb24ubGF5b3V0U3RyYXRlZ3ksZS5kaW1zLDEsW10se3JldmVyc2VXSDohMH0pLHI9dGhpcy5jcmVhdGVUZXh0dXJlRGF0YSh0LGUudHlwZSxlLm51bWJlckRhdGEsZSwxKTtuPXRoaXMucGFjayhyKTt9ZWxzZSBuPXRoaXMuY3JlYXRlVGV4dHVyZURhdGEocixlLnR5cGUsZS5udW1iZXJEYXRhLGUsMSk7fXJldHVybiBufWNyZWF0ZVRleHR1cmVEYXRhRnJvbUxheW91dEJpbmRUZW5zb3IoZSx0LG4scil7cmV0dXJuIHRoaXMuY3JlYXRlVGV4dHVyZURhdGEoZSx0LG4sciwxKX1jcmVhdGVUZXh0dXJlRGF0YShlLHQsbixvLGkpe3IuTG9nZ2VyLnZlcmJvc2UoIkluZmVyZW5jZUhhbmRsZXIiLGBDcmVhdGluZyBUZXh0dXJlRGF0YTogbGF5b3V0Olske0pTT04uc3RyaW5naWZ5KGUpfV1gKTtjb25zdCBzPXRoaXMuc2Vzc2lvbi50ZXh0dXJlTWFuYWdlci5jcmVhdGVUZXh0dXJlRnJvbUxheW91dCh0LGUsbixpKTtyZXR1cm4gdGhpcy5jcmVhdGVUZXh0dXJlRGF0YUZyb21UZXh0dXJlKGUsdCxzLG8pfXJlc2hhcGVVbnBhY2tlZChlLHQpe2NvbnN0IG49dGhpcy5nZXRPckNyZWF0ZVRleHR1cmVEYXRhKGUscC5UZXh0dXJlVHlwZS51bnBhY2tlZCkscj17Y2hhbm5lbHM6bi5jaGFubmVscyxoZWlnaHQ6bi5oZWlnaHQsd2lkdGg6bi53aWR0aCxzaGFwZTowIT09dC5sZW5ndGg/dDpbMV0sc3RyaWRlczppLlNoYXBlVXRpbC5jb21wdXRlU3RyaWRlcyh0KSx1bnBhY2tlZFNoYXBlOnR9O3JldHVybiB0aGlzLmNyZWF0ZVRleHR1cmVEYXRhRnJvbVRleHR1cmUocixlLnR5cGUsbi50ZXh0dXJlKS50ZW5zb3J9cmVzaGFwZVBhY2tlZChlLHQpe2NvbnN0IG49dGhpcy5nZXRPckNyZWF0ZVRleHR1cmVEYXRhKGUscC5UZXh0dXJlVHlwZS5wYWNrZWQpO2lmKCgwLCBhLmlzUmVzaGFwZUNoZWFwKShlLmRpbXMsdCkpe2NvbnN0IHI9e2NoYW5uZWxzOm4uY2hhbm5lbHMsaGVpZ2h0Om4uaGVpZ2h0LHdpZHRoOm4ud2lkdGgsc2hhcGU6MCE9PXQubGVuZ3RoP3Q6WzFdLHN0cmlkZXM6aS5TaGFwZVV0aWwuY29tcHV0ZVN0cmlkZXModCksdW5wYWNrZWRTaGFwZTp0LGlzUGFja2VkOiEwfTtyZXR1cm4gdGhpcy5jcmVhdGVUZXh0dXJlRGF0YUZyb21UZXh0dXJlKHIsZS50eXBlLG4udGV4dHVyZSkudGVuc29yfWNvbnN0IHI9KDAsIGEucHJvY2Vzc0RpbXMzRCkoZS5kaW1zKSxvPSgwLCBhLnByb2Nlc3NEaW1zM0QpKHQpLHM9dGhpcy5yZXNoYXBlUGFja2VkKGUsciksdT10aGlzLnJ1bigoMCwgYS5jcmVhdGVQYWNrZWRSZXNoYXBlM0RQcm9ncmFtSW5mb0xvYWRlcikodGhpcyxzLG8pLFtzXSk7cmV0dXJuIHRoaXMucmVzaGFwZVBhY2tlZCh1LHQpfWNhc3QoZSx0KXtjb25zdCBuPXRoaXMuZ2V0T3JDcmVhdGVUZXh0dXJlRGF0YShlLHAuVGV4dHVyZVR5cGUudW5wYWNrZWQpO3JldHVybiB0aGlzLmNyZWF0ZVRleHR1cmVEYXRhRnJvbVRleHR1cmUobix0LG4udGV4dHVyZSkudGVuc29yfWNyZWF0ZVRleHR1cmVEYXRhRnJvbVRleHR1cmUoZSx0LG4scixpKXtjb25zdCBzPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7dGVuc29yOnJ8fG5ldyBvLlRlbnNvcihlLnVucGFja2VkU2hhcGUsdCwoZT0+dGhpcy5yZWFkVGV4dHVyZShzKSksKGFzeW5jIGU9PnRoaXMucmVhZFRleHR1cmVBc3luYyhzKSksdm9pZCAwLGkpLHRleHR1cmU6bn0pO3JldHVybiB0aGlzLnNldFRleHR1cmVEYXRhKHMudGVuc29yLmRhdGFJZCxzLGUuaXNQYWNrZWQpLHN9Z2V0VGV4dHVyZURhdGEoZSx0PSExKXtyZXR1cm4gdGhpcy5zZXNzaW9uLmlzSW5pdGlhbGl6ZXIoZSk/dGhpcy5zZXNzaW9uLmdldFRleHR1cmVEYXRhKGUsdCk6dD90aGlzLnBhY2tlZFRleHR1cmVEYXRhQ2FjaGUuZ2V0KGUpOnRoaXMudW5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlLmdldChlKX1zZXRUZXh0dXJlRGF0YShlLHQsbj0hMSl7dGhpcy5zZXNzaW9uLmlzSW5pdGlhbGl6ZXIoZSk/dGhpcy5zZXNzaW9uLnNldFRleHR1cmVEYXRhKGUsdCxuKToobj90aGlzLnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU6dGhpcy51bnBhY2tlZFRleHR1cmVEYXRhQ2FjaGUpLnNldChlLHQpO31pc1RleHR1cmVMYXlvdXRDYWNoZWQoZSx0PSExKXtyZXR1cm4gISF0aGlzLmdldFRleHR1cmVEYXRhKGUuZGF0YUlkLHQpfWRpc3Bvc2UoKXt0aGlzLnNlc3Npb24udGV4dHVyZU1hbmFnZXIuY2xlYXJBY3RpdmVUZXh0dXJlcygpLHRoaXMucGFja2VkVGV4dHVyZURhdGFDYWNoZS5mb3JFYWNoKChlPT50aGlzLnNlc3Npb24udGV4dHVyZU1hbmFnZXIucmVsZWFzZVRleHR1cmUoZSkpKSx0aGlzLnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU9bmV3IE1hcCx0aGlzLnVucGFja2VkVGV4dHVyZURhdGFDYWNoZS5mb3JFYWNoKChlPT50aGlzLnNlc3Npb24udGV4dHVyZU1hbmFnZXIucmVsZWFzZVRleHR1cmUoZSkpKSx0aGlzLnVucGFja2VkVGV4dHVyZURhdGFDYWNoZT1uZXcgTWFwO31yZWFkVGV4dHVyZShlKXtyZXR1cm4gZS5pc1BhY2tlZD90aGlzLnJlYWRUZXh0dXJlKHRoaXMudW5wYWNrKGUpKTp0aGlzLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQuaXNGbG9hdDMyRG93bmxvYWRTdXBwb3J0ZWQ/dGhpcy5zZXNzaW9uLnRleHR1cmVNYW5hZ2VyLnJlYWRUZXh0dXJlKGUsZS50ZW5zb3IudHlwZSxlLmNoYW5uZWxzKTp0aGlzLnNlc3Npb24udGV4dHVyZU1hbmFnZXIucmVhZFVpbnQ4VGV4dHVyZUFzRmxvYXQoKDAsIHUuZW5jb2RlQXNVaW50OCkodGhpcyxlKSl9YXN5bmMgcmVhZFRleHR1cmVBc3luYyhlKXtyZXR1cm4gZS5pc1BhY2tlZD90aGlzLnJlYWRUZXh0dXJlQXN5bmModGhpcy51bnBhY2soZSkpOnRoaXMuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC5pc0Zsb2F0MzJEb3dubG9hZFN1cHBvcnRlZD90aGlzLnNlc3Npb24udGV4dHVyZU1hbmFnZXIucmVhZFRleHR1cmVBc3luYyhlLGUudGVuc29yLnR5cGUsZS5jaGFubmVscyk6dGhpcy5zZXNzaW9uLnRleHR1cmVNYW5hZ2VyLnJlYWRVaW50OFRleHR1cmVBc0Zsb2F0KCgwLCB1LmVuY29kZUFzVWludDgpKHRoaXMsZSkpfXBhY2soZSl7cmV0dXJuIHRoaXMuZXhlY3V0ZVByb2dyYW0oKDAsIHMuY3JlYXRlUGFja1Byb2dyYW1JbmZvTG9hZGVyKSh0aGlzLGUudGVuc29yKSxbZS50ZW5zb3JdKX11bnBhY2soZSl7cmV0dXJuIHRoaXMuZXhlY3V0ZVByb2dyYW0oKDAsIGwuY3JlYXRlVW5wYWNrUHJvZ3JhbUluZm9Mb2FkZXIpKHRoaXMsZS50ZW5zb3IpLFtlLnRlbnNvcl0pfX07fSw0MTEwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzJiZ0aGlzLl9fY3JlYXRlQmluZGluZ3x8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24oZSx0LG4scil7dm9pZCAwPT09ciYmKHI9bik7dmFyIG89T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LG4pO28mJiEoImdldCJpbiBvPyF0Ll9fZXNNb2R1bGU6by53cml0YWJsZXx8by5jb25maWd1cmFibGUpfHwobz17ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdFtuXX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLG8pO306ZnVuY3Rpb24oZSx0LG4scil7dm9pZCAwPT09ciYmKHI9biksZVtyXT10W25dO30pLG89dGhpcyYmdGhpcy5fX3NldE1vZHVsZURlZmF1bHR8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsImRlZmF1bHQiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOnR9KTt9OmZ1bmN0aW9uKGUsdCl7ZS5kZWZhdWx0PXQ7fSksaT10aGlzJiZ0aGlzLl9faW1wb3J0U3Rhcnx8ZnVuY3Rpb24oZSl7aWYoZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciB0PXt9O2lmKG51bGwhPWUpZm9yKHZhciBuIGluIGUpImRlZmF1bHQiIT09biYmT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnIodCxlLG4pO3JldHVybiBvKHQsZSksdH07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuV0VCR0xfT1BfUkVTT0xWRV9SVUxFUz12b2lkIDA7Y29uc3Qgcz1uKDg4MTcpLGE9aShuKDUxOTQpKSx1PW4oNDc1MiksbD1uKDY2NjgpLGM9big5NzU0KSxwPW4oNTA0MiksZD1uKDY3NDIpLGY9big0MTI1KSxoPW4oNjE0OSksZz1uKDUzNzgpLGI9big2OTgxKSxtPW4oNzQxMykseT1uKDcwMDYpLHY9big4Mjc2KSxfPW4oNTU2NSksdz1uKDI4MzQpLFQ9bigxMDEwKSx4PW4oODEyNiksTz1uKDI4MDEpLFM9big1NjUpLEE9bigyNDQ0KSxQPW4oODE1KSxJPW4oNTY0KSxFPW4oNTQxNiksRD1uKDEyNDApLCQ9big1OTQ0KSxrPW4oNTcwNyksRj1pKG4oOTA4NykpLE49big3ODYyKSxqPW4oMzk4MCk7dC5XRUJHTF9PUF9SRVNPTFZFX1JVTEVTPVtbIkFicyIsIiIsIjYrIixGLmFic10sWyJBY29zIiwiIiwiNysiLEYuYWNvc10sWyJBZGQiLCIiLCI3KyIsYS5hZGRdLFsiQW5kIiwiIiwiNysiLGEuYW5kXSxbIkFzaW4iLCIiLCI3KyIsRi5hc2luXSxbIkF0YW4iLCIiLCI3KyIsRi5hdGFuXSxbIkF2ZXJhZ2VQb29sIiwiIiwiNysiLHcuYXZlcmFnZVBvb2wsdy5wYXJzZUF2ZXJhZ2VQb29sQXR0cmlidXRlc10sWyJCYXRjaE5vcm1hbGl6YXRpb24iLCIiLCI3KyIscy5iYXRjaE5vcm1hbGl6YXRpb24scy5wYXJzZUJhdGNoTm9ybWFsaXphdGlvbkF0dHJpYnV0ZXNdLFsiQ2FzdCIsIiIsIjYrIix1LmNhc3QsdS5wYXJzZUNhc3RBdHRyaWJ1dGVzXSxbIkNlaWwiLCIiLCI2KyIsRi5jZWlsXSxbIkNsaXAiLCIiLCI2LTEwIixGLmNsaXAsRi5wYXJzZUNsaXBBdHRyaWJ1dGVzXSxbIkNsaXAiLCIiLCIxMSsiLEYuY2xpcFYxMV0sWyJDb25jYXQiLCIiLCI0KyIsbC5jb25jYXQsbC5wYXJzZUNvbmNhdEF0dHJpYnV0ZXNdLFsiQ29udiIsIiIsIjErIixjLmNvbnYsYy5wYXJzZUNvbnZBdHRyaWJ1dGVzXSxbIkNvbnZUcmFuc3Bvc2UiLCIiLCIxKyIscC5jb252VHJhbnNwb3NlLHAucGFyc2VDb252VHJhbnNwb3NlQXR0cmlidXRlc10sWyJDb3MiLCIiLCI3KyIsRi5jb3NdLFsiRGl2IiwiIiwiNysiLGEuZGl2XSxbIkRyb3BvdXQiLCIiLCI3KyIsRi5pZGVudGl0eV0sWyJEZXB0aFRvU3BhY2UiLCIiLCIxKyIsZC5kZXB0aFRvU3BhY2UsZC5wYXJzZURlcHRoVG9TcGFjZUF0dHJpYnV0ZXNdLFsiRXF1YWwiLCIiLCI3KyIsYS5lcXVhbF0sWyJFbHUiLCIiLCI2KyIsRi5lbHUsRi5wYXJzZUVsdUF0dHJpYnV0ZXNdLFsiRXhwIiwiIiwiNisiLEYuZXhwXSxbIkZsYXR0ZW4iLCIiLCIxKyIsZi5mbGF0dGVuLGYucGFyc2VGbGF0dGVuQXR0cmlidXRlc10sWyJGbG9vciIsIiIsIjYrIixGLmZsb29yXSxbIkZ1c2VkQ29udiIsImNvbS5taWNyb3NvZnQiLCIxKyIsYy5jb252LGMucGFyc2VDb252QXR0cmlidXRlc10sWyJHYXRoZXIiLCIiLCIxKyIsaC5nYXRoZXIsaC5wYXJzZUdhdGhlckF0dHJpYnV0ZXNdLFsiR2VtbSIsIiIsIjctMTAiLGcuZ2VtbSxnLnBhcnNlR2VtbUF0dHJpYnV0ZXNWN10sWyJHZW1tIiwiIiwiMTErIixnLmdlbW0sZy5wYXJzZUdlbW1BdHRyaWJ1dGVzVjExXSxbIkdsb2JhbEF2ZXJhZ2VQb29sIiwiIiwiMSsiLHcuZ2xvYmFsQXZlcmFnZVBvb2wsdy5wYXJzZUdsb2JhbEF2ZXJhZ2VQb29sQXR0cmlidXRlc10sWyJHbG9iYWxNYXhQb29sIiwiIiwiMSsiLHcuZ2xvYmFsTWF4UG9vbF0sWyJHcmVhdGVyIiwiIiwiNysiLGEuZ3JlYXRlcl0sWyJJZGVudGl0eSIsIiIsIjErIixGLmlkZW50aXR5XSxbIkltYWdlU2NhbGVyIiwiIiwiMSsiLGIuaW1hZ2VTY2FsZXIsYi5wYXJzZUltYWdlU2NhbGVyQXR0cmlidXRlc10sWyJJbnN0YW5jZU5vcm1hbGl6YXRpb24iLCIiLCI2KyIsbS5pbnN0YW5jZU5vcm1hbGl6YXRpb24sbS5wYXJzZUluc3RhbmNlTm9ybWFsaXphdGlvbkF0dHJpYnV0ZXNdLFsiTGVha3lSZWx1IiwiIiwiNisiLEYubGVha3lSZWx1LEYucGFyc2VMZWFreVJlbHVBdHRyaWJ1dGVzXSxbIkxlc3MiLCIiLCI3KyIsYS5sZXNzXSxbIkxSTiIsIiIsIjErIix5Lmxybix5LnBhcnNlTHJuQXR0cmlidXRlc10sWyJMb2ciLCIiLCI2KyIsRi5sb2ddLFsiTWF0TXVsIiwiIiwiMSsiLHYubWF0TXVsLHYucGFyc2VNYXRNdWxBdHRyaWJ1dGVzXSxbIk1heFBvb2wiLCIiLCIxKyIsdy5tYXhQb29sLHcucGFyc2VNYXhQb29sQXR0cmlidXRlc10sWyJNdWwiLCIiLCI3KyIsYS5tdWxdLFsiTmVnIiwiIiwiNisiLEYubmVnXSxbIk5vdCIsIiIsIjErIixGLm5vdF0sWyJPciIsIiIsIjcrIixhLm9yXSxbIlBhZCIsIiIsIjItMTAiLF8ucGFkVjIsXy5wYXJzZVBhZEF0dHJpYnV0ZXNWMl0sWyJQYWQiLCIiLCIxMSsiLF8ucGFkVjExLF8ucGFyc2VQYWRBdHRyaWJ1dGVzVjExXSxbIlBvdyIsIiIsIjcrIixhLnBvd10sWyJQUmVsdSIsIiIsIjcrIixhLnBSZWx1XSxbIlJlZHVjZUxvZ1N1bSIsIiIsIjErIixULnJlZHVjZUxvZ1N1bSxULnBhcnNlUmVkdWNlQXR0cmlidXRlc10sWyJSZWR1Y2VNYXgiLCIiLCIxKyIsVC5yZWR1Y2VNYXgsVC5wYXJzZVJlZHVjZUF0dHJpYnV0ZXNdLFsiUmVkdWNlTWVhbiIsIiIsIjErIixULnJlZHVjZU1lYW4sVC5wYXJzZVJlZHVjZUF0dHJpYnV0ZXNdLFsiUmVkdWNlTWluIiwiIiwiMSsiLFQucmVkdWNlTWluLFQucGFyc2VSZWR1Y2VBdHRyaWJ1dGVzXSxbIlJlZHVjZVByb2QiLCIiLCIxKyIsVC5yZWR1Y2VQcm9kLFQucGFyc2VSZWR1Y2VBdHRyaWJ1dGVzXSxbIlJlZHVjZVN1bSIsIiIsIjEtMTIiLFQucmVkdWNlU3VtLFQucGFyc2VSZWR1Y2VBdHRyaWJ1dGVzXSxbIlJlZHVjZVN1bVNxdWFyZSIsIiIsIjErIixULnJlZHVjZUxvZ1N1bVNxdWFyZSxULnBhcnNlUmVkdWNlQXR0cmlidXRlc10sWyJSZWx1IiwiIiwiNisiLEYucmVsdV0sWyJSZXNoYXBlIiwiIiwiNSsiLHgucmVzaGFwZV0sWyJSZXNpemUiLCIiLCIxMCIsTy5yZXNpemUsTy5wYXJzZVJlc2l6ZUF0dHJpYnV0ZXNWMTBdLFsiUmVzaXplIiwiIiwiMTErIixPLnJlc2l6ZSxPLnBhcnNlUmVzaXplQXR0cmlidXRlc1YxMV0sWyJTaGFwZSIsIiIsIjErIixTLnNoYXBlXSxbIlNpZ21vaWQiLCIiLCI2KyIsRi5zaWdtb2lkXSxbIlNpbiIsIiIsIjcrIixGLnNpbl0sWyJTbGljZSIsIiIsIjEwKyIsQS5zbGljZVYxMF0sWyJTbGljZSIsIiIsIjEtOSIsQS5zbGljZSxBLnBhcnNlU2xpY2VBdHRyaWJ1dGVzXSxbIlNvZnRtYXgiLCIiLCIxLTEyIixQLnNvZnRtYXgsUC5wYXJzZVNvZnRtYXhBdHRyaWJ1dGVzXSxbIlNvZnRtYXgiLCIiLCIxMysiLFAuc29mdG1heFYxMyxQLnBhcnNlU29mdG1heEF0dHJpYnV0ZXNWMTNdLFsiU3BsaXQiLCIiLCIyLTEyIixJLnNwbGl0LEkucGFyc2VTcGxpdEF0dHJpYnV0ZXNdLFsiU3FydCIsIiIsIjYrIixGLnNxcnRdLFsiU3F1ZWV6ZSIsIiIsIjEtMTIiLEUuc3F1ZWV6ZSxFLnBhcnNlU3F1ZWV6ZUF0dHJpYnV0ZXNdLFsiU3F1ZWV6ZSIsIiIsIjEzKyIsRS5zcXVlZXplVjEzXSxbIlN1YiIsIiIsIjcrIixhLnN1Yl0sWyJTdW0iLCIiLCI2KyIsRC5zdW1dLFsiVGFuIiwiIiwiNysiLEYudGFuXSxbIlRhbmgiLCIiLCI2KyIsRi50YW5oXSxbIlRpbGUiLCIiLCI2KyIsJC50aWxlXSxbIlRyYW5zcG9zZSIsIiIsIjErIixrLnRyYW5zcG9zZSxrLnBhcnNlVHJhbnNwb3NlQXR0cmlidXRlc10sWyJVcHNhbXBsZSIsIiIsIjctOCIsai51cHNhbXBsZSxqLnBhcnNlVXBzYW1wbGVBdHRyaWJ1dGVzVjddLFsiVXBzYW1wbGUiLCIiLCI5IixqLnVwc2FtcGxlLGoucGFyc2VVcHNhbXBsZUF0dHJpYnV0ZXNWOV0sWyJVbnNxdWVlemUiLCIiLCIxLTEyIixOLnVuc3F1ZWV6ZSxOLnBhcnNlVW5zcXVlZXplQXR0cmlidXRlc10sWyJVbnNxdWVlemUiLCIiLCIxMysiLE4udW5zcXVlZXplVjEzXSxbIlhvciIsIiIsIjcrIixhLnhvcl1dO30sODgxNzooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQucGFyc2VCYXRjaE5vcm1hbGl6YXRpb25BdHRyaWJ1dGVzPXQuYmF0Y2hOb3JtYWxpemF0aW9uPXZvaWQgMDtjb25zdCByPW4oNDkxMCksbz1uKDY3NTcpLGk9big1NjM5KSxzPXtuYW1lOiJCYXRjaE5vcm1hbGl6YXRpb24iLGlucHV0TmFtZXM6WyJBIiwiU2NhbGUiLCJCIiwiTWVhbiIsIlZhcmlhbmNlIl0saW5wdXRUeXBlczpbaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkLGkuVGV4dHVyZVR5cGUudW5wYWNrZWQsaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXX07dC5iYXRjaE5vcm1hbGl6YXRpb249KGUsdCxuKT0+KHUodCksW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxzKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXksZ2V0OigpPT5hKGUsdCxuKX0pLHQpXSksdC5wYXJzZUJhdGNoTm9ybWFsaXphdGlvbkF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEZsb2F0KCJlcHNpbG9uIiwxZS01KSxuPWUuYXR0cmlidXRlcy5nZXRGbG9hdCgibW9tZW50dW0iLC45KSxvPWUuYXR0cmlidXRlcy5nZXRJbnQoInNwYXRpYWwiLDEpO3JldHVybiAoMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHtlcHNpbG9uOnQsbW9tZW50dW06bixzcGF0aWFsOm99KX07Y29uc3QgYT0oZSx0LG4pPT57Y29uc3Qgcj0oMCwgby5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksYT10WzBdLmRpbXMubGVuZ3RoLFt1LGxdPWUuY2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0KHRbMV0uZGltcyxpLlRleHR1cmVUeXBlLnVucGFja2VkKSxjPWBcbiAgZmxvYXQgcHJvY2VzcyhpbnRbJHthfV0gaW5kaWNlcykge1xuICAgIHZlYzIgcG9zaXRpb24gPSBvZmZzZXRUb0Nvb3JkcyhpbmRpY2VzWzFdLCAke3V9LCAke2x9KTtcbiAgICBmbG9hdCBzY2FsZSA9IGdldENvbG9yQXNGbG9hdCgke3IudGV4dHVyZTJEfShTY2FsZSwgcG9zaXRpb24pKTtcbiAgICBmbG9hdCBtZWFuID0gZ2V0Q29sb3JBc0Zsb2F0KCR7ci50ZXh0dXJlMkR9KE1lYW4sIHBvc2l0aW9uKSk7XG4gICAgZmxvYXQgdmFyaWFuY2UgPSBnZXRDb2xvckFzRmxvYXQoJHtyLnRleHR1cmUyRH0oVmFyaWFuY2UsIHBvc2l0aW9uKSk7XG4gICAgZmxvYXQgYiA9IGdldENvbG9yQXNGbG9hdCgke3IudGV4dHVyZTJEfShCLCBwb3NpdGlvbikpO1xuXG4gICAgcmV0dXJuIHNjYWxlICogKCAoX0EoaW5kaWNlcykgLSBtZWFuKSAvIHNxcnQodmFyaWFuY2UgKyBmbG9hdCgke24uZXBzaWxvbn0pKSApICsgYjtcbiAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxzKSx7b3V0cHV0OntkaW1zOnRbMF0uZGltcyx0eXBlOnRbMF0udHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6Y30pfSx1PWU9PntpZighZXx8NSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiQmF0Y2hOb3JtYWxpemF0aW9uIHJlcXVpcmVzIDUgaW5wdXRzLiIpO2NvbnN0IHQ9ZVswXSxuPWVbMV0scj1lWzJdLG89ZVszXSxpPWVbNF07aWYodC5kaW1zLmxlbmd0aDwzfHwxIT09bi5kaW1zLmxlbmd0aHx8MSE9PXIuZGltcy5sZW5ndGh8fDEhPT1vLmRpbXMubGVuZ3RofHwxIT09aS5kaW1zLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgaW5wdXQgc2hhcGUuIik7aWYobi5kaW1zWzBdIT09dC5kaW1zWzFdfHxyLmRpbXNbMF0hPT10LmRpbXNbMV18fG8uZGltc1swXSE9PXQuZGltc1sxXXx8aS5kaW1zWzBdIT09dC5kaW1zWzFdKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBpbnB1dCBzaGFwZS4iKTtpZigiZmxvYXQzMiIhPT10LnR5cGUmJiJmbG9hdDY0IiE9PXQudHlwZXx8ImZsb2F0MzIiIT09bi50eXBlJiYiZmxvYXQ2NCIhPT1uLnR5cGV8fCJmbG9hdDMyIiE9PXIudHlwZSYmImZsb2F0NjQiIT09ci50eXBlfHwiZmxvYXQzMiIhPT1vLnR5cGUmJiJmbG9hdDY0IiE9PW8udHlwZXx8ImZsb2F0MzIiIT09aS50eXBlJiYiZmxvYXQ2NCIhPT1pLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGlucHV0IHRlbnNvciB0eXBlcy4iKX07fSw1MTk0OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC54b3I9dC5zdWI9dC5wUmVsdT10LnBvdz10Lm9yPXQubXVsPXQubGVzcz10LmdyZWF0ZXI9dC5lcXVhbD10LmRpdj10LmFuZD10LmFkZD10Lmdsc2xQUmVsdT10Lmdsc2xQb3c9dC5nbHNsWG9yPXQuZ2xzbE9yPXQuZ2xzbEFuZD10Lmdsc2xMZXNzPXQuZ2xzbEdyZWF0ZXI9dC5nbHNsRXF1YWw9dC5nbHNsU3ViPXQuZ2xzbE11bD10Lmdsc2xEaXY9dC5nbHNsQWRkPXZvaWQgMDtjb25zdCByPW4oNzI3Myksbz1uKDE5OTcpLGk9big2NzU3KSxzPW4oNTYzOSk7ZnVuY3Rpb24gYSgpe2NvbnN0IGU9ImFkZF8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBhICsgYjtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2MSArIHYyO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gdSgpe2NvbnN0IGU9ImRpdl8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBhIC8gYjtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2MSAvIHYyO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gbCgpe2NvbnN0IGU9Im11bF8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBhICogYjtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2MSAqIHYyO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gYygpe2NvbnN0IGU9InN1Yl8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBhIC0gYjtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2MSAtIHYyO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gcCgpe2NvbnN0IGU9ImVxdWFsXyI7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHtlfShmbG9hdCBhLCBmbG9hdCBiKSB7XG4gICAgcmV0dXJuIGZsb2F0KGEgPT0gYik7XG4gIH1cbiAgdmVjNCAke2V9KHZlYzQgdjEsIHZlYzQgdjIpIHtcbiAgICByZXR1cm4gdmVjNChlcXVhbCh2MSwgdjIpKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOm8uRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIGQoKXtjb25zdCBlPSJncmVhdGVyXyI7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHtlfShmbG9hdCBhLCBmbG9hdCBiKSB7XG4gICAgcmV0dXJuIGZsb2F0KGEgPiBiKTtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2ZWM0KCB2MS5yID4gdjIuciAsXG4gICAgICB2MS5nID4gdjIuZyxcbiAgICAgIHYxLmIgPiB2Mi5iLFxuICAgICAgdjEuYSA+IHYyLmEgKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOm8uRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIGYoKXtjb25zdCBlPSJsZXNzXyI7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHtlfShmbG9hdCBhLCBmbG9hdCBiKSB7XG4gICAgcmV0dXJuIGZsb2F0KGEgPCBiKTtcbiAgfVxuICB2ZWM0ICR7ZX0odmVjNCB2MSwgdmVjNCB2Mikge1xuICAgIHJldHVybiB2ZWM0KCB2MS5yIDwgdjIuciAsXG4gICAgICAgICAgICAgICAgdjEuZyA8IHYyLmcsXG4gICAgICAgICAgICAgICAgdjEuYiA8IHYyLmIsXG4gICAgICAgICAgICAgICAgdjEuYSA8IHYyLmEgKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOm8uRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIGgoKXtjb25zdCBlPSJhbmRfIjtyZXR1cm4ge2JvZHk6YFxuICBmbG9hdCAke2V9KGZsb2F0IGEsIGZsb2F0IGIpIHtcbiAgICByZXR1cm4gZmxvYXQoIGJvb2woYSkgJiYgYm9vbChiKSApO1xuICB9XG4gIHZlYzQgJHtlfSh2ZWM0IHYxLCB2ZWM0IHYyKSB7XG4gICAgYnZlYzQgYjEgPSBidmVjNCh2MSk7XG4gICAgYnZlYzQgYjIgPSBidmVjNCh2Mik7XG4gICAgcmV0dXJuIHZlYzQoIGIxLnIgJiYgYjIuciAsXG4gICAgICAgICAgICAgICAgYjEuZyAmJiBiMi5nLFxuICAgICAgICAgICAgICAgIGIxLmIgJiYgYjIuYixcbiAgICAgICAgICAgICAgICBiMS5hICYmIGIyLmEgKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOm8uRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIGcoKXtjb25zdCBlPSJvcl8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBmbG9hdCggYm9vbChhKSB8fCBib29sKGIpICk7XG4gIH1cbiAgdmVjNCAke2V9KHZlYzQgdjEsIHZlYzQgdjIpIHtcbiAgICBidmVjNCBiMSA9IGJ2ZWM0KHYxKTtcbiAgICBidmVjNCBiMiA9IGJ2ZWM0KHYyKTtcbiAgICByZXR1cm4gdmVjNCggYjEuciB8fCBiMi5yICxcbiAgICAgICAgICAgICAgICBiMS5nIHx8IGIyLmcsXG4gICAgICAgICAgICAgICAgYjEuYiB8fCBiMi5iLFxuICAgICAgICAgICAgICAgIGIxLmEgfHwgYjIuYSApO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gYigpe2NvbnN0IGU9Inhvcl8iO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX0oZmxvYXQgYSwgZmxvYXQgYikge1xuICAgIHJldHVybiBmbG9hdCggYm9vbChhKSBeXiBib29sKGIpICk7XG4gIH1cbiAgdmVjNCAke2V9KHZlYzQgdjEsIHZlYzQgdjIpIHtcbiAgICBidmVjNCBiMSA9IGJ2ZWM0KHYxKTtcbiAgICBidmVjNCBiMiA9IGJ2ZWM0KHYyKTtcbiAgICByZXR1cm4gdmVjNCggYjEuciBeXiBiMi5yICxcbiAgICAgICAgICAgICAgICBiMS5nIF5eIGIyLmcsXG4gICAgICAgICAgICAgICAgYjEuYiBeXiBiMi5iLFxuICAgICAgICAgICAgICAgIGIxLmEgXl4gYjIuYSApO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gbSgpe3JldHVybiBmdW5jdGlvbihlKXtjb25zdCB0PWAke2V9X2A7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHt0fShmbG9hdCBhLCBmbG9hdCBiKSB7XG4gICAgcmV0dXJuICR7ZX0oYSwgYik7XG4gIH1cbiAgdmVjNCAke3R9KHZlYzQgdjEsIHZlYzQgdjIpIHtcbiAgICByZXR1cm4gJHtlfSh2MSwgdjIpO1xuICB9XG4gIGAsbmFtZTp0LHR5cGU6by5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19KCJwb3ciKX1mdW5jdGlvbiB5KCl7Y29uc3QgZT0icHJlbHVfIjtyZXR1cm4ge2JvZHk6YFxuICBmbG9hdCAke2V9KGZsb2F0IGEsIGZsb2F0IGIpIHtcbiAgICByZXR1cm4gYSA8IDAuMCA/IGEgKiBiOiBhO1xuICB9XG4gIHZlYzQgJHtlfSh2ZWM0IHYxLCB2ZWM0IHYyKSB7XG4gICAgcmV0dXJuIHZlYzQoXG4gICAgICB2MS5yIDwgMC4wID8gdjEuciAqIHYyLnI6IHYxLnIsXG4gICAgICB2MS5nIDwgMC4wID8gdjEuZyAqIHYyLmc6IHYxLmcsXG4gICAgICB2MS5iIDwgMC4wID8gdjEuYiAqIHYyLmI6IHYxLmIsXG4gICAgICB2MS5hIDwgMC4wID8gdjEuYSAqIHYyLmE6IHYxLmFcbiAgICAgICk7XG4gIH1cbiAgYCxuYW1lOmUsdHlwZTpvLkZ1bmN0aW9uVHlwZS5WYWx1ZUJhc2VkfX10Lmdsc2xBZGQ9YSx0Lmdsc2xEaXY9dSx0Lmdsc2xNdWw9bCx0Lmdsc2xTdWI9Yyx0Lmdsc2xFcXVhbD1wLHQuZ2xzbEdyZWF0ZXI9ZCx0Lmdsc2xMZXNzPWYsdC5nbHNsQW5kPWgsdC5nbHNsT3I9Zyx0Lmdsc2xYb3I9Yix0Lmdsc2xQb3c9bSx0Lmdsc2xQUmVsdT15O2NvbnN0IHY9KGUsdCxuLHI9dFswXS50eXBlLG8pPT57Y29uc3QgaT1lLnNlc3Npb24ucGFjaz9zLlRleHR1cmVUeXBlLnBhY2tlZDpzLlRleHR1cmVUeXBlLnVucGFja2VkO3JldHVybiB7bmFtZTpuLm5hbWUsaW5wdXROYW1lczpbIkEiLCJCIl0saW5wdXRUeXBlczpbaSxpXSxjYWNoZUhpbnQ6byxnZXQ6KCk9Pl8oZSx0LG4scil9fSxfPShlLHQsbixvPXRbMF0udHlwZSk9Pntjb25zdCBhPWUuc2Vzc2lvbi5wYWNrP3MuVGV4dHVyZVR5cGUucGFja2VkOnMuVGV4dHVyZVR5cGUudW5wYWNrZWQsdT0hci5TaGFwZVV0aWwuYXJlRXF1YWwodFswXS5kaW1zLHRbMV0uZGltcyk7bGV0IGw9dFswXS5kaW1zO2NvbnN0IGM9ZS5zZXNzaW9uLnBhY2s7aWYodSl7Y29uc3Qgcz1yLkJyb2FkY2FzdFV0aWwuY2FsY1NoYXBlKHRbMF0uZGltcyx0WzFdLmRpbXMsITEpO2lmKCFzKXRocm93IG5ldyBFcnJvcigiQ2FuJ3QgcGVyZm9ybSBiaW5hcnkgb3Agb24gdGhlIGdpdmVuIHRlbnNvcnMiKTtsPXM7Y29uc3QgdT1sLmxlbmd0aCxwPTAhPT10WzBdLmRpbXMubGVuZ3RoP3RbMF0uZGltcy5sZW5ndGg6MSxkPTAhPT10WzFdLmRpbXMubGVuZ3RoP3RbMV0uZGltcy5sZW5ndGg6MSxmPTAhPT10WzBdLmRpbXMubGVuZ3RoPyJiY2FzdEluZGljZXNfQShpbmRpY2VzLCBhaW5kaWNlcyk7IjoiYWluZGljZXNbMF0gPSAwOyIsaD0wIT09dFsxXS5kaW1zLmxlbmd0aD8iYmNhc3RJbmRpY2VzX0IoaW5kaWNlcywgYmluZGljZXMpOyI6ImJpbmRpY2VzWzBdID0gMDsiLGc9KDAsIGkuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLGI9Yz9gXG4gICAgICAke24uYm9keX1cbiAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgdmVjNCBhID0gZ2V0QUF0T3V0Q29vcmRzKCk7XG4gICAgICAgIHZlYzQgYiA9IGdldEJBdE91dENvb3JkcygpO1xuICAgICAgICB2ZWM0IHJlc3VsdCA9ICR7bi5uYW1lfShhLCBiKTtcbiAgICAgICAgJHtnLm91dHB1dH0gPSByZXN1bHQ7XG4gICAgICB9YDpgXG4gICAgICAke24uYm9keX1cbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50IGluZGljZXNbJHt1fV0pIHtcbiAgICAgICAgaW50IGFpbmRpY2VzWyR7cH1dO1xuICAgICAgICBpbnQgYmluZGljZXNbJHtkfV07XG4gICAgICAgICR7Zn1cbiAgICAgICAgJHtofVxuICAgICAgICByZXR1cm4gJHtuLm5hbWV9KF9BKGFpbmRpY2VzKSwgX0IoYmluZGljZXMpKTtcbiAgICAgIH1gO3JldHVybiB7bmFtZTpuLm5hbWUsaW5wdXROYW1lczpbIkEiLCJCIl0saW5wdXRUeXBlczpbYSxhXSxvdXRwdXQ6e2RpbXM6bCx0eXBlOm8sdGV4dHVyZVR5cGU6YX0sc2hhZGVyU291cmNlOmIsaGFzTWFpbjpjfX1jb25zdCBwPSgwLCBpLmdldEdsc2wpKGUuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC52ZXJzaW9uKSxkPWBcbiAgICAke24uYm9keX1cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWM0IHYxID0gJHtwLnRleHR1cmUyRH0oQSwgVGV4Q29vcmRzKTtcbiAgICAgIHZlYzQgdjIgPSAke3AudGV4dHVyZTJEfShCLCBUZXhDb29yZHMpO1xuICAgICAgdmVjNCByZXN1bHQgPSAke24ubmFtZX0odjEsIHYyKTtcbiAgICAgICR7cC5vdXRwdXR9ID0gcmVzdWx0O1xuICAgIH1cbiAgICBgO3JldHVybiB7bmFtZTpuLm5hbWUsaW5wdXROYW1lczpbIkEiLCJCIl0saW5wdXRUeXBlczpbYSxhXSxvdXRwdXQ6e2RpbXM6dFswXS5kaW1zLHR5cGU6byx0ZXh0dXJlVHlwZTphfSxzaGFkZXJTb3VyY2U6ZCxoYXNNYWluOiEwfX07dC5hZGQ9KGUsdCk9PltlLnJ1bih2KGUsdCxhKCkpLHQpXSx0LmFuZD0oZSx0KT0+W2UucnVuKHYoZSx0LGgoKSwiYm9vbCIpLHQpXSx0LmRpdj0oZSx0KT0+W2UucnVuKHYoZSx0LHUoKSksdCldLHQuZXF1YWw9KGUsdCk9PltlLnJ1bih2KGUsdCxwKCksImJvb2wiKSx0KV0sdC5ncmVhdGVyPShlLHQpPT5bZS5ydW4odihlLHQsZCgpLCJib29sIiksdCldLHQubGVzcz0oZSx0KT0+W2UucnVuKHYoZSx0LGYoKSwiYm9vbCIpLHQpXSx0Lm11bD0oZSx0KT0+W2UucnVuKHYoZSx0LGwoKSksdCldLHQub3I9KGUsdCk9PltlLnJ1bih2KGUsdCxnKCksImJvb2wiKSx0KV0sdC5wb3c9KGUsdCk9PltlLnJ1bih2KGUsdCxtKCkpLHQpXSx0LnBSZWx1PShlLHQpPT5bZS5ydW4odihlLHQseSgpKSx0KV0sdC5zdWI9KGUsdCk9PltlLnJ1bih2KGUsdCxjKCkpLHQpXSx0Lnhvcj0oZSx0KT0+W2UucnVuKHYoZSx0LGIoKSwiYm9vbCIpLHQpXTt9LDQ3NTI6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlQ2FzdEF0dHJpYnV0ZXM9dC5jYXN0PXZvaWQgMDtjb25zdCByPW4oNzI3Myk7dC5jYXN0PShlLHQsbik9PihvKHQpLFtlLmNhc3QodFswXSxuKV0pLHQucGFyc2VDYXN0QXR0cmlidXRlcz1lPT5yLlByb3RvVXRpbC50ZW5zb3JEYXRhVHlwZUZyb21Qcm90byhlLmF0dHJpYnV0ZXMuZ2V0SW50KCJ0byIpKTtjb25zdCBvPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiQ2FzdCByZXF1aXJlcyAxIGlucHV0LiIpO2lmKCJzdHJpbmciPT09ZVswXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt9LDQ1OTU6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNyZWF0ZVBhY2tlZENvbmNhdFByb2dyYW1JbmZvTG9hZGVyPXZvaWQgMDtjb25zdCByPW4oNjc1Nyksbz1uKDU2MzkpLGk9big0MzIpLHM9big1NjE0KTt0LmNyZWF0ZVBhY2tlZENvbmNhdFByb2dyYW1JbmZvTG9hZGVyPShlLHQsbik9Pntjb25zdCB1PShsPXQubGVuZ3RoLGM9bi5jYWNoZUtleSx7bmFtZToiQ29uY2F0IChwYWNrZWQpIixpbnB1dE5hbWVzOkFycmF5LmZyb20oe2xlbmd0aDpsfSwoKGUsdCk9PmBYJHt0fWApKSxpbnB1dFR5cGVzOkFycmF5KGwpLmZpbGwoby5UZXh0dXJlVHlwZS5wYWNrZWQpLGNhY2hlSGludDpjfSk7dmFyIGwsYztyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtnZXQ6KCk9PigoZSx0LG4sdSk9Pntjb25zdCBsPW5bMF0uZGltcy5zbGljZSgpO2lmKHU+PWwubGVuZ3RofHx1PC0xKmwubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiYXhpcyBzcGVjaWZpZWQgZm9yIGNvbmNhdCBkb2Vzbid0IG1hdGNoIGlucHV0IGRpbWVuc2lvbmFsaXR5Iik7dTwwJiYodT1sLmxlbmd0aCt1KTtjb25zdCBjPWwuc2xpY2UoMCk7Zm9yKGxldCBlPTE7ZTxuLmxlbmd0aDtlKyspe2NvbnN0IHQ9bltlXS5kaW1zLnNsaWNlKCk7Zm9yKGxldCBlPTA7ZTxsLmxlbmd0aDtlKyspaWYoZT09PXUpY1t1XSs9dFtlXTtlbHNlIGlmKGxbZV0hPT10W2VdKXRocm93IG5ldyBFcnJvcigibm9uIGNvbmNhdCBkaW1lbnNpb25zIG11c3QgbWF0Y2giKX1jb25zdCBwPWMubGVuZ3RoLGQ9KDAsIHMuZ2V0Q2hhbm5lbHMpKCJjb29yZHMiLHApLGY9KDAsIGkuZ2V0Q29vcmRzRGF0YVR5cGUpKHApLGg9KDAsIHMudW5wYWNrRnJvbUNoYW5uZWwpKCksZz1uLm1hcCgoZT0+ZS5kaW1zKSksYj0oMCwgaS5nZXRHbENoYW5uZWxzKShwKSxtPW5ldyBBcnJheShnLmxlbmd0aC0xKTttWzBdPWdbMF1bdV07Zm9yKGxldCBlPTE7ZTxtLmxlbmd0aDtlKyspbVtlXT1tW2UtMV0rZ1tlXVt1XTtjb25zdCB5PWJbdV0sdj1iLnNsaWNlKC0yKSxfPWIuam9pbigpO2xldCB3PWBpZiAoJHt5fSA8ICR7bVswXX0pIHtcbiAgICAgICAgcmV0dXJuIGdldENoYW5uZWwoXG4gICAgICAgICAgICBnZXRYMCgke199KSwgdmVjMigke3Yuam9pbigpfSkpO1xuICAgICAgICB9YDtmb3IobGV0IGU9MTtlPG0ubGVuZ3RoO2UrKyl7Y29uc3QgdD1tW2UtMV07dys9YFxuICAgICAgICAgICAgaWYgKCR7eX0gPCAke21bZV19ICAmJiAke3l9ID49ICR7bVtlLTFdfSkge1xuICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2hhbm5lbChcbiAgICAgICAgICAgICAgICBnZXRYJHtlfSgke2EoYix5LHQpfSksXG4gICAgICAgICAgICAgICAgdmVjMigke2Eodix5LHQpfSkpO1xuICAgICAgICAgICAgfWA7fWNvbnN0IFQ9bS5sZW5ndGgseD1tW20ubGVuZ3RoLTFdO3crPWBcbiAgICAgICAgICAgIHJldHVybiBnZXRDaGFubmVsKFxuICAgICAgICAgICAgICBnZXRYJHtUfSgke2EoYix5LHgpfSksXG4gICAgICAgICAgICAgIHZlYzIoJHthKHYseSx4KX0pKTtgO2NvbnN0IE89KDAsIHIuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLFM9YFxuICAgICAgICAgICR7aH1cbiAgICAgICAgICBmbG9hdCBnZXRWYWx1ZSgke2IubWFwKChlPT4iaW50ICIrZSkpfSkge1xuICAgICAgICAgICAgJHt3fVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgICAgICR7Zn0gY29vcmRzID0gZ2V0T3V0cHV0Q29vcmRzKCk7XG4gICAgICAgICAgICBpbnQgbGFzdERpbSA9IGNvb3Jkcy4ke2JbcC0xXX07XG4gICAgICAgICAgICBjb29yZHMuJHtiW3AtMV19ID0gY29vcmRzLiR7YltwLTJdfTtcbiAgICAgICAgICAgIGNvb3Jkcy4ke2JbcC0yXX0gPSBsYXN0RGltO1xuXG4gICAgICAgICAgICB2ZWM0IHJlc3VsdCA9IHZlYzQoZ2V0VmFsdWUoJHtkfSksIDAuLCAwLiwgMC4pO1xuXG4gICAgICAgICAgICAke2RbcC0xXX0gPSAke2RbcC0xXX0gKyAxO1xuICAgICAgICAgICAgaWYgKCR7ZFtwLTFdfSA8ICR7Y1twLTFdfSkge1xuICAgICAgICAgICAgICByZXN1bHQuZyA9IGdldFZhbHVlKCR7ZH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAke2RbcC0yXX0gPSAke2RbcC0yXX0gKyAxO1xuICAgICAgICAgICAgaWYgKCR7ZFtwLTJdfSA8ICR7Y1twLTJdfSkge1xuICAgICAgICAgICAgICByZXN1bHQuYSA9IGdldFZhbHVlKCR7ZH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAke2RbcC0xXX0gPSAke2RbcC0xXX0gLSAxO1xuICAgICAgICAgICAgaWYgKCR7ZFtwLTJdfSA8ICR7Y1twLTJdfSAmJlxuICAgICAgICAgICAgICAgICR7ZFtwLTFdfSA8ICR7Y1twLTFdfSkge1xuICAgICAgICAgICAgICByZXN1bHQuYiA9IGdldFZhbHVlKCR7ZH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHtPLm91dHB1dH0gPSByZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICBgO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse291dHB1dDp7ZGltczpjLHR5cGU6blswXS50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUucGFja2VkfSxzaGFkZXJTb3VyY2U6UyxoYXNNYWluOiEwfSl9KShlLHUsdCxuLmF4aXMpfSl9O2NvbnN0IGE9KGUsdCxuKT0+e2NvbnN0IHI9ZS5pbmRleE9mKHQpO3JldHVybiBlLm1hcCgoKGUsdCk9PnQ9PT1yP2Ake2V9IC0gJHtufWA6ZSkpLmpvaW4oKX07fSw2NjY4OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZUNvbmNhdEF0dHJpYnV0ZXM9dC5jb25jYXQ9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNTYzOSksaT1uKDQ1OTUpO3QuY29uY2F0PShlLHQsbik9PihwKHQpLGUuc2Vzc2lvbi5wYWNrJiZ0WzBdLmRpbXMubGVuZ3RoPjE/W2UucnVuKCgwLCBpLmNyZWF0ZVBhY2tlZENvbmNhdFByb2dyYW1JbmZvTG9hZGVyKShlLHQsbiksdCldOltlLnJ1bihzKGUsdCxuKSx0KV0pO2NvbnN0IHM9KGUsdCxuKT0+e2NvbnN0IHI9KGk9dC5sZW5ndGgscz1uLmNhY2hlS2V5LHtuYW1lOiJDb25jYXQiLGlucHV0TmFtZXM6QXJyYXkuZnJvbSh7bGVuZ3RoOml9LCgoZSx0KT0+YFgke3R9YCkpLGlucHV0VHlwZXM6QXJyYXkoaSkuZmlsbChvLlRleHR1cmVUeXBlLnVucGFja2VkKSxjYWNoZUhpbnQ6c30pO3ZhciBpLHM7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7Z2V0OigpPT4oKGUsdCxuLHIpPT57Y29uc3QgaT1uWzBdLmRpbXMuc2xpY2UoKTtpZihyPj1pLmxlbmd0aHx8cjwtMSppLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImF4aXMgc3BlY2lmaWVkIGZvciBjb25jYXQgZG9lc24ndCBtYXRjaCBpbnB1dCBkaW1lbnNpb25hbGl0eSIpO3I8MCYmKHI9aS5sZW5ndGgrcik7Y29uc3Qgcz1pLnNsaWNlKDApO2ZvcihsZXQgZT0xO2U8bi5sZW5ndGg7ZSsrKXtjb25zdCB0PW5bZV0uZGltcy5zbGljZSgpO2ZvcihsZXQgZT0wO2U8aS5sZW5ndGg7ZSsrKWlmKGU9PT1yKXNbcl0rPXRbZV07ZWxzZSBpZihpW2VdIT09dFtlXSl0aHJvdyBuZXcgRXJyb3IoIm5vbiBjb25jYXQgZGltZW5zaW9ucyBtdXN0IG1hdGNoIil9Y29uc3QgcD1zLmxlbmd0aCxkPW5ldyBBcnJheShuLmxlbmd0aCk7bGV0IGY9MDtmb3IobGV0IGU9MDtlPGQubGVuZ3RoOysrZSlmKz1uW2VdLmRpbXNbcl0sZFtlXT1mO2xldCBoPSIiO2g9bi5sZW5ndGg8NT9hKGQpOnUoZCk7Y29uc3QgZz1gXG4gICAgICAgICR7bChuLmxlbmd0aCxwKX1cbiAgICAgICAgJHtjKGQpfVxuICAgICAgICAke2h9XG4gICAgICAgIGZsb2F0IHByb2Nlc3MoaW50IGluZGljZXNbJHtwfV0pIHtcbiAgICAgICAgICBpbnQgdGV4dHVyZUluZGV4ID0gZ2V0VGV4dHVyZVdoZXJlRGF0YVJlc2lkZXMgKGluZGljZXNbJHtyfV0pO1xuXG4gICAgICAgICAgaWYodGV4dHVyZUluZGV4ICE9IDApIHtcbiAgICAgICAgICAgIGluZGljZXNbJHtyfV0gPSBpbmRpY2VzWyR7cn1dIC0gaW50KGdldFNpemVJbkNvbmNhdEF4aXNWYWx1ZUZyb21JbmRleCh0ZXh0dXJlSW5kZXgtaW50KDEpKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGZldGNoRGF0YUZyb21Db3JyZWN0VGV4dHVyZSh0ZXh0dXJlSW5kZXgsIGluZGljZXMpO1xuICAgICAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtvdXRwdXQ6e2RpbXM6cyx0eXBlOm5bMF0udHlwZSx0ZXh0dXJlVHlwZTpvLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6Z30pfSkoMCxyLHQsbi5heGlzKX0pfSxhPWU9PmBpbnQgZ2V0VGV4dHVyZVdoZXJlRGF0YVJlc2lkZXMoaW50IGluZGV4KSB7XG4gICAgICAke2UubWFwKCgoZSx0KT0+YGlmKGluZGV4PCR7ZX0pIHtyZXR1cm4gJHt0fTt9XG5gKSkuam9pbigiIil9XG4gICAgfWAsdT1lPT5hKGUpLGw9KGUsdCk9Pntjb25zdCBuPVtgZmxvYXQgZmV0Y2hEYXRhRnJvbUNvcnJlY3RUZXh0dXJlKGludCB0ZXh0dXJlSW5kZXgsIGludCBpbmRpY2VzWyR7dH1dKSB7YF07Zm9yKGxldCB0PTA7dDxlOysrdCkwPT09dD9uLnB1c2goYFx0aWYgKHRleHR1cmVJbmRleCA9PSAke3R9KSB7IHJldHVybiBfWCR7dH0oaW5kaWNlcyk7IH1gKTp0PT09ZS0xP24ucHVzaChgXHRlbHNlIHsgcmV0dXJuIF9YJHt0fShpbmRpY2VzKTsgfWApOm4ucHVzaChgXHRlbHNlIGlmICh0ZXh0dXJlSW5kZXggPT0gJHt0fSkgeyByZXR1cm4gX1gke3R9KGluZGljZXMpOyB9YCk7cmV0dXJuIG4ucHVzaCgiXHR9Iiksbi5qb2luKCJcbiIpfSxjPWU9Pntjb25zdCB0PVsiaW50IGdldFNpemVJbkNvbmNhdEF4aXNWYWx1ZUZyb21JbmRleChpbnQgaW5kZXgpIHsiXTtmb3IobGV0IG49MDtuPGUubGVuZ3RoOysrbikwPT09bj90LnB1c2goYFx0aWYgKGluZGV4ID09ICR7bn0pIHsgcmV0dXJuICR7ZVtuXX07IH1gKTpuPT09ZS5sZW5ndGgtMT90LnB1c2goYFx0ZWxzZSB7IHJldHVybiAke2Vbbl19OyB9YCk6dC5wdXNoKGBcdGVsc2UgaWYgKGluZGV4ID09ICR7bn0pIHsgcmV0dXJuICR7ZVtuXX07IH1gKTtyZXR1cm4gdC5wdXNoKCJcdH0iKSx0LmpvaW4oIlxuIil9O3QucGFyc2VDb25jYXRBdHRyaWJ1dGVzPWU9PigwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2F4aXM6ZS5hdHRyaWJ1dGVzLmdldEludCgiYXhpcyIpfSk7Y29uc3QgcD1lPT57aWYoIWV8fGUubGVuZ3RoPDEpdGhyb3cgbmV3IEVycm9yKCJ0b28gZmV3IGlucHV0cyIpO2NvbnN0IHQ9ZVswXS50eXBlLG49ZVswXS5kaW1zLmxlbmd0aDtpZigic3RyaW5nIj09PXQpdGhyb3cgbmV3IEVycm9yKCJzdHJpbmcgdGVuc29yIGlzIG5vdCBzdXBwb3J0ZWQgeWV0Iik7Zm9yKGNvbnN0IHIgb2YgZSl7aWYoci50eXBlIT09dCl0aHJvdyBuZXcgRXJyb3IoImlucHV0IHRlbnNvcnMgc2hvdWxkIGJlIG9uZSB0eXBlIik7aWYoci5kaW1zLmxlbmd0aCE9PW4pdGhyb3cgbmV3IEVycm9yKCJpbnB1dCB0ZW5zb3JzIHNob3VsZCBoYXZlIHRoZSBzYW1lIHNoYXBlIil9fTt9LDc4MjU6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNyZWF0ZVVucGFja2VkR3JvdXBlZENvbnZQcm9ncmFtSW5mb0xvYWRlcj12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpLG89big2NzU3KSxpPW4oNTYzOSkscz1uKDk3NTQpLGE9bigyMTUwKTt0LmNyZWF0ZVVucGFja2VkR3JvdXBlZENvbnZQcm9ncmFtSW5mb0xvYWRlcj0oZSx0LG4pPT57Y29uc3QgdT0obD10Lmxlbmd0aD4yLGM9bi5jYWNoZUtleSx7bmFtZToiR3JvdXBlZENvbnYiLGlucHV0TmFtZXM6bD9bIlgiLCJXIiwiQmlhcyJdOlsiWCIsIlciXSxpbnB1dFR5cGVzOmw/W2kuVGV4dHVyZVR5cGUudW5wYWNrZWQsaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXTpbaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6Y30pO3ZhciBsLGM7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx1KSx7Z2V0OigpPT4oKGUsdCxuLHUpPT57Y29uc3QgbD10Lmxlbmd0aD4yPyJ2YWx1ZSArPSBnZXRCaWFzKG91dHB1dF9jaGFubmVsKTsiOiIiLGM9dFswXS5kaW1zLnNsaWNlKCkscD10WzFdLmRpbXMuc2xpY2UoKSxkPXBbMF0vdS5ncm91cDtyLkxvZ2dlci52ZXJib3NlKCJHcm91cGVkQ29udiIsYGF1dHBQYWQ6JHt1LmF1dG9QYWR9LCBkaWxhdGlvbnM6JHt1LmRpbGF0aW9uc30sIGdyb3VwOiR7dS5ncm91cH0sIGtlcm5lbFNoYXBlOiR7dS5rZXJuZWxTaGFwZX0sIHBhZHM6JHt1LnBhZHN9LCBzdHJpZGVzOiR7dS5zdHJpZGVzfWApO2NvbnN0IGY9KDAsIHMuY2FsY3VsYXRlT3V0cHV0U2hhcGUpKGMscCx1LmRpbGF0aW9ucyx1LnBhZHMsdS5zdHJpZGVzKSxoPSgwLCBvLmdldEdsc2wpKGUuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC52ZXJzaW9uKSx7YWN0aXZhdGlvbkZ1bmN0aW9uOmcsYXBwbHlBY3RpdmF0aW9uOmJ9PSgwLCBhLmdldEFjdGl2YXRpb25TbmlwcGV0KSh1KSxtPWBcbiAgY29uc3QgaXZlYzIgc3RyaWRlcyA9IGl2ZWMyKCR7dS5zdHJpZGVzWzBdfSwgJHt1LnN0cmlkZXNbMV19KTtcbiAgY29uc3QgaXZlYzIgcGFkcyA9IGl2ZWMyKCR7dS5wYWRzWzBdfSwgJHt1LnBhZHNbMV19KTtcbiAgJHtnfVxuICB2b2lkIG1haW4oKSB7XG4gICAgaXZlYzQgY29vcmRzID0gZ2V0T3V0cHV0Q29vcmRzKCk7XG4gICAgaW50IGJhdGNoID0gY29vcmRzLng7XG4gICAgaW50IG91dHB1dF9jaGFubmVsID0gY29vcmRzLnk7XG4gICAgaXZlYzIgeFJDQ29ybmVyID0gY29vcmRzLnp3ICogc3RyaWRlcyAtIHBhZHM7XG4gICAgaW50IGdyb3VwX2lkID0gb3V0cHV0X2NoYW5uZWwgLyAke2R9O1xuXG4gICAgZmxvYXQgdmFsdWUgPSAwLjA7XG4gICAgZm9yIChpbnQgd0luQ2hhbm5lbCA9IDA7IHdJbkNoYW5uZWwgPCAke3BbMV19OyB3SW5DaGFubmVsKyspIHtcbiAgICAgIGludCBpbnB1dF9jaGFubmVsID0gZ3JvdXBfaWQgKiAke3BbMV19ICsgd0luQ2hhbm5lbDtcbiAgICAgIGZvciAoaW50IHdIZWlnaHQgPSAwOyB3SGVpZ2h0IDwgJHtwWzJdfTsgd0hlaWdodCsrKSB7XG4gICAgICAgIGludCB4SGVpZ2h0ID0geFJDQ29ybmVyLnggKyB3SGVpZ2h0ICogJHt1LmRpbGF0aW9uc1swXX07XG5cbiAgICAgICAgaWYgKHhIZWlnaHQgPCAwIHx8IHhIZWlnaHQgPj0gJHtjWzJdfSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpbnQgd1dpZHRoID0gMDsgd1dpZHRoIDwgJHtwWzNdfTsgd1dpZHRoKyspIHtcbiAgICAgICAgICBpbnQgeFdpZHRoID0geFJDQ29ybmVyLnkgKyB3V2lkdGggKiAke3UuZGlsYXRpb25zWzFdfTtcbiAgICAgICAgICBpZiAoeFdpZHRoIDwgMCB8fCB4V2lkdGggPj0gJHtjWzNdfSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZmxvYXQgeFZhbCA9IGdldFgoYmF0Y2gsIGlucHV0X2NoYW5uZWwsIHhXaWR0aCwgeEhlaWdodCk7XG4gICAgICAgICAgZmxvYXQgd1ZhbCA9IGdldFcob3V0cHV0X2NoYW5uZWwsIHdJbkNoYW5uZWwsIHdXaWR0aCwgd0hlaWdodCk7XG4gICAgICAgICAgdmFsdWUgKz0geFZhbCp3VmFsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgICR7bH1cbiAgICAke2J9XG4gICAgJHtoLm91dHB1dH0gPSB2ZWM0KHZhbHVlLCAuMCwgLjAsIC4wKTtcbiAgfVxuYDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG4pLHtvdXRwdXQ6e2RpbXM6Zix0eXBlOnRbMF0udHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6bSxoYXNNYWluOiEwfSl9KShlLHQsdSxuKX0pfTt9LDc3MDg6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNvbnYyRFBhY2tlZD10LmNvbnYyRFBhY2tlZFBvaW50d2lzZT12b2lkIDA7Y29uc3Qgcj1uKDk3NTQpLG89big1OTUwKSxpPW4oNTYzMik7dC5jb252MkRQYWNrZWRQb2ludHdpc2U9KGUsdCxuKT0+e2NvbnN0IG89dFswXS5kaW1zLHM9dFsxXS5kaW1zLGE9KDAsIHIuY2FsY3VsYXRlT3V0cHV0U2hhcGUpKG8scyxuLmRpbGF0aW9ucyxuLnBhZHMsbi5zdHJpZGVzKSx1PWUucmVzaGFwZVBhY2tlZCh0WzBdLFtvWzFdLG9bMl0qb1szXV0pLGw9ZS5yZXNoYXBlUGFja2VkKHRbMV0sW3NbMF0sc1sxXV0pLGM9dC5sZW5ndGg+Mj9bbCx1LHRbMl1dOltsLHVdLHA9ZS5ydW4oKDAsIGkuY3JlYXRlUGFja2VkTWF0bXVsUHJvZ3JhbUluZm9Mb2FkZXIpKGUsYyxuKSxjKTtyZXR1cm4gZS5yZXNoYXBlUGFja2VkKHAsYSl9LHQuY29udjJEUGFja2VkPShlLHQsbik9Pntjb25zdCBzPXRbMF0uZGltcyxhPXRbMV0uZGltcyx1PSgwLCByLmNhbGN1bGF0ZU91dHB1dFNoYXBlKShzLGEsbi5kaWxhdGlvbnMsbi5wYWRzLG4uc3RyaWRlcyksbD1lLnJ1bigoMCwgby5jcmVhdGVQYWNrZWRJbTJDb2xQcm9ncmFtSW5mb0xvYWRlcikoZSx0WzBdLHRbMV0sdSxuKSxbdFswXV0pLGM9ZS5yZXNoYXBlUGFja2VkKHRbMV0sW2FbMF0sYVsxXSphWzJdKmFbM11dKSxwPTM9PT10Lmxlbmd0aD9bYyxsLHRbMl1dOltjLGxdLGQ9ZS5ydW4oKDAsIGkuY3JlYXRlUGFja2VkTWF0bXVsUHJvZ3JhbUluZm9Mb2FkZXIpKGUscCxuKSxwKTtyZXR1cm4gZS5yZXNoYXBlUGFja2VkKGQsdSl9O30sNTA0MjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQucGFyc2VDb252VHJhbnNwb3NlQXR0cmlidXRlcz10LmNvbnZUcmFuc3Bvc2U9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNjc1NyksaT1uKDU2MzkpLHM9bigyMTUwKSxhPShlLHQsbixyLG8saSk9PihlLTEpKnQrbisoci0xKSpvKzEtaSx1PShlLHQsbixyLG8pPT57Y29uc3QgaT1NYXRoLmZsb29yKGUvMik7IlNBTUVfVVBQRVIiPT09dD8obltyXT1pLG5bb109ZS1pKToiU0FNRV9MT1dFUiI9PT10JiYobltyXT1lLWksbltvXT1pKTt9O3QuY29udlRyYW5zcG9zZT0oZSx0LG4pPT4oZCh0LG4pLGwoZSx0LG4pKTtjb25zdCBsPShlLHQsbik9Pntjb25zdCByPXAobix0KTtyZXR1cm4gW2MoZSx0LHIpXX0sYz0oZSx0LG4pPT5lLnJ1bigoKGUsdCxuKT0+e2NvbnN0IHI9KGE9dC5sZW5ndGg+Mix1PW4uY2FjaGVLZXkse25hbWU6IkNvbnZUcmFuc3Bvc2UiLGlucHV0TmFtZXM6YT9bIlgiLCJXIiwiQiJdOlsiWCIsIlciXSxpbnB1dFR5cGVzOmE/W2kuVGV4dHVyZVR5cGUudW5wYWNrZWQsaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXTpbaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6dX0pO3ZhciBhLHU7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7Z2V0OigpPT4oKGUsdCxuLHIpPT57Y29uc3QgYT10Lmxlbmd0aD4yPyJnZXRCKG91dHB1dF9jaGFubmVsKSI6IjAuMCIsdT10WzBdLmRpbXMsbD10WzFdLmRpbXMsYz1sWzFdLHA9bFswXS9yLmdyb3VwLGQ9W3RbMF0uZGltc1swXSx0WzFdLmRpbXNbMV0qci5ncm91cCwuLi5yLm91dHB1dFNoYXBlXSxmPSgwLCBvLmdldEdsc2wpKGUuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC52ZXJzaW9uKSx7YWN0aXZhdGlvbkZ1bmN0aW9uOmgsYXBwbHlBY3RpdmF0aW9uOmd9PSgwLCBzLmdldEFjdGl2YXRpb25TbmlwcGV0KShyKSxiPWBcbiAgY29uc3QgaXZlYzIgc3RyaWRlcyA9IGl2ZWMyKCR7ci5zdHJpZGVzWzBdfSwgJHtyLnN0cmlkZXNbMV19KTtcbiAgY29uc3QgaXZlYzIgcGFkcyA9IGl2ZWMyKCR7ci5wYWRzWzBdfSwgJHtyLnBhZHNbMV19KTtcbiAgJHtofVxuICB2b2lkIG1haW4oKSB7XG4gICAgaXZlYzQgY29vcmRzID0gZ2V0T3V0cHV0Q29vcmRzKCk7XG4gICAgaW50IGJhdGNoID0gY29vcmRzLng7XG4gICAgaW50IG91dHB1dF9jaGFubmVsID0gY29vcmRzLnk7XG5cbiAgICBpdmVjMiBsb2MgPSBjb29yZHMuencgKyBwYWRzO1xuXG4gICAgaW50IGdyb3VwX2lkID0gb3V0cHV0X2NoYW5uZWwgLyAke2N9O1xuICAgIGludCB3T3V0Q2hhbm5lbCA9IG91dHB1dF9jaGFubmVsIC0gZ3JvdXBfaWQgKiAke2N9O1xuXG4gICAgZmxvYXQgdmFsdWUgPSAke2F9O1xuICAgIGZvciAoaW50IGluQ2hhbm5lbE9mZnNldCA9IDA7IGluQ2hhbm5lbE9mZnNldCA8ICR7cH07IGluQ2hhbm5lbE9mZnNldCsrKSB7XG4gICAgICBpbnQgaW5wdXRfY2hhbm5lbCA9IGdyb3VwX2lkICogJHtwfSArIGluQ2hhbm5lbE9mZnNldDtcbiAgICAgIGZvciAoaW50IHdXT2ZmID0gMDsgd1dPZmYgPCAke2xbMl19OyB3V09mZisrKSB7XG4gICAgICAgIGZvciAoaW50IHdIT2ZmID0gMDsgd0hPZmYgPCAke2xbM119OyB3SE9mZisrKSB7XG4gICAgICAgICAgaXZlYzIgd09mZiA9IGl2ZWMyKHdXT2ZmICogJHtyLmRpbGF0aW9uc1swXX0sIHdIT2ZmICogJHtyLmRpbGF0aW9uc1sxXX0pO1xuICAgICAgICAgIGl2ZWMyIHdMb2MgPSBsb2MgLSB3T2ZmO1xuICAgICAgICAgIGl2ZWMyIHdMb2NJbiA9IHdMb2MgLyBzdHJpZGVzO1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHdMb2NJbiAqIHN0cmlkZXMgPT0gd0xvYyAmJlxuICAgICAgICAgICAgd0xvY0luLnggPj0gMCAmJiB3TG9jSW4ueCA8ICR7dVsyXX0gJiZcbiAgICAgICAgICAgIHdMb2NJbi55ID49IDAgJiYgd0xvY0luLnkgPCAke3VbM119XG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBmbG9hdCB4VmFsID0gZ2V0WChiYXRjaCwgaW5wdXRfY2hhbm5lbCwgd0xvY0luLnksIHdMb2NJbi54KTtcbiAgICAgICAgICAgIGZsb2F0IHdWYWwgPSBnZXRXKGlucHV0X2NoYW5uZWwsIHdPdXRDaGFubmVsLCB3SE9mZiwgd1dPZmYpO1xuICAgICAgICAgICAgdmFsdWUgKz0geFZhbCAqIHdWYWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgICR7Z31cbiAgICAke2Yub3V0cHV0fSA9IHZlYzQodmFsdWUsIC4wLCAuMCwgLjApO1xuICB9XG5gO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbikse291dHB1dDp7ZGltczpkLHR5cGU6dFswXS50eXBlLHRleHR1cmVUeXBlOmkuVGV4dHVyZVR5cGUudW5wYWNrZWR9LHNoYWRlclNvdXJjZTpiLGhhc01haW46ITB9KX0pKGUsdCxyLG4pfSl9KShlLHQsbiksdCkscD0oZSx0KT0+e2NvbnN0IG49ZS5rZXJuZWxTaGFwZS5zbGljZSgpO2lmKDA9PT1lLmtlcm5lbFNoYXBlLmxlbmd0aClmb3IobGV0IGU9MjtlPHRbMV0uZGltcy5sZW5ndGg7KytlKW4ucHVzaCh0WzFdLmRpbXNbZV0pO2NvbnN0IHI9ZS5wYWRzLnNsaWNlKCksbz1lLm91dHB1dFNoYXBlLnNsaWNlKCk7KChlLHQsbixyLG8saSxzLGwpPT57Y29uc3QgYz1lLmxlbmd0aC0yLHA9MD09PWwubGVuZ3RoO2ZvcihsZXQgZD0wO2Q8YzsrK2Qpe2NvbnN0IGY9cD9lW2QrMl0qaVtkXTpsW2RdLGg9YShlW2QrMl0saVtkXSxvW2RdLHRbZF0sbltkXSxmKTt1KGgscixvLGQsZCtjKSxwJiZsLnB1c2goaVtkXSooZVtkKzJdLTEpK3NbZF0rKHRbZF0tMSkqbltkXSsxLW9bZF0tb1tkK2NdKTt9fSkodFswXS5kaW1zLG4sZS5kaWxhdGlvbnMsZS5hdXRvUGFkLHIsZS5zdHJpZGVzLGUub3V0cHV0UGFkZGluZyxvKTtjb25zdCBpPU9iamVjdC5hc3NpZ24oe30sZSk7cmV0dXJuIE9iamVjdC5hc3NpZ24oaSx7a2VybmVsU2hhcGU6bixwYWRzOnIsb3V0cHV0U2hhcGU6byxjYWNoZUtleTplLmNhY2hlS2V5fSksaX07dC5wYXJzZUNvbnZUcmFuc3Bvc2VBdHRyaWJ1dGVzPWU9Pntjb25zdCB0PWUuYXR0cmlidXRlcyxuPSgwLCBzLnBhcnNlSW50ZXJuYWxBY3RpdmF0aW9uQXR0cmlidXRlcykodCksbz10LmdldFN0cmluZygiYXV0b19wYWQiLCJOT1RTRVQiKSxpPXQuZ2V0SW50cygiZGlsYXRpb25zIixbMSwxXSksYT10LmdldEludCgiZ3JvdXAiLDEpLHU9dC5nZXRJbnRzKCJrZXJuZWxfc2hhcGUiLFtdKSxsPXQuZ2V0SW50cygib3V0cHV0X3BhZGRpbmciLFswLDBdKSxjPXQuZ2V0SW50cygib3V0cHV0X3NoYXBlIixbXSkscD10LmdldEludHMoInBhZHMiLFswLDAsMCwwXSksZD10LmdldEludHMoInN0cmlkZXMiLFsxLDFdKTtyZXR1cm4gKDAsIHIuY3JlYXRlQXR0cmlidXRlV2l0aENhY2hlS2V5KShPYmplY3QuYXNzaWduKHthdXRvUGFkOm8sZGlsYXRpb25zOmksZ3JvdXA6YSxrZXJuZWxTaGFwZTp1LG91dHB1dFBhZGRpbmc6bCxvdXRwdXRTaGFwZTpjLHBhZHM6cCxzdHJpZGVzOmR9LG4pKX07Y29uc3QgZD0oZSx0KT0+e2lmKCFlfHwyIT09ZS5sZW5ndGgmJjMhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkNvbnYgcmVxdWlyZXMgMiBvciAzIGlucHV0cyIpO2lmKDQhPT1lWzBdLmRpbXMubGVuZ3RofHw0IT09ZVsxXS5kaW1zLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImN1cnJlbnRseSBvbmx5IHN1cHBvcnQgMi1kaW1lbnNpb25hbCBjb252Iik7aWYoZVswXS5kaW1zWzFdIT09ZVsxXS5kaW1zWzBdKXRocm93IG5ldyBFcnJvcigiRklMVEVSX0lOX0NIQU5ORUwgc2hvdWxkIGJlIGVxdWFsIHRvIERBVEFfQ0hBTk5FTCIpO2NvbnN0IG49ZVsxXS5kaW1zWzFdKnQuZ3JvdXA7aWYoMz09PWUubGVuZ3RoJiYoMSE9PWVbMl0uZGltcy5sZW5ndGh8fGVbMl0uZGltc1swXSE9PW4pKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBiaWFzIik7Y29uc3Qgcj1lWzBdLmRpbXMubGVuZ3RoLTI7aWYodC5kaWxhdGlvbnMubGVuZ3RoIT09cil0aHJvdyBuZXcgRXJyb3IoYGRpbGF0aW9ucyBzaG91bGQgYmUgJHtyfURgKTtpZih0LnN0cmlkZXMubGVuZ3RoIT09cil0aHJvdyBuZXcgRXJyb3IoYHN0cmlkZXMgc2hvdWxkIGJlICR7cn1EYCk7aWYodC5wYWRzLmxlbmd0aCE9PTIqcil0aHJvdyBuZXcgRXJyb3IoYHBhZHMgc2hvdWxkIGJlICR7MipyfURgKTtpZih0Lm91dHB1dFBhZGRpbmcubGVuZ3RoIT09cil0aHJvdyBuZXcgRXJyb3IoYG91dHB1dF9wYWRkaW5nIHNob3VsZCBiZSAke3J9RGApO2lmKDAhPT10Lmtlcm5lbFNoYXBlLmxlbmd0aCYmdC5rZXJuZWxTaGFwZS5sZW5ndGghPT1lWzFdLmRpbXMubGVuZ3RoLTIpdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGtlcm5lbCBzaGFwZSIpO2lmKDAhPT10Lm91dHB1dFNoYXBlLmxlbmd0aCYmdC5vdXRwdXRTaGFwZS5sZW5ndGghPT1lWzBdLmRpbXMubGVuZ3RoLTIpdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIG91dHB1dCBzaGFwZSIpO2lmKCJmbG9hdDMyIiE9PWVbMF0udHlwZXx8ImZsb2F0MzIiIT09ZVsxXS50eXBlKXRocm93IG5ldyBFcnJvcigiQ29udlRyYW5zcG9zZSBpbnB1dChYLFcpIHNob3VsZCBiZSBmbG9hdCB0ZW5zb3IiKTtpZigzPT09ZS5sZW5ndGgmJiJmbG9hdDMyIiE9PWVbMl0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkNvbnZUcmFuc3Bvc2UgaW5wdXQoYmlhcykgc2hvdWxkIGJlIGZsb2F0IHRlbnNvciIpfTt9LDk3NTQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlQ29udkF0dHJpYnV0ZXM9dC5jb252PXQuY2FsY3VsYXRlT3V0cHV0U2hhcGU9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNzI3MyksaT1uKDc4MjUpLHM9big3NzA4KSxhPW4oMzI4MSksdT1uKDIxNTApLGw9bigxNjI1KSxjPW4oODI3Nik7dC5jYWxjdWxhdGVPdXRwdXRTaGFwZT0oZSx0LG4scixvKT0+e2NvbnN0IGk9ZVswXSxzPWUuc2xpY2UoMiksYT1zLmxlbmd0aCx1PXRbMF0sbD10LnNsaWNlKDIpLm1hcCgoKGUsdCk9PmUrKGUtMSkqKG5bdF0tMSkpKSxjPXMubWFwKCgoZSx0KT0+ZStyW3RdK3JbdCthXSkpLm1hcCgoKGUsdCk9Pk1hdGguZmxvb3IoKGUtbFt0XStvW3RdKS9vW3RdKSkpO3JldHVybiBbaSx1XS5jb25jYXQoLi4uYyl9LHQuY29udj0oZSx0LG4pPT4oZyh0LG4pLHAoZSx0LG4pKTtjb25zdCBwPShlLHQsbik9Pntjb25zdCByPWgobix0KSxvPWUuc2Vzc2lvbi5wYWNrLGE9MT09PXIua2VybmVsU2hhcGVbMF0mJjE9PT1yLmtlcm5lbFNoYXBlWzFdO3JldHVybiByLmdyb3VwPjE/W2UucnVuKCgwLCBpLmNyZWF0ZVVucGFja2VkR3JvdXBlZENvbnZQcm9ncmFtSW5mb0xvYWRlcikoZSx0LHIpLHQpXTphJiZvP1tkKGUsdCxyKV06byYmND09PXRbMF0uZGltcy5sZW5ndGgmJjE9PT10WzBdLmRpbXNbMF0mJiFhP1soMCwgcy5jb252MkRQYWNrZWQpKGUsdCxyKV06W2YoZSx0LHIpXX0sZD0oZSxuLHIpPT57Y29uc3Qgbz1uWzBdLmRpbXMsaT1uWzFdLmRpbXMscz0oMCwgdC5jYWxjdWxhdGVPdXRwdXRTaGFwZSkobyxpLHIuZGlsYXRpb25zLHIucGFkcyxyLnN0cmlkZXMpLGE9ZS5yZXNoYXBlVW5wYWNrZWQoblswXSxbb1sxXSxvWzJdKm9bM11dKSx1PWUucmVzaGFwZVVucGFja2VkKG5bMV0sW2lbMF0saVsxXV0pLGw9bi5sZW5ndGg+Mj9bdSxhLG5bMl1dOlt1LGFdLHA9ZS5ydW4oKDAsIGMuY3JlYXRlTWF0bXVsUHJvZ3JhbUluZm9Mb2FkZXIpKGwsciksbCk7cmV0dXJuIGUucmVzaGFwZVVucGFja2VkKHAscyl9LGY9KGUsbixyKT0+e2NvbnN0IG89blswXS5kaW1zLGk9blsxXS5kaW1zLHM9KDAsIHQuY2FsY3VsYXRlT3V0cHV0U2hhcGUpKG8saSxyLmRpbGF0aW9ucyxyLnBhZHMsci5zdHJpZGVzKSx1PWUucnVuKCgwLCBsLmNyZWF0ZUltMkNvbFByb2dyYW1JbmZvTG9hZGVyKShlLG5bMF0sblsxXSxzLHIpLFtuWzBdXSksYz0zPT09bi5sZW5ndGg/W3UsblsxXSxuWzJdXTpbdSxuWzFdXTtyZXR1cm4gZS5ydW4oKDAsIGEuY3JlYXRlRG90UHJvZHVjdFByb2dyYW1JbmZvTG9hZGVyKShlLG4scyxyKSxjKX0saD0oZSx0KT0+e2NvbnN0IG49ZS5rZXJuZWxTaGFwZS5zbGljZSgpO2lmKDA9PT1lLmtlcm5lbFNoYXBlLmxlbmd0aClmb3IobGV0IGU9MjtlPHRbMV0uZGltcy5sZW5ndGg7KytlKW4ucHVzaCh0WzFdLmRpbXNbZV0pO2NvbnN0IHI9ZS5wYWRzLnNsaWNlKCk7by5Qb29sQ29udlV0aWwuYWRqdXN0UGFkc0Jhc2VkT25BdXRvUGFkKHRbMF0uZGltcyxlLnN0cmlkZXMsZS5kaWxhdGlvbnMsbixyLGUuYXV0b1BhZCk7Y29uc3QgaT1PYmplY3QuYXNzaWduKHt9LGUpO3JldHVybiBPYmplY3QuYXNzaWduKGkse2tlcm5lbFNoYXBlOm4scGFkczpyLGNhY2hlS2V5OmUuY2FjaGVLZXl9KSxpfTt0LnBhcnNlQ29udkF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLG49KDAsIHUucGFyc2VJbnRlcm5hbEFjdGl2YXRpb25BdHRyaWJ1dGVzKSh0KSxvPXQuZ2V0U3RyaW5nKCJhdXRvX3BhZCIsIk5PVFNFVCIpLGk9dC5nZXRJbnRzKCJkaWxhdGlvbnMiLFsxLDFdKSxzPXQuZ2V0SW50KCJncm91cCIsMSksYT10LmdldEludHMoImtlcm5lbF9zaGFwZSIsW10pLGw9dC5nZXRJbnRzKCJwYWRzIixbMCwwLDAsMF0pLGM9dC5nZXRJbnRzKCJzdHJpZGVzIixbMSwxXSk7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoT2JqZWN0LmFzc2lnbih7YXV0b1BhZDpvLGRpbGF0aW9uczppLGdyb3VwOnMsa2VybmVsU2hhcGU6YSxwYWRzOmwsc3RyaWRlczpjfSxuKSl9O2NvbnN0IGc9KGUsdCk9PntpZighZXx8MiE9PWUubGVuZ3RoJiYzIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJDb252IHJlcXVpcmVzIDIgb3IgMyBpbnB1dHMiKTtpZig0IT09ZVswXS5kaW1zLmxlbmd0aHx8NCE9PWVbMV0uZGltcy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJjdXJyZW50bHkgb25seSBzdXBwb3J0IDItZGltZW5zaW9uYWwgY29udiIpO2lmKGVbMF0uZGltc1sxXSE9PWVbMV0uZGltc1sxXSp0Lmdyb3VwKXRocm93IG5ldyBFcnJvcigiRklMVEVSX0lOX0NIQU5ORUwgc2hvdWxkIGJlIGVxdWFsIHRvIERBVEFfQ0hBTk5FTCIpO2lmKDM9PT1lLmxlbmd0aCYmKDEhPT1lWzJdLmRpbXMubGVuZ3RofHxlWzFdLmRpbXNbMF0hPT1lWzJdLmRpbXNbMF0pKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBiaWFzIik7Y29uc3Qgbj1lWzBdLmRpbXMubGVuZ3RoLTI7aWYodC5kaWxhdGlvbnMubGVuZ3RoIT09bil0aHJvdyBuZXcgRXJyb3IoYGRpbGF0aW9ucyBzaG91bGQgYmUgJHtufURgKTtpZih0LnN0cmlkZXMubGVuZ3RoIT09bil0aHJvdyBuZXcgRXJyb3IoYHN0cmlkZXMgc2hvdWxkIGJlICR7bn1EYCk7aWYodC5wYWRzLmxlbmd0aCE9PTIqbil0aHJvdyBuZXcgRXJyb3IoYHBhZHMgc2hvdWxkIGJlICR7MipufURgKTtpZigwIT09dC5rZXJuZWxTaGFwZS5sZW5ndGgmJnQua2VybmVsU2hhcGUubGVuZ3RoIT09ZVsxXS5kaW1zLmxlbmd0aC0yKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBrZXJuZWwgc2hhcGUiKTtpZigiZmxvYXQzMiIhPT1lWzBdLnR5cGV8fCJmbG9hdDMyIiE9PWVbMV0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkNvbnYgaW5wdXQoWCxXKSBzaG91bGQgYmUgZmxvYXQgdGVuc29yIik7aWYoMz09PWUubGVuZ3RoJiYiZmxvYXQzMiIhPT1lWzJdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJDb252IGlucHV0KGJpYXMpIHNob3VsZCBiZSBmbG9hdCB0ZW5zb3IiKX07fSw2NzQyOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZURlcHRoVG9TcGFjZUF0dHJpYnV0ZXM9dC5kZXB0aFRvU3BhY2U9dm9pZCAwO2NvbnN0IHI9big1NzA3KTt0LmRlcHRoVG9TcGFjZT0oZSx0LG4pPT57byh0KTtjb25zdCBpPW4uYmxvY2tzaXplLHM9aSppLGE9IkRDUiI9PT1uLm1vZGU/WzAsMyw0LDEsNSwyXTpbMCwxLDQsMiw1LDNdLHU9IkRDUiI9PT1uLm1vZGU/W3RbMF0uZGltc1swXSxpLGksdFswXS5kaW1zWzFdL3MsdFswXS5kaW1zWzJdLHRbMF0uZGltc1szXV06W3RbMF0uZGltc1swXSx0WzBdLmRpbXNbMV0vcyxpLGksdFswXS5kaW1zWzJdLHRbMF0uZGltc1szXV0sbD1lLnJlc2hhcGVVbnBhY2tlZCh0WzBdLHUpLGM9e3Blcm06YSxjYWNoZUtleTpgJHthfWB9LFtwXT0oMCwgci50cmFuc3Bvc2UpKGUsW2xdLGMpLGQ9W3RbMF0uZGltc1swXSx0WzBdLmRpbXNbMV0vcyx0WzBdLmRpbXNbMl0qaSx0WzBdLmRpbXNbM10qaV07cmV0dXJuIFtlLnJlc2hhcGVVbnBhY2tlZChwLGQpXX0sdC5wYXJzZURlcHRoVG9TcGFjZUF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEludCgiYmxvY2tzaXplIik7aWYodDwxKXRocm93IG5ldyBFcnJvcihgYmxvY2tzaXplIG11c3QgYmUgPj0gMSwgYnV0IGdvdCA6ICR7dH0gZm9yIERlcHRoVG9TcGFjZWApO2NvbnN0IG49ZS5hdHRyaWJ1dGVzLmdldFN0cmluZygibW9kZSIsIkRDUiIpO2lmKCJEQ1IiIT09biYmIkNSRCIhPT1uKXRocm93IG5ldyBFcnJvcihgdW5yZWNvZ25pemVkIG1vZGU6ICR7bn0gZm9yIERlcHRoVG9TcGFjZWApO3JldHVybiB7bW9kZTpuLGJsb2Nrc2l6ZTp0fX07Y29uc3Qgbz1lPT57aWYoMSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcihgRGVwdGhUb1NwYWNlIGV4cGVjdCAxIGlucHV0cywgYnV0IGdvdCAke2UubGVuZ3RofWApO2lmKCJzdHJpbmciPT09ZVswXS50eXBlfHw0IT09ZVswXS5kaW1zLmxlbmd0aCl0aHJvdyBuZXcgVHlwZUVycm9yKCJEZXB0aFRvU3BhY2UgaW5wdXQgc2hvdWxkIGJlIGEgNC1EIG51bWVyaWMgdGVuc29yIil9O30sMzI4MTooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuY3JlYXRlRG90UHJvZHVjdFByb2dyYW1JbmZvTG9hZGVyPXZvaWQgMDtjb25zdCByPW4oNzI3Myksbz1uKDY3NTcpLGk9big1NjM5KSxzPW4oMjE1MCksYT1uKDE2MjUpO3QuY3JlYXRlRG90UHJvZHVjdFByb2dyYW1JbmZvTG9hZGVyPShlLHQsbix1KT0+e2NvbnN0IGw9KChlLHQpPT4oe25hbWU6IkNvbnZEb3RQcm9kdWN0IixpbnB1dE5hbWVzOmU/WyJJbTJDb2wiLCJLIiwiQiJdOlsiSW0yQ29sIiwiSyJdLGlucHV0VHlwZXM6ZT9baS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnBhY2tlZExhc3REaW1lbnNpb24saS5UZXh0dXJlVHlwZS51bnBhY2tlZF06W2kuVGV4dHVyZVR5cGUudW5wYWNrZWQsaS5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uXSxjYWNoZUtleTp0LmFjdGl2YXRpb25DYWNoZUtleX0pKSh0Lmxlbmd0aD4yLHUpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbCkse2dldDooKT0+KChlLHQsbix1LGwpPT57Y29uc3QgYz1uWzBdLmRpbXMscD1uWzFdLmRpbXMsZD1bcFswXSxNYXRoLmNlaWwoY1sxXSpwWzJdKnBbM10vNCldLGY9KDAsIGEuY2FsY3VsYXRlSW0yQ29sRGltcykoYyxwLHUpLFtoLGddPWUuY2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0KGQsaS5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uKSxiPXIuU2hhcGVVdGlsLmNvbXB1dGVTdHJpZGVzKGYpLFttLHldPWUuY2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0KGYsaS5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uKSx2PXUubGVuZ3RoLF89bi5sZW5ndGg8Mz8iMC4wIjoiX0IoYikiLHc9TWF0aC5jZWlsKGNbMV0qcFsyXSpwWzNdLzQpLHthY3RpdmF0aW9uRnVuY3Rpb246VCxhcHBseUFjdGl2YXRpb246eH09KDAsIHMuZ2V0QWN0aXZhdGlvblNuaXBwZXQpKGwpLE89KDAsIG8uZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLFM9YFxuJHtUfVxuZmxvYXQgcHJvY2VzcyhpbnQgaW5kaWNlc1ske3Z9XSkge1xuICBpbnQgYlsxXTtcbiAgYlswXSA9IGluZGljZXNbMV07XG4gIGludCBpbTJjb2xbNF07XG4gIGltMmNvbFswXSA9IGluZGljZXNbMF07XG4gIGltMmNvbFsxXSA9IGluZGljZXNbMl07XG4gIGltMmNvbFsyXSA9IGluZGljZXNbM107XG4gIGludCBpbTJjb2xPZmZzZXQgPSBpbTJjb2xbMF0gKiAke2JbMF19ICsgaW0yY29sWzFdICogJHtiWzFdfSArIGltMmNvbFsyXSAqICR7YlsyXX07XG4gIGludCBrZXJuZWxPZmZzZXQgPSBpbmRpY2VzWzFdICogJHtkWzFdfTtcbiAgZmxvYXQgdmFsdWUgPSAke199O1xuICBmb3IgKGludCBpID0gMDsgaSA8ICR7d307ICsraSkge1xuICAgIHZlYzIgaW0yY29sQ29vcmRzID0gb2Zmc2V0VG9Db29yZHMoaW0yY29sT2Zmc2V0LCAke219LCAke3l9KTtcbiAgICB2ZWMyIGtlcm5lbENvb3JkcyA9IG9mZnNldFRvQ29vcmRzKGtlcm5lbE9mZnNldCwgJHtofSwgJHtnfSk7XG4gICAgdmFsdWUgKz0gZG90KCR7Ty50ZXh0dXJlMkR9KEltMkNvbCwgaW0yY29sQ29vcmRzKSwgJHtPLnRleHR1cmUyRH0oSywga2VybmVsQ29vcmRzKSk7XG4gICAgKytpbTJjb2xPZmZzZXQ7XG4gICAgKytrZXJuZWxPZmZzZXQ7XG4gIH1cbiAgJHt4fVxuICByZXR1cm4gdmFsdWU7XG59YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtvdXRwdXQ6e2RpbXM6dSx0eXBlOm5bMF0udHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6U30pfSkoZSxsLHQsbix1KX0pfTt9LDQxMjU6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlRmxhdHRlbkF0dHJpYnV0ZXM9dC5mbGF0dGVuPXZvaWQgMDtjb25zdCByPW4oNzI3Myk7dC5mbGF0dGVuPShlLHQsbik9PntvKHQsbik7Y29uc3QgaT1yLlNoYXBlVXRpbC5mbGF0dGVuU2hhcGUodFswXS5kaW1zLG4pO3JldHVybiBbZS5yZXNoYXBlVW5wYWNrZWQodFswXSxpKV19LHQucGFyc2VGbGF0dGVuQXR0cmlidXRlcz1lPT5lLmF0dHJpYnV0ZXMuZ2V0SW50KCJheGlzIiwxKTtjb25zdCBvPShlLHQpPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkZsYXR0ZW4gcmVxdWlyZXMgMSBpbnB1dC4iKTtjb25zdCBuPWVbMF0uZGltcy5sZW5ndGg7aWYoMD09PW4pdGhyb3cgbmV3IEVycm9yKCJzY2FsYXIgdGVuc29yIGlzIG5vdCBzdXBwb3J0ZWQuIik7aWYodDwtbnx8dD5uKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBheGlzIik7aWYoInN0cmluZyI9PT1lWzBdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJzdHJpbmcgdGVuc29yIGlzIG5vdCBzdXBwb3J0ZWQuIil9O30sMjE1MDooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQucGFyc2VJbnRlcm5hbEFjdGl2YXRpb25BdHRyaWJ1dGVzPXQuZ2V0QWN0aXZhdGlvblNuaXBwZXQ9dm9pZCAwO2NvbnN0IHI9big3MjczKSxvPW4oOTA4Nyk7dC5nZXRBY3RpdmF0aW9uU25pcHBldD1mdW5jdGlvbihlKXtsZXQgdDtzd2l0Y2goZS5hY3RpdmF0aW9uKXtjYXNlIlJlbHUiOnQ9KDAsIG8uZ2xzbFJlbHUpKCk7YnJlYWs7Y2FzZSJTaWdtb2lkIjp0PSgwLCBvLmdsc2xTaWdtb2lkKSgpO2JyZWFrO2Nhc2UiQ2xpcCI6dD0oMCwgby5nbHNsQ2xpcCkoZS5jbGlwTWluLGUuY2xpcE1heCk7YnJlYWs7ZGVmYXVsdDpyZXR1cm4ge2FjdGl2YXRpb25GdW5jdGlvbjoiIixhcHBseUFjdGl2YXRpb246IiJ9fWNvbnN0IG49dC5uYW1lO3JldHVybiB7YWN0aXZhdGlvbkZ1bmN0aW9uOnQuYm9keSxhcHBseUFjdGl2YXRpb246YHZhbHVlID0gJHtufV8odmFsdWUpO2B9fSx0LnBhcnNlSW50ZXJuYWxBY3RpdmF0aW9uQXR0cmlidXRlcz1lPT57Y29uc3QgdD1lLmdldFN0cmluZygiYWN0aXZhdGlvbiIsIiIpO2lmKCJDbGlwIj09PXQpe2NvbnN0W24sb109ZS5nZXRGbG9hdHMoImFjdGl2YXRpb25fcGFyYW1zIixbci5NSU5fQ0xJUCxyLk1BWF9DTElQXSk7cmV0dXJuIHthY3RpdmF0aW9uOnQsY2xpcE1heDpvLGNsaXBNaW46bixhY3RpdmF0aW9uQ2FjaGVLZXk6YCR7dH06JHtufSwke299YH19cmV0dXJuIHthY3RpdmF0aW9uOnQsYWN0aXZhdGlvbkNhY2hlS2V5OnR9fTt9LDYxNDk6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlR2F0aGVyQXR0cmlidXRlcz10LmdhdGhlcj12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big2MTQ1KSxpPW4oNzI3Mykscz1uKDU2MzkpO3QuZ2F0aGVyPShlLHQsbik9PihsKHQsbi5heGlzKSxbZS5ydW4odShlLHQsbiksdCldKSx0LnBhcnNlR2F0aGVyQXR0cmlidXRlcz1lPT4oMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHtheGlzOmUuYXR0cmlidXRlcy5nZXRJbnQoImF4aXMiLDApfSk7Y29uc3QgYT17bmFtZToiR2F0aGVyIixpbnB1dE5hbWVzOlsiQSIsIkIiXSxpbnB1dFR5cGVzOltzLlRleHR1cmVUeXBlLnVucGFja2VkLHMuVGV4dHVyZVR5cGUudW5wYWNrZWRdfSx1PShlLHQsbik9Pntjb25zdCByPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxhKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXl9KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtnZXQ6KCk9PigoZSx0LG4scik9Pntjb25zdCBvPW5bMF0uZGltcy5zbGljZSgpLGE9blsxXS5kaW1zLnNsaWNlKCksdT1uZXcgQXJyYXkoby5sZW5ndGgrYS5sZW5ndGgtMSk7cj1pLlNoYXBlVXRpbC5ub3JtYWxpemVBeGlzKHIsby5sZW5ndGgpO2NvbnN0IGw9W107Zm9yKGxldCBlPTA7ZTx1Lmxlbmd0aDtlKyspZTxyPyh1W2VdPW9bZV0sbC5wdXNoKGBpbnB1dElkeFske2V9XSA9IG91dHB1dElkeFske2V9XTtgKSk6ZTxyK2EubGVuZ3RoPyh1W2VdPWFbZS1yXSxsLnB1c2goYGluZGV4RGF0YUlkeFske2Utcn1dID0gb3V0cHV0SWR4WyR7ZX1dO2ApKToodVtlXT1vW2UtYS5sZW5ndGgrMV0sbC5wdXNoKGBpbnB1dElkeFske2UtYS5sZW5ndGgrMX1dID0gb3V0cHV0SWR4WyR7ZX1dO2ApKTtjb25zdCBjPWBcbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50IG91dHB1dElkeFske3UubGVuZ3RofHwxfV0pIHtcbiAgICAgICAgaW50IGlucHV0SWR4WyR7by5sZW5ndGh9XTtcbiAgICAgICAgaW50IGluZGV4RGF0YUlkeFske2EubGVuZ3RofHwxfV07XG4gICAgICAgIGluZGV4RGF0YUlkeFswXSA9IDA7XG4gICAgICAgICR7bC5qb2luKCJcbiAgICAgICAgIil9XG4gICAgICAgIGludCBpZHggPSBpbnQoX0IoaW5kZXhEYXRhSWR4KSk7XG4gICAgICAgIGlucHV0SWR4WyR7cn1dID0gaWR4IDwgMCA/IGlkeCArICR7b1tyXX0gOiBpZHg7XG4gICAgICAgIHJldHVybiBfQShpbnB1dElkeCk7XG4gICAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtvdXRwdXQ6e2RpbXM6dSx0eXBlOm5bMF0udHlwZSx0ZXh0dXJlVHlwZTpzLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6Y30pfSkoMCxyLHQsbi5heGlzKX0pfSxsPShlLHQpPT57aWYoIWV8fDIhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkdhdGhlciByZXF1aXJlcyAyIGlucHV0cy4iKTtjb25zdCBuPWVbMF0uZGltcy5sZW5ndGg7aWYobjwxKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCBzaGFwZS4iKTtpZih0PC1ufHx0Pm4tMSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgYXhpcy4iKTtpZigtMT09PW8uTlVNQkVSX1RZUEVTLmluZGV4T2YoZVswXS50eXBlKSl0aHJvdyBuZXcgRXJyb3IoIkludmFpZCBpbnB1dCB0eXBlLiIpO2lmKCJpbnQzMiIhPT1lWzFdLnR5cGUmJiJpbnQxNiIhPT1lWzFdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJJbnZhaWQgaW5wdXQgdHlwZS4iKX07fSw1Mzc4OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZUdlbW1BdHRyaWJ1dGVzVjExPXQucGFyc2VHZW1tQXR0cmlidXRlc1Y3PXQuZ2VtbT12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big3MjczKSxpPW4oNTYzOSk7dC5nZW1tPShlLHQsbik9PihsKHQsbiksW2UucnVuKGEodCxuKSx0KV0pO2NvbnN0IHM9KGUsdCk9Pntjb25zdCBuPTAhPT1lLmF0dHJpYnV0ZXMuZ2V0SW50KCJ0cmFuc0EiLDApLG89MCE9PWUuYXR0cmlidXRlcy5nZXRJbnQoInRyYW5zQiIsMCksaT1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoImFscGhhIiwxKSxzPWUuYXR0cmlidXRlcy5nZXRGbG9hdCgiYmV0YSIsMSk7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe3RyYW5zQTpuLHRyYW5zQjpvLGFscGhhOmksYmV0YTpzLGlzT3B0aW9uYWxDOnR9KX07dC5wYXJzZUdlbW1BdHRyaWJ1dGVzVjc9ZT0+cyhlLCExKSx0LnBhcnNlR2VtbUF0dHJpYnV0ZXNWMTE9ZT0+cyhlLCEwKTtjb25zdCBhPShlLHQpPT57Y29uc3Qgbj17bmFtZToiR2VtbSIsaW5wdXROYW1lczozPT09ZS5sZW5ndGg/WyJBIiwiQiIsIkMiXTpbIkEiLCJCIl0saW5wdXRUeXBlczozPT09ZS5sZW5ndGg/W2kuVGV4dHVyZVR5cGUudW5wYWNrZWQsaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXTpbaS5UZXh0dXJlVHlwZS51bnBhY2tlZCxpLlRleHR1cmVUeXBlLnVucGFja2VkXSxrZXk6dC5jYWNoZUtleX07cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7Z2V0OigpPT51KG4sZSx0KX0pfSx1PShlLHQsbik9Pntjb25zdCByPXRbMF0uZGltcy5zbGljZSgpLHM9dFsxXS5kaW1zLnNsaWNlKCksW2EsdV09by5HZW1tVXRpbC5nZXRTaGFwZU9mR2VtbVJlc3VsdChyLG4udHJhbnNBLHMsbi50cmFuc0IsMz09PXQubGVuZ3RoP3RbMl0uZGltczp2b2lkIDApLGw9W2EsdV07aWYoIWwpdGhyb3cgbmV3IEVycm9yKCJDYW4ndCB1c2UgZ2VtbSBvbiB0aGUgZ2l2ZW4gdGVuc29ycyIpO2xldCBjPXJbci5sZW5ndGgtMV0scD0iIjtuLnRyYW5zQSYmKGM9clswXSksbi50cmFuc0EmJm4udHJhbnNCP3A9InZhbHVlICs9IF9BX1QoYSkgKiBfQl9UKGIpOyI6bi50cmFuc0EmJiFuLnRyYW5zQj9wPSJ2YWx1ZSArPSBfQV9UKGEpICogX0IoYik7Ijohbi50cmFuc0EmJm4udHJhbnNCP3A9InZhbHVlICs9IF9BKGEpICogX0JfVChiKTsiOm4udHJhbnNBfHxuLnRyYW5zQnx8KHA9InZhbHVlICs9IF9BKGEpICogX0IoYik7Iik7Y29uc3QgZD1sLmxlbmd0aCxmPWBcbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50IGluZGljZXNbJHtkfV0pIHtcbiAgICAgICAgICBpbnQgYVske2R9XTtcbiAgICAgICAgICBpbnQgYlske2R9XTtcbiAgICAgICAgICAkezM9PT10Lmxlbmd0aD9gaW50IGNbJHt0WzJdLmRpbXMubGVuZ3RofV07YDoiIn1cblxuICAgICAgICAgIGNvcHlWZWMoaW5kaWNlcywgYSk7XG4gICAgICAgICAgY29weVZlYyhpbmRpY2VzLCBiKTtcbiAgICAgICAgICAkezM9PT10Lmxlbmd0aD8iYmNhc3RJbmRpY2VzX0MoaW5kaWNlcywgYyk7IjoiIn1cblxuICAgICAgICAgIGZsb2F0IHZhbHVlID0gMC4wO1xuICAgICAgICAgIGZvciAoaW50IGs9MDsgazwke2N9OyArK2spIHtcbiAgICAgICAgICAgICAgYVske2QtMX1dID0gaztcbiAgICAgICAgICAgICAgYlske2QtMn1dID0gaztcbiAgICAgICAgICAgICAgJHtwfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhbHVlID0gdmFsdWUgKiBhbHBoYTtcbiAgICAgICAgICAkezM9PT10Lmxlbmd0aD8idmFsdWUgKz0gYmV0YSAqIF9DKGMpOyI6IiJ9XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7b3V0cHV0OntkaW1zOmwsdHlwZTp0WzBdLnR5cGUsdGV4dHVyZVR5cGU6aS5UZXh0dXJlVHlwZS51bnBhY2tlZH0sdmFyaWFibGVzOlt7bmFtZToiYWxwaGEiLHR5cGU6ImZsb2F0IixkYXRhOm4uYWxwaGF9LHtuYW1lOiJiZXRhIix0eXBlOiJmbG9hdCIsZGF0YTpuLmJldGF9XSxzaGFkZXJTb3VyY2U6Zn0pfSxsPShlLHQpPT57aWYoIWUpdGhyb3cgbmV3IEVycm9yKCJJbnB1dCBpcyBtaXNzaW5nIik7aWYodC5pc09wdGlvbmFsQyYmKGUubGVuZ3RoPDJ8fGUubGVuZ3RoPjMpKXRocm93IG5ldyBFcnJvcigiSW52YWlkIGlucHV0IHNoYXBlLiIpO2lmKCF0LmlzT3B0aW9uYWxDJiYzIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJHZW1tIHJlcXVpcmVzIDMgaW5wdXRzIik7aWYoMz09PWUubGVuZ3RoJiYxIT09ZVsyXS5kaW1zLmxlbmd0aCYmMiE9PWVbMl0uZGltcy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHNoYXBlIG9mIEMiKTtpZigiZmxvYXQzMiIhPT1lWzBdLnR5cGUmJiJmbG9hdDY0IiE9PWVbMF0udHlwZXx8ImZsb2F0MzIiIT09ZVsxXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzFdLnR5cGV8fDM9PT1lLmxlbmd0aCYmImZsb2F0MzIiIT09ZVsyXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzJdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHR5cGUuIik7aWYoZVswXS50eXBlIT09ZVsxXS50eXBlfHwzPT09ZS5sZW5ndGgmJmVbMF0udHlwZSE9PWVbMl0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IHR5cGVzIGFyZSBtaXNtYXRjaGVkIil9O30sNTk1MDooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuY3JlYXRlUGFja2VkSW0yQ29sUHJvZ3JhbUluZm9Mb2FkZXI9dm9pZCAwO2NvbnN0IHI9big2NzU3KSxvPW4oNTYzOSksaT1uKDU2MTQpO3QuY3JlYXRlUGFja2VkSW0yQ29sUHJvZ3JhbUluZm9Mb2FkZXI9KGUsdCxuLHMsYSk9Pntjb25zdCB1PShsPWEuY2FjaGVLZXkse25hbWU6IkltMkNvbCAocGFja2VkKSIsaW5wdXROYW1lczpbIkEiXSxpbnB1dFR5cGVzOltvLlRleHR1cmVUeXBlLnBhY2tlZF0sY2FjaGVIaW50Omx9KTt2YXIgbDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtnZXQ6KCk9PigoZSx0LG4scyxhLHUpPT57Y29uc3QgbD1uLmRpbXMsYz1zLmRpbXMscD1hLmxlbmd0aCxkPVtjWzFdKmNbMl0qY1szXSxhWzJdKmFbM11dLGY9Y1syXSpjWzNdLGg9KDAsIGkudW5wYWNrRnJvbUNoYW5uZWwpKCksZz0oMCwgci5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbik7bGV0IGI9IiI7Zm9yKGxldCBlPTA7ZTw9MTtlKyspZm9yKGxldCB0PTA7dDw9MTt0KyspYis9YFxuICAgICAgICAgICAgYmxvY2tJbmRleCA9IHJjLnggKyAke3R9O1xuICAgICAgICAgICAgcG9zID0gcmMueSArICR7ZX07XG5cbiAgICAgICAgICAgIGlmKGJsb2NrSW5kZXggPCAke2RbMV19ICYmIHBvcyA8ICR7ZFswXX0pIHtcbiAgICAgICAgICAgICAgb2Zmc2V0WSA9IGludChibG9ja0luZGV4IC8gKCR7YVtwLTFdfSkpICogJHt1LnN0cmlkZXNbMF19IC1cbiAgICAgICAgICAgICAgICAke3UucGFkc1swXX07XG4gICAgICAgICAgICAgIGQwID0gb2Zmc2V0WSArICR7dS5kaWxhdGlvbnNbMF19ICogKGltb2QocG9zLCAke2Z9KSAvICR7Y1syXX0pO1xuXG4gICAgICAgICAgICAgIGlmKGQwIDwgJHtsWzJdfSAmJiBkMCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0WCA9IGltb2QoYmxvY2tJbmRleCwgJHthW3AtMV19KSAqICR7dS5zdHJpZGVzWzFdfSAtXG4gICAgICAgICAgICAgICAgICAke3UucGFkc1sxXX07XG4gICAgICAgICAgICAgICAgZDEgPSBvZmZzZXRYICsgJHt1LmRpbGF0aW9uc1sxXX0gKiBpbW9kKGltb2QocG9zLCAke2Z9KSwgJHtjWzJdfSk7XG5cbiAgICAgICAgICAgICAgICBpZihkMSA8ICR7bFszXX0gJiYgZDEgPj0gMCkge1xuXG4gICAgICAgICAgICAgICAgICBjaCA9IGludChmbG9hdChwb3MpLyAke2Z9Lik7XG4gICAgICAgICAgICAgICAgICAgIGlubmVyRGltcyA9IHZlYzIoZDAsIGQxKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0WyR7MiplK3R9XSA9IGdldENoYW5uZWwoXG4gICAgICAgICAgICAgICAgICAgICAgZ2V0QSgwLCBjaCwgaW50KGlubmVyRGltcy54KSxcbiAgICAgICAgICAgICAgICAgICAgICBpbnQoaW5uZXJEaW1zLnkpKSwgaW5uZXJEaW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIGA7Y29uc3QgbT1gXG4gICAgICAke2h9XG5cbiAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgaXZlYzIgcmMgPSBnZXRPdXRwdXRDb29yZHMoKTtcbiAgICAgICAgICB2ZWM0IHJlc3VsdCA9IHZlYzQoMC4wKTtcbiAgICAgICAgICBpbnQgYmxvY2tJbmRleCwgcG9zLCBvZmZzZXRZLCBkMCwgb2Zmc2V0WCwgZDEsIGNoO1xuICAgICAgICAgIHZlYzIgaW5uZXJEaW1zO1xuICAgICAgICAgICR7Yn1cbiAgICAgICAgICAke2cub3V0cHV0fSA9IHJlc3VsdDtcbiAgICAgIH1cbiAgICAgICAgICAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7b3V0cHV0OntkaW1zOmQsdHlwZTpuLnR5cGUsdGV4dHVyZVR5cGU6by5UZXh0dXJlVHlwZS5wYWNrZWR9LHNoYWRlclNvdXJjZTptLGhhc01haW46ITB9KX0pKGUsdSx0LG4scyxhKX0pfTt9LDE2MjU6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNhbGN1bGF0ZUltMkNvbERpbXM9dC5jcmVhdGVJbTJDb2xQcm9ncmFtSW5mb0xvYWRlcj12b2lkIDA7Y29uc3Qgcj1uKDU2MzkpO3QuY3JlYXRlSW0yQ29sUHJvZ3JhbUluZm9Mb2FkZXI9KGUsbixvLGkscyk9Pntjb25zdCBhPSh1PXMuY2FjaGVLZXkse25hbWU6IkltMkNvbCIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltyLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6dX0pO3ZhciB1O3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2dldDooKT0+KChlLG4sbyxpLHMsYSk9Pntjb25zdCB1PW8uZGltcyxsPWkuZGltcyxjPXMubGVuZ3RoLHA9KDAsIHQuY2FsY3VsYXRlSW0yQ29sRGltcykodSxsLHMsNCksZD1gXG4gICAgICAgIGNvbnN0IGludCBYQyA9ICR7dVsxXX07XG4gICAgICAgIGNvbnN0IGludCBYSCA9ICR7dVsyXX07XG4gICAgICAgIGNvbnN0IGludCBYVyA9ICR7dVszXX07XG4gICAgICAgIGNvbnN0IGludCBLSCA9ICR7YS5rZXJuZWxTaGFwZVswXX07XG4gICAgICAgIGNvbnN0IGludCBLVyA9ICR7YS5rZXJuZWxTaGFwZVsxXX07XG4gICAgICAgIGNvbnN0IGludCBkaWxhdGlvbkggPSAke2EuZGlsYXRpb25zWzBdfTtcbiAgICAgICAgY29uc3QgaW50IGRpbGF0aW9uVyA9ICR7YS5kaWxhdGlvbnNbMV19O1xuICAgICAgICBjb25zdCBpbnQgc3RyaWRlSCA9ICR7YS5zdHJpZGVzWzBdfTtcbiAgICAgICAgY29uc3QgaW50IHN0cmlkZVcgPSAke2Euc3RyaWRlc1sxXX07XG4gICAgICAgIGNvbnN0IGludCBwYWRIID0gJHthLnBhZHNbMF19O1xuICAgICAgICBjb25zdCBpbnQgcGFkVyA9ICR7YS5wYWRzWzFdfTtcbiAgICAgICAgY29uc3QgaW50IEtIS1cgPSBLSCpLVztcbiAgICAgICAgY29uc3QgaW50IFhDS0hLVyA9IFhDICogS0hLVztcbiAgICAgICAgY29uc3QgaW50IG91dHB1dENoYW5uZWxzID0gNDtcbiAgICAgICAgdmVjNCBwcm9jZXNzKGludCBpbmRpY2VzWyR7Y31dKSB7XG4gICAgICAgICAgaW50IGIgID0gaW5kaWNlc1swXTsgLy8gYmF0Y2ggc2l6ZVxuICAgICAgICAgIGludCBvaCA9IGluZGljZXNbMV0gKiBzdHJpZGVIIC0gcGFkSDsgLy9vdXRwdXQgaGVpZ2h0XG4gICAgICAgICAgaW50IG93ID0gaW5kaWNlc1syXSAqIHN0cmlkZVcgLSBwYWRXOyAvL291dHB1dCB3aWR0aFxuICAgICAgICAgIGludCBwID0gaW5kaWNlc1szXSAqIG91dHB1dENoYW5uZWxzOyAvL3BhdGNoXG4gICAgICAgICAgdmVjNCB2YWx1ZSA9IHZlYzQoMC4wKTtcbiAgICAgICAgICBmb3IoaW50IGk9MDsgaSA8IG91dHB1dENoYW5uZWxzOyArK2kpIHtcbiAgICAgICAgICAgIGlmKHAgPCBYQ0tIS1cpIHtcbiAgICAgICAgICAgICAgaW50IHBhdGNoQyA9IHAgLyBLSEtXO1xuICAgICAgICAgICAgICBpbnQgcGF0Y2hIID0gKHAgLSBwYXRjaEMqS0hLVykgLyBLVztcbiAgICAgICAgICAgICAgaW50IHBhdGNoVyA9IChwIC0gcGF0Y2hDKktIS1cpIC0gcGF0Y2hIICogS1c7XG4gICAgICAgICAgICAgIGludCB4aDIgPSBvaCArIHBhdGNoSCAqIGRpbGF0aW9uSDtcbiAgICAgICAgICAgICAgaW50IHh3MiA9IG93ICsgcGF0Y2hXICogZGlsYXRpb25XO1xuICAgICAgICAgICAgICBpbnQgeFske3UubGVuZ3RofV07XG4gICAgICAgICAgICAgIHhbMF0gPSBiO1xuICAgICAgICAgICAgICB4WzFdID0gcGF0Y2hDO1xuICAgICAgICAgICAgICB4WzJdID0geGgyO1xuICAgICAgICAgICAgICB4WzNdID0geHcyO1xuICAgICAgICAgICAgICBpZih4aDIgPj0gMCAmJlxuICAgICAgICAgICAgICAgICAgeGgyIDwgWEggJiZcbiAgICAgICAgICAgICAgICAgIHh3MiA+PSAwICYmXG4gICAgICAgICAgICAgICAgICB4dzIgPCBYVykge1xuICAgICAgICAgICAgICAgIHZhbHVlW2ldID0gX1goeCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICsrcDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7b3V0cHV0OntkaW1zOnAsdHlwZTpvLnR5cGUsdGV4dHVyZVR5cGU6ci5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9ufSxzaGFkZXJTb3VyY2U6ZH0pfSkoMCxhLG4sbyxpLHMpfSl9LHQuY2FsY3VsYXRlSW0yQ29sRGltcz0oZSx0LG4scj00KT0+W25bMF0sblsyXSxuWzNdLE1hdGguY2VpbChlWzFdKnRbMl0qdFszXS9yKV07fSw2OTgxOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZUltYWdlU2NhbGVyQXR0cmlidXRlcz10LmltYWdlU2NhbGVyPXZvaWQgMDtjb25zdCByPW4oNDkxMCksbz1uKDU2MzkpO3QuaW1hZ2VTY2FsZXI9KGUsdCxuKT0+KHUodCksW2UucnVuKHMoZSx0LG4pLHQpXSksdC5wYXJzZUltYWdlU2NhbGVyQXR0cmlidXRlcz1lPT57Y29uc3QgdD1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoInNjYWxlIiksbj1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXRzKCJiaWFzIik7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe3NjYWxlOnQsYmlhczpufSl9O2NvbnN0IGk9e25hbWU6IkltYWdlU2NhbGVyIixpbnB1dE5hbWVzOlsiWCJdLGlucHV0VHlwZXM6W28uVGV4dHVyZVR5cGUudW5wYWNrZWRdfSxzPShlLHQsbik9Pntjb25zdCByPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxpKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXl9KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtnZXQ6KCk9PigoZSx0LG4scik9Pntjb25zdCBpPW5bMF0uZGltcy5zbGljZSgpLHM9aS5sZW5ndGgsdT1gXG4gICAgICAke2Eoci5iaWFzLmxlbmd0aCl9XG4gICAgICBmbG9hdCBwcm9jZXNzKGludCBpbmRpY2VzWyR7c31dKSB7XG4gICAgICAgIHJldHVybiBfWChpbmRpY2VzKSAqIHNjYWxlICsgZ2V0QmlhcyhiaWFzLCBpbmRpY2VzWzFdKTtcbiAgICAgIH1gO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse291dHB1dDp7ZGltczppLHR5cGU6blswXS50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUudW5wYWNrZWR9LHZhcmlhYmxlczpbe25hbWU6ImJpYXMiLHR5cGU6ImZsb2F0IixhcnJheUxlbmd0aDpyLmJpYXMubGVuZ3RoLGRhdGE6ci5iaWFzfSx7bmFtZToic2NhbGUiLHR5cGU6ImZsb2F0IixkYXRhOnIuc2NhbGV9XSxzaGFkZXJTb3VyY2U6dX0pfSkoMCxyLHQsbil9KX0sYT1lPT57Y29uc3QgdD1bYGZsb2F0IGdldEJpYXMoZmxvYXQgYmlhc1ske2V9XSwgaW50IGNoYW5uZWwpIHtgXTtmb3IobGV0IG49MDtuPGU7KytuKTA9PT1uP3QucHVzaChgXHRpZiAoY2hhbm5lbCA9PSAke259KSB7IHJldHVybiBiaWFzWyR7bn1dOyB9YCk6bj09PWUtMT90LnB1c2goYFx0ZWxzZSB7IHJldHVybiBiaWFzWyR7bn1dOyB9YCk6dC5wdXNoKGBcdGVsc2UgaWYgKGNoYW5uZWwgPT0gJHtufSkgeyByZXR1cm4gYmlhc1ske259XTsgfWApO3JldHVybiB0LnB1c2goIlx0fSIpLHQuam9pbigiXG4iKX0sdT1lPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkltYWdlU2NhbGVyIHJlcXVpcmVzIDEgaW5wdXQuIik7aWYoNCE9PWVbMF0uZGltcy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHNoYXBlLiIpO2lmKCJmbG9hdDMyIiE9PWVbMF0udHlwZSYmImZsb2F0NjQiIT09ZVswXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt9LDc0MTM6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlSW5zdGFuY2VOb3JtYWxpemF0aW9uQXR0cmlidXRlcz10Lmluc3RhbmNlTm9ybWFsaXphdGlvbj12b2lkIDA7Y29uc3Qgcj1uKDY3NTcpLG89big1NjM5KTt0Lmluc3RhbmNlTm9ybWFsaXphdGlvbj0oZSx0LG4pPT57bCh0KTtjb25zdCByPWUucnVuKHModFswXSksdCk7cmV0dXJuIFtlLnJ1bih1KGUsdFswXSxuLHIuZGltcyksW3RbMF0scix0WzFdLHRbMl1dKV19LHQucGFyc2VJbnN0YW5jZU5vcm1hbGl6YXRpb25BdHRyaWJ1dGVzPWU9PmUuYXR0cmlidXRlcy5nZXRGbG9hdCgiZXBzaWxvbiIsMWUtNSk7Y29uc3QgaT17bmFtZToiSW5zdGFuY2VOb3JtYWxpemF0aW9uX01lYW5BbmRWYXJpYW5jZSIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltvLlRleHR1cmVUeXBlLnVucGFja2VkXX0scz1lPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30saSkse2dldDooKT0+KChlLHQpPT57Y29uc3Qgbj10LmRpbXMuc2xpY2UoKSxyPW5bMV0saT1uWzJdKm5bM10scz1bblswXSxyXSxhPWBcbiAgICAgIHZlYzQgcHJvY2VzcyhpbnRbMl0gaW5kaWNlcykge1xuICAgICAgICB2ZWM0IHYgPSB2ZWM0KDAuMCk7XG4gICAgICAgIGludCBhWzRdO1xuICAgICAgICBhWzBdID0gaW5kaWNlc1swXTtcbiAgICAgICAgYVsxXSA9IGluZGljZXNbMV07XG4gICAgICAgIGZsb2F0IHRlbXAgPSAwLjA7XG4gICAgICAgIGZvcihpbnQgYTI9MDsgYTI8JHtuWzJdfTsgYTIrKykge1xuICAgICAgICAgIGFbMl0gPSBhMjtcbiAgICAgICAgICBmb3IoaW50IGEzPTA7IGEzPCR7blszXX07IGEzKyspIHtcbiAgICAgICAgICAgIGFbM10gPSBhMztcbiAgICAgICAgICAgIGZsb2F0IHggPSBfWChhKTtcbiAgICAgICAgICAgIHRlbXAgKz0geDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZmxvYXQgbWVhbiA9IHRlbXAgLyBmbG9hdCgke2l9KTtcbiAgICAgICAgdGVtcCA9IDAuMDtcbiAgICAgICAgZm9yKGludCBhMj0wOyBhMjwke25bMl19OyBhMisrKSB7XG4gICAgICAgICAgYVsyXSA9IGEyO1xuICAgICAgICAgIGZvcihpbnQgYTM9MDsgYTM8JHtuWzNdfTsgYTMrKykge1xuICAgICAgICAgICAgYVszXSA9IGEzO1xuICAgICAgICAgICAgZmxvYXQgeCA9IF9YKGEpO1xuICAgICAgICAgICAgdGVtcCArPSAoeCAtIG1lYW4pICogKHggLSBtZWFuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdi5yID0gbWVhbjtcbiAgICAgICAgdi5nID0gdGVtcCAvIGZsb2F0KCR7aX0pO1xuXG4gICAgICAgIHJldHVybiB2O1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7b3V0cHV0OntkaW1zOnMsdHlwZTp0LnR5cGUsdGV4dHVyZVR5cGU6by5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9ufSxzaGFkZXJTb3VyY2U6YX0pfSkoaSxlKX0pLGE9e25hbWU6Ikluc3RhbmNlTm9ybWFsaXphdGlvbl9Db21wdXRlT3V0cHV0IixpbnB1dE5hbWVzOlsiWCIsIk1lYW5BbmRWYXJpYW5jZSIsIlNjYWxlIiwiQiJdLGlucHV0VHlwZXM6W28uVGV4dHVyZVR5cGUudW5wYWNrZWQsby5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uLG8uVGV4dHVyZVR5cGUudW5wYWNrZWQsby5UZXh0dXJlVHlwZS51bnBhY2tlZF19LHU9KGUsdCxuLGkpPT57Y29uc3Qgcz1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2NhY2hlSGludDpgJHtufWB9KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtnZXQ6KCk9PigoZSx0LG4saSxzKT0+e2NvbnN0IGE9KDAsIHIuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLFt1LGxdPWUuY2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0KHMsby5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uKSxbYyxwXT1bdS80LGxdLGQ9YFxuICAgICAgdmVjNCBnZXRfTWVhbkFuZFZhcmlhbmNlKGludFsyXSBtdikge1xuICAgICAgICBpbnQgb2Zmc2V0ID0gaW5kaWNlc1RvT2Zmc2V0X01lYW5BbmRWYXJpYW5jZShtdik7XG4gICAgICAgIHZlYzIgY29vcmRzID0gb2Zmc2V0VG9Db29yZHMob2Zmc2V0LCAke2N9LCAke3B9KTtcbiAgICAgICAgcmV0dXJuICR7YS50ZXh0dXJlMkR9KE1lYW5BbmRWYXJpYW5jZSwgY29vcmRzKTtcbiAgICAgIH1cblxuICAgICAgZmxvYXQgcHJvY2VzcyhpbnRbNF0gaW5kaWNlcykge1xuICAgICAgICBpbnQgbXZbMl07XG4gICAgICAgIG12WzBdID0gaW5kaWNlc1swXTtcbiAgICAgICAgbXZbMV0gPSBpbmRpY2VzWzFdO1xuICAgICAgICB2ZWM0IG1lYW5fYW5kX3ZhcmlhbmNlID0gZ2V0X01lYW5BbmRWYXJpYW5jZShtdik7XG4gICAgICAgIGZsb2F0IG1lYW4gPSBtZWFuX2FuZF92YXJpYW5jZS5yO1xuICAgICAgICBmbG9hdCB2YXJpYW5jZSA9IG1lYW5fYW5kX3ZhcmlhbmNlLmc7XG5cbiAgICAgICAgaW50IHNiWzFdO1xuICAgICAgICBzYlswXSA9IGluZGljZXNbMV07XG4gICAgICAgIGZsb2F0IHNjYWxlID0gX1NjYWxlKHNiKTtcbiAgICAgICAgZmxvYXQgYiA9IF9CKHNiKTtcblxuICAgICAgICByZXR1cm4gc2NhbGUgKiAoX1goaW5kaWNlcykgLSBtZWFuKSAvIHNxcnQodmFyaWFuY2UgKyBlcHNpbG9uKSArIGI7XG4gICAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtvdXRwdXQ6e2RpbXM6bi5kaW1zLHR5cGU6bi50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUudW5wYWNrZWR9LHZhcmlhYmxlczpbe25hbWU6ImVwc2lsb24iLHR5cGU6ImZsb2F0IixkYXRhOml9XSxzaGFkZXJTb3VyY2U6ZH0pfSkoZSxzLHQsbixpKX0pfSxsPWU9PntpZighZXx8MyE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW5zdGFuY2VOb3JtYWxpemF0aW9uIHJlcXVpcmVzIDMgaW5wdXRzLiIpO2NvbnN0IHQ9ZVswXSxuPWVbMV0scj1lWzJdO2lmKHQuZGltcy5sZW5ndGg8M3x8MSE9PW4uZGltcy5sZW5ndGh8fDEhPT1yLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCBzaGFwZS4iKTtpZihuLmRpbXNbMF0hPT10LmRpbXNbMV18fHIuZGltc1swXSE9PXQuZGltc1sxXSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IHNoYXBlcyBhcmUgbWlzbWF0Y2hlZC4iKTtpZigiZmxvYXQzMiIhPT10LnR5cGUmJiJmbG9hdDY0IiE9PXQudHlwZXx8ImZsb2F0MzIiIT09bi50eXBlJiYiZmxvYXQ2NCIhPT1uLnR5cGV8fCJmbG9hdDMyIiE9PXIudHlwZSYmImZsb2F0NjQiIT09ci50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpO2lmKDQhPT1lWzBdLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiT25seSBzdXBwb3J0IDQtRCBpbnB1dCBzaGFwZS4iKX07fSw3MDA2OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5jcmVhdGVMcm5Qcm9ncmFtSW5mb0xvYWRlcj10LnBhcnNlTHJuQXR0cmlidXRlcz10Lmxybj12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big1NjM5KTt0Lmxybj0oZSx0LG4pPT4oYSh0KSxbZS5ydW4ocyh0LG4pLHQpXSksdC5wYXJzZUxybkF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEZsb2F0KCJhbHBoYSIsMWUtNCksbj1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoImJldGEiLC43NSksbz1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoImJpYXMiLDEpLGk9ZS5hdHRyaWJ1dGVzLmdldEludCgic2l6ZSIpO3JldHVybiAoMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHthbHBoYTp0LGJldGE6bixiaWFzOm8sc2l6ZTppfSl9O2NvbnN0IGk9e25hbWU6IkxSTiIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltvLlRleHR1cmVUeXBlLnVucGFja2VkXX07ZnVuY3Rpb24gcyhlLHQpe3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30saSkse2NhY2hlSGludDp0LmNhY2hlS2V5LGdldDooKT0+ZnVuY3Rpb24oZSx0KXtjb25zdCBuPWVbMF0uZGltc1sxXSxyPWVbMF0uZGltcy5sZW5ndGgscz0tTWF0aC5mbG9vcigodC5zaXplLTEpLzIpLGE9TWF0aC5jZWlsKCh0LnNpemUtMSkvMiksdT1gZmxvYXQoJHt0LmFscGhhfSkgLyBmbG9hdCgke3Quc2l6ZX0pYCxsPWBcbiAgICBmbG9hdCBwcm9jZXNzKGludCBpbmRpY2VzWyR7cn1dKSB7XG4gICAgICAgIGludCBjID0gaW5kaWNlc1sxXTtcbiAgICAgICAgZmxvYXQgeCA9IF9YKGluZGljZXMpO1xuICAgICAgICBmbG9hdCBzcXVhcmVfc3VtID0gMC4wO1xuXG4gICAgICAgIGZvciAoaW50IGkgPSAke3N9OyBpIDw9ICR7YX07IGkrKykge1xuICAgICAgICAgIGludCBpZHggPSBjICsgaTtcbiAgICAgICAgICBpZiAoYyA+PSAwICYmIGMgPCAke259KSB7XG4gICAgICAgICAgICBpbmRpY2VzWzFdID0gaWR4O1xuICAgICAgICAgICAgZmxvYXQgaiA9IF9YKGluZGljZXMpO1xuICAgICAgICAgICAgc3F1YXJlX3N1bSArPSBqICogajtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHggLyBwb3coZmxvYXQoJHt0LmJpYXN9KSArICR7dX0gKiBzcXVhcmVfc3VtLCBmbG9hdCgke3QuYmV0YX0pKTtcbiAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLHtjYWNoZUhpbnQ6dC5jYWNoZUtleSxvdXRwdXQ6e2RpbXM6ZVswXS5kaW1zLHR5cGU6ZVswXS50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUudW5wYWNrZWR9LHNoYWRlclNvdXJjZTpsfSl9KGUsdCl9KX10LmNyZWF0ZUxyblByb2dyYW1JbmZvTG9hZGVyPXM7Y29uc3QgYT1lPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkxSTiByZXF1aXJlcyAxIGlucHV0LiIpO2lmKDQhPT1lWzBdLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcignY3VycmVudGx5IG9ubHkgc3VwcG9ydCBMUk4gZm9yIGlucHV0IHdpdGggIk5DSFciIGZvcm1hdCcpO2lmKCJmbG9hdDMyIiE9PWVbMF0udHlwZSl0aHJvdyBuZXcgRXJyb3IoImlucHV0IHNob3VsZCBiZSBmbG9hdCB0eXBlIil9O30sNTYzMjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuY3JlYXRlUGFja2VkTWF0bXVsUHJvZ3JhbUluZm9Mb2FkZXI9dm9pZCAwO2NvbnN0IHI9big3MjczKSxvPW4oNjc1NyksaT1uKDU2MzkpLHM9big0MzIpLGE9bigyMTUwKSx1PW4oODI3Nik7dC5jcmVhdGVQYWNrZWRNYXRtdWxQcm9ncmFtSW5mb0xvYWRlcj0oZSx0LG4pPT57Y29uc3QgbD0oYz10Lmxlbmd0aD4yLHA9bi5hY3RpdmF0aW9uQ2FjaGVLZXkse25hbWU6Ik1hdE11bCAocGFja2VkKSIsaW5wdXROYW1lczpjP1siQSIsIkIiLCJCaWFzIl06WyJBIiwiQiJdLGlucHV0VHlwZXM6Yz9baS5UZXh0dXJlVHlwZS5wYWNrZWQsaS5UZXh0dXJlVHlwZS5wYWNrZWQsaS5UZXh0dXJlVHlwZS5wYWNrZWRdOltpLlRleHR1cmVUeXBlLnBhY2tlZCxpLlRleHR1cmVUeXBlLnBhY2tlZF0sY2FjaGVIaW50OnB9KTt2YXIgYyxwO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbCkse2dldDooKT0+KChlLHQsbixsKT0+e2NvbnN0IGM9bi5sZW5ndGg+MixwPWM/InZhbHVlICs9IGdldEJpYXNGb3JNYXRtdWwoKTsiOiIiLGQ9blswXS5kaW1zLGY9blsxXS5kaW1zLGg9ci5Ccm9hZGNhc3RVdGlsLmNhbGNTaGFwZShkLGYsITApLGc9IXIuU2hhcGVVdGlsLmFyZUVxdWFsKG5bMF0uZGltcyxuWzFdLmRpbXMpO2lmKCFoKXRocm93IG5ldyBFcnJvcigiQ2FuJ3QgdXNlIG1hdG11bCBvbiB0aGUgZ2l2ZW4gdGVuc29ycyIpO2NvbnN0IGI9ZFtkLmxlbmd0aC0xXSxtPU1hdGguY2VpbChiLzIpLHk9ZC5sZW5ndGgsdj1mLmxlbmd0aCxfPSgwLCBvLmdldEdsc2wpKGUuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC52ZXJzaW9uKSx3PSgwLCBzLmdldENvb3Jkc0RhdGFUeXBlKShoLmxlbmd0aCksVD1oLmxlbmd0aCx4PSgwLCBzLmdldEdsQ2hhbm5lbHMpKCkse2FjdGl2YXRpb25GdW5jdGlvbjpPLGFwcGx5QWN0aXZhdGlvbjpTfT0oMCwgYS5nZXRBY3RpdmF0aW9uU25pcHBldCkobCksQT1jP2AkeygwLCB1LmdldEJpYXNGb3JNYXRtdWwpKHcseCxuWzJdLmRpbXMsaCwhMCl9YDoiIixQPWc/YCR7ZnVuY3Rpb24oZSx0LG4sbyl7bGV0IGk9W10scz1bXTtjb25zdCBhPW5bMF0uZGltcyx1PW5bMV0uZGltcyxsPWEubGVuZ3RoLGM9dS5sZW5ndGgscD1vLmxlbmd0aCxkPXAtbCxmPXAtYztpPWEubWFwKCgoZSxuKT0+YGNvb3Jkcy4ke3RbbitkXX1gKSksaVtsLTFdPSJpKjIiLGkuam9pbigiLCAiKSxzPXUubWFwKCgoZSxuKT0+YGNvb3Jkcy4ke3RbbitmXX1gKSksc1tjLTJdPSJpKjIiLHMuam9pbigiLCAiKTtjb25zdCBoPXIuQnJvYWRjYXN0VXRpbC5nZXRCcm9hZGNhc3REaW1zKGEsbyksZz1yLkJyb2FkY2FzdFV0aWwuZ2V0QnJvYWRjYXN0RGltcyh1LG8pLGI9aC5tYXAoKGU9PmBjb29yZHMuJHt0W2UrZF19ID0gMDtgKSkuam9pbigiXG4iKSxtPWcubWFwKChlPT5gY29vcmRzLiR7dFtlK2ZdfSA9IDA7YCkpLmpvaW4oIlxuIikseT1gaW50IGxhc3REaW0gPSBjb29yZHMuJHt0W3AtMV19O1xuICBjb29yZHMuJHt0W3AtMV19ID0gY29vcmRzLiR7dFtwLTJdfTtcbiAgY29vcmRzLiR7dFtwLTJdfSA9IGxhc3REaW07YDtyZXR1cm4gYFxudmVjNCBnZXRBQXRPdXRDb29yZHNNYXRtdWwoaW50IGkpIHtcbiAgJHtlfSBjb29yZHMgPSBnZXRPdXRwdXRDb29yZHMoKTtcbiAgJHt5fVxuICAke2J9XG4gIHZlYzQgb3V0cHV0VmFsdWUgPSBnZXRBKCR7aX0pO1xuICByZXR1cm4gb3V0cHV0VmFsdWU7XG59XG5cbnZlYzQgZ2V0QkF0T3V0Q29vcmRzTWF0bXVsKGludCBpKSB7XG4gICR7ZX0gY29vcmRzID0gZ2V0T3V0cHV0Q29vcmRzKCk7XG4gICR7eX1cbiAgJHttfVxuICB2ZWM0IG91dHB1dFZhbHVlID0gZ2V0Qigke3N9KTtcbiAgcmV0dXJuIG91dHB1dFZhbHVlO1xufWB9KHcseCxuLGgpfWA6IiIsST1nPyJnZXRBQXRPdXRDb29yZHNNYXRtdWwoaSkiOmBnZXRBKCR7ZnVuY3Rpb24oZSx0KXtsZXQgbj0iIjtmb3IobGV0IHI9MDtyPHQtMjtyKyspbis9YHJjLiR7ZVtyXX0sIGA7cmV0dXJuIG4rPWByYy4ke2VbdC0yXX0sIGkqMmAsbn0oeCx5KX0pYCxFPWc/ImdldEJBdE91dENvb3Jkc01hdG11bChpKSI6YGdldEIoJHtmdW5jdGlvbihlLHQpe2xldCBuPSIiO2ZvcihsZXQgcj0wO3I8dC0yO3IrKyluKz1gcmMuJHtlW3JdfSwgYDtyZXR1cm4gbis9YGkqMiwgcmMuJHtlW3QtMV19YCxufSh4LHYpfSlgLEQ9YFxuICAgICAgICAgICAgJHtQfVxuICAgICAgICAgICAgJHtBfVxuICAgICAgICAgICAgJHtPfVxuICAgICAgICAgICAgdm9pZCBtYWluKCkge1xuICAgICAgICAgICAgICAke2c/IiI6YCR7d30gcmMgPVxuICAgICAgICAgIGdldE91dHB1dENvb3JkcygpOyBpbnQgbGFzdERpbSA9IHJjLiR7eFtULTFdfTsgcmMuJHt4W1QtMV19ID1cbiAgICAgICAgICByYy4ke3hbVC0yXX07IHJjLiR7eFtULTJdfSA9IGxhc3REaW07XG4gICAgICBgfVxuXG4gICAgICAgICAgICAgIHZlYzQgdmFsdWUgPSB2ZWM0KDApO1xuICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8ICR7bX07IGkrKykge1xuICAgICAgICAgICAgICAgIHZlYzQgYSA9ICR7SX07XG4gICAgICAgICAgICAgICAgdmVjNCBiID0gJHtFfTtcblxuICAgICAgICAgICAgICAgIHZhbHVlICs9IChhLnJyYmIgKiBiLnJncmcpO1xuICAgICAgICAgICAgICAgIHZhbHVlICs9IChhLmdnYWEgKiBiLmJhYmEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICR7cH1cbiAgICAgICAgICAgICAgJHtTfVxuICAgICAgICAgICAgICAke18ub3V0cHV0fSA9IHZhbHVlO1xuICAgICAgICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7b3V0cHV0OntkaW1zOmgsdHlwZTpuWzBdLnR5cGUsdGV4dHVyZVR5cGU6aS5UZXh0dXJlVHlwZS5wYWNrZWR9LHNoYWRlclNvdXJjZTpELGhhc01haW46ITB9KX0pKGUsbCx0LG4pfSl9O30sODI3NjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZ2V0Qmlhc0Zvck1hdG11bD10LmNyZWF0ZU1hdG11bFByb2dyYW1JbmZvTG9hZGVyPXQucGFyc2VNYXRNdWxBdHRyaWJ1dGVzPXQubWF0TXVsPXZvaWQgMDtjb25zdCByPW4oNzI3Myksbz1uKDU2MzkpLGk9big0MzIpLHM9bigyMTUwKSxhPW4oNTYzMik7dC5tYXRNdWw9KGUsdCxuKT0+KGModCksZS5zZXNzaW9uLnBhY2s/W2UucnVuKCgwLCBhLmNyZWF0ZVBhY2tlZE1hdG11bFByb2dyYW1JbmZvTG9hZGVyKShlLHQsbiksdCldOltlLnJ1bihsKHQsbiksdCldKSx0LnBhcnNlTWF0TXVsQXR0cmlidXRlcz1lPT4oMCwgcy5wYXJzZUludGVybmFsQWN0aXZhdGlvbkF0dHJpYnV0ZXMpKGUuYXR0cmlidXRlcyk7Y29uc3QgdT0oZSx0KT0+KHtuYW1lOiJNYXRNdWwiLGlucHV0TmFtZXM6ZT9bIkEiLCJCIiwiQmlhcyJdOlsiQSIsIkIiXSxpbnB1dFR5cGVzOmU/W28uVGV4dHVyZVR5cGUudW5wYWNrZWQsby5UZXh0dXJlVHlwZS51bnBhY2tlZCxvLlRleHR1cmVUeXBlLnVucGFja2VkXTpbby5UZXh0dXJlVHlwZS51bnBhY2tlZCxvLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6dH0pO2Z1bmN0aW9uIGwoZSx0KXtjb25zdCBuPXUoZS5sZW5ndGg+Mix0LmFjdGl2YXRpb25DYWNoZUtleSk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7Z2V0OigpPT5mdW5jdGlvbihlLHQsbil7Y29uc3QgYT10WzBdLmRpbXMsdT10WzFdLmRpbXMsbD1yLkJyb2FkY2FzdFV0aWwuY2FsY1NoYXBlKGEsdSwhMCk7aWYoIWwpdGhyb3cgbmV3IEVycm9yKCJDYW4ndCB1c2UgbWF0bXVsIG9uIHRoZSBnaXZlbiB0ZW5zb3JzIik7Y29uc3QgYz0oMCwgaS5nZXRDb29yZHNEYXRhVHlwZSkobC5sZW5ndGgpLGQ9KDAsIGkuZ2V0R2xDaGFubmVscykoKSx7YWN0aXZhdGlvbkZ1bmN0aW9uOmYsYXBwbHlBY3RpdmF0aW9uOmh9PSgwLCBzLmdldEFjdGl2YXRpb25TbmlwcGV0KShuKSxnPXQubGVuZ3RoPjIsYj1nPyJ2YWx1ZSArPSBnZXRCaWFzRm9yTWF0bXVsKCk7IjoiIixtPWc/YCR7cChjLGQsdFsyXS5kaW1zLGwsITEpfWA6IiIseT1sLmxlbmd0aCx2PWEubGVuZ3RoLF89dS5sZW5ndGgsdz1gXG4gICAgJHtmfVxuICAgICR7bX1cbiAgICBmbG9hdCBwcm9jZXNzKGludCBpbmRpY2VzWyR7eX1dKSB7XG4gICAgICAgIGludCBhWyR7dn1dO1xuICAgICAgICBpbnQgYlske199XTtcbiAgICAgICAgYmNhc3RNYXRtdWxJbmRpY2VzX0EoaW5kaWNlcywgYSk7XG4gICAgICAgIGJjYXN0TWF0bXVsSW5kaWNlc19CKGluZGljZXMsIGIpO1xuXG4gICAgICAgIGZsb2F0IHZhbHVlO1xuICAgICAgICBmb3IgKGludCBrPTA7IGs8JHthW2EubGVuZ3RoLTFdfTsgKytrKSB7XG4gICAgICAgICAgICBhWyR7di0xfV0gPSBrO1xuICAgICAgICAgICAgYlske18tMn1dID0gaztcbiAgICAgICAgICAgIHZhbHVlICs9IF9BKGEpICogX0IoYik7XG4gICAgICAgIH1cbiAgICAgICAgJHtifVxuICAgICAgICAke2h9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtvdXRwdXQ6e2RpbXM6bCx0eXBlOnRbMF0udHlwZSx0ZXh0dXJlVHlwZTpvLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6d30pfShuLGUsdCl9KX10LmNyZWF0ZU1hdG11bFByb2dyYW1JbmZvTG9hZGVyPWw7Y29uc3QgYz1lPT57aWYoIWV8fDIhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIk1hdE11bCByZXF1aXJlcyAyIGlucHV0cy4iKTtpZihlWzBdLmRpbXNbZVswXS5kaW1zLmxlbmd0aC0xXSE9PWVbMV0uZGltc1tlWzFdLmRpbXMubGVuZ3RoLTJdKXRocm93IG5ldyBFcnJvcigic2hhcmVkIGRpbWVuc2lvbiBkb2VzIG5vdCBtYXRjaC4iKTtpZigiZmxvYXQzMiIhPT1lWzBdLnR5cGUmJiJmbG9hdDY0IiE9PWVbMF0udHlwZXx8ImZsb2F0MzIiIT09ZVsxXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzFdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJpbnB1dHMgc2hvdWxkIGJlIGZsb2F0IHR5cGUiKTtpZihlWzBdLnR5cGUhPT1lWzFdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJpbnB1dHMgdHlwZXMgc2hvdWxkIG1hdGNoIil9O2Z1bmN0aW9uIHAoZSx0LG4sbyxpKXtsZXQgcz0iIjtjb25zdCBhPW4ubGVuZ3RoLHU9by5sZW5ndGgsbD11LWE7cz11PDImJmE+MD8iY29vcmRzIjpuLm1hcCgoKGUsbik9PmBjb29yZHMuJHt0W24rbF19YCkpLmpvaW4oIiwgIik7Y29uc3QgYz1yLkJyb2FkY2FzdFV0aWwuZ2V0QnJvYWRjYXN0RGltcyhuLG8pLm1hcCgoZT0+YGNvb3Jkcy4ke3RbZStsXX0gPSAwO2ApKS5qb2luKCJcbiIpO2xldCBwPSJ2ZWM0KG91dHB1dFZhbHVlLnh4LCBvdXRwdXRWYWx1ZS55eSkiO3JldHVybiAxPT09ci5TaGFwZVV0aWwuc2l6ZShuKSYmKHA9InZlYzQob3V0cHV0VmFsdWUueCkiKSxpP2BcbnZlYzQgZ2V0Qmlhc0Zvck1hdG11bCgpIHtcbiAgJHtlfSBjb29yZHMgPSBnZXRPdXRwdXRDb29yZHMoKTtcbiAgJHtjfVxuICB2ZWM0IG91dHB1dFZhbHVlID0gZ2V0Qmlhcygke3N9KTtcbiAgcmV0dXJuICR7cH07XG59YDpgXG5mbG9hdCBnZXRCaWFzRm9yTWF0bXVsKCkge1xuICAke2V9IGNvb3JkcyA9IGdldE91dHB1dENvb3JkcygpO1xuICAke2N9XG4gIHJldHVybiBnZXRCaWFzKGNvb3Jkcy54KTtcbn1gfXQuZ2V0Qmlhc0Zvck1hdG11bD1wO30sOTooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuY3JlYXRlUGFja1Byb2dyYW1JbmZvTG9hZGVyPXZvaWQgMDtjb25zdCByPW4oNjc1Nyksbz1uKDU2MzkpLGk9big0MzIpLHM9big1NjE0KSxhPXtuYW1lOiJwYWNrIixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W28uVGV4dHVyZVR5cGUudW5wYWNrZWRSZXZlcnNlZF19O3QuY3JlYXRlUGFja1Byb2dyYW1JbmZvTG9hZGVyPShlLHQpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2dldDooKT0+KChlLHQpPT57Y29uc3Qgbj0oMCwgci5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksdT10LmRpbXMsbD11Lmxlbmd0aCxjPXQuZGltcy5sZW5ndGgscD0oMCwgaS5nZXRDb29yZHNEYXRhVHlwZSkoYyksZD0oMCwgcy5nZXRDaGFubmVscykoInJjIixjKSxmPShoPWMsZz1kLGI9dVt1Lmxlbmd0aC0yXSxtPXVbdS5sZW5ndGgtMV0sMD09PWh8fDE9PT1oPyIiOmBcbiAgICBpbnQgciA9ICR7Z1toLTJdfTtcbiAgICBpbnQgYyA9ICR7Z1toLTFdfTtcbiAgICBpbnQgcnAxID0gJHtnW2gtMl19ICsgMTtcbiAgICBpbnQgY3AxID0gJHtnW2gtMV19ICsgMTtcbiAgICBib29sIHJFZGdlID0gcnAxID49ICR7bX07XG4gICAgYm9vbCBjRWRnZSA9IGNwMSA+PSAke2J9O1xuICAgIGApO3ZhciBoLGcsYixtO2xldCB5O3k9MD09PWw/WzEsMV06MT09PWw/W3VbMF0sMV06W3VbYy0xXSx1W2MtMl1dO2NvbnN0IHY9ZnVuY3Rpb24oZSx0LG4pe2lmKDA9PT1lKXJldHVybiAiZmFsc2UiO2lmKDE9PT1lKXJldHVybiBgcmMgPiAke3RbMF19YDtsZXQgcj0iIjtmb3IobGV0IG89ZS0yO288ZTtvKyspcis9YCR7bltvXX0gPj0gJHt0W28tZSsyXX1gLG88ZS0xJiYocis9Inx8Iik7cmV0dXJuIHJ9KGMseSxkKSxfPWZ1bmN0aW9uKGUsdCl7Y29uc3Qgbj1lLmxlbmd0aDtpZigwPT09bilyZXR1cm4gImdldEEoKSwgMCwgMCwgMCI7aWYoMT09PW4pcmV0dXJuIGBnZXRBKHJjKSxcbiAgICAgICAgICAgIHJjICsgMSA+PSAke2VbMF19ID8gMC4gOiBnZXRBKHJjICsgMSksXG4gICAgICAgICAgICAwLCAwYDtsZXQgcj0iIjtpZihuPjIpZm9yKGxldCBlPTA7ZTxuLTI7KytlKXIrPWAke3RbZV19LGA7cmV0dXJuIGBnZXRBKCR7cn1yLCBjKSxcbiAgICAgICAgICByRWRnZSA/IDAuIDogZ2V0QSgke3J9cnAxLCBjKSxcbiAgICAgICAgICBjRWRnZSA/IDAuIDogZ2V0QSgke3J9ciwgY3AxKSxcbiAgICAgICAgICByRWRnZSB8fCBjRWRnZSA/IDAuIDogZ2V0QSgke3J9cnAxLCBjcDEpYH0odSxkKSx3PWBcbiAgICAgICAgdm9pZCBtYWluKCkge1xuICAgICAgICAgICR7cH0gcmMgPSBnZXRPdXRwdXRDb29yZHMoKTtcblxuICAgICAgICAgIGlmKCR7dn0pIHtcbiAgICAgICAgICAgICR7bi5vdXRwdXR9ID0gdmVjNCgwKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHtmfVxuXG4gICAgICAgICAgICAke24ub3V0cHV0fSA9IHZlYzQoJHtffSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBgO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2hhc01haW46ITAsb3V0cHV0OntkaW1zOnQuZGltcyx0eXBlOnQudHlwZSx0ZXh0dXJlVHlwZTpvLlRleHR1cmVUeXBlLnBhY2tlZH0sc2hhZGVyU291cmNlOnd9KX0pKGUsdCl9KTt9LDU2MTQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnVucGFja0Zyb21DaGFubmVsPXQuZ2V0Q2hhbm5lbHM9dC5nZXRWZWNDaGFubmVscz12b2lkIDA7Y29uc3Qgcj1uKDQzMik7ZnVuY3Rpb24gbyhlLHQpe3JldHVybiAoMCwgci5nZXRHbENoYW5uZWxzKSh0KS5tYXAoKHQ9PmAke2V9LiR7dH1gKSl9dC5nZXRWZWNDaGFubmVscz1vLHQuZ2V0Q2hhbm5lbHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gMT09PXQ/W2VdOm8oZSx0KX0sdC51bnBhY2tGcm9tQ2hhbm5lbD1mdW5jdGlvbigpe3JldHVybiAiXG4gICAgZmxvYXQgZ2V0Q2hhbm5lbCh2ZWM0IGZyYWcsIGludCBkaW0pIHtcbiAgICAgIGludCBtb2RDb29yZCA9IGltb2QoZGltLCAyKTtcbiAgICAgIHJldHVybiBtb2RDb29yZCA9PSAwID8gZnJhZy5yIDogZnJhZy5nO1xuICAgIH1cblxuICAgIGZsb2F0IGdldENoYW5uZWwodmVjNCBmcmFnLCB2ZWMyIGlubmVyRGltcykge1xuICAgICAgdmVjMiBtb2RDb29yZCA9IG1vZChpbm5lckRpbXMsIDIuKTtcbiAgICAgIHJldHVybiBtb2RDb29yZC54ID09IDAuID9cbiAgICAgICAgKG1vZENvb3JkLnkgPT0gMC4gPyBmcmFnLnIgOiBmcmFnLmcpIDpcbiAgICAgICAgKG1vZENvb3JkLnkgPT0gMC4gPyBmcmFnLmIgOiBmcmFnLmEpO1xuICAgIH1cbiAgIn07fSw1NTY1OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZVBhZEF0dHJpYnV0ZXNWMTE9dC5wYWRWMTE9dC5wYXJzZVBhZEF0dHJpYnV0ZXNWMj10LnBhZFYyPXZvaWQgMDtjb25zdCByPW4oNDkxMCksbz1uKDcyNzMpLGk9big2NzU3KSxzPW4oNTYzOSksYT17bmFtZToiUGFkIixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W3MuVGV4dHVyZVR5cGUudW5wYWNrZWRdfTt0LnBhZFYyPShlLHQsbik9PihjKHQpLFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2NhY2hlSGludDpuLmNhY2hlS2V5LGdldDooKT0+bChlLHRbMF0sbil9KSx0KV0pLHQucGFyc2VQYWRBdHRyaWJ1dGVzVjI9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldFN0cmluZygibW9kZSIsImNvbnN0YW50Iiksbj1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoInZhbHVlIiwwKSxvPWUuYXR0cmlidXRlcy5nZXRJbnRzKCJwYWRzIik7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe21vZGU6dCx2YWx1ZTpuLHBhZHM6b30pfSx0LnBhZFYxMT0oZSxuLHIpPT57cChuKTtjb25zdCBvPXUoZSxuLHIpO3JldHVybiAoMCwgdC5wYWRWMikoZSxbblswXV0sbyl9LHQucGFyc2VQYWRBdHRyaWJ1dGVzVjExPWU9PmUuYXR0cmlidXRlcy5nZXRTdHJpbmcoIm1vZGUiLCJjb25zdGFudCIpO2NvbnN0IHU9KGUsdCxuKT0+e2lmKCFlLnNlc3Npb24uaXNJbml0aWFsaXplcih0WzFdLmRhdGFJZCl8fHQubGVuZ3RoPj0zJiYhZS5zZXNzaW9uLmlzSW5pdGlhbGl6ZXIodFsyXS5kYXRhSWQpKXRocm93IG5ldyBFcnJvcigiZHluYW1pYyBwYWQgYXR0cmlidXRlcyBhcmUgbm90IGFsbG93ZWQiKTtjb25zdCBvPUFycmF5LmZyb20odFsxXS5pbnRlZ2VyRGF0YSksaT10Lmxlbmd0aD49Mz90WzJdLmZsb2F0RGF0YVswXTowO3JldHVybiAoMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHttb2RlOm4scGFkczpvLHZhbHVlOml9KX0sbD0oZSx0LG4pPT57Y29uc3Qgcj1vLlNoYXBlVXRpbC5wYWRTaGFwZSh0LmRpbXMuc2xpY2UoKSxuLnBhZHMpLGk9ci5sZW5ndGgsYT1gXG4gICAgICAke2QoZSx0LG4pfVxuICAgICAgZmxvYXQgcHJvY2VzcyhpbnRbJHtpfV0gaW5kaWNlcykge1xuICAgICAgICAgIHJldHVybiBwYWRBKGluZGljZXMpO1xuICAgICAgfWA7cmV0dXJuIHtuYW1lOiJQYWQiLGlucHV0TmFtZXM6WyJBIl0saW5wdXRUeXBlczpbcy5UZXh0dXJlVHlwZS51bnBhY2tlZF0sb3V0cHV0OntkaW1zOnIsdHlwZTp0LnR5cGUsdGV4dHVyZVR5cGU6cy5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOmF9fSxjPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiUGFkIHJlcXVpcmVzIDEgaW5wdXQiKTtpZigiZmxvYXQzMiIhPT1lWzBdLnR5cGUmJiJmbG9hdDY0IiE9PWVbMF0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKX0scD1lPT57aWYoIWV8fDIhPT1lLmxlbmd0aCYmMyE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiUGFkIHJlcXVpcmVzIDIgb3IgMyBpbnB1dHMiKTtpZigiaW50MzIiIT09ZVsxXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpO2lmKGUubGVuZ3RoPj0zJiYic3RyaW5nIj09PWVbMl0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKX0sZD0oZSx0LG4pPT57Y29uc3Qgcj0oMCwgaS5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksW2EsdV09ZS5jYWxjdWxhdGVUZXh0dXJlV2lkdGhBbmRIZWlnaHQodC5kaW1zLHMuVGV4dHVyZVR5cGUudW5wYWNrZWQpLGw9by5TaGFwZVV0aWwuY29tcHV0ZVN0cmlkZXModC5kaW1zKTtzd2l0Y2gobi5tb2RlKXtjYXNlImNvbnN0YW50IjpyZXR1cm4gZihyLHQuZGltcyxsLGEsdSxuLnBhZHMsbi52YWx1ZSk7Y2FzZSJyZWZsZWN0IjpyZXR1cm4gaChyLHQuZGltcyxsLGEsdSxuLnBhZHMpO2Nhc2UiZWRnZSI6cmV0dXJuIGcocix0LmRpbXMsbCxhLHUsbi5wYWRzKTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiSW52YWxpZCBtb2RlIil9fSxmPShlLHQsbixyLG8saSxzKT0+e2NvbnN0IGE9dC5sZW5ndGg7bGV0IHU9IiI7Zm9yKGxldCBlPWEtMTtlPj0wOy0tZSl1Kz1gXG4gICAgICAgIGsgPSBtWyR7ZX1dIC0gJHtpW2VdfTtcbiAgICAgICAgaWYgKGsgPCAwKSAgcmV0dXJuIGNvbnN0YW50O1xuICAgICAgICBpZiAoayA+PSAke3RbZV19KSByZXR1cm4gY29uc3RhbnQ7XG4gICAgICAgIG9mZnNldCArPSBrICogJHtuW2VdfTtcbiAgICAgICAgYDtyZXR1cm4gYFxuICAgICAgZmxvYXQgcGFkQShpbnQgbVske2F9XSkge1xuICAgICAgICBjb25zdCBmbG9hdCBjb25zdGFudCA9IGZsb2F0KCR7c30pO1xuICAgICAgICBpbnQgb2Zmc2V0ID0gMDtcbiAgICAgICAgaW50IGsgPSAwO1xuICAgICAgICAke3V9XG4gICAgICAgIHZlYzIgY29vcmRzID0gb2Zmc2V0VG9Db29yZHMob2Zmc2V0LCAke3J9LCAke299KTtcbiAgICAgICAgZmxvYXQgdmFsdWUgPSBnZXRDb2xvckFzRmxvYXQoJHtlLnRleHR1cmUyRH0oQSwgY29vcmRzKSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGB9LGg9KGUsdCxuLHIsbyxpKT0+e2NvbnN0IHM9dC5sZW5ndGg7bGV0IGE9IiI7Zm9yKGxldCBlPXMtMTtlPj0wOy0tZSlhKz1gXG4gICAgICAgIGsgPSBtWyR7ZX1dIC0gJHtpW2VdfTtcbiAgICAgICAgaWYgKGsgPCAwKSB7IGsgPSAtazsgfVxuICAgICAgICB7XG4gICAgICAgICAgY29uc3QgaW50IF8ybl8xID0gJHsyKih0W2VdLTEpfTtcbiAgICAgICAgICBrID0gaW50KCBtb2QoIGZsb2F0KGspLCBmbG9hdChfMm5fMSkgKSApIDtcbiAgICAgICAgICBpZihrID49ICR7dFtlXX0pIHsgayA9IF8ybl8xIC0gazsgfVxuICAgICAgICB9XG4gICAgICAgIG9mZnNldCArPSBrICogJHtuW2VdfTtcbiAgICAgICAgYDtyZXR1cm4gYFxuICAgICAgZmxvYXQgcGFkQShpbnQgbVske3N9XSkge1xuICAgICAgICBpbnQgb2Zmc2V0ID0gMDtcbiAgICAgICAgaW50IGsgPSAwO1xuICAgICAgICAke2F9XG4gICAgICAgIHZlYzIgY29vcmRzID0gb2Zmc2V0VG9Db29yZHMob2Zmc2V0LCAke3J9LCAke299KTtcbiAgICAgICAgZmxvYXQgdmFsdWUgPSBnZXRDb2xvckFzRmxvYXQoJHtlLnRleHR1cmUyRH0oQSwgY29vcmRzKSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGB9LGc9KGUsdCxuLHIsbyxpKT0+e2NvbnN0IHM9dC5sZW5ndGg7bGV0IGE9IiI7Zm9yKGxldCBlPXMtMTtlPj0wOy0tZSlhKz1gXG4gICAgICAgIGsgPSBtWyR7ZX1dIC0gJHtpW2VdfTtcbiAgICAgICAgaWYgKGsgPCAwKSAgayA9IDA7XG4gICAgICAgIGlmIChrID49ICR7dFtlXX0pIGsgPSAke3RbZV0tMX07XG4gICAgICAgIG9mZnNldCArPSBrICogJHtuW2VdfTtcbiAgICAgIGA7cmV0dXJuIGBcbiAgICAgIGZsb2F0IHBhZEEoaW50IG1bJHtzfV0pIHtcbiAgICAgICAgaW50IG9mZnNldCA9IDA7XG4gICAgICAgIGludCBrID0gMDtcbiAgICAgICAgJHthfVxuICAgICAgICB2ZWMyIGNvb3JkcyA9IG9mZnNldFRvQ29vcmRzKG9mZnNldCwgJHtyfSwgJHtvfSk7XG4gICAgICAgIGZsb2F0IHZhbHVlID0gZ2V0Q29sb3JBc0Zsb2F0KCR7ZS50ZXh0dXJlMkR9KEEsIGNvb3JkcykpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBgfTt9LDI4MzQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0Lmdsb2JhbE1heFBvb2w9dC5wYXJzZU1heFBvb2xBdHRyaWJ1dGVzPXQubWF4UG9vbD10LnBhcnNlR2xvYmFsQXZlcmFnZVBvb2xBdHRyaWJ1dGVzPXQuZ2xvYmFsQXZlcmFnZVBvb2w9dC5wYXJzZUF2ZXJhZ2VQb29sQXR0cmlidXRlcz10LmF2ZXJhZ2VQb29sPXZvaWQgMDtjb25zdCByPW4oNDkxMCksbz1uKDcyNzMpLGk9big1NjM5KTt0LmF2ZXJhZ2VQb29sPShlLHQsbik9PntwKHQpO2NvbnN0IHI9e25hbWU6IkF2ZXJhZ2VQb29sIixpbnB1dE5hbWVzOlsiWCJdLGlucHV0VHlwZXM6W2kuVGV4dHVyZVR5cGUudW5wYWNrZWRdLGNhY2hlSGludDpuLmNhY2hlS2V5fTtyZXR1cm4gW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7Z2V0OigpPT5zKHQsciwhMSxuKX0pLHQpXX0sdC5wYXJzZUF2ZXJhZ2VQb29sQXR0cmlidXRlcz1lPT57Y29uc3QgdD1lLmF0dHJpYnV0ZXMuZ2V0U3RyaW5nKCJhdXRvX3BhZCIsIk5PVFNFVCIpLG49ZS5hdHRyaWJ1dGVzLmdldEludCgiY2VpbF9tb2RlIiwwKSxvPTAhPT1lLmF0dHJpYnV0ZXMuZ2V0SW50KCJjb3VudF9pbmNsdWRlX3BhZCIsMCksaT1lLmF0dHJpYnV0ZXMuZ2V0SW50cygia2VybmVsX3NoYXBlIikscz1lLmF0dHJpYnV0ZXMuZ2V0SW50cygic3RyaWRlcyIsW10pLGE9ZS5hdHRyaWJ1dGVzLmdldEludHMoInBhZHMiLFtdKTtpZigwIT09bil0aHJvdyBuZXcgRXJyb3IoInVzaW5nIGNlaWwoKSBpbiBzaGFwZSBjb21wdXRhdGlvbiBpcyBub3QgeWV0IHN1cHBvcnRlZCBmb3IgQXZlcmFnZVBvb2wiKTtyZXR1cm4gKDAsIHIuY3JlYXRlQXR0cmlidXRlV2l0aENhY2hlS2V5KSh7YXV0b1BhZDp0LGNlaWxNb2RlOm4sY291bnRJbmNsdWRlUGFkOm8sa2VybmVsU2hhcGU6aSxzdHJpZGVzOnMscGFkczphfSl9O2NvbnN0IHM9KGUsdCxuLHIpPT57Y29uc3RbcyxhXT11KGUscixuKSxsPW8uU2hhcGVVdGlsLnNpemUocy5rZXJuZWxTaGFwZSk7bGV0IGM9IiI7cy5jb3VudEluY2x1ZGVQYWQ/Yys9YHZhbHVlIC89IGZsb2F0KCR7bH0pO2A6Yys9YHZhbHVlIC89IGZsb2F0KCR7bH0gLSBwYWQpO2A7Y29uc3QgcD1gXG4gICAgICAgICR7ZChlWzBdLmRpbXMscywidmFsdWUgKz0gX1goeCk7IixjLCIwLjAiKX1cbiAgICAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7b3V0cHV0OntkaW1zOmEsdHlwZTplWzBdLnR5cGUsdGV4dHVyZVR5cGU6aS5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOnB9KX07dC5nbG9iYWxBdmVyYWdlUG9vbD0oZSx0LG4pPT57cCh0KTtjb25zdCByPXtuYW1lOiJHbG9iYWxBdmVyYWdlUG9vbCIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltpLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6YCR7bi5jb3VudEluY2x1ZGVQYWR9YH07cmV0dXJuIFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse2dldDooKT0+cyh0LHIsITAsbil9KSx0KV19LHQucGFyc2VHbG9iYWxBdmVyYWdlUG9vbEF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9MCE9PWUuYXR0cmlidXRlcy5nZXRJbnQoImNvdW50X2luY2x1ZGVfcGFkIiwwKTtyZXR1cm4gKDAsIHIuY3JlYXRlQXR0cmlidXRlV2l0aENhY2hlS2V5KSh7YXV0b1BhZDoiIixjZWlsTW9kZTowLGNvdW50SW5jbHVkZVBhZDp0LGtlcm5lbFNoYXBlOltdLHN0cmlkZXM6W10scGFkczpbXX0pfSx0Lm1heFBvb2w9KGUsdCxuKT0+e3AodCk7Y29uc3Qgcj17bmFtZToiTWF4UG9vbCIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltpLlRleHR1cmVUeXBlLnVucGFja2VkXSxjYWNoZUhpbnQ6bi5jYWNoZUtleX07cmV0dXJuIFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse2dldDooKT0+YSh0LHIsITEsbil9KSx0KV19LHQucGFyc2VNYXhQb29sQXR0cmlidXRlcz1lPT57Y29uc3QgdD1lLmF0dHJpYnV0ZXMuZ2V0U3RyaW5nKCJhdXRvX3BhZCIsIk5PVFNFVCIpLG49ZS5hdHRyaWJ1dGVzLmdldEludCgiY2VpbF9tb2RlIiwwKSxvPWUuYXR0cmlidXRlcy5nZXRJbnRzKCJrZXJuZWxfc2hhcGUiKSxpPWUuYXR0cmlidXRlcy5nZXRJbnRzKCJzdHJpZGVzIixbXSkscz1lLmF0dHJpYnV0ZXMuZ2V0SW50cygicGFkcyIsW10pLGE9ZS5hdHRyaWJ1dGVzLmdldEludCgic3RvcmFnZV9vcmRlciIsMCksdT1lLmF0dHJpYnV0ZXMuZ2V0SW50cygiZGlsYXRpb25zIixbXSk7aWYoMCE9PWEpdGhyb3cgbmV3IEVycm9yKCJjb2x1bW4gbWFqb3Igc3RvcmFnZSBvcmRlciBpcyBub3QgeWV0IHN1cHBvcnRlZCBmb3IgTWF4UG9vbCIpO2lmKDAhPT1uKXRocm93IG5ldyBFcnJvcigidXNpbmcgY2VpbCgpIGluIHNoYXBlIGNvbXB1dGF0aW9uIGlzIG5vdCB5ZXQgc3VwcG9ydGVkIGZvciBNYXhQb29sIik7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2F1dG9QYWQ6dCxjZWlsTW9kZTpuLGNvdW50SW5jbHVkZVBhZDohMSxrZXJuZWxTaGFwZTpvLHN0cmlkZXM6aSxwYWRzOnMsc3RvcmFnZU9yZGVyOmEsZGlsYXRpb25zOnV9KX07Y29uc3QgYT0oZSx0LG4scik9Pntjb25zdFtvLHNdPXUoZSxyLG4pLGE9YFxuICAgICAgJHtkKGVbMF0uZGltcyxvLCJcbiAgICAgIHZhbHVlID0gbWF4KF9YKHgpLCB2YWx1ZSk7XG4gICAgIiwiIiwiLTFlNSIpfVxuICAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7b3V0cHV0OntkaW1zOnMsdHlwZTplWzBdLnR5cGUsdGV4dHVyZVR5cGU6aS5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOmF9KX0sdT0oZSx0LG4pPT57Y29uc3Qgcj1lWzBdLmRpbXMuc2xpY2UoKSxpPU9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsImRpbGF0aW9ucyIpLHM9dC5rZXJuZWxTaGFwZS5zbGljZSgpLGE9dC5zdHJpZGVzLnNsaWNlKCksdT1pP3QuZGlsYXRpb25zLnNsaWNlKCk6W10sbD10LnBhZHMuc2xpY2UoKTtvLlBvb2xDb252VXRpbC5hZGp1c3RQb29sQXR0cmlidXRlcyhuLHIscyxhLHUsbCk7Y29uc3QgYz1vLlBvb2xDb252VXRpbC5jb21wdXRlUG9vbE91dHB1dFNoYXBlKG4scixhLHUscyxsLHQuYXV0b1BhZCkscD1PYmplY3QuYXNzaWduKHt9LHQpO3JldHVybiBpP09iamVjdC5hc3NpZ24ocCx7a2VybmVsU2hhcGU6cyxzdHJpZGVzOmEscGFkczpsLGRpbGF0aW9uczp1LGNhY2hlS2V5OnQuY2FjaGVLZXl9KTpPYmplY3QuYXNzaWduKHAse2tlcm5lbFNoYXBlOnMsc3RyaWRlczphLHBhZHM6bCxjYWNoZUtleTp0LmNhY2hlS2V5fSksW3AsY119LGw9e2F1dG9QYWQ6IiIsY2VpbE1vZGU6MCxjb3VudEluY2x1ZGVQYWQ6ITEsa2VybmVsU2hhcGU6W10sc3RyaWRlczpbXSxwYWRzOltdLHN0b3JhZ2VPcmRlcjowLGRpbGF0aW9uczpbXSxjYWNoZUtleToiIn0sYz17bmFtZToiR2xvYmFsTWF4UG9vbCIsaW5wdXROYW1lczpbIlgiXSxpbnB1dFR5cGVzOltpLlRleHR1cmVUeXBlLnVucGFja2VkXX07dC5nbG9iYWxNYXhQb29sPShlLHQpPT4ocCh0KSxbZS5ydW4oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGMpLHtnZXQ6KCk9PmEodCxjLCEwLGwpfSksdCldKTtjb25zdCBwPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiUG9vbCBvcHMgcmVxdWlyZXMgMSBpbnB1dC4iKTtpZigiZmxvYXQzMiIhPT1lWzBdLnR5cGUmJiJmbG9hdDY0IiE9PWVbMF0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKX0sZD0oZSx0LG4scixpKT0+e2NvbnN0IHM9ZS5sZW5ndGg7aWYodC5rZXJuZWxTaGFwZS5sZW5ndGg8PTIpe2NvbnN0IG89dC5rZXJuZWxTaGFwZVt0Lmtlcm5lbFNoYXBlLmxlbmd0aC0xXSxhPXQuc3RyaWRlc1t0LnN0cmlkZXMubGVuZ3RoLTFdLHU9dC5wYWRzW3QucGFkcy5sZW5ndGgvMi0xXSxsPXQucGFkc1t0LnBhZHMubGVuZ3RoLTFdLGM9ZVtzLTFdO2xldCBwPSIiLGQ9IiIsZj0iIjtpZihwPXUrbCE9PTA/YFxuICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgJHtvfTsgaSsrKSB7XG4gICAgICAgICAgICB4WyR7c30gLSAxXSA9IGluZGljZXNbJHtzfSAtIDFdICogJHthfSAtICR7dX0gKyBpO1xuICAgICAgICAgICAgaWYgKHhbJHtzfSAtIDFdIDwgMCB8fCB4WyR7c30gLSAxXSA+PSAke2N9KSB7XG4gICAgICAgICAgICAgIHBhZCsrO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICR7bn1cbiAgICAgICAgICB9YDpgXG4gICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAke299OyBpKyspIHtcbiAgICAgICAgICAgIHhbJHtzfSAtIDFdID0gaW5kaWNlc1ske3N9IC0gMV0gKiAke2F9IC0gJHt1fSArIGk7XG4gICAgICAgICAgICAke259XG4gICAgICAgICAgfWAsMj09PXQua2VybmVsU2hhcGUubGVuZ3RoKXtjb25zdCBuPXQua2VybmVsU2hhcGVbdC5rZXJuZWxTaGFwZS5sZW5ndGgtMl0scj10LnN0cmlkZXNbdC5zdHJpZGVzLmxlbmd0aC0yXSxpPXQucGFkc1t0LnBhZHMubGVuZ3RoLzItMl0sYT10LnBhZHNbdC5wYWRzLmxlbmd0aC0yXSx1PWVbcy0yXTtkPWkrYSE9PTA/YFxuICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCAke259OyBqKyspIHtcbiAgICAgICAgICAgICAgeFske3N9IC0gMl0gPSBpbmRpY2VzWyR7c30gLSAyXSAqICR7cn0gLSAke2l9ICsgajtcbiAgICAgICAgICAgICAgaWYgKHhbJHtzfSAtIDJdIDwgMCB8fCB4WyR7c30gLSAyXSA+PSAke3V9KSB7XG4gICAgICAgICAgICAgICAgcGFkKz0gJHtvfTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIGA6YFxuICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCAke259OyBqKyspIHtcbiAgICAgICAgICAgICAgeFske3N9IC0gMl0gPSBpbmRpY2VzWyR7c30gLSAyXSAqICR7cn0gLSAke2l9ICsgajtcbiAgICAgICAgICAgIGAsZj0iXG4gICAgICAgICAgfVxuICAgICAgICAiO31yZXR1cm4gYFxuICAgICAgICBmbG9hdCBwcm9jZXNzKGludCBpbmRpY2VzWyR7c31dKSB7XG4gICAgICAgICAgaW50IHhbJHtzfV07XG4gICAgICAgICAgY29weVZlYyhpbmRpY2VzLCB4KTtcblxuICAgICAgICAgIGZsb2F0IHZhbHVlID0gJHtpfTtcbiAgICAgICAgICBpbnQgcGFkID0gMDtcbiAgICAgICAgICAke2R9XG4gICAgICAgICAgJHtwfVxuICAgICAgICAgICR7Zn1cbiAgICAgICAgICAke3J9XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICBgfXtjb25zdCBhPW8uU2hhcGVVdGlsLnNpemUodC5rZXJuZWxTaGFwZSksdT1vLlNoYXBlVXRpbC5jb21wdXRlU3RyaWRlcyh0Lmtlcm5lbFNoYXBlKSxsPXUubGVuZ3RoLGM9dC5wYWRzLmxlbmd0aCxwPWgobCksZD1mKGUsImlucHV0RGltcyIpLGc9Zih0LnBhZHMsInBhZHMiKSxiPWYodSwia2VybmVsU3RyaWRlcyIpLG09Zih0LnN0cmlkZXMsInN0cmlkZXMiKTtsZXQgeT0iIjtyZXR1cm4geT10LnBhZHMucmVkdWNlKCgoZSx0KT0+ZSt0KSk/YFxuICAgICAgICAgICAgaWYgKHhbal0gPj0gaW5wdXREaW1zW2pdIHx8IHhbal0gPCAwKSB7XG4gICAgICAgICAgICAgIHBhZCsrO1xuICAgICAgICAgICAgICBpc1BhZCA9IHRydWU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWlzUGFkKSB7XG4gICAgICAgICAgICAke259XG4gICAgICAgICAgfWA6YFxuICAgICAgICAgIH1cbiAgICAgICAgICAke259XG4gICAgICAgIGAsYFxuICAgICAgICAke3B9XG4gICAgICAgIGZsb2F0IHByb2Nlc3MoaW50IGluZGljZXNbJHtzfV0pIHtcbiAgICAgICAgICBpbnQgeFske3N9XTtcbiAgICAgICAgICBjb3B5VmVjKGluZGljZXMsIHgpO1xuICAgICAgICAgIGludCBvZmZzZXRbJHtsfV07XG4gICAgICAgICAgaW50IHBhZHNbJHtjfV07XG4gICAgICAgICAgaW50IGlucHV0RGltc1ske3N9XTtcbiAgICAgICAgICBpbnQga2VybmVsU3RyaWRlc1ske2x9XTtcbiAgICAgICAgICBpbnQgc3RyaWRlc1ske2x9XTtcbiAgICAgICAgICAke2d9XG4gICAgICAgICAgJHtkfVxuICAgICAgICAgICR7bX1cbiAgICAgICAgICAke2J9XG5cbiAgICAgICAgICBmbG9hdCB2YWx1ZSA9ICR7aX07XG4gICAgICAgICAgaW50IHBhZCA9IDA7XG4gICAgICAgICAgYm9vbCBpc1BhZCA9IGZhbHNlO1xuICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgJHthfTsgaSsrKSB7XG4gICAgICAgICAgICBvZmZzZXRUb0luZGljZXMoaSwga2VybmVsU3RyaWRlcywgb2Zmc2V0KTtcbiAgICAgICAgICAgIGlzUGFkID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKGludCBqID0gJHtzfSAtICR7bH07IGogPCAke3N9OyBqKyspIHtcbiAgICAgICAgICAgICAgeFtqXSA9IGluZGljZXNbal0gKiBzdHJpZGVzW2ogLSAke3N9ICsgJHtsfV1cbiAgICAgICAgICAgICAgICArIG9mZnNldFtqIC0gJHtzfSArICR7bH1dIC0gcGFkc1tqIC0gMl07XG4gICAgICAgICAgICAgICR7eX1cbiAgICAgICAgICB9XG4gICAgICAgICAgJHtyfVxuXG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICBgfX0sZj0oZSx0KT0+e2xldCBuPSIiO2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGg7cisrKW4rPWBcbiAgICAgICR7dH1bJHtyfV0gPSAke2Vbcl19O1xuICAgIGA7cmV0dXJuIG59LGg9ZT0+YFxuICB2b2lkIG9mZnNldFRvSW5kaWNlcyhpbnQgb2Zmc2V0LCBpbnRbJHtlfV0gc3RyaWRlcywgb3V0IGludFske2V9XSBpbmRpY2VzKSB7XG4gICAgaWYgKCR7ZX0gPT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKGludCBpID0gMDsgaSA8ICR7ZX0gLSAxOyArK2kpIHtcbiAgICAgIGluZGljZXNbaV0gPSBvZmZzZXQgLyBzdHJpZGVzW2ldO1xuICAgICAgb2Zmc2V0IC09IGluZGljZXNbaV0gKiBzdHJpZGVzW2ldO1xuICAgIH1cbiAgICBpbmRpY2VzWyR7ZX0gLSAxXSA9IG9mZnNldDtcbiAgfWA7fSwxMDEwOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5yZWR1Y2VMb2dTdW1TcXVhcmU9dC5yZWR1Y2VMb2dTdW09dC5yZWR1Y2VQcm9kPXQucmVkdWNlTWluPXQucmVkdWNlTWF4PXQucmVkdWNlTWVhbj10LnJlZHVjZVN1bT10LnBhcnNlUmVkdWNlQXR0cmlidXRlcz12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big2MTQ1KSxpPW4oNzI3Mykscz1uKDU2MzkpLGE9KGUsdCxuLHIsbyk9PntsKHQpO2NvbnN0IGk9e25hbWU6cixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W3MuVGV4dHVyZVR5cGUudW5wYWNrZWRdfTtyZXR1cm4gW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxpKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXksZ2V0OigpPT51KGUsdCxuLHIsbyxpKX0pLHQpXX07dC5wYXJzZVJlZHVjZUF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEludHMoImF4ZXMiLFtdKSxuPTE9PT1lLmF0dHJpYnV0ZXMuZ2V0SW50KCJrZWVwZGltcyIsMSk7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2F4ZXM6dCxrZWVwRGltczpufSl9O2NvbnN0IHU9KGUsdCxuLHIsbyxhKT0+e2NvbnN0IHU9W10sbD10WzBdLmRpbXMubGVuZ3RofHwxLGM9W10scD1pLlNoYXBlVXRpbC5ub3JtYWxpemVBeGVzKG4uYXhlcyx0WzBdLmRpbXMubGVuZ3RoKSxkPW8odCxwKTtsZXQgZj1kWzFdO2ZvcihsZXQgZT0wO2U8dFswXS5kaW1zLmxlbmd0aDtlKyspcC5pbmRleE9mKGUpPj0wfHwwPT09cC5sZW5ndGg/KG4ua2VlcERpbXMmJnUucHVzaCgxKSxmPWBcbiAgICAgICAgICBmb3IoaW50IGoke2V9ID0gMDsgaiR7ZX0gPCAke3RbMF0uZGltc1tlXX07IGoke2V9KyspIHtcbiAgICAgICAgICAgIGlucHV0SWR4WyR7ZX1dID0gaiR7ZX07XG4gICAgICAgICAgICAke2Z9XG4gICAgICAgICAgfWApOihjLnB1c2goYGlucHV0SWR4WyR7ZX1dID0gb3V0cHV0SWR4WyR7dS5sZW5ndGh9XTtgKSx1LnB1c2godFswXS5kaW1zW2VdKSk7Y29uc3QgaD1gXG4gICAgICBmbG9hdCBwcm9jZXNzKGludCBvdXRwdXRJZHhbJHt1Lmxlbmd0aHx8MX1dKSB7XG4gICAgICAgIGZsb2F0IHZhbHVlOyAgICAgICAgICAgICAgICAgLy8gZmluYWwgcmVzdWx0XG4gICAgICAgIGludCBpbnB1dElkeFske2x9XTsgICAgICAvLyBhZGRyZXNzaW5nIGlucHV0IGRhdGFcbiAgICAgICAgJHtjLmpvaW4oIlxuIil9XG4gICAgICAgICR7ZFswXX0gICAgICAgLy8gaW5pdCBvcHMgZm9yIHJlZHVjZSBtYXgvbWluXG4gICAgICAgICR7Zn1cbiAgICAgICAgJHtkWzJdfSAgICAgICAvLyBmaW5hbCBjb21wdXRhdGlvbiBmb3IgcmVkdWNlIG1lYW5cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxhKSx7b3V0cHV0OntkaW1zOnUsdHlwZTp0WzBdLnR5cGUsdGV4dHVyZVR5cGU6cy5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOmh9KX0sbD1lPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlJlZHVjZSBvcCByZXF1aXJlcyAxIGlucHV0LiIpO2lmKC0xPT09by5OVU1CRVJfVFlQRVMuaW5kZXhPZihlWzBdLnR5cGUpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt0LnJlZHVjZVN1bT0oZSx0LG4pPT5hKGUsdCxuLCJSZWR1Y2VTdW0iLCgoKT0+WyJ2YWx1ZSA9IDAuMDsiLCJ2YWx1ZSArPSBfQShpbnB1dElkeCk7IiwiIl0pKSx0LnJlZHVjZU1lYW49KGUsdCxuKT0+YShlLHQsbiwiUmVkdWNlTWVhbiIsKChlLHQpPT57bGV0IG49MTtmb3IobGV0IHI9MDtyPGVbMF0uZGltcy5sZW5ndGg7cisrKSh0LmluZGV4T2Yocik+PTB8fDA9PT10Lmxlbmd0aCkmJihuKj1lWzBdLmRpbXNbcl0pO3JldHVybiBbInZhbHVlID0gMC4wOyIsInZhbHVlICs9IF9BKGlucHV0SWR4KTsiLGB2YWx1ZSAvPSAke259LjtgXX0pKSx0LnJlZHVjZU1heD0oZSx0LG4pPT5hKGUsdCxuLCJSZWR1Y2VNYXgiLCgoZSx0KT0+e2NvbnN0IG49W107Zm9yKGxldCByPTA7cjxlWzBdLmRpbXMubGVuZ3RoO3IrKykodC5pbmRleE9mKHIpPj0wfHwwPT09dC5sZW5ndGgpJiZuLnB1c2goYGlucHV0SWR4WyR7cn1dID0gMDtgKTtyZXR1cm4gW2Ake24uam9pbigiXG4iKX1cbnZhbHVlID0gX0EoaW5wdXRJZHgpO2AsInZhbHVlID0gbWF4KHZhbHVlLCBfQShpbnB1dElkeCkpOyIsIiJdfSkpLHQucmVkdWNlTWluPShlLHQsbik9PmEoZSx0LG4sIlJlZHVjZU1pbiIsKChlLHQpPT57Y29uc3Qgbj1bXTtmb3IobGV0IHI9MDtyPGVbMF0uZGltcy5sZW5ndGg7cisrKSh0LmluZGV4T2Yocik+PTB8fDA9PT10Lmxlbmd0aCkmJm4ucHVzaChgaW5wdXRJZHhbJHtyfV0gPSAwO2ApO3JldHVybiBbYCR7bi5qb2luKCJcbiIpfVxudmFsdWUgPSBfQShpbnB1dElkeCk7YCwidmFsdWUgPSBtaW4odmFsdWUsIF9BKGlucHV0SWR4KSk7IiwiIl19KSksdC5yZWR1Y2VQcm9kPShlLHQsbik9PmEoZSx0LG4sIlJlZHVjZVByb2QiLCgoKT0+WyJ2YWx1ZSA9IDEuMDsiLCJ2YWx1ZSAqPSBfQShpbnB1dElkeCk7IiwiIl0pKSx0LnJlZHVjZUxvZ1N1bT0oZSx0LG4pPT5hKGUsdCxuLCJSZWR1Y2VMb2dTdW0iLCgoKT0+WyJ2YWx1ZSA9IDAuMDsiLCJ2YWx1ZSArPSBfQShpbnB1dElkeCk7IiwidmFsdWUgPSBsb2codmFsdWUpOyJdKSksdC5yZWR1Y2VMb2dTdW1TcXVhcmU9KGUsdCxuKT0+YShlLHQsbiwiUmVkdWNlTG9nU3VtU3F1YXJlIiwoKCk9PlsiZmxvYXQgdDsgdmFsdWUgPSAwLjA7IiwidCA9IF9BKGlucHV0SWR4KTsgdmFsdWUgKz0gdCAqIHQ7IiwiIl0pKTt9LDczNzk6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmlzUmVzaGFwZUNoZWFwPXQucHJvY2Vzc0RpbXMzRD10LmNyZWF0ZVBhY2tlZFJlc2hhcGUzRFByb2dyYW1JbmZvTG9hZGVyPXZvaWQgMDtjb25zdCByPW4oNzI3Myksbz1uKDY3NTcpLGk9big1NjM5KSxzPW4oNTYxNCk7dC5jcmVhdGVQYWNrZWRSZXNoYXBlM0RQcm9ncmFtSW5mb0xvYWRlcj0oZSx0LG4pPT57Y29uc3QgYT0oZT0+KHtuYW1lOiJSZXNoYXBlIChwYWNrZWQpIixpbnB1dFR5cGVzOltpLlRleHR1cmVUeXBlLnBhY2tlZF0saW5wdXROYW1lczpbIkEiXSxjYWNoZUhpbnQ6YCR7ZX1gfSkpKG4pO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2dldDooKT0+KChlLHQsbixhKT0+e2NvbnN0IHU9dC5kaW1zLGw9YTtsZXQgYz0iIjtmb3IobGV0IGU9MDtlPDQ7ZSsrKXtsZXQgdD0iIjtzd2l0Y2goZSl7Y2FzZSAwOnQ9Im91dHB1dENvb3JkcyA9IHJjOyI7YnJlYWs7Y2FzZSAxOnQ9Im91dHB1dENvb3JkcyA9IGl2ZWMzKHJjLngsIHJjLnkrMSwgcmMueik7IjticmVhaztjYXNlIDI6dD0ib3V0cHV0Q29vcmRzID0gaXZlYzMocmMueCwgcmMueSwgcmMueisxKTsiO2JyZWFrO2Nhc2UgMzp0PSJvdXRwdXRDb29yZHMgPSBpdmVjMyhyYy54LCByYy55KzEsIHJjLnorMSk7IjticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcn1jKz1gXG4gICAgICAgICR7dH1cbiAgICAgICAgJHtlPjA/ImlmKG91dHB1dENvb3Jkcy55IDwgcm93cyAmJiBvdXRwdXRDb29yZHMueiA8IGNvbHMpeyI6IiJ9XG4gICAgICAgICAgaW50IGZsYXR0ZW5lZEluZGV4ID0gZ2V0RmxhdHRlbmVkSW5kZXgob3V0cHV0Q29vcmRzKTtcblxuICAgICAgICAgIGl2ZWMzIGlucHV0UkMgPSBpbnB1dENvb3Jkc0Zyb21SZXNoYXBlZE91dENvb3JkcyhmbGF0dGVuZWRJbmRleCk7XG4gICAgICAgICAgdmVjMiBpbm5lckRpbXMgPSB2ZWMyKGZsb2F0KGlucHV0UkMueSksZmxvYXQoaW5wdXRSQy56KSk7XG5cbiAgICAgICAgICByZXN1bHRbJHtlfV0gPSBnZXRDaGFubmVsKGdldEEoaW5wdXRSQy54LCBpbnB1dFJDLnksIGlucHV0UkMueiksIGlubmVyRGltcyk7XG5cbiAgICAgICAgJHtlPjA/In0iOiIifVxuICAgICAgYDt9Y29uc3QgcD0oMCwgby5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksZD1gXG4gICAgICAke2Z1bmN0aW9uKGUpe2NvbnN0IHQ9ci5TaGFwZVV0aWwuY29tcHV0ZVN0cmlkZXMoZSksbj1bImIiLCJyIiwiYyJdLG89ImluZGV4IjtyZXR1cm4gYFxuICAgIGl2ZWMzIGlucHV0Q29vcmRzRnJvbVJlc2hhcGVkT3V0Q29vcmRzKGludCBpbmRleCkge1xuICAgICAgJHt0Lm1hcCgoKGUscik9PmBpbnQgJHtuW3JdfSA9ICR7b30gLyAke2V9OyAke3I9PT10Lmxlbmd0aC0xP2BpbnQgJHtuW3IrMV19ID0gJHtvfSAtICR7bltyXX0gKiAke2V9YDpgaW5kZXggLT0gJHtuW3JdfSAqICR7ZX1gfTtgKSkuam9pbigiIil9XG4gICAgICByZXR1cm4gaXZlYzMoYiwgciwgYyk7XG4gICAgfVxuICBgfSh1KX1cbiAgICAgICR7ZnVuY3Rpb24oZSl7Y29uc3QgdD1yLlNoYXBlVXRpbC5jb21wdXRlU3RyaWRlcyhlKTtyZXR1cm4gYFxuICBpbnQgZ2V0RmxhdHRlbmVkSW5kZXgoaXZlYzMgY29vcmRzKSB7XG4gICAgLy8gcmV2ZXJzZSB5LCB6IG9yZGVyXG4gICAgcmV0dXJuIGNvb3Jkcy54ICogJHt0WzBdfSArIGNvb3Jkcy56ICogJHt0WzFdfSArIGNvb3Jkcy55O1xuICB9XG5gfShsKX1cbiAgICAgICR7KDAsIHMudW5wYWNrRnJvbUNoYW5uZWwpKCl9XG5cbiAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgaXZlYzMgcmMgPSBnZXRPdXRwdXRDb29yZHMoKTtcblxuICAgICAgICB2ZWM0IHJlc3VsdCA9IHZlYzQoMC4wKTtcblxuICAgICAgICBpdmVjMyBvdXRwdXRDb29yZHM7XG4gICAgICAgIGludCByb3dzID0gJHtsWzJdfTtcbiAgICAgICAgaW50IGNvbHMgPSAke2xbMV19O1xuXG4gICAgICAgICR7Y31cbiAgICAgICAgJHtwLm91dHB1dH0gPSByZXN1bHQ7XG4gICAgICB9XG4gICAgYDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG4pLHtvdXRwdXQ6e2RpbXM6bCx0eXBlOnQudHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnBhY2tlZH0sc2hhZGVyU291cmNlOmQsaGFzTWFpbjohMH0pfSkoZSx0LGEsbil9KX0sdC5wcm9jZXNzRGltczNEPWZ1bmN0aW9uKGUpe2lmKDA9PT1lLmxlbmd0aClyZXR1cm4gWzEsMSwxXTtsZXQgdD0xO2ZvcihsZXQgbj0wO248ZS5sZW5ndGgtMjsrK24pdCo9ZVtuXTtyZXR1cm4gW3QsZS5sZW5ndGg+MT9lW2UubGVuZ3RoLTJdOjEsZVtlLmxlbmd0aC0xXV19LHQuaXNSZXNoYXBlQ2hlYXA9ZnVuY3Rpb24oZSx0KXtsZXQgbj0hMTtyZXR1cm4gbj0wPT09ZS5sZW5ndGh8fDA9PT10Lmxlbmd0aHx8KGUubGVuZ3RoPDJ8fHQubGVuZ3RoPDI/ZVtlLmxlbmd0aC0xXT09PXRbdC5sZW5ndGgtMV06ZVtlLmxlbmd0aC0xXT09PXRbdC5sZW5ndGgtMV0mJmVbZS5sZW5ndGgtMl09PT10W3QubGVuZ3RoLTJdKSxufTt9LDgxMjY6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnJlc2hhcGU9dm9pZCAwO2NvbnN0IHI9big3MjczKTt0LnJlc2hhcGU9KGUsdCk9Pntjb25zdCBuPXIuU2hhcGVVdGlsLmNhbGN1bGF0ZVJlc2hhcGVkRGltcyh0WzBdLmRpbXMsdFsxXS5pbnRlZ2VyRGF0YSk7cmV0dXJuIGUuc2Vzc2lvbi5wYWNrP1tlLnJlc2hhcGVQYWNrZWQodFswXSxuKV06W2UucmVzaGFwZVVucGFja2VkKHRbMF0sbildfTt9LDI4MDE6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlUmVzaXplQXR0cmlidXRlc1YxMT10LnBhcnNlUmVzaXplQXR0cmlidXRlc1YxMD10LnJlc2l6ZT12b2lkIDA7Y29uc3Qgcj1uKDY3NTcpLG89big1NjM5KSxpPW4oNDMyKSxzPW4oNTYxNCksYT1uKDM5ODApLHU9e25hbWU6IlJlc2l6ZSIsaW5wdXROYW1lczpbIkEiXSxpbnB1dFR5cGVzOltvLlRleHR1cmVUeXBlLnBhY2tlZF19O3QucmVzaXplPShlLHQsbik9PigoMCwgYS52YWxpZGF0ZUlucHV0cykodCxuKSxbZS5ydW4oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtjYWNoZUhpbnQ6bi5jYWNoZUtleSxnZXQ6KCk9PmwoZSx0LG4pfSksdCldKSx0LnBhcnNlUmVzaXplQXR0cmlidXRlc1YxMD1lPT4oMCwgYS5wYXJzZVVwc2FtcGxlQXR0cmlidXRlcykoZSwxMCksdC5wYXJzZVJlc2l6ZUF0dHJpYnV0ZXNWMTE9ZT0+KDAsIGEucGFyc2VVcHNhbXBsZUF0dHJpYnV0ZXMpKGUsMTEpO2NvbnN0IGw9KGUsdCxuKT0+e2NvbnN0IGE9KDAsIHIuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLFtsLHBdPWModCxuKTtpZihsLmV2ZXJ5KChlPT4xPT09ZSkpJiYidGZfY3JvcF9hbmRfcmVzaXplIiE9PW4uY29vcmRpbmF0ZVRyYW5zZm9ybU1vZGUpcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx1KSx7b3V0cHV0OntkaW1zOnAsdHlwZTp0WzBdLnR5cGUsdGV4dHVyZVR5cGU6by5UZXh0dXJlVHlwZS5wYWNrZWR9LGhhc01haW46ITAsc2hhZGVyU291cmNlOmB2b2lkIG1haW4oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZlYzQgdiA9ICR7YS50ZXh0dXJlMkR9KFgsIFRleENvb3Jkcyk7XG4gICAgICAgICAgICAgICAgICAgICR7YS5vdXRwdXR9ID0gdjtcbiAgICAgICAgICAgICAgICB9YH0pO2NvbnN0IGQ9cC5sZW5ndGg7aWYoZDwyKXRocm93IG5ldyBFcnJvcihgb3V0cHV0IGRpbWVuc2lvbiBzaG91bGQgYmUgYXQgbGVhc3QgMiwgYnV0IGdvdCAke2R9YCk7Y29uc3QgZj1wW2QtMl0saD1wW2QtMV0sZz10WzBdLmRpbXM7aWYoZCE9PWcubGVuZ3RoKXRocm93IG5ldyBFcnJvcihgb3V0cHV0IGRpbWVuc2lvbiBzaG91bGQgbWF0Y2ggaW5wdXQgJHtnLmxlbmd0aH0sIGJ1dCBnb3QgJHtkfWApO2NvbnN0IGI9Z1tkLTJdLG09Z1tkLTFdLHk9bFtkLTJdLHY9bFtkLTFdO2xldCBfPSIiO2lmKCJsaW5lYXIiIT09bi5tb2RlKXRocm93IG5ldyBFcnJvcihgcmVzaXplIChwYWNrZWQpIGRvZXMgbm90IHN1cHBvcnQgbW9kZTogJyR7bi5tb2RlfSdgKTtzd2l0Y2gobi5jb29yZGluYXRlVHJhbnNmb3JtTW9kZSl7Y2FzZSJhc3ltbWV0cmljIjpfPSJcbiAgICAgICAgICAgICAgICAgICAgdmVjNCBnZXRTb3VyY2VGcmFjSW5kZXgoaXZlYzQgY29vcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVjNChjb29yZHMpIC8gc2NhbGVXSFdIO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIjticmVhaztjYXNlImhhbGZfcGl4ZWwiOl89IlxuICAgICAgICAgICAgICAgICAgICB2ZWM0IGdldFNvdXJjZUZyYWNJbmRleChpdmVjNCBjb29yZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAodmVjNChjb29yZHMpICsgMC41KSAvIHNjYWxlV0hXSCAtIDAuNTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICI7YnJlYWs7Y2FzZSJweXRvcmNoX2hhbGZfcGl4ZWwiOl89YFxuICAgICAgICAgICAgICAgICAgICB2ZWM0IGdldFNvdXJjZUZyYWNJbmRleChpdmVjNCBjb29yZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlYzQgZmNvb3JkcyA9IHZlYzQoY29vcmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2ZWM0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7aH0uMCA+IDEuMCA/IChmY29vcmRzLnggKyAwLjUpIC8gc2NhbGVXSFdILnggLSAwLjUgOiAwLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmfS4wID4gMS4wID8gKGZjb29yZHMueSArIDAuNSkgLyBzY2FsZVdIV0gueSAtIDAuNSA6IDAuMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2h9LjAgPiAxLjAgPyAoZmNvb3Jkcy56ICsgMC41KSAvIHNjYWxlV0hXSC56IC0gMC41IDogMC4wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Zn0uMCA+IDEuMCA/IChmY29vcmRzLncgKyAwLjUpIC8gc2NhbGVXSFdILncgLSAwLjUgOiAwLjBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGA7YnJlYWs7Y2FzZSJhbGlnbl9jb3JuZXJzIjpfPWBcbiAgICAgICAgICAgICAgICAgICAgdmVjNCBnZXRTb3VyY2VGcmFjSW5kZXgoaXZlYzQgY29vcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZWM0IHJlc2l6ZWQgPSB2ZWM0KCR7aH0uMCAtIDEuMCwgJHtmfS4wIC0gMS4wLCAke2h9LjAgLSAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmfS4wIC0gMS4wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlYzQgb3JpZ2luYWwgPSB2ZWM0KCR7bX0uMCAtIDEuMCwgJHtifS4wIC0gMS4wLCAke219LjAgLSAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtifS4wIC0gMS4wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlYzQgbmV3X3NjYWxlID0gb3JpZ2luYWwgLyByZXNpemVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZlYzQoY29vcmRzKSAqIG5ld19zY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGA7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHJlc2l6ZSAocGFja2VkKSBkb2VzIG5vdCBzdXBwb3J0IGNvb3JkaW5hdGVUcmFuc2Zvcm1Nb2RlOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcke24uY29vcmRpbmF0ZVRyYW5zZm9ybU1vZGV9J2ApfWNvbnN0IHc9KDAsIGkuZ2V0Q29vcmRzRGF0YVR5cGUpKGQpLFQ9YFxuICAgICAgICAgICAgY29uc3QgdmVjMiBpbnB1dFdIID0gdmVjMigke2J9LjAsICR7bX0uMCk7XG4gICAgICAgICAgICBjb25zdCB2ZWM0IHNjYWxlV0hXSCA9IHZlYzQoZmxvYXQoJHt5fSksIGZsb2F0KCR7dn0pLCBmbG9hdCgke3l9KSwgZmxvYXQoJHt2fSkpO1xuICAgICAgICAgICAgJHsoMCwgcy51bnBhY2tGcm9tQ2hhbm5lbCkoKX1cbiAgICAgICAgICAgICR7X31cbiAgICAgICAgICAgIGZsb2F0IGdldEFWYWx1ZShpbnQgeDEwLCBpbnQgciwgaW50IGMsIGludCBkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldENoYW5uZWwoZ2V0QSh4MTAsIHIsIGMsIGQpLCB2ZWMyKGMsIGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgICAgICAgICAke3d9IHJjID0gZ2V0T3V0cHV0Q29vcmRzKCk7XG5cbiAgICAgICAgICAgICAgICBpbnQgYmF0Y2ggPSByY1swXTtcbiAgICAgICAgICAgICAgICBpbnQgZGVwdGggPSByY1sxXTtcblxuICAgICAgICAgICAgICAgIC8vIHJldHJpZXZlIHRoZSA0IGNvb3JkaW5hdGVzIHRoYXQgaXMgdXNlZCBpbiB0aGUgNCBwYWNrZWQgb3V0cHV0IHZhbHVlcy5cbiAgICAgICAgICAgICAgICBpdmVjNCBjb29yZHMgPSBpdmVjNChyYy53eiwgcmMudyArIDEsIHJjLnogKyAxKTtcblxuICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgc291cmNlIGluZGV4IGluIGZyYWN0aW9uXG4gICAgICAgICAgICAgICAgdmVjNCBzb3VyY2VGcmFjID0gZ2V0U291cmNlRnJhY0luZGV4KGNvb3Jkcyk7XG5cbiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGxvd2VyIGFuZCB1cHBlciBib3VuZCBvZiB0aGUgNCB2YWx1ZXMgdGhhdCB3aWxsIGJlIHBhY2tlZCBpbnRvIG9uZSB0ZXhlbC5cbiAgICAgICAgICAgICAgICBpdmVjNCB4MDAgPSBpdmVjNChtYXgoc291cmNlRnJhYy54eSwgdmVjMigwLjApKSwgbWluKGlucHV0V0ggLSAxLjAsIGNlaWwoc291cmNlRnJhYy54eSkpKTtcbiAgICAgICAgICAgICAgICBpdmVjNCB4MDEgPSBpdmVjNChtYXgoc291cmNlRnJhYy54dywgdmVjMigwLjApKSwgbWluKGlucHV0V0ggLSAxLjAsIGNlaWwoc291cmNlRnJhYy54dykpKTtcbiAgICAgICAgICAgICAgICBpdmVjNCB4MTAgPSBpdmVjNChtYXgoc291cmNlRnJhYy56eSwgdmVjMigwLjApKSwgbWluKGlucHV0V0ggLSAxLjAsIGNlaWwoc291cmNlRnJhYy56eSkpKTtcbiAgICAgICAgICAgICAgICBpdmVjNCB4MTEgPSBpdmVjNChtYXgoc291cmNlRnJhYy56dywgdmVjMigwLjApKSwgbWluKGlucHV0V0ggLSAxLjAsIGNlaWwoc291cmNlRnJhYy56dykpKTtcblxuICAgICAgICAgICAgICAgIGJvb2wgaGFzTmV4dFJvdyA9IHJjLncgPCAke2YtMX07XG4gICAgICAgICAgICAgICAgYm9vbCBoYXNOZXh0Q29sID0gcmMueiA8ICR7aC0xfTtcblxuICAgICAgICAgICAgICAgIC8vIHBhY2sgeDAwLCB4MDEsIHgxMCwgeDExJ3MgdG9wLWxlZnQgY29ybmVyIGludG8gb25lIHZlYzQgc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgdmVjNCB0b3BMZWZ0ID0gdmVjNChcbiAgICAgICAgICAgICAgICAgICAgZ2V0QVZhbHVlKGJhdGNoLCBkZXB0aCwgeDAwLngsIHgwMC55KSxcbiAgICAgICAgICAgICAgICAgICAgaGFzTmV4dENvbCA/IGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgwMS54LCB4MDEueSkgOiAwLjAsXG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRSb3cgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MTAueCwgeDEwLnkpIDogMC4wLFxuICAgICAgICAgICAgICAgICAgICAoaGFzTmV4dFJvdyAmJiBoYXNOZXh0Q29sKSA/IGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgxMS54LCB4MTEueSkgOiAwLjApO1xuXG4gICAgICAgICAgICAgICAgLy8gcGFjayB4MDAsIHgwMSwgeDEwLCB4MTEncyB0b3AtcmlnaHQgY29ybmVyIGludG8gb25lIHZlYzQgc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgdmVjNCB0b3BSaWdodCA9IHZlYzQoXG4gICAgICAgICAgICAgICAgICAgIGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgwMC54LCB4MDAudyksXG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRDb2wgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MDEueCwgeDAxLncpIDogMC4wLFxuICAgICAgICAgICAgICAgICAgICBoYXNOZXh0Um93ID8gZ2V0QVZhbHVlKGJhdGNoLCBkZXB0aCwgeDEwLngsIHgxMC53KSA6IDAuMCxcbiAgICAgICAgICAgICAgICAgICAgKGhhc05leHRSb3cgJiYgaGFzTmV4dENvbCkgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MTEueCwgeDExLncpIDogMC4wKTtcblxuICAgICAgICAgICAgICAgIC8vIHBhY2sgeDAwLCB4MDEsIHgxMCwgeDExJ3MgYm90dG9tLWxlZnQgY29ybmVyIGludG8gb25lIHZlYzQgc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgdmVjNCBib3R0b21MZWZ0ID0gdmVjNChcbiAgICAgICAgICAgICAgICAgICAgZ2V0QVZhbHVlKGJhdGNoLCBkZXB0aCwgeDAwLnosIHgwMC55KSxcbiAgICAgICAgICAgICAgICAgICAgaGFzTmV4dENvbCA/IGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgwMS56LCB4MDEueSkgOiAwLjAsXG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRSb3cgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MTAueiwgeDEwLnkpIDogMC4wLFxuICAgICAgICAgICAgICAgICAgICAoaGFzTmV4dFJvdyAmJiBoYXNOZXh0Q29sKSA/IGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgxMS56LCB4MTEueSkgOiAwLjApO1xuXG4gICAgICAgICAgICAgICAgLy8gcGFjayB4MDAsIHgwMSwgeDEwLCB4MTEncyBib3R0b20tcmlnaHQgY29ybmVyIGludG8gb25lIHZlYzQgc3RydWN0dXJlXG4gICAgICAgICAgICAgICAgdmVjNCBib3R0b21SaWdodCA9IHZlYzQoXG4gICAgICAgICAgICAgICAgICAgIGdldEFWYWx1ZShiYXRjaCwgZGVwdGgsIHgwMC56LCB4MDAudyksXG4gICAgICAgICAgICAgICAgICAgIGhhc05leHRDb2wgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MDEueiwgeDAxLncpIDogMC4wLFxuICAgICAgICAgICAgICAgICAgICBoYXNOZXh0Um93ID8gZ2V0QVZhbHVlKGJhdGNoLCBkZXB0aCwgeDEwLnosIHgxMC53KSA6IDAuMCxcbiAgICAgICAgICAgICAgICAgICAgKGhhc05leHRSb3cgJiYgaGFzTmV4dENvbCkgPyBnZXRBVmFsdWUoYmF0Y2gsIGRlcHRoLCB4MTEueiwgeDExLncpIDogMC4wKTtcblxuICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgaW50ZXJwb2xhdGlvbiBmcmFjdGlvbiBvbiB1IGFuZCB2IGRpcmVjdGlvblxuICAgICAgICAgICAgICAgIHZlYzQgZnJhYyA9IHZlYzQoc291cmNlRnJhYykgLSBmbG9vcihzb3VyY2VGcmFjKTtcbiAgICAgICAgICAgICAgICB2ZWM0IGNsYW1wRnJhYyA9IGNsYW1wKGZyYWMsIHZlYzQoMC4wKSwgdmVjNCgxLjApKTtcblxuICAgICAgICAgICAgICAgIHZlYzQgdG9wID0gbWl4KHRvcExlZnQsIHRvcFJpZ2h0LCBjbGFtcEZyYWMueXd5dyk7XG4gICAgICAgICAgICAgICAgdmVjNCBib3R0b20gPSBtaXgoYm90dG9tTGVmdCwgYm90dG9tUmlnaHQsIGNsYW1wRnJhYy55d3l3KTtcbiAgICAgICAgICAgICAgICB2ZWM0IG5ld1ZhbHVlID0gbWl4KHRvcCwgYm90dG9tLCBjbGFtcEZyYWMueHh6eik7XG5cbiAgICAgICAgICAgICAgICAke2Eub3V0cHV0fSA9IHZlYzQobmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICBgO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdSkse291dHB1dDp7ZGltczpwLHR5cGU6dFswXS50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUucGFja2VkfSxoYXNNYWluOiEwLHNoYWRlclNvdXJjZTpUfSl9LGM9KGUsdCk9Pntjb25zdCBuPWVbMF0uZGltcztsZXQgcixvPXQuc2NhbGVzO2lmKDA9PT1vLmxlbmd0aCl7Y29uc3QgaT1lW3Quc2NhbGVzSW5wdXRJZHhdO2lmKGkmJjAhPT1pLnNpemUpe2lmKGVbdC5zaXplc0lucHV0SWR4XSl0aHJvdyBuZXcgRXJyb3IoIk9ubHkgb25lIG9mIHNjYWxlcyBvciBzaXplcyBtdXN0IGJlIHByb3ZpZGVkIGFzIGlucHV0LiIpO289cChpLHQubW9kZSx0LmlzUmVzaXplKTt9ZWxzZSB7Y29uc3QgaT1lW3Quc2l6ZXNJbnB1dElkeF07aWYoIWl8fDA9PT1pLnNpemUpdGhyb3cgbmV3IEVycm9yKCJFaXRoZXIgc2NhbGVzIG9yIHNpemVzIE1VU1QgYmUgcHJvdmlkZWQgYXMgaW5wdXQuIik7cj1BcnJheS5mcm9tKGkuaW50ZWdlckRhdGEpLG89ZChyLG4sdC5tb2RlLHQuaXNSZXNpemUpO319ZWxzZSBpZihlW3Quc2l6ZXNJbnB1dElkeF0pdGhyb3cgbmV3IEVycm9yKCJPbmx5IG9uZSBvZiBzY2FsZXMgb3Igc2l6ZXMgbXVzdCBiZSBwcm92aWRlZCBhcyBpbnB1dC4iKTtjb25zdCBpPXJ8fG4ubWFwKCgoZSx0KT0+TWF0aC5mbG9vcihlKm9bdF0pKSk7cmV0dXJuIFtvLGldfSxwPShlLHQsbik9Pntjb25zdCByPUFycmF5LmZyb20oZS5mbG9hdERhdGEpO3JldHVybiAoMCwgYS5zY2FsZXNWYWxpZGF0aW9uKShyLHQsbikscn0sZD0oZSx0LG4scik9Pntjb25zdCBvPXQubGVuZ3RoLGk9bmV3IEFycmF5KG8pO2ZvcihsZXQgbj0wLHI9bztuPHI7bisrKWlmKDA9PT10W25dKXtpZigwIT09ZVtuXSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IGRpbSBpcyB6ZXJvIGJ1dCByZXF1aXJlZCBvdXRwdXQgZGltIGlzIG5vbi16ZXJvLiIpO2lbbl09MTt9ZWxzZSBpW25dPWVbbl0vdFtuXTtyZXR1cm4gKDAsIGEuc2NhbGVzVmFsaWRhdGlvbikoaSxuLHIpLGl9O30sNTY1OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5zaGFwZT12b2lkIDA7Y29uc3Qgcj1uKDkyNDApO3Quc2hhcGU9KGUsdCk9PihvKHQpLFtuZXcgci5UZW5zb3IoW3RbMF0uZGltcy5sZW5ndGhdLCJpbnQzMiIsdm9pZCAwLHZvaWQgMCxuZXcgSW50MzJBcnJheSh0WzBdLmRpbXMpKV0pO2NvbnN0IG89ZT0+e2lmKCFlfHwxIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJTaGFwZSByZXF1aXJlcyAxIGlucHV0LiIpfTt9LDI0NDQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnNsaWNlVjEwPXQucGFyc2VTbGljZUF0dHJpYnV0ZXM9dC5zbGljZT12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big2MTQ1KSxpPW4oNzI3Mykscz1uKDU2MzkpLGE9e25hbWU6IlNsaWNlIixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W3MuVGV4dHVyZVR5cGUudW5wYWNrZWRdfTt0LnNsaWNlPShlLHQsbik9PihsKHQpLFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2NhY2hlSGludDpuLmNhY2hlS2V5LGdldDooKT0+dShlLHRbMF0sbil9KSx0KV0pLHQucGFyc2VTbGljZUF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEludHMoInN0YXJ0cyIpLG49ZS5hdHRyaWJ1dGVzLmdldEludHMoImVuZHMiKSxvPWUuYXR0cmlidXRlcy5nZXRJbnRzKCJheGVzIixbXSk7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe3N0YXJ0czp0LGVuZHM6bixheGVzOm99KX07Y29uc3QgdT0oZSx0LG4pPT57Y29uc3Qgcj0wPT09bi5heGVzLmxlbmd0aD90LmRpbXMuc2xpY2UoMCkubWFwKCgoZSx0KT0+dCkpOm4uYXhlcyxvPWkuU2hhcGVVdGlsLm5vcm1hbGl6ZUF4ZXMocix0LmRpbXMubGVuZ3RoKSx1PW4uc3RhcnRzLm1hcCgoKGUsbik9PmU+dC5kaW1zW29bbl1dLTE/dC5kaW1zW29bbl1dOmkuU2hhcGVVdGlsLm5vcm1hbGl6ZUF4aXMoZSx0LmRpbXNbb1tuXV0pKSksbD1uLmVuZHMubWFwKCgoZSxuKT0+ZT50LmRpbXNbb1tuXV0tMT90LmRpbXNbb1tuXV06aS5TaGFwZVV0aWwubm9ybWFsaXplQXhpcyhlLHQuZGltc1tvW25dXSkpKSxjPXQuZGltcy5zbGljZSgpLHA9W107Zm9yKGxldCBlPTA7ZTxvLmxlbmd0aDtlKyspY1tvW2VdXT1sW2VdLXVbZV0sdVtlXT4wJiZwLnB1c2goYG91dHB1dElkeFske29bZV19XSArPSAke3VbZV19O2ApO2NvbnN0IGQ9YFxuICAgICAgZmxvYXQgcHJvY2VzcyhpbnQgb3V0cHV0SWR4WyR7Yy5sZW5ndGh9XSkge1xuICAgICAgICAke3Auam9pbigiXG4gICAgICAiKX1cbiAgICAgICAgcmV0dXJuIF9BKG91dHB1dElkeCk7XG4gICAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGEpLHtvdXRwdXQ6e2RpbXM6Yyx0eXBlOnQudHlwZSx0ZXh0dXJlVHlwZTpzLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6ZH0pfSxsPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiU2xpY2UgcmVxdWlyZXMgMSBpbnB1dC4iKTtpZigtMT09PW8uTlVNQkVSX1RZUEVTLmluZGV4T2YoZVswXS50eXBlKSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKX07dC5zbGljZVYxMD0oZSx0KT0+e3AodCk7Y29uc3Qgbj1jKGUsdCk7cmV0dXJuIFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYSkse2NhY2hlSGludDpuLmNhY2hlS2V5LGdldDooKT0+dShlLHRbMF0sbil9KSxbdFswXV0pXX07Y29uc3QgYz0oZSx0KT0+e2lmKCFlLnNlc3Npb24uaXNJbml0aWFsaXplcih0WzFdLmRhdGFJZCl8fCFlLnNlc3Npb24uaXNJbml0aWFsaXplcih0WzJdLmRhdGFJZCl8fHQubGVuZ3RoPj00JiYhZS5zZXNzaW9uLmlzSW5pdGlhbGl6ZXIodFszXS5kYXRhSWQpfHx0Lmxlbmd0aD49NSYmIWUuc2Vzc2lvbi5pc0luaXRpYWxpemVyKHRbNF0uZGF0YUlkKSl0aHJvdyBuZXcgRXJyb3IoImR5bmFtaWMgc2xpY2UgYXR0cmlidXRlcyBhcmUgbm90IGFsbG93ZWQiKTtpZih0Lmxlbmd0aD49NSYmdFs0XS5pbnRlZ2VyRGF0YS5zb21lKChlPT4xIT09ZSkpKXRocm93IG5ldyBFcnJvcigiY3VycmVudGx5IG5vbi0xIHN0ZXBzIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIFNsaWNlIik7Y29uc3Qgbj1BcnJheS5mcm9tKHRbMV0uaW50ZWdlckRhdGEpLHI9QXJyYXkuZnJvbSh0WzJdLmludGVnZXJEYXRhKSxvPXQubGVuZ3RoPj00P0FycmF5LmZyb20odFszXS5pbnRlZ2VyRGF0YSk6W107cmV0dXJuIHtzdGFydHM6bixlbmRzOnIsYXhlczpvLGNhY2hlS2V5OmAke299OyR7bn07JHtyfWB9fSxwPWU9PntpZighZXx8ZS5sZW5ndGg8M3x8ZS5sZW5ndGg+NSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgbnVtYmVyLiIpO2lmKCJpbnQzMiIhPT1lWzFdLnR5cGV8fDEhPT1lWzFdLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpO2lmKCJpbnQzMiIhPT1lWzJdLnR5cGV8fDEhPT1lWzJdLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpO2lmKGUubGVuZ3RoPj00JiYoImludDMyIiE9PWVbM10udHlwZXx8MSE9PWVbM10uZGltcy5sZW5ndGgpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpO2lmKGUubGVuZ3RoPj01JiYoImludDMyIiE9PWVbNF0udHlwZXx8MSE9PWVbNF0uZGltcy5sZW5ndGgpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt9LDgxNTooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuc29mdG1heFYxMz10LnBhcnNlU29mdG1heEF0dHJpYnV0ZXNWMTM9dC5wYXJzZVNvZnRtYXhBdHRyaWJ1dGVzPXQuc29mdG1heD12b2lkIDA7Y29uc3Qgcj1uKDQ5MTApLG89big3MjczKSxpPW4oNjc1Nykscz1uKDU2MzkpLGE9big1NzA3KSx1PXtuYW1lOiJTb2Z0bWF4Q29tcHV0ZU1heCIsaW5wdXROYW1lczpbIkEiXSxpbnB1dFR5cGVzOltzLlRleHR1cmVUeXBlLnVucGFja2VkXX0sbD17bmFtZToiU29mdG1heENvbXB1dGVTY2FsZSIsaW5wdXROYW1lczpbIkEiLCJNYXgiXSxpbnB1dFR5cGVzOltzLlRleHR1cmVUeXBlLnVucGFja2VkLHMuVGV4dHVyZVR5cGUudW5wYWNrZWRdfSxjPXtuYW1lOiJTb2Z0TWF4IixpbnB1dE5hbWVzOlsiQSIsIk1heCIsIk5vcm0iXSxpbnB1dFR5cGVzOltzLlRleHR1cmVUeXBlLnVucGFja2VkLHMuVGV4dHVyZVR5cGUudW5wYWNrZWQscy5UZXh0dXJlVHlwZS51bnBhY2tlZF19O3Quc29mdG1heD0oZSx0LG4pPT57Zyh0KTtjb25zdCByPXRbMF0uZGltcy5zbGljZSgpLGk9by5TaGFwZVV0aWwubm9ybWFsaXplQXhpcyhuLmF4aXMsci5sZW5ndGgpLHM9by5TaGFwZVV0aWwuc2l6ZVRvRGltZW5zaW9uKHIsaSksYT1vLlNoYXBlVXRpbC5zaXplRnJvbURpbWVuc2lvbihyLGkpO3JldHVybiBwKGUsdCxuLHMsYSl9LHQucGFyc2VTb2Z0bWF4QXR0cmlidXRlcz1lPT4oMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHtheGlzOmUuYXR0cmlidXRlcy5nZXRJbnQoImF4aXMiLDEpfSksdC5wYXJzZVNvZnRtYXhBdHRyaWJ1dGVzVjEzPWU9PigwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2F4aXM6ZS5hdHRyaWJ1dGVzLmdldEludCgiYXhpcyIsLTEpfSksdC5zb2Z0bWF4VjEzPShlLHQsbik9PntnKHQpO2NvbnN0IGk9dFswXS5kaW1zLnNsaWNlKCkscz1vLlNoYXBlVXRpbC5ub3JtYWxpemVBeGlzKG4uYXhpcyxpLmxlbmd0aCksdT1pLmxlbmd0aCxsPXMhPT11LTEsYz1bXTtsZXQgZCxmPVtdLGg9W107bCYmKGY9QXJyYXkuZnJvbSh7bGVuZ3RoOnV9KS5tYXAoKChlLHQpPT50KSksZltzXT11LTEsZlt1LTFdPXMsZi5tYXAoKGU9PmMucHVzaChpW2VdKSkpLGQ9KDAsIHIuY3JlYXRlQXR0cmlidXRlV2l0aENhY2hlS2V5KSh7cGVybTpmfSksaD0oMCwgYS50cmFuc3Bvc2UpKGUsdCxkKSk7Y29uc3QgYj1sP28uU2hhcGVVdGlsLnNpemVUb0RpbWVuc2lvbihjLHUtMSk6by5TaGFwZVV0aWwuc2l6ZVRvRGltZW5zaW9uKGksdS0xKSxtPWw/by5TaGFwZVV0aWwuc2l6ZUZyb21EaW1lbnNpb24oYyx1LTEpOm8uU2hhcGVVdGlsLnNpemVGcm9tRGltZW5zaW9uKGksdS0xKSx5PXAoZSxsP2g6dCxuLGIsbSk7cmV0dXJuIGw/KDAsIGEudHJhbnNwb3NlKShlLHksZCk6eX07Y29uc3QgcD0oZSx0LG4scixvKT0+e2NvbnN0IGk9ZChlLHRbMF0scixvLFtyXSkscz1lLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdSkse2NhY2hlSGludDpuLmNhY2hlS2V5LGdldDooKT0+aX0pLHQpLGE9ZihlLHRbMF0scixvLGkub3V0cHV0LmRpbXMsW3JdKSxwPWUucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxsKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXksZ2V0OigpPT5hfSksW3RbMF0sc10pLGc9aChlLHRbMF0scixvLGkub3V0cHV0LmRpbXMsYS5vdXRwdXQuZGltcyk7cmV0dXJuIFtlLnJ1bihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYykse2NhY2hlSGludDpuLmNhY2hlS2V5LGdldDooKT0+Z30pLFt0WzBdLHMscF0pXX0sZD0oZSx0LG4scixvKT0+e2NvbnN0W2EsbF09ZS5jYWxjdWxhdGVUZXh0dXJlV2lkdGhBbmRIZWlnaHQodC5kaW1zLHMuVGV4dHVyZVR5cGUudW5wYWNrZWQpLGM9by5sZW5ndGg7aWYobjwxfHxyPDEpdGhyb3cgbmV3IEVycm9yKCJMb2dpY2FsIHJvdyBjb3VudCBOIGFuZCBmZWF0dXJlIGNvdW50IEQgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMSIpO2lmKDEhPT1vLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkRpbWVuc2lvbmFsaXR5IG9mIHRoZSBvdXRwdXQgc2hvdWxkIGJlIDEiKTtpZihvWzBdIT09bil0aHJvdyBuZXcgRXJyb3IoIlNoYXBlIG9mIHRoZSBvdXRwdXQgc2hvdWxkIGJlIGVxdWFsIHRvIGxvZ2ljYWwgcm93IGNvdW50Iik7Y29uc3QgcD0oMCwgaS5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksZD1gXG4gICAgICBmbG9hdCBwcm9jZXNzKGludFske2N9XSBpbmRpY2VzKSB7XG4gICAgICAgIGludCBsb2dpY2FsX3Jvd19zdGFydF9vZmZzZXQgPSBpbmRpY2VzWzBdICogJHtyfTtcblxuICAgICAgICBmbG9hdCBtYXggPSBnZXRDb2xvckFzRmxvYXQoJHtwLnRleHR1cmUyRH0oQSwgb2Zmc2V0VG9Db29yZHMobG9naWNhbF9yb3dfc3RhcnRfb2Zmc2V0LCAke2F9LFxuICAgICAgICAke2x9ICkpKTtcbiAgICAgICAgZm9yKGludCBpPTE7IGk8JHtyfTsgKytpKVxuICAgICAgICB7XG4gICAgICAgICAgZmxvYXQgY3VycmVudCA9IGdldENvbG9yQXNGbG9hdCgke3AudGV4dHVyZTJEfShBLCBvZmZzZXRUb0Nvb3Jkcyhsb2dpY2FsX3Jvd19zdGFydF9vZmZzZXQgKyBpLFxuICAgICAgICAgICAgJHthfSwgJHtsfSkpKTtcbiAgICAgICAgICBpZihjdXJyZW50ID4gbWF4KVxuICAgICAgICAgIG1heCA9IGN1cnJlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbWF4O1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx1KSx7b3V0cHV0OntkaW1zOm8sdHlwZTp0LnR5cGUsdGV4dHVyZVR5cGU6cy5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOmR9KX0sZj0oZSx0LG4scixvLGEpPT57Y29uc3RbdSxjXT1lLmNhbGN1bGF0ZVRleHR1cmVXaWR0aEFuZEhlaWdodCh0LmRpbXMscy5UZXh0dXJlVHlwZS51bnBhY2tlZCkscD1hLmxlbmd0aDtpZihuPDF8fHI8MSl0aHJvdyBuZXcgRXJyb3IoIkxvZ2ljYWwgcm93IGNvdW50IE4gYW5kIGZlYXR1cmUgY291bnQgRCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAxIik7aWYoMSE9PWEubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiRGltZW5zaW9uYWxpdHkgb2YgdGhlIG91dHB1dCBzaG91bGQgYmUgMSIpO2lmKGFbMF0hPT1uKXRocm93IG5ldyBFcnJvcigiU2hhcGUgb2YgdGhlIG91dHB1dCBzaG91bGQgYmUgZXF1YWwgdG8gbG9naWNhbCByb3cgY291bnQiKTtpZigxIT09by5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJEaW1lbnNpb25hbGl0eSBvZiB0aGUgaW50ZXJtZWRpYXRlIHJlc3VsdHMgc2hvdWxkIGJlIDEiKTtpZihvWzBdIT09bil0aHJvdyBuZXcgRXJyb3IoIlNoYXBlIG9mIHRoZSBpbnRlcm1lZGlhdGUgcmVzdWx0cyBzaG91bGQgYmUgZXF1YWwgdG8gbG9naWNhbCByb3cgY291bnQiKTtjb25zdCBkPWBcbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50WyR7cH1dIGluZGljZXMpIHtcbiAgICAgICAgaW50IGxvZ2ljYWxfcm93X3N0YXJ0X29mZnNldCA9IGluZGljZXNbMF0gKiAke3J9O1xuXG4gICAgICAgIGZsb2F0IG5vcm1fZmFjdG9yID0gMC4wO1xuICAgICAgICBmbG9hdCBtYXggPSBfTWF4KGluZGljZXMpO1xuICAgICAgICBmb3IoaW50IGk9MDsgaTwke3J9OyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICBub3JtX2ZhY3RvciArPSBleHAoZ2V0Q29sb3JBc0Zsb2F0KCR7KDAsIGkuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pLnRleHR1cmUyRH0oQSwgb2Zmc2V0VG9Db29yZHMobG9naWNhbF9yb3dfc3RhcnRfb2Zmc2V0ICsgaSxcbiAgICAgICAgICAgICR7dX0sICR7Y30pKSkgLSBtYXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5vcm1fZmFjdG9yO1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxsKSx7b3V0cHV0OntkaW1zOmEsdHlwZTp0LnR5cGUsdGV4dHVyZVR5cGU6cy5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOmR9KX0saD0oZSx0LG4scixvLGkpPT57Y29uc3RbYSx1XT1lLmNhbGN1bGF0ZVRleHR1cmVXaWR0aEFuZEhlaWdodCh0LmRpbXMscy5UZXh0dXJlVHlwZS51bnBhY2tlZCksbD10LmRpbXMubGVuZ3RoO2lmKG48MXx8cjwxKXRocm93IG5ldyBFcnJvcigiTG9naWNhbCByb3cgY291bnQgTiBhbmQgZmVhdHVyZSBjb3VudCBEIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDEiKTtpZigxIT09by5sZW5ndGh8fDEhPT1pLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkRpbWVuc2lvbmFsaXR5IG9mIHRoZSBpbnRlcm1lZGlhdGUgcmVzdWx0cyBzaG91bGQgYmUgMSIpO2lmKG9bMF0hPT1ufHxpWzBdIT09bil0aHJvdyBuZXcgRXJyb3IoIlNoYXBlIG9mIHRoZSBpbnRlcm1lZGlhdGUgcmVzdWx0cyBzaG91bGQgYmUgZXF1YWwgdG8gbG9naWNhbCByb3cgY291bnQiKTtjb25zdCBwPWBcbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50WyR7bH1dIGluZGljZXMpIHtcblxuICAgICAgLy8gZ2V0IG9mZnNldCBvZiBjdXJyZW50IGxvZ2ljYWwgdGVuc29yIGluZGV4IGZyb20gdGhlIDItRCB0ZXh0dXJlIGNvb3JkaW5hdGVzIChUZXhDb29yZHMpXG4gICAgICBpbnQgb2Zmc2V0ID0gY29vcmRzVG9PZmZzZXQoVGV4Q29vcmRzLCAke2F9LCAke3V9KTtcblxuICAgICAgLy9kZXRlcm1pbmUgdGhlIGxvZ2ljYWwgcm93IGZvciB0aGlzIGluZGV4XG4gICAgICBpbnQgbG9naWNhbF9yb3dfaW5kZXhbMV07XG4gICAgICBsb2dpY2FsX3Jvd19pbmRleFswXSA9IG9mZnNldCAvICR7cn07XG5cbiAgICAgIGZsb2F0IG5vcm1fZmFjdG9yID0gX05vcm0obG9naWNhbF9yb3dfaW5kZXgpO1xuXG4gICAgICAvLyBhdm9pZCBwb3NzaWJsZSBkaXZpc2lvbiBieSAwXG4gICAgICAvLyBpZiBub3JtX2ZhY29yIGlzIDAsIGFsbCBlbGVtZW50cyBhcmUgemVyb1xuICAgICAgLy8gaWYgc28sIHJldHVybiAwXG4gICAgICBpZihub3JtX2ZhY3RvciA9PSAwLjApXG4gICAgICAgIHJldHVybiAwLjA7XG5cbiAgICAgIHJldHVybiBleHAoX0EoaW5kaWNlcykgLSBfTWF4KGxvZ2ljYWxfcm93X2luZGV4KSkgLyBub3JtX2ZhY3RvcjtcbiAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGMpLHtvdXRwdXQ6e2RpbXM6dC5kaW1zLHR5cGU6dC50eXBlLHRleHR1cmVUeXBlOnMuVGV4dHVyZVR5cGUudW5wYWNrZWR9LHNoYWRlclNvdXJjZTpwfSl9LGc9ZT0+e2lmKCFlfHwxIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJTb2Z0bWF4IHJlcXVpcmVzIDEgaW5wdXQuIik7aWYoImZsb2F0MzIiIT09ZVswXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzBdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHR5cGUiKX07fSw1NjQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlU3BsaXRBdHRyaWJ1dGVzPXQuc3BsaXQ9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNzI3MyksaT1uKDU2MzkpLHM9e25hbWU6IlNwbGl0IixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W2kuVGV4dHVyZVR5cGUudW5wYWNrZWRdfTt0LnNwbGl0PShlLHQsbik9PntsKHQpO2NvbnN0IHI9by5TaGFwZVV0aWwubm9ybWFsaXplQXhpcyhuLmF4aXMsdFswXS5kaW1zLmxlbmd0aCksaT1hKGUsdCxyLG4pLGM9W107Zm9yKGxldCBvPTA7bzxpOysrbyljLnB1c2goZS5ydW4oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtjYWNoZUhpbnQ6YCR7bi5jYWNoZUtleX07JHtvfWAsZ2V0OigpPT51KGUsdFswXSxuLHIsbyl9KSx0KSk7cmV0dXJuIGN9LHQucGFyc2VTcGxpdEF0dHJpYnV0ZXM9ZT0+e2NvbnN0IHQ9ZS5hdHRyaWJ1dGVzLmdldEludCgiYXhpcyIsMCksbj1lLmF0dHJpYnV0ZXMuZ2V0SW50cygic3BsaXQiLFtdKSxvPWUub3V0cHV0cy5sZW5ndGg7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2F4aXM6dCxzcGxpdDpuLG51bU91dHB1dHM6b30pfTtjb25zdCBhPShlLHQsbixyKT0+e2NvbnN0WyxpXT1vLlNwbGl0VXRpbC5zcGxpdFNoYXBlKHRbMF0uZGltcyxuLHIuc3BsaXQsci5udW1PdXRwdXRzKTtyZXR1cm4gaS5sZW5ndGh9LHU9KGUsdCxuLHIsYSk9Pntjb25zdFt1LGxdPW8uU3BsaXRVdGlsLnNwbGl0U2hhcGUodC5kaW1zLHIsbi5zcGxpdCxuLm51bU91dHB1dHMpLGM9bFthXSxwPXVbYV0sZD1gXG4gICAgICBmbG9hdCBwcm9jZXNzKGludCBpbmRpY2VzWyR7cC5sZW5ndGh9XSkge1xuICAgICAgICBpbmRpY2VzWyR7cn1dICs9ICR7Y307XG4gICAgICAgIHJldHVybiBfQShpbmRpY2VzKTtcbiAgICAgIH1cbiAgICBgO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scykse2NhY2hlSGludDpgJHtuLmNhY2hlS2V5fToke2F9YCxvdXRwdXQ6e2RpbXM6cCx0eXBlOnQudHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6ZH0pfSxsPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiU3BsaXQgcmVxdWlyZXMgb25lIGlucHV0LiIpO2lmKCJpbnQ4IiE9PWVbMF0udHlwZSYmInVpbnQ4IiE9PWVbMF0udHlwZSYmImludDE2IiE9PWVbMF0udHlwZSYmInVpbnQxNiIhPT1lWzBdLnR5cGUmJiJpbnQzMiIhPT1lWzBdLnR5cGUmJiJ1aW50MzIiIT09ZVswXS50eXBlJiYiZmxvYXQzMiIhPT1lWzBdLnR5cGUmJiJmbG9hdDY0IiE9PWVbMF0udHlwZSYmImJvb2wiIT09ZVswXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt9LDU0MTY6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnBhcnNlU3F1ZWV6ZUF0dHJpYnV0ZXM9dC5zcXVlZXplVjEzPXQuc3F1ZWV6ZT12b2lkIDA7Y29uc3Qgcj1uKDcyNzMpO3Quc3F1ZWV6ZT0oZSx0LG4pPT57byh0KTtjb25zdCBpPXIuU2hhcGVVdGlsLnNxdWVlemVTaGFwZSh0WzBdLmRpbXMsbik7cmV0dXJuIFtlLnJlc2hhcGVVbnBhY2tlZCh0WzBdLGkpXX0sdC5zcXVlZXplVjEzPShlLG4pPT4oaShuKSwoMCwgdC5zcXVlZXplKShlLFtuWzBdXSxBcnJheS5mcm9tKG5bMV0uaW50ZWdlckRhdGEpKSksdC5wYXJzZVNxdWVlemVBdHRyaWJ1dGVzPWU9PmUuYXR0cmlidXRlcy5nZXRJbnRzKCJheGVzIik7Y29uc3Qgbz1lPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlNxdWVlemUgcmVxdWlyZXMgMSBpbnB1dC4iKTtpZigic3RyaW5nIj09PWVbMF0udHlwZSl0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgaW5wdXQgdGVuc29yIHR5cGVzLiIpfSxpPWU9PntpZighZXx8MiE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiU3F1ZWV6ZSByZXF1aXJlcyAyIGlucHV0cy4iKTtpZigiaW50MzIiIT09ZVsxXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCB0eXBlLiIpfTt9LDEyNDA6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnN1bT12b2lkIDA7Y29uc3Qgcj1uKDY3NTcpLG89big1NjM5KTt0LnN1bT0oZSx0KT0+e3ModCk7Y29uc3Qgbj17bmFtZToiU3VtIixpbnB1dE5hbWVzOnQubWFwKCgoZSx0KT0+YFgke3R9YCkpLGlucHV0VHlwZXM6bmV3IEFycmF5KHQubGVuZ3RoKS5maWxsKG8uVGV4dHVyZVR5cGUudW5wYWNrZWQpfTtyZXR1cm4gW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7Z2V0OigpPT5pKGUsdCxuKX0pLHQpXX07Y29uc3QgaT0oZSx0LG4pPT57Y29uc3QgaT0oMCwgci5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbikscz10WzBdLmRpbXMuc2xpY2UoKSxhPWBcbiAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgdmVjNCByZXN1bHQgPSAke3QubWFwKCgoZSx0KT0+YCR7aS50ZXh0dXJlMkR9KFgke3R9LFRleENvb3JkcylgKSkuam9pbigiICsgIil9O1xuICAgICAgICAke2kub3V0cHV0fSA9IHJlc3VsdDtcbiAgICAgIH1cbiAgICBgO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbikse291dHB1dDp7ZGltczpzLHR5cGU6dFswXS50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUudW5wYWNrZWR9LGhhc01haW46ITAsc2hhZGVyU291cmNlOmF9KX0scz1lPT57aWYoIWV8fDA9PT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlN1bSByZXF1aXJlcyBpbnB1dHMuIik7Y29uc3QgdD1lWzBdLmRpbXMubGVuZ3RoO2ZvcihsZXQgbj0xO248ZS5sZW5ndGg7bisrKXtpZih0IT09ZVtuXS5kaW1zLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIklucHV0IHNoYXBlcyBhcmUgbWlzbWF0Y2hlZC4iKTtmb3IobGV0IHI9MDtyPHQ7cisrKWlmKGVbMF0uZGltc1tyXSE9PWVbbl0uZGltc1tyXSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IHNoYXBlcyBhcmUgbm90IG1hdGNoZWQuIil9aWYoImZsb2F0MzIiIT09ZVswXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzBdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHR5cGUuIik7Zm9yKGxldCB0PTE7dDxlLmxlbmd0aDt0KyspaWYoZVswXS50eXBlIT09ZVt0XS50eXBlKXRocm93IG5ldyBFcnJvcigiSW5wdXQgdHlwZXMgYXJlIG5vdCBtYXRjaGVkLiIpfTt9LDU5NDQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnRpbGU9dm9pZCAwO2NvbnN0IHI9big2MTQ1KSxvPW4oNTYzOSk7dC50aWxlPShlLHQpPT57cyh0KTtjb25zdCBuPXtuYW1lOiJUaWxlIixpbnB1dE5hbWVzOlsiQSJdLGlucHV0VHlwZXM6W28uVGV4dHVyZVR5cGUudW5wYWNrZWRdfTtyZXR1cm4gW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7Z2V0OigpPT5pKGUsdCxuKX0pLHQpXX07Y29uc3QgaT0oZSx0LG4pPT57Y29uc3Qgcj10WzBdLmRpbXMuc2xpY2UoKSxpPW5ldyBBcnJheShyLmxlbmd0aCkscz1bXTtmb3IobGV0IGU9MDtlPHIubGVuZ3RoO2UrKylpW2VdPXJbZV0qdFsxXS5udW1iZXJEYXRhW2VdLHMucHVzaChgaW5wdXRJZHhbJHtlfV0gPSBpbnQobW9kKGZsb2F0KG91dHB1dElkeFske2V9XSksICR7cltlXX0uKSk7YCk7Y29uc3QgYT1pLmxlbmd0aCx1PWBcbiAgICAgIGZsb2F0IHByb2Nlc3MoaW50IG91dHB1dElkeFske2F9XSkge1xuICAgICAgICBpbnQgaW5wdXRJZHhbJHthfV07XG4gICAgICAgICR7cy5qb2luKCJcbiIpfVxuICAgICAgICByZXR1cm4gX0EoaW5wdXRJZHgpO1xuICAgICAgfVxuICAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7b3V0cHV0OntkaW1zOmksdHlwZTp0WzBdLnR5cGUsdGV4dHVyZVR5cGU6by5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOnV9KX0scz1lPT57aWYoIWV8fDIhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlRpbGUgcmVxdWlyZXMgMiBpbnB1dC4iKTtpZigxIT09ZVsxXS5kaW1zLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlRoZSBzZWNvbmQgaW5wdXQgc2hhcGUgbXVzdCAxIGRpbWVuc2lvbi4iKTtpZihlWzFdLmRpbXNbMF0hPT1lWzBdLmRpbXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBpbnB1dCBzaGFwZS4iKTtpZigtMT09PXIuTlVNQkVSX1RZUEVTLmluZGV4T2YoZVswXS50eXBlKSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKTtpZigiaW50MzIiIT09ZVsxXS50eXBlJiYiaW50MTYiIT09ZVsxXS50eXBlKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCByZXBlYXQgdHlwZS4iKX07fSw1NzA3OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5wYXJzZVRyYW5zcG9zZUF0dHJpYnV0ZXM9dC50cmFuc3Bvc2U9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNzI3MyksaT1uKDU2MzkpLHM9e25hbWU6IlRyYW5zcG9zZSIsaW5wdXROYW1lczpbIkEiXSxpbnB1dFR5cGVzOltpLlRleHR1cmVUeXBlLnVucGFja2VkXX07dC50cmFuc3Bvc2U9KGUsdCxuKT0+KHAodCksW2UucnVuKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxzKSx7Y2FjaGVIaW50Om4uY2FjaGVLZXksZ2V0OigpPT5hKGUsdFswXSxuLnBlcm0pfSksdCldKSx0LnBhcnNlVHJhbnNwb3NlQXR0cmlidXRlcz1lPT4oMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHtwZXJtOmUuYXR0cmlidXRlcy5nZXRJbnRzKCJwZXJtIixbXSl9KTtjb25zdCBhPShlLHQsbik9Pntjb25zdCByPXQuZGltcztuPXUocixuKTtjb25zdCBvPWwocixuKSxhPXIubGVuZ3RoLHA9YFxuICAgICAgJHtjKCJwZXJtIixuLGEpfVxuICAgICAgZmxvYXQgcHJvY2VzcyhpbnQgaW5kaWNlc1ske2F9XSkge1xuICAgICAgICBpbnQgYVske2F9XTtcbiAgICAgICAgcGVybShhLCBpbmRpY2VzKTtcbiAgICAgICAgcmV0dXJuIF9BKGEpO1xuICAgICAgfWA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxzKSx7b3V0cHV0OntkaW1zOm8sdHlwZTp0LnR5cGUsdGV4dHVyZVR5cGU6aS5UZXh0dXJlVHlwZS51bnBhY2tlZH0sc2hhZGVyU291cmNlOnB9KX0sdT0oZSx0KT0+KHQmJnQubGVuZ3RoIT09ZS5sZW5ndGgmJih0PVsuLi5lLmtleXMoKV0ucmV2ZXJzZSgpKSx0KSxsPShlLHQpPT4odD11KGUsdCksby5TaGFwZVV0aWwuc29ydEJhc2VkT25QZXJtKGUsdCkpLGM9KGUsdCxuKT0+e2NvbnN0IHI9W107ci5wdXNoKGB2b2lkICR7ZX0ob3V0IGludCBhWyR7bn1dLCBpbnQgc3JjWyR7bn1dKSB7YCk7Zm9yKGxldCBlPTA7ZTxuOysrZSlyLnB1c2goYFx0YVske3RbZV19XT1zcmNbJHtlfV07YCk7cmV0dXJuIHIucHVzaCgiXHR9Iiksci5qb2luKCJcbiIpfSxwPWU9PntpZighZXx8MSE9PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVHJhbnNwb3NlIHJlcXVpcmVzIDEgaW5wdXQuIik7aWYoImZsb2F0MzIiIT09ZVswXS50eXBlJiYiZmxvYXQ2NCIhPT1lWzBdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJpbnB1dCBzaG91bGQgYmUgZmxvYXQgdGVuc29yIil9O30sMjQ4ODooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZW5jb2RlQXNVaW50OD12b2lkIDA7Y29uc3Qgcj1uKDY3NTcpLG89big1NjM5KTt0LmVuY29kZUFzVWludDg9KGUsdCk9Pntjb25zdCBuPXQuc2hhcGUsaT0oMCwgci5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbikscz1gXG4gICAgY29uc3QgZmxvYXQgRkxPQVRfTUFYID0gMS43MDE0MTE4NGUzODtcbiAgICBjb25zdCBmbG9hdCBGTE9BVF9NSU4gPSAxLjE3NTQ5NDM1ZS0zODtcblxuICAgIGJvb2wgaXNOYU4oZmxvYXQgdmFsKSB7XG4gICAgICByZXR1cm4gKHZhbCA8IDEuMCB8fCAwLjAgPCB2YWwgfHwgdmFsID09IDAuMCkgPyBmYWxzZSA6IHRydWU7XG4gICAgfVxuXG4gICAgaGlnaHAgdmVjNCBlbmNvZGVBc1VpbnQ4KGhpZ2hwIGZsb2F0IHYpIHtcbiAgICAgIGlmIChpc05hTih2KSkge1xuICAgICAgICByZXR1cm4gdmVjNCgyNTUsIDI1NSwgMjU1LCAyNTUpO1xuICAgICAgfVxuXG4gICAgICBoaWdocCBmbG9hdCBhdiA9IGFicyh2KTtcblxuICAgICAgaWYoYXYgPCBGTE9BVF9NSU4pIHtcbiAgICAgICAgcmV0dXJuIHZlYzQoMC4wLCAwLjAsIDAuMCwgMC4wKTtcbiAgICAgIH0gZWxzZSBpZih2ID4gRkxPQVRfTUFYKSB7XG4gICAgICAgIHJldHVybiB2ZWM0KDAuMCwgMC4wLCAxMjguMCwgMTI3LjApIC8gMjU1LjA7XG4gICAgICB9IGVsc2UgaWYodiA8IC1GTE9BVF9NQVgpIHtcbiAgICAgICAgcmV0dXJuIHZlYzQoMC4wLCAwLjAsICAxMjguMCwgMjU1LjApIC8gMjU1LjA7XG4gICAgICB9XG5cbiAgICAgIGhpZ2hwIHZlYzQgYyA9IHZlYzQoMCwwLDAsMCk7XG5cbiAgICAgIGhpZ2hwIGZsb2F0IGUgPSBmbG9vcihsb2cyKGF2KSk7XG4gICAgICBoaWdocCBmbG9hdCBtID0gZXhwMihmcmFjdChsb2cyKGF2KSkpIC0gMS4wO1xuXG4gICAgICBjWzJdID0gZmxvb3IoMTI4LjAgKiBtKTtcbiAgICAgIG0gLT0gY1syXSAvIDEyOC4wO1xuICAgICAgY1sxXSA9IGZsb29yKDMyNzY4LjAgKiBtKTtcbiAgICAgIG0gLT0gY1sxXSAvIDMyNzY4LjA7XG4gICAgICBjWzBdID0gZmxvb3IoODM4ODYwOC4wICogbSk7XG5cbiAgICAgIGhpZ2hwIGZsb2F0IGViaWFzID0gZSArIDEyNy4wO1xuICAgICAgY1szXSA9IGZsb29yKGViaWFzIC8gMi4wKTtcbiAgICAgIGViaWFzIC09IGNbM10gKiAyLjA7XG4gICAgICBjWzJdICs9IGZsb29yKGViaWFzKSAqIDEyOC4wO1xuXG4gICAgICBjWzNdICs9IDEyOC4wICogc3RlcCgwLjAsIC12KTtcblxuICAgICAgcmV0dXJuIGMgLyAyNTUuMDtcbiAgICB9XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICBmbG9hdCB2YWx1ZSA9ICR7aS50ZXh0dXJlMkR9KFgsVGV4Q29vcmRzKS5yO1xuICAgICAgJHtpLm91dHB1dH0gPSBlbmNvZGVBc1VpbnQ4KHZhbHVlKTtcbiAgICB9YCxhPXtuYW1lOiJVaW50OEVuY29kZSIsaW5wdXRUeXBlczpbby5UZXh0dXJlVHlwZS51bnBhY2tlZF0saW5wdXROYW1lczpbIlgiXSxvdXRwdXQ6e2RpbXM6bix0eXBlOnQudGVuc29yLnR5cGUsdGV4dHVyZVR5cGU6by5UZXh0dXJlVHlwZS5kb3dubG9hZFVpbnQ4QXNGbG9hdH0sc2hhZGVyU291cmNlOnMsaGFzTWFpbjohMH07cmV0dXJuIGUuZXhlY3V0ZVByb2dyYW0oYSxbdC50ZW5zb3JdKX07fSw5MDg3OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC50YW5oPXQudGFuPXQuc3FydD10LnNpbj10LnNpZ21vaWQ9dC5yZWx1PXQubm90PXQubmVnPXQubG9nPXQucGFyc2VMZWFreVJlbHVBdHRyaWJ1dGVzPXQubGVha3lSZWx1PXQuaWRlbnRpdHk9dC5mbG9vcj10LmV4cD10LnBhcnNlRWx1QXR0cmlidXRlcz10LmVsdT10LmNvcz10LmNlaWw9dC5jbGlwVjExPXQucGFyc2VDbGlwQXR0cmlidXRlcz10LmNsaXA9dC5hdGFuPXQuYXNpbj10LmFjb3M9dC5hYnM9dC5nbHNsVGFuaD10Lmdsc2xUYW49dC5nbHNsU3FydD10Lmdsc2xTaWdtb2lkPXQuZ2xzbFJlbHU9dC5nbHNsU2luPXQuZ2xzbE5vdD10Lmdsc2xOZWc9dC5nbHNsTG9nPXQuZ2xzbExlYWt5UmVsdT10Lmdsc2xJZGVudGl0eT10Lmdsc2xDbGlwPXQuZ2xzbEZsb29yPXQuZ2xzbEV4cD10Lmdsc2xFbHU9dC5nbHNsQ29zPXQuZ2xzbENlaWw9dC5nbHNsQXRhbj10Lmdsc2xBc2luPXQuZ2xzbEFjb3M9dC5nbHNsQWJzPXZvaWQgMDtjb25zdCByPW4oNDkxMCksbz1uKDcyNzMpLGk9bigxOTk3KSxzPW4oNjc1NyksYT1uKDU2MzkpO2Z1bmN0aW9uIHUoKXtyZXR1cm4gRSgiYWJzIil9ZnVuY3Rpb24gbCgpe3JldHVybiBFKCJhY29zIil9ZnVuY3Rpb24gYygpe3JldHVybiBFKCJhc2luIil9ZnVuY3Rpb24gcCgpe3JldHVybiBFKCJhdGFuIil9ZnVuY3Rpb24gZCgpe3JldHVybiBFKCJjZWlsIil9ZnVuY3Rpb24gZigpe3JldHVybiBFKCJjb3MiKX1mdW5jdGlvbiBoKGUpe2NvbnN0IHQ9ImVsdSI7cmV0dXJuIHtib2R5OmBcbiAgY29uc3QgZmxvYXQgYWxwaGEgPSBmbG9hdCgke2V9KTtcblxuICBmbG9hdCAke3R9XyhmbG9hdCBhKSB7XG4gICAgcmV0dXJuIGEgPj0gMC4wID8gYTogKGV4cChhKSAtIDEuMCkgKiBhbHBoYTtcbiAgfVxuICB2ZWM0ICR7dH1fKHZlYzQgdikge1xuICAgIHJldHVybiB2ZWM0KCR7dH1fKHYueCksICR7dH1fKHYueSksICR7dH1fKHYueiksICR7dH1fKHYudykpO1xuICB9XG4gIGAsbmFtZTp0LHR5cGU6aS5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gZygpe3JldHVybiBFKCJleHAiKX1mdW5jdGlvbiBiKCl7cmV0dXJuIEUoImZsb29yIil9ZnVuY3Rpb24gbShlLHQpe2NvbnN0IG49ImNsaXAiO3JldHVybiB7Ym9keTpgXG4gIGNvbnN0IGZsb2F0IG1pbiA9IGZsb2F0KCR7ZX0pO1xuICBjb25zdCBmbG9hdCBtYXggPSBmbG9hdCgke3R9KTtcblxuICBmbG9hdCAke259XyhmbG9hdCBhKSB7XG4gICAgcmV0dXJuIGNsYW1wKGEsIG1pbiwgbWF4KTtcbiAgfVxuICB2ZWM0ICR7bn1fKHZlYzQgdikge1xuICAgIHJldHVybiBjbGFtcCh2LCBtaW4sIG1heCk7XG4gIH1cbiAgYCxuYW1lOm4sdHlwZTppLkZ1bmN0aW9uVHlwZS5WYWx1ZUJhc2VkfX1mdW5jdGlvbiB5KCl7Y29uc3QgZT0iaW5kZW50aXR5IjtyZXR1cm4ge2JvZHk6YFxuICBmbG9hdCAke2V9XyhmbG9hdCBhKSB7XG4gICAgcmV0dXJuIGE7XG4gIH1cbiAgdmVjNCAke2V9Xyh2ZWM0IHYpIHtcbiAgICByZXR1cm4gdjtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIHYoZSl7Y29uc3QgdD0ibGVha3lSZWx1IjtyZXR1cm4ge2JvZHk6YFxuICBjb25zdCBmbG9hdCBhbHBoYSA9IGZsb2F0KCR7ZX0pO1xuXG4gIGZsb2F0ICR7dH1fKGZsb2F0IGEpIHtcbiAgICByZXR1cm4gYSA8IDAuMCA/IGEgKiBhbHBoYSA6IGE7XG4gIH1cbiAgdmVjNCAke3R9Xyh2ZWM0IHYpIHtcbiAgICByZXR1cm4gdmVjNCgke3R9Xyh2LngpLCAke3R9Xyh2LnkpLCAke3R9Xyh2LnopLCAke3R9Xyh2LncpKTtcbiAgfVxuICBgLG5hbWU6dCx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIF8oKXtyZXR1cm4gRSgibG9nIil9ZnVuY3Rpb24gdygpe2NvbnN0IGU9Im5lZyI7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHtlfV8oZmxvYXQgYSkge1xuICAgIHJldHVybiAtYTtcbiAgfVxuICB2ZWM0ICR7ZX1fKHZlYzQgdikge1xuICAgIHJldHVybiAtdjtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIFQoKXtjb25zdCBlPSJub3QiO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX1fKGZsb2F0IGEpIHtcbiAgICByZXR1cm4gZmxvYXQoICEgYm9vbChhKSApO1xuICB9XG4gIGJvb2wgJHtlfV8oYm9vbCBhKSB7XG4gICAgcmV0dXJuICFhO1xuICB9XG4gIHZlYzQgJHtlfV8odmVjNCB2KSB7XG4gICAgcmV0dXJuIHZlYzQoIWJvb2wodi54KSwgIWJvb2wodi55KSwgIWJvb2wodi56KSwgIWJvb2wodi53KSk7XG4gIH1cbiAgYnZlYzQgJHtlfV8oYnZlYzQgdikge1xuICAgIHJldHVybiBidmVjNCghdi54LCAhdi55LCAhdi56LCAhdi53KTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIHgoKXtyZXR1cm4gRSgic2luIil9ZnVuY3Rpb24gTygpe2NvbnN0IGU9InJlbHUiO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX1fKGZsb2F0IGEpIHtcbiAgICByZXR1cm4gbWF4KCBhLCAwLjAgKTtcbiAgfVxuICB2ZWM0ICR7ZX1fKHZlYzQgdikge1xuICAgIHJldHVybiBtYXgoIHYsIDAuMCApO1xuICB9XG4gIGAsbmFtZTplLHR5cGU6aS5GdW5jdGlvblR5cGUuVmFsdWVCYXNlZH19ZnVuY3Rpb24gUygpe2NvbnN0IGU9InNpZ21vaWQiO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX1fKGZsb2F0IGEpIHtcbiAgICByZXR1cm4gMS4wIC8gKDEuMCArIGV4cCgtYSkpO1xuICB9XG4gIHZlYzQgJHtlfV8odmVjNCB2KSB7XG4gICAgcmV0dXJuIDEuMCAvICgxLjAgKyBleHAoLXYpKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIEEoKXtyZXR1cm4gRSgic3FydCIpfWZ1bmN0aW9uIFAoKXtyZXR1cm4gRSgidGFuIil9ZnVuY3Rpb24gSSgpe2NvbnN0IGU9InRhbmgiO3JldHVybiB7Ym9keTpgXG4gIGZsb2F0ICR7ZX1fKGZsb2F0IGEpIHtcbiAgICBhID0gY2xhbXAoYSwgLTEwLiwgMTAuKTtcbiAgICBhID0gZXhwKDIuKmEpO1xuICAgIHJldHVybiAoYSAtIDEuKSAvIChhICsgMS4pO1xuICB9XG4gIHZlYzQgJHtlfV8odmVjNCB2KSB7XG4gICAgdiA9IGNsYW1wKHYsIC0xMC4sIDEwLik7XG4gICAgdiA9IGV4cCgyLip2KTtcbiAgICByZXR1cm4gKHYgLSAxLikgLyAodiArIDEuKTtcbiAgfVxuICBgLG5hbWU6ZSx0eXBlOmkuRnVuY3Rpb25UeXBlLlZhbHVlQmFzZWR9fWZ1bmN0aW9uIEUoZSl7cmV0dXJuIHtib2R5OmBcbiAgZmxvYXQgJHtlfV8oZmxvYXQgYSkge1xuICAgIHJldHVybiAke2V9KGEpO1xuICB9XG4gIHZlYzQgJHtlfV8odmVjNCB2KSB7XG4gICAgcmV0dXJuICR7ZX0odik7XG4gIH1cbiAgYCxuYW1lOmUsdHlwZTppLkZ1bmN0aW9uVHlwZS5WYWx1ZUJhc2VkfX10Lmdsc2xBYnM9dSx0Lmdsc2xBY29zPWwsdC5nbHNsQXNpbj1jLHQuZ2xzbEF0YW49cCx0Lmdsc2xDZWlsPWQsdC5nbHNsQ29zPWYsdC5nbHNsRWx1PWgsdC5nbHNsRXhwPWcsdC5nbHNsRmxvb3I9Yix0Lmdsc2xDbGlwPW0sdC5nbHNsSWRlbnRpdHk9eSx0Lmdsc2xMZWFreVJlbHU9dix0Lmdsc2xMb2c9Xyx0Lmdsc2xOZWc9dyx0Lmdsc2xOb3Q9VCx0Lmdsc2xTaW49eCx0Lmdsc2xSZWx1PU8sdC5nbHNsU2lnbW9pZD1TLHQuZ2xzbFNxcnQ9QSx0Lmdsc2xUYW49UCx0Lmdsc2xUYW5oPUk7Y29uc3QgRD0oZSx0LG4scik9Pntjb25zdCBvPWUuc2Vzc2lvbi5wYWNrP2EuVGV4dHVyZVR5cGUucGFja2VkOmEuVGV4dHVyZVR5cGUudW5wYWNrZWQsaT17bmFtZTpuLm5hbWUsaW5wdXRUeXBlczpbb10saW5wdXROYW1lczpbIkEiXSxjYWNoZUhpbnQ6cn07cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxpKSx7Z2V0OigpPT4oKGUsdCxuLHIpPT57Y29uc3Qgbz1lLnNlc3Npb24ucGFjaz9hLlRleHR1cmVUeXBlLnBhY2tlZDphLlRleHR1cmVUeXBlLnVucGFja2VkLGk9KDAsIHMuZ2V0R2xzbCkoZS5zZXNzaW9uLmJhY2tlbmQuZ2xDb250ZXh0LnZlcnNpb24pO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse291dHB1dDp7ZGltczpuLmRpbXMsdHlwZTpuLnR5cGUsdGV4dHVyZVR5cGU6b30sc2hhZGVyU291cmNlOmBcbiAgICAgJHtyLmJvZHl9XG4gICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICB2ZWM0IHYgPSAke2kudGV4dHVyZTJEfShBLCBUZXhDb29yZHMpO1xuICAgICAgIHYgPSAke3IubmFtZX1fKHYpO1xuICAgICAgICR7aS5vdXRwdXR9ID0gdjtcbiAgICAgfVxuICAgICBgLGhhc01haW46ITB9KX0pKGUsaSx0LG4pfSl9O3QuYWJzPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sdSgpKSx0KV0sdC5hY29zPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sbCgpKSx0KV0sdC5hc2luPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sYygpKSx0KV0sdC5hdGFuPShlLHQpPT5bZS5ydW4oRChlLHRbMF0scCgpKSx0KV0sdC5jbGlwPShlLHQsbik9PltlLnJ1bihEKGUsdFswXSxtKG4ubWluLG4ubWF4KSxuLmNhY2hlS2V5KSx0KV0sdC5wYXJzZUNsaXBBdHRyaWJ1dGVzPWU9PigwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe21pbjplLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoIm1pbiIsby5NSU5fQ0xJUCksbWF4OmUuYXR0cmlidXRlcy5nZXRGbG9hdCgibWF4IixvLk1BWF9DTElQKX0pLHQuY2xpcFYxMT0oZSxuKT0+e2NvbnN0IHI9JChlLG4pO3JldHVybiAoMCwgdC5jbGlwKShlLFtuWzBdXSxyKX07Y29uc3QgJD0oZSx0KT0+e2lmKHQubGVuZ3RoPj0zJiYoIWUuc2Vzc2lvbi5pc0luaXRpYWxpemVyKHRbMV0uZGF0YUlkKXx8IWUuc2Vzc2lvbi5pc0luaXRpYWxpemVyKHRbMl0uZGF0YUlkKSkpdGhyb3cgbmV3IEVycm9yKCJkeW5hbWljIGNsaXAgYXR0cmlidXRlcyBhcmUgbm90IGFsbG93ZWQiKTtjb25zdCBuPXQubGVuZ3RoPj0zP3RbMV0ubnVtYmVyRGF0YVswXTpvLk1JTl9DTElQLGk9dC5sZW5ndGg+PTM/dFsyXS5udW1iZXJEYXRhWzBdOm8uTUFYX0NMSVA7cmV0dXJuICgwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe21pbjpuLG1heDppfSl9O3QuY2VpbD0oZSx0KT0+W2UucnVuKEQoZSx0WzBdLGQoKSksdCldLHQuY29zPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sZigpKSx0KV0sdC5lbHU9KGUsdCxuKT0+W2UucnVuKEQoZSx0WzBdLGgobi5hbHBoYSksbi5jYWNoZUtleSksdCldLHQucGFyc2VFbHVBdHRyaWJ1dGVzPWU9PigwLCByLmNyZWF0ZUF0dHJpYnV0ZVdpdGhDYWNoZUtleSkoe2FscGhhOmUuYXR0cmlidXRlcy5nZXRGbG9hdCgiYWxwaGEiLDEpfSksdC5leHA9KGUsdCk9PltlLnJ1bihEKGUsdFswXSxnKCkpLHQpXSx0LmZsb29yPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sYigpKSx0KV0sdC5pZGVudGl0eT0oZSx0KT0+W2UucnVuKEQoZSx0WzBdLHkoKSksdCldLHQubGVha3lSZWx1PShlLHQsbik9PltlLnJ1bihEKGUsdFswXSx2KG4uYWxwaGEpLG4uY2FjaGVLZXkpLHQpXSx0LnBhcnNlTGVha3lSZWx1QXR0cmlidXRlcz1lPT4oMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHthbHBoYTplLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoImFscGhhIiwuMDEpfSksdC5sb2c9KGUsdCk9PltlLnJ1bihEKGUsdFswXSxfKCkpLHQpXSx0Lm5lZz0oZSx0KT0+W2UucnVuKEQoZSx0WzBdLHcoKSksdCldLHQubm90PShlLHQpPT5bZS5ydW4oRChlLHRbMF0sVCgpKSx0KV0sdC5yZWx1PShlLHQpPT5bZS5ydW4oRChlLHRbMF0sTygpKSx0KV0sdC5zaWdtb2lkPShlLHQpPT5bZS5ydW4oRChlLHRbMF0sUygpKSx0KV0sdC5zaW49KGUsdCk9PltlLnJ1bihEKGUsdFswXSx4KCkpLHQpXSx0LnNxcnQ9KGUsdCk9PltlLnJ1bihEKGUsdFswXSxBKCkpLHQpXSx0LnRhbj0oZSx0KT0+W2UucnVuKEQoZSx0WzBdLFAoKSksdCldLHQudGFuaD0oZSx0KT0+W2UucnVuKEQoZSx0WzBdLEkoKSksdCldO30sNTQwOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5jcmVhdGVVbnBhY2tQcm9ncmFtSW5mb0xvYWRlcj10LmNyZWF0ZVVucGFja1Byb2dyYW1JbmZvPXZvaWQgMDtjb25zdCByPW4oNjc1Nyksbz1uKDU2MzkpLGk9big0MzIpLHM9big1NjE0KSxhPXtuYW1lOiJ1bnBhY2siLGlucHV0TmFtZXM6WyJBIl0saW5wdXRUeXBlczpbby5UZXh0dXJlVHlwZS5wYWNrZWRdfTt0LmNyZWF0ZVVucGFja1Byb2dyYW1JbmZvPShlLHQpPT57Y29uc3Qgbj10LmRpbXMubGVuZ3RoLHU9KDAsIHMuZ2V0Q2hhbm5lbHMpKCJyYyIsbiksbD11LnNsaWNlKC0yKSxjPSgwLCBpLmdldENvb3Jkc0RhdGFUeXBlKShuKSxwPSgwLCBzLnVucGFja0Zyb21DaGFubmVsKSgpLGQ9MD09PXQuZGltcy5sZW5ndGg/IiI6ZnVuY3Rpb24oZSx0KXtpZigxPT09ZSlyZXR1cm4gInJjIjtsZXQgbj0iIjtmb3IobGV0IHI9MDtyPGU7cisrKW4rPXRbcl0scjxlLTEmJihuKz0iLCIpO3JldHVybiBufShuLHUpLGY9bjw9MT8icmMiOmB2ZWMyKCR7bC5qb2luKCIsIil9KWAsaD1gXG4gICAgJHtwfVxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICR7Y30gcmMgPSBnZXRPdXRwdXRDb29yZHMoKTtcblxuICAgICAgIC8vIFNhbXBsZSB0aGUgdGV4dHVyZSB3aXRoIHRoZSBjb29yZHMgdG8gZ2V0IHRoZSByZ2JhIGNoYW5uZWwgdmFsdWUuXG4gICAgICAgdmVjNCBwYWNrZWRJbnB1dCA9IGdldEEoJHtkfSk7XG5cbiAgICAgICAkeygwLCByLmdldEdsc2wpKGUuc2Vzc2lvbi5iYWNrZW5kLmdsQ29udGV4dC52ZXJzaW9uKS5vdXRwdXR9ID0gdmVjNChnZXRDaGFubmVsKHBhY2tlZElucHV0LCAke2Z9KSwgMCwgMCwgMCk7XG4gICAgIH1cbiAgIGA7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxhKSx7aGFzTWFpbjohMCxvdXRwdXQ6e2RpbXM6dC5kaW1zLHR5cGU6dC50eXBlLHRleHR1cmVUeXBlOm8uVGV4dHVyZVR5cGUudW5wYWNrZWR9LHNoYWRlclNvdXJjZTpofSl9LHQuY3JlYXRlVW5wYWNrUHJvZ3JhbUluZm9Mb2FkZXI9KGUsbik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxhKSx7Z2V0OigpPT4oMCwgdC5jcmVhdGVVbnBhY2tQcm9ncmFtSW5mbykoZSxuKX0pO30sNzg2MjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQucGFyc2VVbnNxdWVlemVBdHRyaWJ1dGVzPXQudW5zcXVlZXplVjEzPXQudW5zcXVlZXplPXZvaWQgMDtjb25zdCByPW4oNzI3Myk7dC51bnNxdWVlemU9KGUsdCxuKT0+e28odCk7Y29uc3QgaT1yLlNoYXBlVXRpbC51bnNxdWVlemVTaGFwZSh0WzBdLmRpbXMsbik7cmV0dXJuIFtlLnJlc2hhcGVVbnBhY2tlZCh0WzBdLGkpXX0sdC51bnNxdWVlemVWMTM9KGUsbik9PihpKG4pLCgwLCB0LnVuc3F1ZWV6ZSkoZSxbblswXV0sQXJyYXkuZnJvbShuWzFdLmludGVnZXJEYXRhKSkpLHQucGFyc2VVbnNxdWVlemVBdHRyaWJ1dGVzPWU9PmUuYXR0cmlidXRlcy5nZXRJbnRzKCJheGVzIik7Y29uc3Qgbz1lPT57aWYoIWV8fDEhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIlVuc3F1ZWV6ZSByZXF1aXJlcyAxIGlucHV0LiIpO2lmKCJzdHJpbmciPT09ZVswXS50eXBlKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBpbnB1dCB0ZW5zb3IgdHlwZXMuIil9LGk9ZT0+e2lmKCFlfHwyIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJVbnNxdWVlemUgcmVxdWlyZXMgMiBpbnB1dHMuIik7aWYoImludDMyIiE9PWVbMV0udHlwZSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgdHlwZS4iKX07fSwzOTgwOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5zY2FsZXNWYWxpZGF0aW9uPXQudmFsaWRhdGVJbnB1dHM9dC5wYXJzZVVwc2FtcGxlQXR0cmlidXRlcz10LnBhcnNlVXBzYW1wbGVBdHRyaWJ1dGVzVjk9dC5wYXJzZVVwc2FtcGxlQXR0cmlidXRlc1Y3PXQudXBzYW1wbGU9dm9pZCAwO2NvbnN0IHI9big0OTEwKSxvPW4oNjc1NyksaT1uKDU2MzkpLHM9e25hbWU6IlVwc2FtcGxlIixpbnB1dE5hbWVzOlsiWCJdLGlucHV0VHlwZXM6W2kuVGV4dHVyZVR5cGUudW5wYWNrZWRdfTt0LnVwc2FtcGxlPShlLG4scik9PigoMCwgdC52YWxpZGF0ZUlucHV0cykobixyKSxbZS5ydW4oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtjYWNoZUhpbnQ6ci5jYWNoZUtleSxnZXQ6KCk9PmEoZSxuLHIpfSksbildKSx0LnBhcnNlVXBzYW1wbGVBdHRyaWJ1dGVzVjc9ZT0+KDAsIHQucGFyc2VVcHNhbXBsZUF0dHJpYnV0ZXMpKGUsNyksdC5wYXJzZVVwc2FtcGxlQXR0cmlidXRlc1Y5PWU9PigwLCB0LnBhcnNlVXBzYW1wbGVBdHRyaWJ1dGVzKShlLDkpLHQucGFyc2VVcHNhbXBsZUF0dHJpYnV0ZXM9KGUsbik9Pntjb25zdCBvPW4+PTEwLGk9ZS5hdHRyaWJ1dGVzLmdldFN0cmluZygibW9kZSIsIm5lYXJlc3QiKTtpZigibmVhcmVzdCIhPT1pJiYibGluZWFyIiE9PWkmJihuPDExfHwiY3ViaWMiIT09aSkpdGhyb3cgbmV3IEVycm9yKGB1bnJlY29nbml6ZWQgbW9kZTogJHtpfWApO2xldCBzPVtdO248OSYmKHM9ZS5hdHRyaWJ1dGVzLmdldEZsb2F0cygic2NhbGVzIiksKDAsIHQuc2NhbGVzVmFsaWRhdGlvbikocyxpLG8pKTtjb25zdCBhPWUuYXR0cmlidXRlcy5nZXRGbG9hdCgiZXh0cmFwb2xhdGlvbl92YWx1ZSIsMCksdT1uPjEwP2UuYXR0cmlidXRlcy5nZXRTdHJpbmcoImNvb3JkaW5hdGVfdHJhbnNmb3JtYXRpb25fbW9kZSIsImhhbGZfcGl4ZWwiKToiYXN5bW1ldHJpYyI7aWYoLTE9PT1bImFzeW1tZXRyaWMiLCJweXRvcmNoX2hhbGZfcGl4ZWwiLCJ0Zl9oYWxmX3BpeGVsX2Zvcl9ubiIsImFsaWduX2Nvcm5lcnMiLCJ0Zl9jcm9wX2FuZF9yZXNpemUiLCJoYWxmX3BpeGVsIl0uaW5kZXhPZih1KSl0aHJvdyBuZXcgRXJyb3IoYGNvb3JkaW5hdGVfdHJhbnNmb3JtX21vZGUgJyR7dX0nIGlzIG5vdCBzdXBwb3J0ZWRgKTtjb25zdCBsPSJ0Zl9jcm9wX2FuZF9yZXNpemUiPT09dSxjPWwscD0ibmVhcmVzdCI9PT1pJiZuPj0xMT9lLmF0dHJpYnV0ZXMuZ2V0U3RyaW5nKCJuZWFyZXN0X21vZGUiLCJyb3VuZF9wcmVmZXJfZmxvb3IiKToiIjtpZigtMT09PVsicm91bmRfcHJlZmVyX2Zsb29yIiwicm91bmRfcHJlZmVyX2NlaWwiLCJmbG9vciIsImNlaWwiLCIiXS5pbmRleE9mKHApKXRocm93IG5ldyBFcnJvcihgbmVhcmVzdF9tb2RlICcke3B9JyBpcyBub3Qgc3VwcG9ydGVkYCk7Y29uc3QgZD1lLmF0dHJpYnV0ZXMuZ2V0RmxvYXQoImN1YmljX2NvZWZmX2EiLC0uNzUpLGY9MCE9PWUuYXR0cmlidXRlcy5nZXRJbnQoImV4Y2x1ZGVfb3V0c2lkZSIsMCk7aWYoZiYmImN1YmljIiE9PWkpdGhyb3cgbmV3IEVycm9yKCJleGNsdWRlX291dHNpZGUgY2FuIGJlIHNldCB0byAxIG9ubHkgd2hlbiBtb2RlIGlzIENVQklDLiIpO2NvbnN0IGg9bjwxMXx8Im5lYXJlc3QiPT09aSYmImFzeW1tZXRyaWMiPT09dSYmImZsb29yIj09PXA7bGV0IGc9MCxiPTAsbT0wO3JldHVybiBuPjEwP2UuaW5wdXRzLmxlbmd0aD4yPyhnPTEsYj0yLG09Myk6KGI9MSxtPTIpOjk9PT1uJiYoYj0xKSwoMCwgci5jcmVhdGVBdHRyaWJ1dGVXaXRoQ2FjaGVLZXkpKHtvcHNldDpuLGlzUmVzaXplOm8sbW9kZTppLHNjYWxlczpzLGV4dHJhcG9sYXRpb25WYWx1ZTphLGNvb3JkaW5hdGVUcmFuc2Zvcm1Nb2RlOnUsdXNlRXh0cmFwb2xhdGlvbjpjLG5lZWRSb2lJbnB1dDpsLG5lYXJlc3RNb2RlOnAsY3ViaWNDb2VmZmljaWVudEE6ZCxleGNsdWRlT3V0c2lkZTpmLHVzZU5lYXJlc3QyeE9wdGltaXphdGlvbjpoLHJvaUlucHV0SWR4Omcsc2NhbGVzSW5wdXRJZHg6YixzaXplc0lucHV0SWR4Om19KX07Y29uc3QgYT0oZSx0LG4pPT57Y29uc3Qgcj0oMCwgby5nZXRHbHNsKShlLnNlc3Npb24uYmFja2VuZC5nbENvbnRleHQudmVyc2lvbiksW2EsdV09ZS5jYWxjdWxhdGVUZXh0dXJlV2lkdGhBbmRIZWlnaHQodFswXS5kaW1zLGkuVGV4dHVyZVR5cGUudW5wYWNrZWQpLGw9dFswXS5kaW1zLm1hcCgoKGUsdCk9Pk1hdGguZmxvb3IoZSpuLnNjYWxlc1t0XSkpKSxbYyxwXT1lLmNhbGN1bGF0ZVRleHR1cmVXaWR0aEFuZEhlaWdodChsLGkuVGV4dHVyZVR5cGUudW5wYWNrZWQpLGQ9bC5sZW5ndGgsZj1uZXcgQXJyYXkoZCksaD1uZXcgQXJyYXkoZCk7bGV0IGc9YFxuICAgICAgaW50IG91dHB1dF9waXRjaGVzWyR7ZH1dO1xuICAgICAgaW50IGlucHV0X3BpdGNoZXNbJHtkfV07XG4gICAgICBgO2ZvcihsZXQgZT1kLTE7ZT49MDtlLS0pZltlXT1lPT09ZC0xPzE6ZltlKzFdKmxbZSsxXSxoW2VdPWU9PT1kLTE/MTpoW2UrMV0qdFswXS5kaW1zW2UrMV0sZys9YFxuICAgICAgICBvdXRwdXRfcGl0Y2hlc1ske2V9XSA9ICR7ZltlXX07XG4gICAgICAgIGlucHV0X3BpdGNoZXNbJHtlfV0gPSAke2hbZV19O1xuICAgICAgICBgO2NvbnN0IGI9YFxuICAgICAgZmxvYXQgZ2V0SW5wdXRGbG9hdChpbnQgaW5kZXgpIHtcbiAgICAgICAgdmVjMiBjb29yZHMgPSBvZmZzZXRUb0Nvb3JkcyhpbmRleCwgJHthfSwgJHt1fSk7XG4gICAgICAgIGZsb2F0IHZhbHVlID0gZ2V0Q29sb3JBc0Zsb2F0KCR7ci50ZXh0dXJlMkR9KFgsIGNvb3JkcykpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBgLG09Im5lYXJlc3QiPT09bi5tb2RlP2BcbiAgICAke2J9XG4gICAgZmxvYXQgcHJvY2VzcyhpbnQgaW5kaWNlc1ske2R9XSkge1xuICAgICAgaW50IGlucHV0X2luZGV4ID0gMDtcbiAgICAgIGludCBvdXRwdXRfaW5kZXggPSBjb29yZHNUb09mZnNldChUZXhDb29yZHMsICR7Y30sICR7cH0pO1xuXG4gICAgICAke2d9XG5cbiAgICAgIGludCBkLCBtO1xuICAgICAgZm9yIChpbnQgZGltID0gMDsgZGltIDwgJHtkfTsgKytkaW0pIHtcbiAgICAgICAgZCA9IG91dHB1dF9pbmRleCAvIG91dHB1dF9waXRjaGVzW2RpbV07XG4gICAgICAgIG0gPSBvdXRwdXRfaW5kZXggLSBkICogb3V0cHV0X3BpdGNoZXNbZGltXTtcbiAgICAgICAgb3V0cHV0X2luZGV4ID0gbTtcblxuICAgICAgICBpZiAoc2NhbGVzW2RpbV0gIT0gMSAmJiBkID4gMCkge1xuICAgICAgICAgIGludCBkMiA9IGQgLyBzY2FsZXNbZGltXTtcbiAgICAgICAgICBtID0gZCAtIGQyICogc2NhbGVzW2RpbV07XG4gICAgICAgICAgZCA9IGQyO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0X2luZGV4ICs9IGlucHV0X3BpdGNoZXNbZGltXSAqIGQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBnZXRJbnB1dEZsb2F0KGlucHV0X2luZGV4KTtcbiAgICB9YDo0PT09ZD9gXG4gICAgJHtifVxuICAgIGZsb2F0IHByb2Nlc3MoaW50IGluZGljZXNbNF0pIHtcbiAgICAgIGludCBpbnB1dF9pbmRleCA9IDA7XG4gICAgICBpbnQgb3V0cHV0X2luZGV4ID0gY29vcmRzVG9PZmZzZXQoVGV4Q29vcmRzLCAke2N9LCAke3B9KTtcblxuICAgICAgJHtnfVxuXG4gICAgICBpbnQgbTtcbiAgICAgIGludCBpbmRleF9vZl9kaW0wLCBpbmRleF9vZl9kaW0xLCBpbmRleF9vZl9kaW0yLCBpbmRleF9vZl9kaW0zO1xuICAgICAgaW5kZXhfb2ZfZGltMCA9IG91dHB1dF9pbmRleCAvIG91dHB1dF9waXRjaGVzWzBdO1xuICAgICAgbSA9IG91dHB1dF9pbmRleCAtIGluZGV4X29mX2RpbTAgKiBvdXRwdXRfcGl0Y2hlc1swXTtcbiAgICAgIGluZGV4X29mX2RpbTEgPSBtIC8gb3V0cHV0X3BpdGNoZXNbMV07XG4gICAgICBtID0gbSAtIGluZGV4X29mX2RpbTEgKiBvdXRwdXRfcGl0Y2hlc1sxXTtcbiAgICAgIGluZGV4X29mX2RpbTIgPSBtIC8gb3V0cHV0X3BpdGNoZXNbMl07XG4gICAgICBtID0gbSAtIGluZGV4X29mX2RpbTIgKiBvdXRwdXRfcGl0Y2hlc1syXTtcbiAgICAgIGluZGV4X29mX2RpbTMgPSBtO1xuXG4gICAgICBpbnQgaW5kZXhfb2ZfaW5wdXRfZGltMiwgaW5kZXhfb2ZfaW5wdXRfZGltMywgeF9vZmZzZXQsIHlfb2Zmc2V0O1xuICAgICAgaW5kZXhfb2ZfaW5wdXRfZGltMiA9IGluZGV4X29mX2RpbTIgLyBzY2FsZXNbMl07XG4gICAgICB5X29mZnNldCA9IGluZGV4X29mX2RpbTIgLSBpbmRleF9vZl9pbnB1dF9kaW0yICogc2NhbGVzWzJdO1xuICAgICAgaW5kZXhfb2ZfaW5wdXRfZGltMyA9IGluZGV4X29mX2RpbTMgLyBzY2FsZXNbM107XG4gICAgICB4X29mZnNldCA9IGluZGV4X29mX2RpbTMgLSBpbmRleF9vZl9pbnB1dF9kaW0zICogc2NhbGVzWzNdO1xuXG4gICAgICBpbnB1dF9pbmRleCA9IGluZGV4X29mX2RpbTAgKiBpbnB1dF9waXRjaGVzWzBdICtcbiAgICAgICAgICAgIGluZGV4X29mX2RpbTEgKiBpbnB1dF9waXRjaGVzWzFdICtcbiAgICAgICAgICAgIGluZGV4X29mX2lucHV0X2RpbTIgKiBpbnB1dF9waXRjaGVzWzJdICtcbiAgICAgICAgICAgIGluZGV4X29mX2lucHV0X2RpbTM7XG5cbiAgICAgIGZsb2F0IHgwMCA9IGdldElucHV0RmxvYXQoaW5wdXRfaW5kZXgpO1xuICAgICAgZmxvYXQgeDEwLCB4MDEsIHgxMTtcblxuICAgICAgYm9vbCBlbmRfb2ZfZGltMiA9IGZhbHNlO1xuICAgICAgaWYgKGluZGV4X29mX2lucHV0X2RpbTIgPT0gKCR7dFswXS5kaW1zWzJdfSAtIDEpKSB7XG4gICAgICAgIC8vIEl0J3MgdGhlIGVuZCBpbiBkaW1lbnNpb24gMlxuICAgICAgICB4MDEgPSB4MDA7XG4gICAgICAgIGVuZF9vZl9kaW0yID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHgwMSA9IGdldElucHV0RmxvYXQoaW5wdXRfaW5kZXggKyBpbnB1dF9waXRjaGVzWzJdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGluZGV4X29mX2lucHV0X2RpbTMgPT0gKGlucHV0X3BpdGNoZXNbMl0gLSAxKSkge1xuICAgICAgICAvLyBJdCdzIHRoZSBlbmQgaW4gZGltZW5zaW9uIDNcbiAgICAgICAgeDEwID0geDAwO1xuICAgICAgICB4MTEgPSB4MDE7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgeDEwID0gZ2V0SW5wdXRGbG9hdChpbnB1dF9pbmRleCArIDEpO1xuICAgICAgICB4MTEgPSBlbmRfb2ZfZGltMiA/IHgxMCA6IGdldElucHV0RmxvYXQoaW5wdXRfaW5kZXggKyBpbnB1dF9waXRjaGVzWzJdICsgMSk7XG4gICAgICB9XG5cbiAgICAgIGZsb2F0IHkwID0geDAwICsgZmxvYXQoeV9vZmZzZXQpICogKHgwMSAtIHgwMCkgLyBmbG9hdChzY2FsZXNbMl0pO1xuICAgICAgZmxvYXQgeTEgPSB4MTAgKyBmbG9hdCh5X29mZnNldCkgKiAoeDExIC0geDEwKSAvIGZsb2F0KHNjYWxlc1syXSk7XG4gICAgICByZXR1cm4geTAgKyBmbG9hdCh4X29mZnNldCkgKiAoeTEgLSB5MCkgLyBmbG9hdChzY2FsZXNbM10pO1xuICAgIH1gOmBcbiAgICAke2J9XG4gICAgZmxvYXQgcHJvY2VzcyhpbnQgaW5kaWNlc1syXSkge1xuICAgICAgaW50IGlucHV0X2luZGV4ID0gMDtcbiAgICAgIGludCBvdXRwdXRfaW5kZXggPSBjb29yZHNUb09mZnNldChUZXhDb29yZHMsICR7Y30sICR7cH0pO1xuXG4gICAgICAke2d9XG5cbiAgICAgIGludCBtO1xuICAgICAgaW50IGluZGV4X29mX2RpbTAsIGluZGV4X29mX2RpbTE7XG4gICAgICBpbmRleF9vZl9kaW0wID0gb3V0cHV0X2luZGV4IC8gb3V0cHV0X3BpdGNoZXNbMF07XG4gICAgICBtID0gb3V0cHV0X2luZGV4IC0gaW5kZXhfb2ZfZGltMCAqIG91dHB1dF9waXRjaGVzWzBdO1xuICAgICAgaW5kZXhfb2ZfZGltMSA9IG07XG5cbiAgICAgIGludCBpbmRleF9vZl9pbnB1dF9kaW0wLCBpbmRleF9vZl9pbnB1dF9kaW0xLCB4X29mZnNldCwgeV9vZmZzZXQ7XG4gICAgICBpbmRleF9vZl9pbnB1dF9kaW0wID0gaW5kZXhfb2ZfZGltMCAvIHNjYWxlc1swXTtcbiAgICAgIHlfb2Zmc2V0ID0gaW5kZXhfb2ZfZGltMCAtIGluZGV4X29mX2lucHV0X2RpbTAgKiBzY2FsZXNbMF07XG4gICAgICBpbmRleF9vZl9pbnB1dF9kaW0xID0gaW5kZXhfb2ZfZGltMSAvIHNjYWxlc1sxXTtcbiAgICAgIHhfb2Zmc2V0ID0gaW5kZXhfb2ZfZGltMSAtIGluZGV4X29mX2lucHV0X2RpbTEgKiBzY2FsZXNbMV07XG5cbiAgICAgIGlucHV0X2luZGV4ID0gaW5kZXhfb2ZfaW5wdXRfZGltMCAqIGlucHV0X3BpdGNoZXNbMF0gKyBpbmRleF9vZl9pbnB1dF9kaW0xO1xuXG4gICAgICBmbG9hdCB4MDAgPSBnZXRJbnB1dEZsb2F0KGlucHV0X2luZGV4KTtcbiAgICAgIGZsb2F0IHgxMCwgeDAxLCB4MTE7XG5cbiAgICAgIGJvb2wgZW5kX29mX2RpbTAgPSBmYWxzZTtcbiAgICAgIGlmIChpbmRleF9vZl9pbnB1dF9kaW0wID09ICgke3RbMF0uZGltc1swXX0gLSAxKSkge1xuICAgICAgICAvLyBJdCdzIHRoZSBlbmQgaW4gZGltZW5zaW9uIDBcbiAgICAgICAgeDAxID0geDAwO1xuICAgICAgICBlbmRfb2ZfZGltMCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB4MDEgPSBnZXRJbnB1dEZsb2F0KGlucHV0X2luZGV4ICsgaW5wdXRfcGl0Y2hlc1swXSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpbmRleF9vZl9pbnB1dF9kaW0xID09IChpbnB1dF9waXRjaGVzWzBdIC0gMSkpIHtcbiAgICAgICAgLy8gSXQncyB0aGUgZW5kIGluIGRpbWVuc2lvbiAxXG4gICAgICAgIHgxMCA9IHgwMDtcbiAgICAgICAgeDExID0geDAxO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHgxMCA9IGdldElucHV0RmxvYXQoaW5wdXRfaW5kZXggKyAxKTtcbiAgICAgICAgeDExID0gZW5kX29mX2RpbTAgPyB4MTAgOiBnZXRJbnB1dEZsb2F0KGlucHV0X2luZGV4ICsgaW5wdXRfcGl0Y2hlc1swXSArIDEpO1xuICAgICAgfVxuXG4gICAgICBmbG9hdCB5MCA9IHgwMCArIGZsb2F0KHlfb2Zmc2V0KSAqICh4MDEgLSB4MDApIC8gZmxvYXQoc2NhbGVzWzBdKTtcbiAgICAgIGZsb2F0IHkxID0geDEwICsgZmxvYXQoeV9vZmZzZXQpICogKHgxMSAtIHgxMCkgLyBmbG9hdChzY2FsZXNbMF0pO1xuICAgICAgcmV0dXJuIHkwICsgZmxvYXQoeF9vZmZzZXQpICogKHkxIC0geTApIC8gZmxvYXQoc2NhbGVzWzFdKTtcbiAgICB9YDtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtvdXRwdXQ6e2RpbXM6bCx0eXBlOnRbMF0udHlwZSx0ZXh0dXJlVHlwZTppLlRleHR1cmVUeXBlLnVucGFja2VkfSxzaGFkZXJTb3VyY2U6bSx2YXJpYWJsZXM6W3tuYW1lOiJzY2FsZXMiLHR5cGU6ImludCIsYXJyYXlMZW5ndGg6bi5zY2FsZXMubGVuZ3RoLGRhdGE6bi5zY2FsZXMubWFwKChlPT5NYXRoLmNlaWwoZSkpKX1dfSl9O3QudmFsaWRhdGVJbnB1dHM9KGUsdCk9PntpZighZXx8dC5vcHNldDw5JiYxIT09ZS5sZW5ndGh8fHQub3BzZXQ+PTkmJnQub3BzZXQ8MTEmJjIhPT1lLmxlbmd0aHx8dC5vcHNldD49MTEmJmUubGVuZ3RoPDIpdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGlucHV0cy4iKTtpZih0LnNjYWxlcy5sZW5ndGg+MCYmZVswXS5kaW1zLmxlbmd0aCE9PXQuc2NhbGVzLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgaW5wdXQgc2hhcGUuIik7aWYoInN0cmluZyI9PT1lWzBdLnR5cGUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGlucHV0IHRlbnNvciB0eXBlcy4iKX0sdC5zY2FsZXNWYWxpZGF0aW9uPShlLHQsbik9PntpZihuKXtmb3IoY29uc3QgdCBvZiBlKWlmKHQ8PTApdGhyb3cgbmV3IEVycm9yKCJTY2FsZSB2YWx1ZSBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIDAuIil9ZWxzZSBmb3IoY29uc3QgdCBvZiBlKWlmKHQ8MSl0aHJvdyBuZXcgRXJyb3IoIlNjYWxlIHZhbHVlIHNob3VsZCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMS4iKTtpZighKCJsaW5lYXIiIT09dCYmImN1YmljIiE9PXR8fDI9PT1lLmxlbmd0aHx8ND09PWUubGVuZ3RoJiYxPT09ZVswXSYmMT09PWVbMV0pKXRocm93IG5ldyBFcnJvcihgJ0xpbmVhcicgbW9kZSBhbmQgJ0N1YmljJyBtb2RlIG9ubHkgc3VwcG9ydCAyLUQgaW5wdXRzICgnQmlsaW5lYXInLCAnQmljdWJpYycpICAgICAgICAgb3IgNC1EIGlucHV0cyB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIG91dGVybW9zdCAyIHNjYWxlIHZhbHVlcyBiZWluZyAxICAgICAgICAgaW4gdGhlICR7bj8iUmVzaXplIjoiVXBzYW1wbGUifSBvcGVhcnRvci5gKX07fSwyNzU3OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5Qcm9ncmFtTWFuYWdlcj12b2lkIDA7Y29uc3Qgcj1uKDIyMzUpLG89bigxMzE1KSxpPW4oODg5Nykscz1uKDY3NTcpO3QuUHJvZ3JhbU1hbmFnZXI9Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4pe3RoaXMucHJvZmlsZXI9ZSx0aGlzLmdsQ29udGV4dD10LHRoaXMudGV4dHVyZUxheW91dFN0cmF0ZWd5PW4sdGhpcy5yZXBvPW5ldyBNYXAsdGhpcy5hdHRyaWJ1dGVzQm91bmQ9ITE7fWdldEFydGlmYWN0KGUpe3JldHVybiB0aGlzLnJlcG8uZ2V0KGUpfXNldEFydGlmYWN0KGUsdCl7dGhpcy5yZXBvLnNldChlLHQpO31ydW4oZSx0LG4pe3ZhciByO3RoaXMucHJvZmlsZXIuZXZlbnQoIm9wIixgUHJvZ3JhbU1hbmFnZXIucnVuICR7bnVsbCE9PShyPWUucHJvZ3JhbUluZm8ubmFtZSkmJnZvaWQgMCE9PXI/cjoidW5rbm93biBrZXJuZWwifWAsKCgpPT57dmFyIHI7Y29uc3QgaT10aGlzLmdsQ29udGV4dC5nbCxzPWUucHJvZ3JhbTtpLnVzZVByb2dyYW0ocyk7dHJ5e3RoaXMuYmluZE91dHB1dChuKSx0aGlzLmF0dHJpYnV0ZXNCb3VuZHx8dGhpcy5iaW5kQXR0cmlidXRlcyhlLmF0dHJpYkxvY2F0aW9ucyksdGhpcy5iaW5kVW5pZm9ybXMoZS51bmlmb3JtTG9jYXRpb25zLG51bGwhPT0ocj1lLnByb2dyYW1JbmZvLnZhcmlhYmxlcykmJnZvaWQgMCE9PXI/cjpbXSx0KTt9Y2F0Y2godCl7dGhyb3cgby5Mb2dnZXIuZXJyb3IoIlByb2dyYW1NYW5hZ2VyIixlLnByb2dyYW1JbmZvLnNoYWRlclNvdXJjZSksdH10aGlzLnByb2ZpbGVyLmV2ZW50KCJiYWNrZW5kIiwiR2xDb250ZXh0LmRyYXcoKSIsKCgpPT57dGhpcy5nbENvbnRleHQuZHJhdygpO30pKTt9KSx0aGlzLmdsQ29udGV4dCk7fWRpc3Bvc2UoKXt0aGlzLnZlcnRleFNoYWRlciYmdGhpcy5nbENvbnRleHQuZGVsZXRlU2hhZGVyKHRoaXMudmVydGV4U2hhZGVyKSx0aGlzLnJlcG8uZm9yRWFjaCgoZT0+dGhpcy5nbENvbnRleHQuZGVsZXRlUHJvZ3JhbShlLnByb2dyYW0pKSk7fWJ1aWxkKGUsdCxuKXtyZXR1cm4gdGhpcy5wcm9maWxlci5ldmVudCgiYmFja2VuZCIsIlByb2dyYW1NYW5hZ2VyLmJ1aWxkIiwoKCk9Pntjb25zdCByPW5ldyBpLkdsc2xQcmVwcm9jZXNzb3IodGhpcy5nbENvbnRleHQsZSx0LG4pLG89ci5wcmVwcm9jZXNzKCkscz10aGlzLmNvbXBpbGUobyk7cmV0dXJuIHtwcm9ncmFtSW5mbzplLHByb2dyYW06cyx1bmlmb3JtTG9jYXRpb25zOnRoaXMuZ2V0VW5pZm9ybUxvY2F0aW9ucyhzLHIuY29udGV4dC5wcm9ncmFtSW5mby5pbnB1dE5hbWVzLHIuY29udGV4dC5wcm9ncmFtSW5mby52YXJpYWJsZXMpLGF0dHJpYkxvY2F0aW9uczp0aGlzLmdldEF0dHJpYkxvY2F0aW9ucyhzKX19KSl9Y29tcGlsZShlKXtpZighdGhpcy52ZXJ0ZXhTaGFkZXIpe28uTG9nZ2VyLnZlcmJvc2UoIlByb3JncmFtTWFuYWdlciIsIkNvbXBpbGluZyBhbmQgY2FjaGluZyBWZXJ0ZXggc2hhZGVyIGZvciB0aGUgZmlyc3QgdGltZSIpO2NvbnN0IGU9KDAsIHMuZ2V0VmVydGV4U2hhZGVyU291cmNlKSh0aGlzLmdsQ29udGV4dC52ZXJzaW9uKTt0aGlzLnZlcnRleFNoYWRlcj10aGlzLmdsQ29udGV4dC5jb21waWxlU2hhZGVyKGUsdGhpcy5nbENvbnRleHQuZ2wuVkVSVEVYX1NIQURFUik7fXIuZW52LmRlYnVnJiZvLkxvZ2dlci52ZXJib3NlKCJQcm9yZ3JhbU1hbmFnZXIiLGBGcmFnU2hhZGVyOlxuJHtlfVxuYCk7Y29uc3QgdD10aGlzLmdsQ29udGV4dC5jb21waWxlU2hhZGVyKGUsdGhpcy5nbENvbnRleHQuZ2wuRlJBR01FTlRfU0hBREVSKSxuPXRoaXMuZ2xDb250ZXh0LmNyZWF0ZVByb2dyYW0odGhpcy52ZXJ0ZXhTaGFkZXIsdCk7cmV0dXJuIHRoaXMuZ2xDb250ZXh0LmRlbGV0ZVNoYWRlcih0KSxufWJpbmRPdXRwdXQoZSl7Y29uc3QgdD1lLndpZHRoLG49ZS5oZWlnaHQ7by5Mb2dnZXIudmVyYm9zZSgiUHJvcmdyYW1NYW5hZ2VyIixgQmluZGluZyBvdXRwdXQgdGV4dHVyZSB0byBGcmFtZWJ1ZmZlcjogdy9oPSR7dH0vJHtufSwgc2hhcGU9JHtlLnNoYXBlfSwgdHlwZT0ke2UudGVuc29yLnR5cGV9YCksdGhpcy5nbENvbnRleHQuYXR0YWNoRnJhbWVidWZmZXIoZS50ZXh0dXJlLHQsbik7fWJpbmRBdHRyaWJ1dGVzKGUpe2NvbnN0IHQ9ZS5wb3NpdGlvbixuPWUudGV4dHVyZUNvb3JkO3RoaXMuZ2xDb250ZXh0LnNldFZlcnRleEF0dHJpYnV0ZXModCxuKSx0aGlzLmF0dHJpYnV0ZXNCb3VuZD0hMDt9YmluZFVuaWZvcm1zKGUsdCxuKXt2YXIgcjtjb25zdCBvPXRoaXMuZ2xDb250ZXh0LmdsO2xldCBpPTA7Zm9yKGNvbnN0e25hbWU6cyx0eXBlOmEsbG9jYXRpb246dSxhcnJheUxlbmd0aDpsfW9mIGUpe2NvbnN0IGU9bnVsbD09PShyPXQuZmluZCgoZT0+ZS5uYW1lPT09cykpKXx8dm9pZCAwPT09cj92b2lkIDA6ci5kYXRhO2lmKCJzYW1wbGVyMkQiIT09YSYmIWUpdGhyb3cgbmV3IEVycm9yKGB2YXJpYWJsZSAnJHtzfScgZG9lcyBub3QgaGF2ZSBkYXRhIGRlZmluZWQgaW4gcHJvZ3JhbSBpbmZvYCk7c3dpdGNoKGEpe2Nhc2Uic2FtcGxlcjJEIjp0aGlzLmJpbmRUZXh0dXJlKG5baV0sdSxpKSxpKys7YnJlYWs7Y2FzZSJmbG9hdCI6bD9vLnVuaWZvcm0xZnYodSxlKTpvLnVuaWZvcm0xZih1LGUpO2JyZWFrO2Nhc2UiaW50IjpsP28udW5pZm9ybTFpdih1LGUpOm8udW5pZm9ybTFpKHUsZSk7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYFVuaWZvcm0gbm90IGltcGxlbWVudGVkOiAke2F9YCl9fX1iaW5kVGV4dHVyZShlLHQsbil7dGhpcy5nbENvbnRleHQuYmluZFRleHR1cmVUb1VuaWZvcm0oZS50ZXh0dXJlLG4sdCk7fWdldEF0dHJpYkxvY2F0aW9ucyhlKXtyZXR1cm4ge3Bvc2l0aW9uOnRoaXMuZ2V0QXR0cmliTG9jYXRpb24oZSwicG9zaXRpb24iKSx0ZXh0dXJlQ29vcmQ6dGhpcy5nZXRBdHRyaWJMb2NhdGlvbihlLCJ0ZXh0dXJlQ29vcmQiKX19Z2V0VW5pZm9ybUxvY2F0aW9ucyhlLHQsbil7Y29uc3Qgcj1bXTtpZih0KWZvcihjb25zdCBuIG9mIHQpci5wdXNoKHtuYW1lOm4sdHlwZToic2FtcGxlcjJEIixsb2NhdGlvbjp0aGlzLmdldFVuaWZvcm1Mb2NhdGlvbihlLG4pfSk7aWYobilmb3IoY29uc3QgdCBvZiBuKXIucHVzaChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse2xvY2F0aW9uOnRoaXMuZ2V0VW5pZm9ybUxvY2F0aW9uKGUsdC5uYW1lKX0pKTtyZXR1cm4gcn1nZXRVbmlmb3JtTG9jYXRpb24oZSx0KXtjb25zdCBuPXRoaXMuZ2xDb250ZXh0LmdsLmdldFVuaWZvcm1Mb2NhdGlvbihlLHQpO2lmKG51bGw9PT1uKXRocm93IG5ldyBFcnJvcihgVW5pZm9ybSAke3R9IG5vdCBmb3VuZC5gKTtyZXR1cm4gbn1nZXRBdHRyaWJMb2NhdGlvbihlLHQpe3JldHVybiB0aGlzLmdsQ29udGV4dC5nbC5nZXRBdHRyaWJMb2NhdGlvbihlLHQpfX07fSwyMTcxOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5XZWJHTFNlc3Npb25IYW5kbGVyPXZvaWQgMDtjb25zdCByPW4oMTMxNSksbz1uKDU4ODEpLGk9big3ODYwKSxzPW4oNDExMCksYT1uKDI3NTcpLHU9big3NjE4KSxsPW4oNTI0Myk7dC5XZWJHTFNlc3Npb25IYW5kbGVyPWNsYXNze2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5iYWNrZW5kPWUsdGhpcy5jb250ZXh0PXQsdGhpcy5sYXlvdXRTdHJhdGVneT1uZXcgdS5QcmVmZXJMb2dpY2FsU3RyYXRlZ3koZS5nbENvbnRleHQubWF4VGV4dHVyZVNpemUpLHRoaXMucHJvZ3JhbU1hbmFnZXI9bmV3IGEuUHJvZ3JhbU1hbmFnZXIodGhpcy5jb250ZXh0LnByb2ZpbGVyLGUuZ2xDb250ZXh0LHRoaXMubGF5b3V0U3RyYXRlZ3kpLHRoaXMudGV4dHVyZU1hbmFnZXI9bmV3IGwuVGV4dHVyZU1hbmFnZXIoZS5nbENvbnRleHQsdGhpcy5sYXlvdXRTdHJhdGVneSx0aGlzLmNvbnRleHQucHJvZmlsZXIse3JldXNlVGV4dHVyZXM6ImZ1bGwiPT09ZS50ZXh0dXJlQ2FjaGVNb2RlfSksdGhpcy5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlPW5ldyBNYXAsdGhpcy51bnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU9bmV3IE1hcCx0aGlzLnBhY2s9ZS5wYWNrLHRoaXMucGFjazJ1bnBhY2tNYXA9bmV3IE1hcCx0aGlzLnVucGFjazJwYWNrTWFwPW5ldyBNYXA7fWNyZWF0ZUluZmVyZW5jZUhhbmRsZXIoKXtyZXR1cm4gbmV3IGkuV2ViR0xJbmZlcmVuY2VIYW5kbGVyKHRoaXMpfW9uR3JhcGhJbml0aWFsaXplZChlKXtjb25zdCB0PWUuZ2V0VmFsdWVzKCkuZmlsdGVyKChlPT4tMT09PWUuZnJvbSYmZS50ZW5zb3IpKS5tYXAoKGU9PmUudGVuc29yLmRhdGFJZCkpO3RoaXMuaW5pdGlhbGl6ZXJzPW5ldyBTZXQodCk7fWlzSW5pdGlhbGl6ZXIoZSl7cmV0dXJuICEhdGhpcy5pbml0aWFsaXplcnMmJnRoaXMuaW5pdGlhbGl6ZXJzLmhhcyhlKX1hZGRJbml0aWFsaXplcihlKXt0aGlzLmluaXRpYWxpemVycy5hZGQoZSk7fWdldFRleHR1cmVEYXRhKGUsdCl7cmV0dXJuIHQ/dGhpcy5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlLmdldChlKTp0aGlzLnVucGFja2VkVGV4dHVyZURhdGFDYWNoZS5nZXQoZSl9c2V0VGV4dHVyZURhdGEoZSx0LG49ITEpe3IuTG9nZ2VyLnZlcmJvc2UoIldlYkdMU2Vzc2lvbkhhbmRsZXIiLCJTdG9yaW5nIFRleHR1cmUgZGF0YSBpbiBjYWNoZSIpLG4/dGhpcy5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlLnNldChlLHQpOnRoaXMudW5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlLnNldChlLHQpO31kaXNwb3NlKCl7dGhpcy5wcm9ncmFtTWFuYWdlci5kaXNwb3NlKCksdGhpcy50ZXh0dXJlTWFuYWdlci5jbGVhckFjdGl2ZVRleHR1cmVzKCksdGhpcy5wYWNrZWRUZXh0dXJlRGF0YUNhY2hlLmZvckVhY2goKGU9PnRoaXMudGV4dHVyZU1hbmFnZXIucmVsZWFzZVRleHR1cmUoZSwhMCkpKSx0aGlzLnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU9bmV3IE1hcCx0aGlzLnVucGFja2VkVGV4dHVyZURhdGFDYWNoZS5mb3JFYWNoKChlPT50aGlzLnRleHR1cmVNYW5hZ2VyLnJlbGVhc2VUZXh0dXJlKGUsITApKSksdGhpcy51bnBhY2tlZFRleHR1cmVEYXRhQ2FjaGU9bmV3IE1hcDt9cmVzb2x2ZShlLHQsbil7Y29uc3Qgcj0oMCwgby5yZXNvbHZlT3BlcmF0b3IpKGUsdCxzLldFQkdMX09QX1JFU09MVkVfUlVMRVMpO3JldHVybiB7aW1wbDpyLm9wSW1wbCxjb250ZXh0OnIub3BJbml0P3Iub3BJbml0KGUsbik6ZX19fTt9LDk2MjI6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LlVpbnQ4RGF0YUVuY29kZXI9dC5SR0JBRmxvYXREYXRhRW5jb2Rlcj10LlJlZEZsb2F0MzJEYXRhRW5jb2Rlcj12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpO3QuUmVkRmxvYXQzMkRhdGFFbmNvZGVyPWNsYXNze2NvbnN0cnVjdG9yKGUsdD0xKXtpZigxPT09dCl0aGlzLmludGVybmFsRm9ybWF0PWUuUjMyRix0aGlzLmZvcm1hdD1lLlJFRCx0aGlzLnRleHR1cmVUeXBlPWUuRkxPQVQsdGhpcy5jaGFubmVsU2l6ZT10O2Vsc2Uge2lmKDQhPT10KXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBudW1iZXIgb2YgY2hhbm5lbHM6ICR7dH1gKTt0aGlzLmludGVybmFsRm9ybWF0PWUuUkdCQTMyRix0aGlzLmZvcm1hdD1lLlJHQkEsdGhpcy50ZXh0dXJlVHlwZT1lLkZMT0FULHRoaXMuY2hhbm5lbFNpemU9dDt9fWVuY29kZShlLHQpe2xldCBuLG87cmV0dXJuIGUuY29uc3RydWN0b3IhPT1GbG9hdDMyQXJyYXkmJihyLkxvZ2dlci53YXJuaW5nKCJFbmNvZGVyIiwiZGF0YSB3YXMgbm90IG9mIHR5cGUgRmxvYXQzMjsgY3JlYXRpbmcgbmV3IEZsb2F0MzJBcnJheSIpLG89bmV3IEZsb2F0MzJBcnJheShlKSksdCp0aGlzLmNoYW5uZWxTaXplPmUubGVuZ3RoPyhyLkxvZ2dlci53YXJuaW5nKCJFbmNvZGVyIiwiU291cmNlIGRhdGEgdG9vIHNtYWxsLiBBbGxvY2F0aW5nIGxhcmdlciBhcnJheSIpLG89ZSxuPXRoaXMuYWxsb2NhdGUodCp0aGlzLmNoYW5uZWxTaXplKSxvLmZvckVhY2goKChlLHQpPT5uW3RdPWUpKSk6KG89ZSxuPW8pLG59YWxsb2NhdGUoZSl7cmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoNCplKX1kZWNvZGUoZSx0KXtyZXR1cm4gMT09PXRoaXMuY2hhbm5lbFNpemU/ZS5maWx0ZXIoKChlLHQpPT50JTQ9PTApKS5zdWJhcnJheSgwLHQpOmUuc3ViYXJyYXkoMCx0KX19LHQuUkdCQUZsb2F0RGF0YUVuY29kZXI9Y2xhc3N7Y29uc3RydWN0b3IoZSx0PTEsbil7aWYoMSE9PXQmJjQhPT10KXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBudW1iZXIgb2YgY2hhbm5lbHM6ICR7dH1gKTt0aGlzLmludGVybmFsRm9ybWF0PWUuUkdCQSx0aGlzLmZvcm1hdD1lLlJHQkEsdGhpcy5jaGFubmVsU2l6ZT10LHRoaXMudGV4dHVyZVR5cGU9bnx8ZS5GTE9BVDt9ZW5jb2RlKGUsdCl7bGV0IG49ZTtyZXR1cm4gMT09PXRoaXMuY2hhbm5lbFNpemUmJihyLkxvZ2dlci52ZXJib3NlKCJFbmNvZGVyIiwiRXhwbG9kaW5nIGludG8gYSBsYXJnZXIgYXJyYXkiKSxuPXRoaXMuYWxsb2NhdGUodCksZS5mb3JFYWNoKCgoZSx0KT0+bls0KnRdPWUpKSksbn1hbGxvY2F0ZShlKXtyZXR1cm4gbmV3IEZsb2F0MzJBcnJheSg0KmUpfWRlY29kZShlLHQpe3JldHVybiAxPT09dGhpcy5jaGFubmVsU2l6ZT9lLmZpbHRlcigoKGUsdCk9PnQlND09MCkpLnN1YmFycmF5KDAsdCk6ZS5zdWJhcnJheSgwLHQpfX0sdC5VaW50OERhdGFFbmNvZGVyPWNsYXNze2NvbnN0cnVjdG9yKGUsdD0xKXtpZih0aGlzLmNoYW5uZWxTaXplPTQsMT09PXQpdGhpcy5pbnRlcm5hbEZvcm1hdD1lLkFMUEhBLHRoaXMuZm9ybWF0PWUuQUxQSEEsdGhpcy50ZXh0dXJlVHlwZT1lLlVOU0lHTkVEX0JZVEUsdGhpcy5jaGFubmVsU2l6ZT10O2Vsc2Uge2lmKDQhPT10KXRocm93IG5ldyBFcnJvcihgSW52YWxpZCBudW1iZXIgb2YgY2hhbm5lbHM6ICR7dH1gKTt0aGlzLmludGVybmFsRm9ybWF0PWUuUkdCQSx0aGlzLmZvcm1hdD1lLlJHQkEsdGhpcy50ZXh0dXJlVHlwZT1lLlVOU0lHTkVEX0JZVEUsdGhpcy5jaGFubmVsU2l6ZT10O319ZW5jb2RlKGUsdCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCxlLmJ5dGVMZW5ndGgpfWFsbG9jYXRlKGUpe3JldHVybiBuZXcgVWludDhBcnJheShlKnRoaXMuY2hhbm5lbFNpemUpfWRlY29kZShlLHQpe2lmKGUgaW5zdGFuY2VvZiBVaW50OEFycmF5KXJldHVybiBlLnN1YmFycmF5KDAsdCk7dGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGFycmF5IHR5cGU6ICR7ZS5jb25zdHJ1Y3Rvcn1gKX19O30sNzYxODooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZ2V0QmF0Y2hEaW09dC5zaXplVG9TcXVhcmlzaFNoYXBlPXQuZ2V0Um93c0NvbHM9dC5zaXplRnJvbVNoYXBlPXQuaXNJbnQ9dC5wYXJzZUF4aXNQYXJhbT10LnNxdWVlemVTaGFwZT10LlByZWZlckxvZ2ljYWxTdHJhdGVneT10LkFsd2F5c0tlZXBPcmlnaW5hbFNpemVTdHJhdGVneT12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpLG89big3MjczKTtmdW5jdGlvbiBpKGUsdCl7Y29uc3Qgbj1bXSxyPVtdLG89bnVsbCE9dCYmQXJyYXkuaXNBcnJheSh0KSYmMD09PXQubGVuZ3RoLGk9bnVsbD09dHx8bz9udWxsOnModCxlKS5zb3J0KCk7bGV0IGE9MDtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoOysrdCl7aWYobnVsbCE9aSl7aWYoaVthXT09PXQmJjEhPT1lW3RdKXRocm93IG5ldyBFcnJvcihgQ2FuJ3Qgc3F1ZWV6ZSBheGlzICR7dH0gc2luY2UgaXRzIGRpbSAnJHtlW3RdfScgaXMgbm90IDFgKTsobnVsbD09aVthXXx8aVthXT50KSYmMT09PWVbdF0mJihuLnB1c2goZVt0XSksci5wdXNoKHQpKSxpW2FdPD10JiZhKys7fTEhPT1lW3RdJiYobi5wdXNoKGVbdF0pLHIucHVzaCh0KSk7fXJldHVybiB7bmV3U2hhcGU6bixrZXB0RGltczpyfX1mdW5jdGlvbiBzKGUsdCl7Y29uc3Qgbj10Lmxlbmd0aDtyZXR1cm4gZT1udWxsPT1lP3QubWFwKCgoZSx0KT0+dCkpOltdLmNvbmNhdChlKSwoMCwgby5hc3NlcnQpKGUuZXZlcnkoKGU9PmU+PS1uJiZlPG4pKSwoKCk9PmBBbGwgdmFsdWVzIGluIGF4aXMgcGFyYW0gbXVzdCBiZSBpbiByYW5nZSBbLSR7bn0sICR7bn0pIGJ1dCBnb3QgYXhpcyAke2V9YCkpLCgwLCBvLmFzc2VydCkoZS5ldmVyeShhKSwoKCk9PmBBbGwgdmFsdWVzIGluIGF4aXMgcGFyYW0gbXVzdCBiZSBpbnRlZ2VycyBidXQgZ290IGF4aXMgJHtlfWApKSxlLm1hcCgoZT0+ZTwwP24rZTplKSl9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZSUxPT0wfWZ1bmN0aW9uIHUoZSl7aWYoMD09PWUubGVuZ3RoKXJldHVybiAxO2xldCB0PWVbMF07Zm9yKGxldCBuPTE7bjxlLmxlbmd0aDtuKyspdCo9ZVtuXTtyZXR1cm4gdH1mdW5jdGlvbiBsKGUpe2NvbnN0IHQ9TWF0aC5jZWlsKE1hdGguc3FydChlKSk7cmV0dXJuIFt0LE1hdGguY2VpbChlL3QpXX10LkFsd2F5c0tlZXBPcmlnaW5hbFNpemVTdHJhdGVneT1jbGFzc3tjb25zdHJ1Y3RvcihlKXt0aGlzLm1heFRleHR1cmVTaXplPWU7fWNvbXB1dGVUZXh0dXJlV0goZSx0KXtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIFsxLDFdO2NvbnN0IG49dGhpcy5tYXhUZXh0dXJlU2l6ZTtpZih0JiZ2b2lkIDAhPT10LmJyZWFrQXhpcyl7Y29uc3Qgbz10LmJyZWFrQXhpcz49ZS5sZW5ndGg/MTplLnNsaWNlKHQuYnJlYWtBeGlzKS5yZWR1Y2UoKChlLHQpPT5lKnQpKSxpPXQuYnJlYWtBeGlzPD0wPzE6ZS5zbGljZSgwLHQuYnJlYWtBeGlzKS5yZWR1Y2UoKChlLHQpPT5lKnQpKTtpZighKG8+bnx8aT5uKSlyZXR1cm4gW28saV07ci5Mb2dnZXIudmVyYm9zZSgiVGV4dHVyZUxheW91dCIsYEdpdmVuIHdpZHRoL2hlaWdodCBwcmVmZXJlbmNlcyB3ZXJlIHVuYXR0YWluYWJsZTogc2hhcGU6JHtlfSwgYnJlYWtBeGlzOiR7dC5icmVha0F4aXN9YCk7fWNvbnN0IG89ZS5yZWR1Y2UoKChlLHQpPT5lKnQpKTtsZXQgaT1NYXRoLmZsb29yKE1hdGguc3FydChvKSk7Zm9yKDtpPG4mJmk8byYmbyVpIT0wO2krKyk7aWYoaT49bnx8byVpIT0wKXRocm93IG5ldyBFcnJvcihgVGhlIGdpdmVuIGRpbWVuc2lvbnMgYXJlIG91dHNpZGUgdGhpcyBHUFUncyBib3VuZGFyaWVzOiAke2V9YCk7cmV0dXJuIFtpLG8vaV19fSx0LlByZWZlckxvZ2ljYWxTdHJhdGVneT1jbGFzc3tjb25zdHJ1Y3RvcihlKXt0aGlzLm1heFRleHR1cmVTaXplPWU7fWNvbXB1dGVUZXh0dXJlV0goZSx0KXtjb25zdCBuPXRoaXMuY29tcHV0ZVRleHR1cmUoZSx0KTtyZXR1cm4gdCYmdC5pc1BhY2tlZCYmKG5bMF0vPTIsblsxXS89MiksdCYmdC5yZXZlcnNlV0g/W25bMV0sblswXV06bn1jb21wdXRlVGV4dHVyZShlLHQpe2NvbnN0IG49dCYmdC5pc1BhY2tlZDtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIG4/WzIsMl06WzEsMV07bGV0IG89dGhpcy5tYXhUZXh0dXJlU2l6ZTtpZih0JiZ2b2lkIDAhPT10LmJyZWFrQXhpcyl7Y29uc3Qgbj10LmJyZWFrQXhpcz49ZS5sZW5ndGg/MTplLnNsaWNlKHQuYnJlYWtBeGlzKS5yZWR1Y2UoKChlLHQpPT5lKnQpKSxpPXQuYnJlYWtBeGlzPD0wPzE6ZS5zbGljZSgwLHQuYnJlYWtBeGlzKS5yZWR1Y2UoKChlLHQpPT5lKnQpKTtpZighKG4+b3x8aT5vKSlyZXR1cm4gW24saV07ci5Mb2dnZXIudmVyYm9zZSgiVGV4dHVyZUxheW91dCIsYEdpdmVuIHdpZHRoL2hlaWdodCBwcmVmZXJlbmNlcyB3ZXJlIHVuYXR0YWluYWJsZTogc2hhcGU6JHtlfSwgYnJlYWtBeGlzOiR7dC5icmVha0F4aXN9YCk7fWxldCBzPWUuc2xpY2UoMCk7aWYobiYmKG8qPTIscz1zLm1hcCgoKGUsdCk9PnQ+PXMubGVuZ3RoLTI/c1t0XSUyPT0wP3NbdF06c1t0XSsxOnNbdF0pKSwxPT09cy5sZW5ndGgmJihzPVsyLHNbMF1dKSksMiE9PXMubGVuZ3RoKXtjb25zdCBlPWkocyk7cz1lLm5ld1NoYXBlO31jb25zdCBhPXUocyk7cmV0dXJuIHMubGVuZ3RoPD0xJiZhPD1vP1sxLGFdOjI9PT1zLmxlbmd0aCYmc1swXTw9byYmc1sxXTw9bz9zOjM9PT1zLmxlbmd0aCYmc1swXSpzWzFdPD1vJiZzWzJdPD1vP1tzWzBdKnNbMV0sc1syXV06Mz09PXMubGVuZ3RoJiZzWzBdPD1vJiZzWzFdKnNbMl08PW8/W3NbMF0sc1sxXSpzWzJdXTo0PT09cy5sZW5ndGgmJnNbMF0qc1sxXSpzWzJdPD1vJiZzWzNdPD1vP1tzWzBdKnNbMV0qc1syXSxzWzNdXTo0PT09cy5sZW5ndGgmJnNbMF08PW8mJnNbMV0qc1syXSpzWzNdPD1vP1tzWzBdLHNbMV0qc1syXSpzWzNdXTpuP2woYS80KS5tYXAoKGU9PjIqZSkpOmwoYSl9fSx0LnNxdWVlemVTaGFwZT1pLHQucGFyc2VBeGlzUGFyYW09cyx0LmlzSW50PWEsdC5zaXplRnJvbVNoYXBlPXUsdC5nZXRSb3dzQ29scz1mdW5jdGlvbihlKXtpZigwPT09ZS5sZW5ndGgpdGhyb3cgRXJyb3IoIkNhbm5vdCBnZXQgcm93cyBhbmQgY29sdW1ucyBvZiBhbiBlbXB0eSBzaGFwZSBhcnJheS4iKTtyZXR1cm4gW2UubGVuZ3RoPjE/ZVtlLmxlbmd0aC0yXToxLGVbZS5sZW5ndGgtMV1dfSx0LnNpemVUb1NxdWFyaXNoU2hhcGU9bCx0LmdldEJhdGNoRGltPWZ1bmN0aW9uKGUsdD0yKXtyZXR1cm4gdShlLnNsaWNlKDAsZS5sZW5ndGgtdCkpfTt9LDMzMTQ6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNyZWF0ZVRleHR1cmVMYXlvdXRGcm9tU2hhcGU9dC5jYWxjdWxhdGVUZXh0dXJlV2lkdGhBbmRIZWlnaHQ9dC5jcmVhdGVUZXh0dXJlTGF5b3V0RnJvbVRleHR1cmVUeXBlPXZvaWQgMDtjb25zdCByPW4oNzI3Myksbz1uKDU2MzkpO3QuY3JlYXRlVGV4dHVyZUxheW91dEZyb21UZXh0dXJlVHlwZT0oZSxuLHIpPT57Y29uc3QgaT1yPT09by5UZXh0dXJlVHlwZS51bnBhY2tlZHx8cj09PW8uVGV4dHVyZVR5cGUudW5wYWNrZWRSZXZlcnNlZD8xOjQscz1yPT09by5UZXh0dXJlVHlwZS5wYWNrZWQsYT1yPT09by5UZXh0dXJlVHlwZS51bnBhY2tlZFJldmVyc2VkfHxyPT09by5UZXh0dXJlVHlwZS5wYWNrZWQsdT1yPT09by5UZXh0dXJlVHlwZS5wYWNrZWRMYXN0RGltZW5zaW9uP24ubGVuZ3RoLTE6dm9pZCAwLGw9cj09PW8uVGV4dHVyZVR5cGUucGFja2VkTGFzdERpbWVuc2lvbj9uLm1hcCgoKGUsdCk9PnQ9PT1uLmxlbmd0aC0xPzQqZTplKSk6dm9pZCAwO3JldHVybiAoMCwgdC5jcmVhdGVUZXh0dXJlTGF5b3V0RnJvbVNoYXBlKShlLG4saSxsLHtpc1BhY2tlZDpzLHJldmVyc2VXSDphLGJyZWFrQXhpczp1fSl9LHQuY2FsY3VsYXRlVGV4dHVyZVdpZHRoQW5kSGVpZ2h0PShlLG4scik9Pntjb25zdCBvPSgwLCB0LmNyZWF0ZVRleHR1cmVMYXlvdXRGcm9tVGV4dHVyZVR5cGUpKGUsbixyKTtyZXR1cm4gW28ud2lkdGgsby5oZWlnaHRdfSx0LmNyZWF0ZVRleHR1cmVMYXlvdXRGcm9tU2hhcGU9KGUsdCxuPTEsbyxpKT0+e2NvbnN0IHM9ISghaXx8IWkuaXNQYWNrZWQpLFthLHVdPWUuY29tcHV0ZVRleHR1cmVXSChzJiZvfHx0LGkpLGw9dC5sZW5ndGg7bGV0IGM9dC5zbGljZSgwKTtpZigwPT09bCYmKGM9WzFdKSwxPT09bilvPXQ7ZWxzZSBpZihzKXtpZig0IT09bil0aHJvdyBuZXcgRXJyb3IoImEgcGFja2VkIHRleHR1cmUgbXVzdCBiZSA0LWNoYW5uZWwiKTtvPXQsbD4wJiYoY1tsLTFdPU1hdGguY2VpbChjW2wtMV0vMikpLGw+MSYmKGNbbC0yXT1NYXRoLmNlaWwoY1tsLTJdLzIpKTt9ZWxzZSBpZighbyl0aHJvdyBuZXcgRXJyb3IoIlVucGFja2VkIHNoYXBlIGlzIG5lZWRlZCB3aGVuIHVzaW5nIGNoYW5uZWxzID4gMSIpO3JldHVybiB7d2lkdGg6YSxoZWlnaHQ6dSxjaGFubmVsczpuLGlzUGFja2VkOnMsc2hhcGU6YyxzdHJpZGVzOnIuU2hhcGVVdGlsLmNvbXB1dGVTdHJpZGVzKGMpLHVucGFja2VkU2hhcGU6byxyZXZlcnNlZFdIOmkmJmkucmV2ZXJzZVdIfX07fSw1MjQzOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5UZXh0dXJlTWFuYWdlcj12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpO3QuVGV4dHVyZU1hbmFnZXI9Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4scil7dGhpcy5nbENvbnRleHQ9ZSx0aGlzLmxheW91dFN0cmF0ZWd5PXQsdGhpcy5wcm9maWxlcj1uLHRoaXMuY29uZmlnPXIsdGhpcy5wZW5kaW5nUmVhZD1uZXcgTWFwLHIucmV1c2VUZXh0dXJlcyYmKHRoaXMuaW5Vc2VUZXh0dXJlcz1uZXcgTWFwLHRoaXMuaWRsZVRleHR1cmVzPW5ldyBNYXAsdGhpcy50ZXh0dXJlTG9va3VwPW5ldyBNYXApO31jcmVhdGVUZXh0dXJlRnJvbUxheW91dChlLHQsbixvKXtjb25zdCBpPXRoaXMudG9FbmNvZGVyVHlwZShlKSxzPXRoaXMuZ2xDb250ZXh0LmdldEVuY29kZXIoaSx0LmNoYW5uZWxzfHwxLG8pO2lmKHQuaXNQYWNrZWQmJjE9PT1vKXRocm93IG5ldyBFcnJvcigibm90IGltcGxlbWVudGVkIik7Y29uc3QgYT10LndpZHRoLHU9dC5oZWlnaHQ7bGV0IGwsYztpZih0aGlzLmNvbmZpZy5yZXVzZVRleHR1cmVzKXtsPWAke2F9eCR7dX1fJHtzLmZvcm1hdH1fJHtzLmludGVybmFsRm9ybWF0fV8ke3MudGV4dHVyZVR5cGV9YCxjPXRoaXMuaW5Vc2VUZXh0dXJlcy5nZXQobCksY3x8KGM9W10sdGhpcy5pblVzZVRleHR1cmVzLnNldChsLGMpKTtjb25zdCB0PXRoaXMuaWRsZVRleHR1cmVzLmdldChsKTtpZih0JiZ0Lmxlbmd0aD4wKXtjb25zdCByPXQucG9wKCk7cmV0dXJuIGMucHVzaChyKSwxPT09byYmdGhpcy5nbENvbnRleHQudXBkYXRlVGV4dHVyZShyLGEsdSxzLHRoaXMudG9UZXh0dXJlRGF0YShlLG4pKSxyfX1yLkxvZ2dlci52ZXJib3NlKCJUZXh0dXJlTWFuYWdlciIsYENyZWF0aW5nIG5ldyB0ZXh0dXJlIG9mIHNpemUgJHt0LndpZHRofXgke3QuaGVpZ2h0fWApO2NvbnN0IHA9dGhpcy5nbENvbnRleHQuYWxsb2NhdGVUZXh0dXJlKGEsdSxzLHRoaXMudG9UZXh0dXJlRGF0YShlLG4pKTtyZXR1cm4gdGhpcy5jb25maWcucmV1c2VUZXh0dXJlcyYmKGMucHVzaChwKSx0aGlzLnRleHR1cmVMb29rdXAuc2V0KHAsbCkpLHB9cmVhZFRleHR1cmUoZSx0LG4pe3JldHVybiBufHwobj0xKSx0aGlzLnByb2ZpbGVyLmV2ZW50KCJiYWNrZW5kIiwiVGV4dHVyZU1hbmFnZXIucmVhZFRleHR1cmUiLCgoKT0+e2NvbnN0IHI9ZS5zaGFwZS5yZWR1Y2UoKChlLHQpPT5lKnQpKSpuLG89dGhpcy5nbENvbnRleHQucmVhZFRleHR1cmUoZS50ZXh0dXJlLGUud2lkdGgsZS5oZWlnaHQscix0aGlzLnRvRW5jb2RlclR5cGUodCksbik7cmV0dXJuIHRoaXMudG9UZW5zb3JEYXRhKHQsbyl9KSl9YXN5bmMgcmVhZFRleHR1cmVBc3luYyhlLHQsbil7Y29uc3Qgcj1lLnRlbnNvci5kYXRhSWQ7aWYobnx8KG49MSksdGhpcy5wZW5kaW5nUmVhZC5oYXMocikpe2NvbnN0IGU9dGhpcy5wZW5kaW5nUmVhZC5nZXQocik7cmV0dXJuIG5ldyBQcm9taXNlKCh0PT5udWxsPT1lP3ZvaWQgMDplLnB1c2godCkpKX1yZXR1cm4gdGhpcy5wcm9maWxlci5ldmVudCgiYmFja2VuZCIsIlRleHR1cmVNYW5hZ2VyLnJlYWRUZXh0dXJlQXN5bmMiLChhc3luYygpPT57dGhpcy5wZW5kaW5nUmVhZC5zZXQocixbXSk7Y29uc3Qgbz1lLnNoYXBlLnJlZHVjZSgoKGUsdCk9PmUqdCkpKm47YXdhaXQgdGhpcy5nbENvbnRleHQuY3JlYXRlQW5kV2FpdEZvckZlbmNlKCk7Y29uc3QgaT10aGlzLmdsQ29udGV4dC5yZWFkVGV4dHVyZShlLnRleHR1cmUsZS53aWR0aCxlLmhlaWdodCxvLHRoaXMudG9FbmNvZGVyVHlwZSh0KSxuKSxzPXRoaXMudG9UZW5zb3JEYXRhKHQsaSksYT10aGlzLnBlbmRpbmdSZWFkLmdldChyKTtyZXR1cm4gdGhpcy5wZW5kaW5nUmVhZC5kZWxldGUociksbnVsbD09YXx8YS5mb3JFYWNoKChlPT5lKHMpKSksc30pKX1yZWFkVWludDhUZXh0dXJlQXNGbG9hdChlKXtyZXR1cm4gdGhpcy5wcm9maWxlci5ldmVudCgiYmFja2VuZCIsIlRleHR1cmVNYW5hZ2VyLnJlYWRVaW50OFRleHR1cmVBc0Zsb2F0IiwoKCk9Pntjb25zdCB0PWUuc2hhcGUucmVkdWNlKCgoZSx0KT0+ZSp0KSksbj10aGlzLmdsQ29udGV4dC5yZWFkVGV4dHVyZShlLnRleHR1cmUsZS53aWR0aCxlLmhlaWdodCw0KnQsImJ5dGUiLDQpO3JldHVybiBuZXcgRmxvYXQzMkFycmF5KG4uYnVmZmVyLG4uYnl0ZU9mZnNldCx0KX0pKX1yZWxlYXNlVGV4dHVyZShlLHQpe2xldCBuO2lmKHRoaXMuY29uZmlnLnJldXNlVGV4dHVyZXMmJihuPXRoaXMudGV4dHVyZUxvb2t1cC5nZXQoZS50ZXh0dXJlKSxuKSl7dCYmdGhpcy50ZXh0dXJlTG9va3VwLmRlbGV0ZShuKTtjb25zdCByPXRoaXMuaW5Vc2VUZXh0dXJlcy5nZXQobik7aWYocil7Y29uc3QgdD1yLmluZGV4T2YoZS50ZXh0dXJlKTtpZigtMSE9PXQpe3Iuc3BsaWNlKHQsMSk7bGV0IG89dGhpcy5pZGxlVGV4dHVyZXMuZ2V0KG4pO298fChvPVtdLHRoaXMuaWRsZVRleHR1cmVzLnNldChuLG8pKSxvLnB1c2goZS50ZXh0dXJlKTt9fX1uJiYhdHx8KHIuTG9nZ2VyLnZlcmJvc2UoIlRleHR1cmVNYW5hZ2VyIixgRGVsZXRpbmcgdGV4dHVyZSBvZiBzaXplICR7ZS53aWR0aH14JHtlLmhlaWdodH1gKSx0aGlzLmdsQ29udGV4dC5kZWxldGVUZXh0dXJlKGUudGV4dHVyZSkpO310b1RlbnNvckRhdGEoZSx0KXtzd2l0Y2goZSl7Y2FzZSJpbnQxNiI6cmV0dXJuIHQgaW5zdGFuY2VvZiBJbnQxNkFycmF5P3Q6SW50MTZBcnJheS5mcm9tKHQpO2Nhc2UiaW50MzIiOnJldHVybiB0IGluc3RhbmNlb2YgSW50MzJBcnJheT90OkludDMyQXJyYXkuZnJvbSh0KTtjYXNlImludDgiOnJldHVybiB0IGluc3RhbmNlb2YgSW50OEFycmF5P3Q6SW50OEFycmF5LmZyb20odCk7Y2FzZSJ1aW50MTYiOnJldHVybiB0IGluc3RhbmNlb2YgVWludDE2QXJyYXk/dDpVaW50MTZBcnJheS5mcm9tKHQpO2Nhc2UidWludDMyIjpyZXR1cm4gdCBpbnN0YW5jZW9mIFVpbnQzMkFycmF5P3Q6VWludDMyQXJyYXkuZnJvbSh0KTtjYXNlInVpbnQ4IjpjYXNlImJvb2wiOnJldHVybiB0IGluc3RhbmNlb2YgVWludDhBcnJheT90OlVpbnQ4QXJyYXkuZnJvbSh0KTtjYXNlImZsb2F0MzIiOnJldHVybiB0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3Q6RmxvYXQzMkFycmF5LmZyb20odCk7Y2FzZSJmbG9hdDY0IjpyZXR1cm4gdCBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheT90OkZsb2F0NjRBcnJheS5mcm9tKHQpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBUZW5zb3JEYXRhIHR5cGUgJHtlfSBpcyBub3Qgc3VwcG9ydGVkYCl9fXRvVGV4dHVyZURhdGEoZSx0KXtpZih0KXJldHVybiB0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5P3Q6bmV3IEZsb2F0MzJBcnJheSh0KX10b0VuY29kZXJUeXBlKGUpe3JldHVybiAiZmxvYXQifWNsZWFyQWN0aXZlVGV4dHVyZXMoKXt0aGlzLmdsQ29udGV4dC5jbGVhckFjdGl2ZVRleHR1cmVzKCk7fX07fSw1NjM5OihlLHQpPT57dmFyIG47T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuVGV4dHVyZVR5cGU9dm9pZCAwLChuPXQuVGV4dHVyZVR5cGV8fCh0LlRleHR1cmVUeXBlPXt9KSlbbi51bnBhY2tlZD0wXT0idW5wYWNrZWQiLG5bbi51bnBhY2tlZFJldmVyc2VkPTFdPSJ1bnBhY2tlZFJldmVyc2VkIixuW24ucGFja2VkPTJdPSJwYWNrZWQiLG5bbi5kb3dubG9hZFVpbnQ4QXNGbG9hdD0zXT0iZG93bmxvYWRVaW50OEFzRmxvYXQiLG5bbi5wYWNrZWRMYXN0RGltZW5zaW9uPTRdPSJwYWNrZWRMYXN0RGltZW5zaW9uIjt9LDQzMjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZ2V0R2xDaGFubmVscz10LmdldENvb3Jkc0RhdGFUeXBlPXQuZ2V0U3F1ZWV6ZWRQYXJhbXM9dC5zcXVlZXplSW5wdXRTaGFwZT10LmdlbmVyYXRlU2hhZGVyRnVuY05hbWVGcm9tSW5wdXRTYW1wbGVyTmFtZUF0T3V0Q29vcmRzPXQuZ2VuZXJhdGVTaGFkZXJGdW5jTmFtZUZyb21JbnB1dFNhbXBsZXJOYW1lPXQucmVwZWF0ZWRUcnk9dC5nZXRQYWNrZWRTaGFwZT12b2lkIDA7Y29uc3Qgcj1uKDcyNzMpO3QuZ2V0UGFja2VkU2hhcGU9ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmxlbmd0aDtyZXR1cm4gZS5zbGljZSgwLHQtMSkuY29uY2F0KGVbdC0xXS80KX0sdC5yZXBlYXRlZFRyeT1hc3luYyBmdW5jdGlvbihlLHQ9KGU9PjApLG4pe3JldHVybiBuZXcgUHJvbWlzZSgoKHIsbyk9PntsZXQgaT0wO2NvbnN0IHM9KCk9PntpZihlKCkpcmV0dXJuIHZvaWQgcigpO2krKztjb25zdCBhPXQoaSk7bnVsbCE9biYmaT49bj9vKCk6c2V0VGltZW91dChzLGEpO307cygpO30pKX0sdC5nZW5lcmF0ZVNoYWRlckZ1bmNOYW1lRnJvbUlucHV0U2FtcGxlck5hbWU9ZnVuY3Rpb24oZSl7cmV0dXJuICgwLCByLmFzc2VydCkodm9pZCAwIT09ZSYmMCE9PWUubGVuZ3RoLCgoKT0+ImVtcHR5IHN0cmluZyBmb3VuZCBmb3Igc2FtcGxlciBuYW1lIikpLCJnZXQiK2UuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKX0sdC5nZW5lcmF0ZVNoYWRlckZ1bmNOYW1lRnJvbUlucHV0U2FtcGxlck5hbWVBdE91dENvb3Jkcz1mdW5jdGlvbihlKXtyZXR1cm4gKDAsIHIuYXNzZXJ0KSh2b2lkIDAhPT1lJiYwIT09ZS5sZW5ndGgsKCgpPT4iZW1wdHkgc3RyaW5nIGZvdW5kIGZvciBzYW1wbGVyIG5hbWUiKSksImdldCIrZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStlLnNsaWNlKDEpKyJBdE91dENvb3JkcyJ9LHQuc3F1ZWV6ZUlucHV0U2hhcGU9ZnVuY3Rpb24oZSx0KXtsZXQgbj1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGUpKTtyZXR1cm4gbj10LG59LHQuZ2V0U3F1ZWV6ZWRQYXJhbXM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5tYXAoKHQ9PmVbdF0pKS5qb2luKCIsICIpfSx0LmdldENvb3Jkc0RhdGFUeXBlPWZ1bmN0aW9uKGUpe2lmKGU8PTEpcmV0dXJuICJpbnQiO2lmKDI9PT1lKXJldHVybiAiaXZlYzIiO2lmKDM9PT1lKXJldHVybiAiaXZlYzMiO2lmKDQ9PT1lKXJldHVybiAiaXZlYzQiO2lmKDU9PT1lKXJldHVybiAiaXZlYzUiO2lmKDY9PT1lKXJldHVybiAiaXZlYzYiO3Rocm93IEVycm9yKGBHUFUgZm9yIHJhbmsgJHtlfSBpcyBub3QgeWV0IHN1cHBvcnRlZGApfSx0LmdldEdsQ2hhbm5lbHM9ZnVuY3Rpb24oZT02KXtyZXR1cm4gWyJ4IiwieSIsInoiLCJ3IiwidSIsInYiXS5zbGljZSgwLGUpfTt9LDMzODk6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNyZWF0ZU5ld1dlYkdMQ29udGV4dD10LmNyZWF0ZVdlYkdMQ29udGV4dD12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpLG89bigzNTI0KSxpPXt9O2Z1bmN0aW9uIHMoZSx0KXtsZXQgbjtjb25zdCBpPXthbHBoYTohMSxkZXB0aDohMSxhbnRpYWxpYXM6ITEsc3RlbmNpbDohMSxwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6ITEscHJlbXVsdGlwbGllZEFscGhhOiExLGZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQ6ITF9O2lmKCghdHx8IndlYmdsMiI9PT10KSYmKG49ZS5nZXRDb250ZXh0KCJ3ZWJnbDIiLGkpLG4pKXRyeXtyZXR1cm4gbmV3IG8uV2ViR0xDb250ZXh0KG4sMil9Y2F0Y2goZSl7ci5Mb2dnZXIud2FybmluZygiR2xDb250ZXh0RmFjdG9yeSIsYGZhaWxlZCB0byBjcmVhdGUgV2ViR0xDb250ZXh0IHVzaW5nIGNvbnRleHRJZCAnd2ViZ2wyJy4gRXJyb3I6ICR7ZX1gKTt9aWYoKCF0fHwid2ViZ2wiPT09dCkmJihuPWUuZ2V0Q29udGV4dCgid2ViZ2wiLGkpfHxlLmdldENvbnRleHQoImV4cGVyaW1lbnRhbC13ZWJnbCIsaSksbikpdHJ5e3JldHVybiBuZXcgby5XZWJHTENvbnRleHQobiwxKX1jYXRjaChlKXtyLkxvZ2dlci53YXJuaW5nKCJHbENvbnRleHRGYWN0b3J5IixgZmFpbGVkIHRvIGNyZWF0ZSBXZWJHTENvbnRleHQgdXNpbmcgY29udGV4dElkICd3ZWJnbCcgb3IgJ2V4cGVyaW1lbnRhbC13ZWJnbCcuIEVycm9yOiAke2V9YCk7fXRocm93IG5ldyBFcnJvcigiV2ViR0wgaXMgbm90IHN1cHBvcnRlZCIpfXQuY3JlYXRlV2ViR0xDb250ZXh0PWZ1bmN0aW9uIGUodCl7bGV0IG47aWYodCYmIndlYmdsMiIhPT10fHwhKCJ3ZWJnbDIiaW4gaSk/dCYmIndlYmdsIiE9PXR8fCEoIndlYmdsImluIGkpfHwobj1pLndlYmdsKTpuPWkud2ViZ2wyLCFuKXRyeXtuPXMoZnVuY3Rpb24oKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIE9mZnNjcmVlbkNhbnZhcyl0aHJvdyBuZXcgVHlwZUVycm9yKCJmYWlsZWQgdG8gY3JlYXRlIG9mZnNjcmVlbiBjYW52YXM6IE9mZnNjcmVlbkNhbnZhcyBpcyBub3Qgc3VwcG9ydGVkIik7cmV0dXJuIG5ldyBPZmZzY3JlZW5DYW52YXMoMSwxKX0oKSx0KTt9Y2F0Y2goZSl7bj1zKGZ1bmN0aW9uKCl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBkb2N1bWVudCl0aHJvdyBuZXcgVHlwZUVycm9yKCJmYWlsZWQgdG8gY3JlYXRlIGNhbnZhczogZG9jdW1lbnQgaXMgbm90IHN1cHBvcnRlZCIpO2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7cmV0dXJuIGUud2lkdGg9MSxlLmhlaWdodD0xLGV9KCksdCk7fXQ9dHx8MT09PW4udmVyc2lvbj8id2ViZ2wiOiJ3ZWJnbDIiO2NvbnN0IHI9bi5nbDtyZXR1cm4gaVt0XT1uLHIuaXNDb250ZXh0TG9zdCgpPyhkZWxldGUgaVt0XSxlKHQpKTooci5kaXNhYmxlKHIuREVQVEhfVEVTVCksci5kaXNhYmxlKHIuU1RFTkNJTF9URVNUKSxyLmRpc2FibGUoci5CTEVORCksci5kaXNhYmxlKHIuRElUSEVSKSxyLmRpc2FibGUoci5QT0xZR09OX09GRlNFVF9GSUxMKSxyLmRpc2FibGUoci5TQU1QTEVfQ09WRVJBR0UpLHIuZW5hYmxlKHIuU0NJU1NPUl9URVNUKSxyLmVuYWJsZShyLkNVTExfRkFDRSksci5jdWxsRmFjZShyLkJBQ0spLG4pfSx0LmNyZWF0ZU5ld1dlYkdMQ29udGV4dD1zO30sMzUyNDpmdW5jdGlvbihlLHQsbil7dmFyIHI9dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pO3ZhciBvPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTtvJiYhKCJnZXQiaW4gbz8hdC5fX2VzTW9kdWxlOm8ud3JpdGFibGV8fG8uY29uZmlndXJhYmxlKXx8KG89e2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRbbl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscixvKTt9OmZ1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pLGVbcl09dFtuXTt9KSxvPXRoaXMmJnRoaXMuX19zZXRNb2R1bGVEZWZhdWx0fHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbihlLHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJkZWZhdWx0Iix7ZW51bWVyYWJsZTohMCx2YWx1ZTp0fSk7fTpmdW5jdGlvbihlLHQpe2UuZGVmYXVsdD10O30pLGk9dGhpcyYmdGhpcy5fX2ltcG9ydFN0YXJ8fGZ1bmN0aW9uKGUpe2lmKGUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgdD17fTtpZihudWxsIT1lKWZvcih2YXIgbiBpbiBlKSJkZWZhdWx0IiE9PW4mJk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZyKHQsZSxuKTtyZXR1cm4gbyh0LGUpLHR9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LldlYkdMQ29udGV4dD10LmxpbmVhclNlYXJjaExhc3RUcnVlPXZvaWQgMDtjb25zdCBzPW4oMjIzNSksYT1pKG4oOTYyMikpLHU9big0MzIpO2Z1bmN0aW9uIGwoZSl7bGV0IHQ9MDtmb3IoO3Q8ZS5sZW5ndGgmJmVbdF0oKTsrK3QpO3JldHVybiB0LTF9dC5saW5lYXJTZWFyY2hMYXN0VHJ1ZT1sLHQuV2ViR0xDb250ZXh0PWNsYXNze2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5mcmFtZUJ1ZmZlckJvdW5kPSExLHRoaXMuaXRlbXNUb1BvbGw9W10sdGhpcy5nbD1lLHRoaXMudmVyc2lvbj10LHRoaXMuZ2V0RXh0ZW5zaW9ucygpLHRoaXMudmVydGV4YnVmZmVyPXRoaXMuY3JlYXRlVmVydGV4YnVmZmVyKCksdGhpcy5mcmFtZWJ1ZmZlcj10aGlzLmNyZWF0ZUZyYW1lYnVmZmVyKCksdGhpcy5xdWVyeVZpdGFsUGFyYW1ldGVycygpO31hbGxvY2F0ZVRleHR1cmUoZSx0LG4scil7Y29uc3Qgbz10aGlzLmdsLGk9by5jcmVhdGVUZXh0dXJlKCk7by5iaW5kVGV4dHVyZShvLlRFWFRVUkVfMkQsaSksby50ZXhQYXJhbWV0ZXJpKG8uVEVYVFVSRV8yRCxvLlRFWFRVUkVfTUlOX0ZJTFRFUixvLk5FQVJFU1QpLG8udGV4UGFyYW1ldGVyaShvLlRFWFRVUkVfMkQsby5URVhUVVJFX01BR19GSUxURVIsby5ORUFSRVNUKSxvLnRleFBhcmFtZXRlcmkoby5URVhUVVJFXzJELG8uVEVYVFVSRV9XUkFQX1Msby5DTEFNUF9UT19FREdFKSxvLnRleFBhcmFtZXRlcmkoby5URVhUVVJFXzJELG8uVEVYVFVSRV9XUkFQX1Qsby5DTEFNUF9UT19FREdFKTtjb25zdCBzPXI/bi5lbmNvZGUocixlKnQpOm51bGw7cmV0dXJuIG8udGV4SW1hZ2UyRChvLlRFWFRVUkVfMkQsMCxuLmludGVybmFsRm9ybWF0LGUsdCwwLG4uZm9ybWF0LG4udGV4dHVyZVR5cGUscyksdGhpcy5jaGVja0Vycm9yKCksaX11cGRhdGVUZXh0dXJlKGUsdCxuLHIsbyl7Y29uc3QgaT10aGlzLmdsO2kuYmluZFRleHR1cmUoaS5URVhUVVJFXzJELGUpO2NvbnN0IHM9ci5lbmNvZGUobyx0Km4pO2kudGV4U3ViSW1hZ2UyRChpLlRFWFRVUkVfMkQsMCwwLDAsdCxuLHIuZm9ybWF0LHIudGV4dHVyZVR5cGUscyksdGhpcy5jaGVja0Vycm9yKCk7fWF0dGFjaEZyYW1lYnVmZmVyKGUsdCxuKXtjb25zdCByPXRoaXMuZ2w7ci5iaW5kVGV4dHVyZShyLlRFWFRVUkVfMkQsZSksci5iaW5kRnJhbWVidWZmZXIoci5GUkFNRUJVRkZFUix0aGlzLmZyYW1lYnVmZmVyKSxyLmZyYW1lYnVmZmVyVGV4dHVyZTJEKHIuRlJBTUVCVUZGRVIsci5DT0xPUl9BVFRBQ0hNRU5UMCxyLlRFWFRVUkVfMkQsZSwwKSx0aGlzLmNoZWNrRXJyb3IoKSxyLnZpZXdwb3J0KDAsMCx0LG4pLHIuc2Npc3NvcigwLDAsdCxuKTt9cmVhZFRleHR1cmUoZSx0LG4scixvLGkpe2NvbnN0IHM9dGhpcy5nbDtpfHwoaT0xKSx0aGlzLmZyYW1lQnVmZmVyQm91bmR8fHRoaXMuYXR0YWNoRnJhbWVidWZmZXIoZSx0LG4pO2NvbnN0IGE9dGhpcy5nZXRFbmNvZGVyKG8saSksdT1hLmFsbG9jYXRlKHQqbik7cmV0dXJuIHMuYmluZFRleHR1cmUocy5URVhUVVJFXzJELGUpLHMuZnJhbWVidWZmZXJUZXh0dXJlMkQocy5GUkFNRUJVRkZFUixzLkNPTE9SX0FUVEFDSE1FTlQwLHMuVEVYVFVSRV8yRCxlLDApLHMucmVhZFBpeGVscygwLDAsdCxuLHMuUkdCQSxhLnRleHR1cmVUeXBlLHUpLHRoaXMuY2hlY2tFcnJvcigpLGEuZGVjb2RlKHUscil9aXNGcmFtZWJ1ZmZlclJlYWR5KCl7cmV0dXJuICEwfWdldEFjdGl2ZVRleHR1cmUoKXtjb25zdCBlPXRoaXMuZ2w7cmV0dXJuICJURVhUVVJFIisoZS5nZXRQYXJhbWV0ZXIodGhpcy5nbC5BQ1RJVkVfVEVYVFVSRSktZS5URVhUVVJFMCl9Z2V0VGV4dHVyZUJpbmRpbmcoKXtyZXR1cm4gdGhpcy5nbC5nZXRQYXJhbWV0ZXIodGhpcy5nbC5URVhUVVJFX0JJTkRJTkdfMkQpfWdldEZyYW1lYnVmZmVyQmluZGluZygpe3JldHVybiB0aGlzLmdsLmdldFBhcmFtZXRlcih0aGlzLmdsLkZSQU1FQlVGRkVSX0JJTkRJTkcpfXNldFZlcnRleEF0dHJpYnV0ZXMoZSx0KXtjb25zdCBuPXRoaXMuZ2w7bi52ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsMyxuLkZMT0FULCExLDIwLDApLG4uZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoZSksLTEhPT10JiYobi52ZXJ0ZXhBdHRyaWJQb2ludGVyKHQsMixuLkZMT0FULCExLDIwLDEyKSxuLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHQpKSx0aGlzLmNoZWNrRXJyb3IoKTt9Y3JlYXRlUHJvZ3JhbShlLHQpe2NvbnN0IG49dGhpcy5nbCxyPW4uY3JlYXRlUHJvZ3JhbSgpO3JldHVybiBuLmF0dGFjaFNoYWRlcihyLGUpLG4uYXR0YWNoU2hhZGVyKHIsdCksbi5saW5rUHJvZ3JhbShyKSxyfWNvbXBpbGVTaGFkZXIoZSx0KXtjb25zdCBuPXRoaXMuZ2wscj1uLmNyZWF0ZVNoYWRlcih0KTtpZighcil0aHJvdyBuZXcgRXJyb3IoYGNyZWF0ZVNoYWRlcigpIHJldHVybmVkIG51bGwgd2l0aCB0eXBlICR7dH1gKTtpZihuLnNoYWRlclNvdXJjZShyLGUpLG4uY29tcGlsZVNoYWRlcihyKSwhMT09PW4uZ2V0U2hhZGVyUGFyYW1ldGVyKHIsbi5DT01QSUxFX1NUQVRVUykpdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY29tcGlsZSBzaGFkZXI6ICR7bi5nZXRTaGFkZXJJbmZvTG9nKHIpfVxuU2hhZGVyIHNvdXJjZTpcbiR7ZX1gKTtyZXR1cm4gcn1kZWxldGVTaGFkZXIoZSl7dGhpcy5nbC5kZWxldGVTaGFkZXIoZSk7fWJpbmRUZXh0dXJlVG9Vbmlmb3JtKGUsdCxuKXtjb25zdCByPXRoaXMuZ2w7ci5hY3RpdmVUZXh0dXJlKHIuVEVYVFVSRTArdCksdGhpcy5jaGVja0Vycm9yKCksci5iaW5kVGV4dHVyZShyLlRFWFRVUkVfMkQsZSksdGhpcy5jaGVja0Vycm9yKCksci51bmlmb3JtMWkobix0KSx0aGlzLmNoZWNrRXJyb3IoKTt9ZHJhdygpe3RoaXMuZ2wuZHJhd0FycmF5cyh0aGlzLmdsLlRSSUFOR0xFX1NUUklQLDAsNCksdGhpcy5jaGVja0Vycm9yKCk7fWNoZWNrRXJyb3IoKXtpZihzLmVudi5kZWJ1Zyl7Y29uc3QgZT10aGlzLmdsLHQ9ZS5nZXRFcnJvcigpO2xldCBuPSIiO3N3aXRjaCh0KXtjYXNlIGUuTk9fRVJST1I6cmV0dXJuO2Nhc2UgZS5JTlZBTElEX0VOVU06bj0iSU5WQUxJRF9FTlVNIjticmVhaztjYXNlIGUuSU5WQUxJRF9WQUxVRTpuPSJJTlZBTElEX1ZBTFVFIjticmVhaztjYXNlIGUuSU5WQUxJRF9PUEVSQVRJT046bj0iSU5WQUxJRF9PUEVSQVRJT04iO2JyZWFrO2Nhc2UgZS5JTlZBTElEX0ZSQU1FQlVGRkVSX09QRVJBVElPTjpuPSJJTlZBTElEX0ZSQU1FQlVGRkVSX09QRVJBVElPTiI7YnJlYWs7Y2FzZSBlLk9VVF9PRl9NRU1PUlk6bj0iT1VUX09GX01FTU9SWSI7YnJlYWs7Y2FzZSBlLkNPTlRFWFRfTE9TVF9XRUJHTDpuPSJDT05URVhUX0xPU1RfV0VCR0wiO2JyZWFrO2RlZmF1bHQ6bj1gVW5rbm93biBXZWJHTCBFcnJvcjogJHt0LnRvU3RyaW5nKDE2KX1gO310aHJvdyBuZXcgRXJyb3Iobil9fWRlbGV0ZVRleHR1cmUoZSl7dGhpcy5nbC5kZWxldGVUZXh0dXJlKGUpO31kZWxldGVQcm9ncmFtKGUpe3RoaXMuZ2wuZGVsZXRlUHJvZ3JhbShlKTt9Z2V0RW5jb2RlcihlLHQsbj0wKXtpZigyPT09dGhpcy52ZXJzaW9uKXJldHVybiBuZXcgYS5SZWRGbG9hdDMyRGF0YUVuY29kZXIodGhpcy5nbCx0KTtzd2l0Y2goZSl7Y2FzZSJmbG9hdCI6cmV0dXJuIDE9PT1ufHx0aGlzLmlzUmVuZGVyRmxvYXQzMlN1cHBvcnRlZD9uZXcgYS5SR0JBRmxvYXREYXRhRW5jb2Rlcih0aGlzLmdsLHQpOm5ldyBhLlJHQkFGbG9hdERhdGFFbmNvZGVyKHRoaXMuZ2wsdCx0aGlzLnRleHR1cmVIYWxmRmxvYXRFeHRlbnNpb24uSEFMRl9GTE9BVF9PRVMpO2Nhc2UiaW50Ijp0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpO2Nhc2UiYnl0ZSI6cmV0dXJuIG5ldyBhLlVpbnQ4RGF0YUVuY29kZXIodGhpcy5nbCx0KTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgSW52YWxpZCBkYXRhVHlwZTogJHtlfWApfX1jbGVhckFjdGl2ZVRleHR1cmVzKCl7Y29uc3QgZT10aGlzLmdsO2ZvcihsZXQgdD0wO3Q8dGhpcy5tYXhUZXh0dXJlSW1hZ2VVbml0czsrK3QpZS5hY3RpdmVUZXh0dXJlKGUuVEVYVFVSRTArdCksZS5iaW5kVGV4dHVyZShlLlRFWFRVUkVfMkQsbnVsbCk7fWRpc3Bvc2UoKXtpZih0aGlzLmRpc3Bvc2VkKXJldHVybjtjb25zdCBlPXRoaXMuZ2w7ZS5iaW5kRnJhbWVidWZmZXIoZS5GUkFNRUJVRkZFUixudWxsKSxlLmRlbGV0ZUZyYW1lYnVmZmVyKHRoaXMuZnJhbWVidWZmZXIpLGUuYmluZEJ1ZmZlcihlLkFSUkFZX0JVRkZFUixudWxsKSxlLmRlbGV0ZUJ1ZmZlcih0aGlzLnZlcnRleGJ1ZmZlciksZS5iaW5kQnVmZmVyKGUuRUxFTUVOVF9BUlJBWV9CVUZGRVIsbnVsbCksZS5maW5pc2goKSx0aGlzLmRpc3Bvc2VkPSEwO31jcmVhdGVEZWZhdWx0R2VvbWV0cnkoKXtyZXR1cm4gbmV3IEZsb2F0MzJBcnJheShbLTEsMSwwLDAsMSwtMSwtMSwwLDAsMCwxLDEsMCwxLDEsMSwtMSwwLDEsMF0pfWNyZWF0ZVZlcnRleGJ1ZmZlcigpe2NvbnN0IGU9dGhpcy5nbCx0PWUuY3JlYXRlQnVmZmVyKCk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKCJjcmVhdGVCdWZmZXIoKSByZXR1cm5lZCBudWxsIik7Y29uc3Qgbj10aGlzLmNyZWF0ZURlZmF1bHRHZW9tZXRyeSgpO3JldHVybiBlLmJpbmRCdWZmZXIoZS5BUlJBWV9CVUZGRVIsdCksZS5idWZmZXJEYXRhKGUuQVJSQVlfQlVGRkVSLG4sZS5TVEFUSUNfRFJBVyksdGhpcy5jaGVja0Vycm9yKCksdH1jcmVhdGVGcmFtZWJ1ZmZlcigpe2NvbnN0IGU9dGhpcy5nbC5jcmVhdGVGcmFtZWJ1ZmZlcigpO2lmKCFlKXRocm93IG5ldyBFcnJvcigiY3JlYXRlRnJhbWVidWZmZXIgcmV0dXJuZWQgbnVsbCIpO3JldHVybiBlfXF1ZXJ5Vml0YWxQYXJhbWV0ZXJzKCl7Y29uc3QgZT10aGlzLmdsO2lmKHRoaXMuaXNGbG9hdFRleHR1cmVBdHRhY2hhYmxlVG9GcmFtZUJ1ZmZlcj10aGlzLmNoZWNrRmxvYXRUZXh0dXJlQXR0YWNoYWJsZVRvRnJhbWVCdWZmZXIoKSx0aGlzLmlzUmVuZGVyRmxvYXQzMlN1cHBvcnRlZD10aGlzLmNoZWNrUmVuZGVyRmxvYXQzMigpLHRoaXMuaXNGbG9hdDMyRG93bmxvYWRTdXBwb3J0ZWQ9dGhpcy5jaGVja0Zsb2F0MzJEb3dubG9hZCgpLDE9PT10aGlzLnZlcnNpb24mJiF0aGlzLnRleHR1cmVIYWxmRmxvYXRFeHRlbnNpb24mJiF0aGlzLmlzUmVuZGVyRmxvYXQzMlN1cHBvcnRlZCl0aHJvdyBuZXcgRXJyb3IoImJvdGggZmxvYXQzMiBhbmQgZmxvYXQxNiBUZXh0dXJlVHlwZSBhcmUgbm90IHN1cHBvcnRlZCIpO3RoaXMuaXNCbGVuZFN1cHBvcnRlZD0hdGhpcy5pc1JlbmRlckZsb2F0MzJTdXBwb3J0ZWR8fHRoaXMuY2hlY2tGbG9hdDMyQmxlbmQoKSx0aGlzLm1heFRleHR1cmVTaXplPWUuZ2V0UGFyYW1ldGVyKGUuTUFYX1RFWFRVUkVfU0laRSksdGhpcy5tYXhUZXh0dXJlSW1hZ2VVbml0cz1lLmdldFBhcmFtZXRlcihlLk1BWF9URVhUVVJFX0lNQUdFX1VOSVRTKSx0aGlzLnZlcnNpb247fWdldEV4dGVuc2lvbnMoKXsyPT09dGhpcy52ZXJzaW9uPyh0aGlzLmNvbG9yQnVmZmVyRmxvYXRFeHRlbnNpb249dGhpcy5nbC5nZXRFeHRlbnNpb24oIkVYVF9jb2xvcl9idWZmZXJfZmxvYXQiKSx0aGlzLmRpc2pvaW50VGltZXJRdWVyeVdlYmdsMkV4dGVuc2lvbj10aGlzLmdsLmdldEV4dGVuc2lvbigiRVhUX2Rpc2pvaW50X3RpbWVyX3F1ZXJ5X3dlYmdsMiIpKToodGhpcy50ZXh0dXJlRmxvYXRFeHRlbnNpb249dGhpcy5nbC5nZXRFeHRlbnNpb24oIk9FU190ZXh0dXJlX2Zsb2F0IiksdGhpcy50ZXh0dXJlSGFsZkZsb2F0RXh0ZW5zaW9uPXRoaXMuZ2wuZ2V0RXh0ZW5zaW9uKCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0IikpO31jaGVja0Zsb2F0VGV4dHVyZUF0dGFjaGFibGVUb0ZyYW1lQnVmZmVyKCl7Y29uc3QgZT10aGlzLmdsLHQ9ZS5jcmVhdGVUZXh0dXJlKCk7ZS5iaW5kVGV4dHVyZShlLlRFWFRVUkVfMkQsdCk7Y29uc3Qgbj0yPT09dGhpcy52ZXJzaW9uP2UuUkdCQTMyRjplLlJHQkE7ZS50ZXhJbWFnZTJEKGUuVEVYVFVSRV8yRCwwLG4sMSwxLDAsZS5SR0JBLGUuRkxPQVQsbnVsbCk7Y29uc3Qgcj1lLmNyZWF0ZUZyYW1lYnVmZmVyKCk7ZS5iaW5kRnJhbWVidWZmZXIoZS5GUkFNRUJVRkZFUixyKSxlLmZyYW1lYnVmZmVyVGV4dHVyZTJEKGUuRlJBTUVCVUZGRVIsZS5DT0xPUl9BVFRBQ0hNRU5UMCxlLlRFWFRVUkVfMkQsdCwwKTtjb25zdCBvPWUuY2hlY2tGcmFtZWJ1ZmZlclN0YXR1cyhlLkZSQU1FQlVGRkVSKT09PWUuRlJBTUVCVUZGRVJfQ09NUExFVEU7cmV0dXJuIGUuYmluZFRleHR1cmUoZS5URVhUVVJFXzJELG51bGwpLGUuYmluZEZyYW1lYnVmZmVyKGUuRlJBTUVCVUZGRVIsbnVsbCksZS5kZWxldGVUZXh0dXJlKHQpLGUuZGVsZXRlRnJhbWVidWZmZXIociksb31jaGVja1JlbmRlckZsb2F0MzIoKXtpZigyPT09dGhpcy52ZXJzaW9uKXtpZighdGhpcy5jb2xvckJ1ZmZlckZsb2F0RXh0ZW5zaW9uKXJldHVybiAhMX1lbHNlIGlmKCF0aGlzLnRleHR1cmVGbG9hdEV4dGVuc2lvbilyZXR1cm4gITE7cmV0dXJuIHRoaXMuaXNGbG9hdFRleHR1cmVBdHRhY2hhYmxlVG9GcmFtZUJ1ZmZlcn1jaGVja0Zsb2F0MzJEb3dubG9hZCgpe2lmKDI9PT10aGlzLnZlcnNpb24pe2lmKCF0aGlzLmNvbG9yQnVmZmVyRmxvYXRFeHRlbnNpb24pcmV0dXJuICExfWVsc2Uge2lmKCF0aGlzLnRleHR1cmVGbG9hdEV4dGVuc2lvbilyZXR1cm4gITE7aWYoIXRoaXMuZ2wuZ2V0RXh0ZW5zaW9uKCJXRUJHTF9jb2xvcl9idWZmZXJfZmxvYXQiKSlyZXR1cm4gITF9cmV0dXJuIHRoaXMuaXNGbG9hdFRleHR1cmVBdHRhY2hhYmxlVG9GcmFtZUJ1ZmZlcn1jaGVja0Zsb2F0MzJCbGVuZCgpe2NvbnN0IGU9dGhpcy5nbDtsZXQgdCxuLHIsbyxpO3RyeXt0PWUuY3JlYXRlVGV4dHVyZSgpLG49ZS5jcmVhdGVGcmFtZWJ1ZmZlcigpLGUuYmluZFRleHR1cmUoZS5URVhUVVJFXzJELHQpO2NvbnN0IHM9Mj09PXRoaXMudmVyc2lvbj9lLlJHQkEzMkY6ZS5SR0JBO3JldHVybiBlLnRleEltYWdlMkQoZS5URVhUVVJFXzJELDAscywxLDEsMCxlLlJHQkEsZS5GTE9BVCxudWxsKSxlLmJpbmRGcmFtZWJ1ZmZlcihlLkZSQU1FQlVGRkVSLG4pLGUuZnJhbWVidWZmZXJUZXh0dXJlMkQoZS5GUkFNRUJVRkZFUixlLkNPTE9SX0FUVEFDSE1FTlQwLGUuVEVYVFVSRV8yRCx0LDApLGUuZW5hYmxlKGUuQkxFTkQpLHI9ZS5jcmVhdGVTaGFkZXIoZS5WRVJURVhfU0hBREVSKSwhIXImJihlLnNoYWRlclNvdXJjZShyLCJ2b2lkIG1haW4oKXt9IiksZS5jb21waWxlU2hhZGVyKHIpLG89ZS5jcmVhdGVTaGFkZXIoZS5GUkFHTUVOVF9TSEFERVIpLCEhbyYmKGUuc2hhZGVyU291cmNlKG8sInByZWNpc2lvbiBoaWdocCBmbG9hdDt2b2lkIG1haW4oKXtnbF9GcmFnQ29sb3I9dmVjNCgwLjUpO30iKSxlLmNvbXBpbGVTaGFkZXIobyksaT1lLmNyZWF0ZVByb2dyYW0oKSwhIWkmJihlLmF0dGFjaFNoYWRlcihpLHIpLGUuYXR0YWNoU2hhZGVyKGksbyksZS5saW5rUHJvZ3JhbShpKSxlLnVzZVByb2dyYW0oaSksZS5kcmF3QXJyYXlzKGUuUE9JTlRTLDAsMSksZS5nZXRFcnJvcigpPT09ZS5OT19FUlJPUikpKX1maW5hbGx5e2UuZGlzYWJsZShlLkJMRU5EKSxpJiZlLmRlbGV0ZVByb2dyYW0oaSksciYmZS5kZWxldGVTaGFkZXIociksbyYmZS5kZWxldGVTaGFkZXIobyksbiYmKGUuYmluZEZyYW1lYnVmZmVyKGUuRlJBTUVCVUZGRVIsbnVsbCksZS5kZWxldGVGcmFtZWJ1ZmZlcihuKSksdCYmKGUuYmluZFRleHR1cmUoZS5URVhUVVJFXzJELG51bGwpLGUuZGVsZXRlVGV4dHVyZSh0KSk7fX1iZWdpblRpbWVyKCl7aWYoMj09PXRoaXMudmVyc2lvbiYmdGhpcy5kaXNqb2ludFRpbWVyUXVlcnlXZWJnbDJFeHRlbnNpb24pe2NvbnN0IGU9dGhpcy5nbCx0PXRoaXMuZGlzam9pbnRUaW1lclF1ZXJ5V2ViZ2wyRXh0ZW5zaW9uLG49ZS5jcmVhdGVRdWVyeSgpO3JldHVybiBlLmJlZ2luUXVlcnkodC5USU1FX0VMQVBTRURfRVhULG4pLG59dGhyb3cgbmV3IEVycm9yKCJXZWJHTDEgcHJvZmlsaW5nIGN1cnJlbnRseSBub3Qgc3VwcG9ydGVkLiIpfWVuZFRpbWVyKCl7aWYoMiE9PXRoaXMudmVyc2lvbnx8IXRoaXMuZGlzam9pbnRUaW1lclF1ZXJ5V2ViZ2wyRXh0ZW5zaW9uKXRocm93IG5ldyBFcnJvcigiV2ViR0wxIHByb2ZpbGluZyBjdXJyZW50bHkgbm90IHN1cHBvcnRlZCIpO3tjb25zdCBlPXRoaXMuZ2wsdD10aGlzLmRpc2pvaW50VGltZXJRdWVyeVdlYmdsMkV4dGVuc2lvbjtlLmVuZFF1ZXJ5KHQuVElNRV9FTEFQU0VEX0VYVCk7fX1pc1RpbWVyUmVzdWx0QXZhaWxhYmxlKGUpe2xldCB0PSExLG49ITE7aWYoMiE9PXRoaXMudmVyc2lvbnx8IXRoaXMuZGlzam9pbnRUaW1lclF1ZXJ5V2ViZ2wyRXh0ZW5zaW9uKXRocm93IG5ldyBFcnJvcigiV2ViR0wxIHByb2ZpbGluZyBjdXJyZW50bHkgbm90IHN1cHBvcnRlZCIpO3tjb25zdCByPXRoaXMuZ2wsbz10aGlzLmRpc2pvaW50VGltZXJRdWVyeVdlYmdsMkV4dGVuc2lvbjt0PXIuZ2V0UXVlcnlQYXJhbWV0ZXIoZSxyLlFVRVJZX1JFU1VMVF9BVkFJTEFCTEUpLG49ci5nZXRQYXJhbWV0ZXIoby5HUFVfRElTSk9JTlRfRVhUKTt9cmV0dXJuIHQmJiFufWdldFRpbWVyUmVzdWx0KGUpe2xldCB0PTA7aWYoMiE9PXRoaXMudmVyc2lvbil0aHJvdyBuZXcgRXJyb3IoIldlYkdMMSBwcm9maWxpbmcgY3VycmVudGx5IG5vdCBzdXBwb3J0ZWQiKTt7Y29uc3Qgbj10aGlzLmdsO3Q9bi5nZXRRdWVyeVBhcmFtZXRlcihlLG4uUVVFUllfUkVTVUxUKSxuLmRlbGV0ZVF1ZXJ5KGUpO31yZXR1cm4gdC8xZTZ9YXN5bmMgd2FpdEZvclF1ZXJ5QW5kR2V0VGltZShlKXtyZXR1cm4gYXdhaXQoMCwgdS5yZXBlYXRlZFRyeSkoKCgpPT50aGlzLmlzVGltZXJSZXN1bHRBdmFpbGFibGUoZSkpKSx0aGlzLmdldFRpbWVyUmVzdWx0KGUpfWFzeW5jIGNyZWF0ZUFuZFdhaXRGb3JGZW5jZSgpe2NvbnN0IGU9dGhpcy5jcmVhdGVGZW5jZSh0aGlzLmdsKTtyZXR1cm4gdGhpcy5wb2xsRmVuY2UoZSl9Y3JlYXRlRmVuY2UoZSl7bGV0IHQ7Y29uc3Qgbj1lLHI9bi5mZW5jZVN5bmMobi5TWU5DX0dQVV9DT01NQU5EU19DT01QTEVURSwwKTtyZXR1cm4gZS5mbHVzaCgpLHQ9bnVsbD09PXI/KCk9PiEwOigpPT57Y29uc3QgZT1uLmNsaWVudFdhaXRTeW5jKHIsMCwwKTtyZXR1cm4gZT09PW4uQUxSRUFEWV9TSUdOQUxFRHx8ZT09PW4uQ09ORElUSU9OX1NBVElTRklFRH0se3F1ZXJ5OnIsaXNGZW5jZVBhc3NlZDp0fX1hc3luYyBwb2xsRmVuY2UoZSl7cmV0dXJuIG5ldyBQcm9taXNlKCh0PT57dGhpcy5hZGRJdGVtVG9Qb2xsKCgoKT0+ZS5pc0ZlbmNlUGFzc2VkKCkpLCgoKT0+dCgpKSk7fSkpfXBvbGxJdGVtcygpe2NvbnN0IGU9bCh0aGlzLml0ZW1zVG9Qb2xsLm1hcCgoZT0+ZS5pc0RvbmVGbikpKTtmb3IobGV0IHQ9MDt0PD1lOysrdCl7Y29uc3R7cmVzb2x2ZUZuOmV9PXRoaXMuaXRlbXNUb1BvbGxbdF07ZSgpO310aGlzLml0ZW1zVG9Qb2xsPXRoaXMuaXRlbXNUb1BvbGwuc2xpY2UoZSsxKTt9YXN5bmMgYWRkSXRlbVRvUG9sbChlLHQpe3RoaXMuaXRlbXNUb1BvbGwucHVzaCh7aXNEb25lRm46ZSxyZXNvbHZlRm46dH0pLHRoaXMuaXRlbXNUb1BvbGwubGVuZ3RoPjF8fGF3YWl0KDAsIHUucmVwZWF0ZWRUcnkpKCgoKT0+KHRoaXMucG9sbEl0ZW1zKCksMD09PXRoaXMuaXRlbXNUb1BvbGwubGVuZ3RoKSkpO319O30sNjQ5NjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuRXhlY3V0aW9uUGxhbj12b2lkIDA7Y29uc3Qgcj1uKDEzMTUpO2NsYXNzIG97Y29uc3RydWN0b3IoZSx0KXt0aGlzLm9wPWUsdGhpcy5ub2RlPXQ7fX10LkV4ZWN1dGlvblBsYW49Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4pe3RoaXMuZ3JhcGg9ZSx0aGlzLnByb2ZpbGVyPW4sdGhpcy5pbml0aWFsaXplKHQpO31pbml0aWFsaXplKGUpe3RoaXMucHJvZmlsZXIuZXZlbnQoInNlc3Npb24iLCJFeGVjdXRpb25QbGFuLmluaXRpYWxpemUiLCgoKT0+e2NvbnN0IHQ9dGhpcy5ncmFwaC5nZXROb2RlcygpO2lmKHQubGVuZ3RoIT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJUaGUgc2l6ZSBvZiBub2RlcyBhbmQgT1BzIGRvIG5vdCBtYXRjaC4iKTt0aGlzLl9vcHM9ZS5tYXAoKChlLG4pPT5uZXcgbyhlLHRbbl0pKSksdGhpcy5yZXNldCgpLHRoaXMuX3N0YXJ0ZXI9W10sdGhpcy5fb3BzLmZvckVhY2goKChlLHQpPT57bGV0IG49ITA7Zm9yKGNvbnN0IHQgb2YgZS5ub2RlLmlucHV0cylpZighdGhpcy5fdmFsdWVzW3RdJiYtMT09PXRoaXMuZ3JhcGguZ2V0SW5wdXRJbmRpY2VzKCkuaW5kZXhPZih0KSl7bj0hMTticmVha31uJiZ0aGlzLl9zdGFydGVyLnB1c2godCk7fSkpO30pKTt9cmVzZXQoKXt0aGlzLl92YWx1ZXM9dGhpcy5ncmFwaC5nZXRWYWx1ZXMoKS5tYXAoKGU9PmUudGVuc29yKSk7fWFzeW5jIGV4ZWN1dGUoZSx0KXtyZXR1cm4gdGhpcy5wcm9maWxlci5ldmVudCgic2Vzc2lvbiIsIkV4ZWN1dGlvblBsYW4uZXhlY3V0ZSIsKGFzeW5jKCk9Pnt0aGlzLnJlc2V0KCk7Y29uc3Qgbj1lLmNyZWF0ZUluZmVyZW5jZUhhbmRsZXIoKSxvPXRoaXMuZ3JhcGguZ2V0SW5wdXRJbmRpY2VzKCk7aWYodC5sZW5ndGghPT1vLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoYG51bWJlciBvZiBpbnB1dCB0ZW5zb3JzIGRvbid0IG1hdGNoIHRoZSBudW1iZXIgb2YgaW5wdXRzIHRvIHRoZSBtb2RlbDogYWN0dWFsOiAke3QubGVuZ3RofSBleHBlY3RlZDogJHtvLmxlbmd0aH1gKTt0LmZvckVhY2goKChlLHQpPT57Y29uc3Qgbj1vW3RdO3RoaXMuX3ZhbHVlc1tuXT1lO30pKTtjb25zdCBpPXRoaXMuX3N0YXJ0ZXIuc2xpY2UoMCkscz10aGlzLmdyYXBoLmdldFZhbHVlcygpLGE9dGhpcy5ncmFwaC5nZXROb2RlcygpO2xldCB1PTA7Zm9yKDt1PGkubGVuZ3RoOyl7Y29uc3QgZT1pW3UrK10sdD10aGlzLl9vcHNbZV0sbz10Lm5vZGUuaW5wdXRzLm1hcCgoZT0+dGhpcy5fdmFsdWVzW2VdKSk7aWYoLTEhPT1vLmluZGV4T2Yodm9pZCAwKSl0aHJvdyBuZXcgRXJyb3IoYHVucmVzb2x2ZWQgaW5wdXQgZGV0ZWN0ZWQ6IG9wOiAke3Qubm9kZX1gKTtjb25zdCBsPW87ci5Mb2dnZXIudmVyYm9zZSgiRXhlY1BsYW4iLGBSdW5pbmcgb3A6JHt0Lm5vZGUubmFtZX0gKCR7bC5tYXAoKChlLG4pPT5gJyR7dC5ub2RlLmlucHV0c1tuXX0nOiAke2UudHlwZX1bJHtlLmRpbXMuam9pbigiLCIpfV1gKSkuam9pbigiLCAiKX0pYCk7Y29uc3QgYz1hd2FpdCB0aGlzLnByb2ZpbGVyLmV2ZW50KCJub2RlIix0Lm5vZGUubmFtZSwoYXN5bmMoKT0+dC5vcC5pbXBsKG4sbCx0Lm9wLmNvbnRleHQpKSk7aWYoYy5sZW5ndGghPT10Lm5vZGUub3V0cHV0cy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0aGUgc2l6ZSBvZiBvdXRwdXQgZG9lcyBub3QgbWF0Y2ggbW9kZWwgZGVmaW5pdGlvbi4iKTtjLmZvckVhY2goKChlLG4pPT57Y29uc3Qgcj10Lm5vZGUub3V0cHV0c1tuXTtpZih0aGlzLl92YWx1ZXNbcl0pdGhyb3cgbmV3IEVycm9yKGBvdXRwdXQgWyR7cn1dIGFscmVhZHkgaGFzIHZhbHVlOiBvcDoke3Qubm9kZS5uYW1lfWApO3RoaXMuX3ZhbHVlc1tyXT1lO30pKTtjb25zdCBwPW5ldyBTZXQ7Yy5mb3JFYWNoKCgoZSxuKT0+e2NvbnN0IHI9dC5ub2RlLm91dHB1dHNbbl07Zm9yKGNvbnN0IGUgb2Ygc1tyXS50byl7Y29uc3QgdD1hW2VdO2xldCBuPSEwO2Zvcihjb25zdCBlIG9mIHQuaW5wdXRzKWlmKCF0aGlzLl92YWx1ZXNbZV0pe249ITE7YnJlYWt9biYmcC5hZGQoZSk7fX0pKSxpLnB1c2goLi4ucCk7fWNvbnN0IGw9W107Zm9yKGxldCBlPTA7ZTx0aGlzLmdyYXBoLmdldE91dHB1dEluZGljZXMoKS5sZW5ndGg7ZSsrKXtjb25zdCB0PXRoaXMuZ3JhcGguZ2V0T3V0cHV0SW5kaWNlcygpW2VdLG49dGhpcy5fdmFsdWVzW3RdO2lmKHZvaWQgMD09PW4pdGhyb3cgbmV3IEVycm9yKGByZXF1aXJlZCBvdXRwdXQgWyR7dH1dIGRvZXMgbm90IGhhdmUgdmFsdWVgKTswPT09dD9hd2FpdCBuLmdldERhdGEoKTpuLmRhdGEsbC5wdXNoKG4pO31yZXR1cm4gci5Mb2dnZXIudmVyYm9zZSgiRXhlY1BsYW4iLCJkaXNwb3Npbmcgb2YgaW5mZXJlbmNlSGFuZGxlciIpLG4uZGlzcG9zZSgpLGx9KSl9fTt9LDQ2NjI6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LkdyYXBoPXZvaWQgMDtjb25zdCByPW4oNjg3NCksbz1uKDUxMjcpLGk9bigyNDQ2KSxzPW4oOTI0MCksYT1uKDcyNzMpO3ZhciB1PW8ub25ueHJ1bnRpbWUuZXhwZXJpbWVudGFsLmZiczt0LkdyYXBoPXtmcm9tOihlLHQpPT5uZXcgcChlLHQpfTtjbGFzcyBse2NvbnN0cnVjdG9yKGUpe3RoaXMuX2Zyb209dm9pZCAwLHRoaXMuX3RvPVtdLHRoaXMudGVuc29yPXZvaWQgMCx0aGlzLnR5cGU9dm9pZCAwLGUmJih0aGlzLnR5cGU9YS5Qcm90b1V0aWwudGVuc29yVmFsdWVUeXBlRnJvbVByb3RvKGUudHlwZS50ZW5zb3JUeXBlKSk7fWdldCBmcm9tKCl7cmV0dXJuIHRoaXMuX2Zyb219Z2V0IHRvKCl7cmV0dXJuIHRoaXMuX3RvfX1jbGFzcyBje2NvbnN0cnVjdG9yKGUsdCl7ZSBpbnN0YW5jZW9mIGkub25ueC5Ob2RlUHJvdG8/KHRoaXMubmFtZT1lLm5hbWUsdGhpcy5vcFR5cGU9ZS5vcFR5cGUsdGhpcy5hdHRyaWJ1dGVzPW5ldyByLkF0dHJpYnV0ZShlLmF0dHJpYnV0ZSkpOmUgaW5zdGFuY2VvZiB1Lk5vZGUmJih0aGlzLm5hbWU9bnVsbCE9dD90OmUubmFtZSgpLHRoaXMub3BUeXBlPWUub3BUeXBlKCksdGhpcy5hdHRyaWJ1dGVzPW5ldyByLkF0dHJpYnV0ZShhLlByb3RvVXRpbC50ZW5zb3JBdHRyaWJ1dGVzRnJvbU9SVEZvcm1hdChlKSkpLHRoaXMuaW5wdXRzPVtdLHRoaXMub3V0cHV0cz1bXSx0aGlzLmV4ZWN1dGVOb2RlPSEwO319Y2xhc3MgcHtjb25zdHJ1Y3RvcihlLHQpe2lmKCFlKXRocm93IG5ldyBUeXBlRXJyb3IoImdyYXBoIGlzIGVtcHR5Iik7dGhpcy5idWlsZEdyYXBoKGUpLHRoaXMudHJhbnNmb3JtR3JhcGgodCksdGhpcy5jaGVja0lzQWN5Y2xpYygpO31nZXRJbnB1dEluZGljZXMoKXtyZXR1cm4gdGhpcy5fYWxsSW5wdXRJbmRpY2VzfWdldElucHV0TmFtZXMoKXtyZXR1cm4gdGhpcy5fYWxsSW5wdXROYW1lc31nZXRPdXRwdXRJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX2FsbE91dHB1dEluZGljZXN9Z2V0T3V0cHV0TmFtZXMoKXtyZXR1cm4gdGhpcy5fYWxsT3V0cHV0TmFtZXN9Z2V0VmFsdWVzKCl7cmV0dXJuIHRoaXMuX2FsbERhdGF9Z2V0Tm9kZXMoKXtyZXR1cm4gdGhpcy5fbm9kZXN9YnVpbGRHcmFwaChlKXtpZihlIGluc3RhbmNlb2YgaS5vbm54LkdyYXBoUHJvdG8pdGhpcy5idWlsZEdyYXBoRnJvbU9ubnhGb3JtYXQoZSk7ZWxzZSB7aWYoIShlIGluc3RhbmNlb2YgdS5HcmFwaCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiR3JhcGggdHlwZSBpcyBub3Qgc3VwcG9ydGVkLiIpO3RoaXMuYnVpbGRHcmFwaEZyb21PcnRGb3JtYXQoZSk7fX1idWlsZEdyYXBoRnJvbU9ubnhGb3JtYXQoZSl7Y29uc3QgdD1uZXcgTWFwO3RoaXMuX2FsbERhdGE9W10sdGhpcy5fYWxsSW5wdXRJbmRpY2VzPVtdLHRoaXMuX2FsbElucHV0TmFtZXM9W10sdGhpcy5fYWxsT3V0cHV0SW5kaWNlcz1bXSx0aGlzLl9hbGxPdXRwdXROYW1lcz1bXSx0aGlzLl9ub2Rlcz1bXTtjb25zdCBuPW5ldyBNYXA7aWYoIWUuaW5wdXQpdGhyb3cgbmV3IEVycm9yKCJtaXNzaW5nIGluZm9ybWF0aW9uIGluIGdyYXBoOiBpbnB1dCIpO2NvbnN0IHI9W107Zm9yKGNvbnN0IG4gb2YgZS5pbnB1dCl7aWYodC5oYXMobi5uYW1lKSl0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZWQgaW5wdXQgbmFtZTogJHtuLm5hbWV9YCk7Y29uc3QgZT10aGlzLl9hbGxEYXRhLnB1c2gobmV3IGwobikpLTE7dC5zZXQobi5uYW1lLGUpLHIucHVzaChuLm5hbWUpO31pZighZS5pbml0aWFsaXplcil0aHJvdyBuZXcgRXJyb3IoIm1pc3NpbmcgaW5mb3JtYXRpb24gaW4gZ3JhcGg6IGluaXRpYWxpemVyIik7Zm9yKGNvbnN0IG4gb2YgZS5pbml0aWFsaXplcil7bGV0IGU9dC5nZXQobi5uYW1lKTtpZih2b2lkIDA9PT1lKXtjb25zdCByPW5ldyBsO3IudHlwZT17c2hhcGU6e2RpbXM6YS5Qcm90b1V0aWwudGVuc29yRGltc0Zyb21Qcm90byhuLmRpbXMpfSx0ZW5zb3JUeXBlOmEuUHJvdG9VdGlsLnRlbnNvckRhdGFUeXBlRnJvbVByb3RvKG4uZGF0YVR5cGUpfSxlPXRoaXMuX2FsbERhdGEucHVzaChyKS0xLHQuc2V0KG4ubmFtZSxlKTt9dGhpcy5fYWxsRGF0YVtlXS5fZnJvbT0tMSx0aGlzLl9hbGxEYXRhW2VdLnRlbnNvcj1zLlRlbnNvci5mcm9tUHJvdG8obik7fWZvcihsZXQgZT0wO2U8dGhpcy5fYWxsRGF0YS5sZW5ndGg7ZSsrKXRoaXMuX2FsbERhdGFbZV0udGVuc29yfHwodGhpcy5fYWxsSW5wdXRJbmRpY2VzLnB1c2goZSksdGhpcy5fYWxsSW5wdXROYW1lcy5wdXNoKHJbZV0pKTtpZighZS5vdXRwdXQpdGhyb3cgbmV3IEVycm9yKCJtaXNzaW5nIGluZm9ybWF0aW9uIGluIGdyYXBoOiBvdXRwdXQiKTtmb3IoY29uc3QgbiBvZiBlLm91dHB1dCl7aWYodC5oYXMobi5uYW1lKSl0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZWQgb3V0cHV0IG5hbWU6ICR7bi5uYW1lfWApO2NvbnN0IGU9dGhpcy5fYWxsRGF0YS5wdXNoKG5ldyBsKG4pKS0xO3Quc2V0KG4ubmFtZSxlKSx0aGlzLl9hbGxPdXRwdXRJbmRpY2VzLnB1c2goZSksdGhpcy5fYWxsT3V0cHV0TmFtZXMucHVzaChuLm5hbWUpO31pZighZS5ub2RlKXRocm93IG5ldyBFcnJvcigibWlzc2luZyBpbmZvcm1hdGlvbiBpbiBncmFwaDogbm9kZSIpO2Zvcihjb25zdCB0IG9mIGUubm9kZSl7aWYoIXQubmFtZSlmb3IobGV0IGU9MDs7ZSsrKXtjb25zdCByPWB1bm5hbWVkXyR7dC5vcFR5cGV9XyR7ZX1gO2lmKCFuLmhhcyhyKSl7dC5uYW1lPXI7YnJlYWt9fWlmKG4uaGFzKHQubmFtZSkpdGhyb3cgbmV3IEVycm9yKGBkdXBsaWNhdGVkIG5vZGUgbmFtZTogJHt0Lm5hbWV9YCk7Y29uc3QgZT10aGlzLl9ub2Rlcy5wdXNoKG5ldyBjKHQpKS0xO24uc2V0KHQubmFtZSxlKTt9Zm9yKGxldCBuPTA7bjx0aGlzLl9ub2Rlcy5sZW5ndGg7bisrKXtjb25zdCByPXRoaXMuX25vZGVzW25dLG89ZS5ub2RlW25dO2lmKCFvLm91dHB1dCl0aHJvdyBuZXcgRXJyb3IoYG1pc3Npbmcgb3V0cHV0IGZvciBub2RlOiAke28ubmFtZX1gKTtmb3IoY29uc3QgZSBvZiBvLm91dHB1dCl7bGV0IGk9dC5nZXQoZSk7aWYodm9pZCAwPT09aSYmKGk9dGhpcy5fYWxsRGF0YS5wdXNoKG5ldyBsKS0xLHQuc2V0KGUsaSkpLHIub3V0cHV0cy5wdXNoKGkpLHZvaWQgMCE9PXRoaXMuX2FsbERhdGFbaV0uX2Zyb20pdGhyb3cgbmV3IEVycm9yKGBtdWx0aXBsZSBub2RlcyBvdXRwdXQgdG8gb25lIGRhdGEgdmFsdWU6ICR7aX1gKTtpZih0aGlzLl9hbGxEYXRhW2ldLl9mcm9tPW4sIkNvbnN0YW50Ij09PW8ub3BUeXBlKXtpZighby5hdHRyaWJ1dGV8fDEhPT1vLmF0dHJpYnV0ZS5sZW5ndGh8fCFvLmF0dHJpYnV0ZVswXS50KXRocm93IG5ldyBFcnJvcigibWlzc2luZyBhdHRyaWJ1dGVzIG9yIG1pc3NpbmcgdGVuc29yIHZhbHVlIGluIGF0dHJpYnV0ZXMgZm9yIHRoaXMgQ29uc3RhbnQgb3BlcmF0b3IiKTtpZighby5vdXRwdXR8fDEhPT1vLm91dHB1dC5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJtaXNzaW5nIG91dHB1dCBvciBpbmNvcnJlY3QgbnVtYmVyIG9mIG91dHB1dHMgZm9yIHRoaXMgQ29uc3RhbnQgb3BlcmF0b3IiKTtyLm91dHB1dHMucG9wKCksci5leGVjdXRlTm9kZT0hMSx0aGlzLl9hbGxEYXRhW2ldLl9mcm9tPS0xLHRoaXMuX2FsbERhdGFbaV0udGVuc29yPXMuVGVuc29yLmZyb21Qcm90byhvLmF0dHJpYnV0ZVswXS50KTt9fX1mb3IobGV0IG49MDtuPHRoaXMuX25vZGVzLmxlbmd0aDtuKyspe2NvbnN0IHI9dGhpcy5fbm9kZXNbbl0sbz1lLm5vZGVbbl07aWYoIW8uaW5wdXQpdGhyb3cgbmV3IEVycm9yKGBtaXNzaW5nIGlucHV0IGZvciBub2RlOiAke28ubmFtZX1gKTtmb3IoY29uc3QgZSBvZiBvLmlucHV0KXtjb25zdCBpPXQuZ2V0KGUpO2lmKHZvaWQgMD09PWkpe2lmKCIiPT09ZSYmKDM9PT1vLmlucHV0Lmxlbmd0aHx8ND09PW8uaW5wdXQubGVuZ3RoKSYmIlJlc2l6ZSI9PT1vLm9wVHlwZSljb250aW51ZTt0aHJvdyBuZXcgRXJyb3IoYHVucmVjb2duaXplZCBpbnB1dCAnJHtlfScgZm9yIG5vZGU6ICR7by5uYW1lfWApfXIuaW5wdXRzLnB1c2goaSksdGhpcy5fYWxsRGF0YVtpXS5fdG8ucHVzaChuKTt9fXJldHVybiAhMH1idWlsZEdyYXBoRnJvbU9ydEZvcm1hdChlKXt2YXIgdCxuLHI7Y29uc3Qgbz1uZXcgTWFwO3RoaXMuX2FsbERhdGE9W10sdGhpcy5fYWxsSW5wdXRJbmRpY2VzPVtdLHRoaXMuX2FsbElucHV0TmFtZXM9W10sdGhpcy5fYWxsT3V0cHV0SW5kaWNlcz1bXSx0aGlzLl9hbGxPdXRwdXROYW1lcz1bXSx0aGlzLl9ub2Rlcz1bXTtjb25zdCBpPW5ldyBNYXAscD1bXTtmb3IobGV0IGk9MDtpPGUuaW5wdXRzTGVuZ3RoKCk7aSsrKXtjb25zdCBzPWUuaW5wdXRzKGkpO2lmKG8uaGFzKHMpKXRocm93IG5ldyBFcnJvcihgZHVwbGljYXRlZCBpbnB1dCBuYW1lOiAke3N9YCk7Zm9yKGxldCBpPTA7aTxlLm5vZGVBcmdzTGVuZ3RoKCk7aSsrKWlmKChudWxsPT09KHQ9ZS5ub2RlQXJncyhpKSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQubmFtZSgpKT09PXMpe2NvbnN0IHQ9bmV3IGw7aWYoKG51bGw9PT0ocj1udWxsPT09KG49ZS5ub2RlQXJncyhpKSl8fHZvaWQgMD09PW4/dm9pZCAwOm4udHlwZSgpKXx8dm9pZCAwPT09cj92b2lkIDA6ci52YWx1ZVR5cGUoKSkhPT11LlR5cGVJbmZvVmFsdWUudGVuc29yX3R5cGUpdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIHZhbHVlIHR5cGUgZm9yIHRoZSBub2RlQXJnLiIpO2NvbnN0IGM9ZS5ub2RlQXJncyhpKS50eXBlKCkudmFsdWUobmV3IHUuVGVuc29yVHlwZUFuZFNoYXBlKSxkPWEuUHJvdG9VdGlsLnRlbnNvckRhdGFUeXBlRnJvbVByb3RvKGMuZWxlbVR5cGUoKSksZj1jLnNoYXBlKCksaD1bXTtmb3IobGV0IGU9MDtlPGYuZGltTGVuZ3RoKCk7ZSsrKWgucHVzaChhLkxvbmdVdGlsLmxvbmdUb051bWJlcihmLmRpbShlKS52YWx1ZSgpLmRpbVZhbHVlKCkpKTt0LnR5cGU9e3NoYXBlOntkaW1zOmh9LHRlbnNvclR5cGU6ZH07Y29uc3QgZz10aGlzLl9hbGxEYXRhLnB1c2godCktMTtvLnNldChzLGcpLHAucHVzaChzKTt9fWZvcihsZXQgdD0wO3Q8ZS5pbml0aWFsaXplcnNMZW5ndGgoKTt0Kyspe2NvbnN0IG49ZS5pbml0aWFsaXplcnModCk7bGV0IHI9by5nZXQobi5uYW1lKCkpO2lmKHZvaWQgMD09PXIpe2NvbnN0IGU9bmV3IGwsdD1hLlByb3RvVXRpbC50ZW5zb3JEaW1zRnJvbU9SVEZvcm1hdChuKSxpPWEuUHJvdG9VdGlsLnRlbnNvckRhdGFUeXBlRnJvbVByb3RvKG4uZGF0YVR5cGUoKSk7ZS50eXBlPXtzaGFwZTp7ZGltczp0fSx0ZW5zb3JUeXBlOml9LHI9dGhpcy5fYWxsRGF0YS5wdXNoKGUpLTEsby5zZXQobi5uYW1lKCkscik7fXRoaXMuX2FsbERhdGFbcl0uX2Zyb209LTEsdGhpcy5fYWxsRGF0YVtyXS50ZW5zb3I9cy5UZW5zb3IuZnJvbU9ydFRlbnNvcihuKTt9Zm9yKGxldCBlPTA7ZTx0aGlzLl9hbGxEYXRhLmxlbmd0aDtlKyspdGhpcy5fYWxsRGF0YVtlXS50ZW5zb3J8fCh0aGlzLl9hbGxJbnB1dEluZGljZXMucHVzaChlKSx0aGlzLl9hbGxJbnB1dE5hbWVzLnB1c2gocFtlXSkpO2ZvcihsZXQgdD0wO3Q8ZS5vdXRwdXRzTGVuZ3RoKCk7dCsrKXtjb25zdCBuPWUub3V0cHV0cyh0KTtpZihvLmhhcyhuKSl0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZWQgb3V0cHV0IG5hbWU6ICR7bn1gKTtjb25zdCByPXRoaXMuX2FsbERhdGEucHVzaChuZXcgbCktMTtvLnNldChuLHIpLHRoaXMuX2FsbE91dHB1dEluZGljZXMucHVzaChyKSx0aGlzLl9hbGxPdXRwdXROYW1lcy5wdXNoKG4pO31pZighZS5ub2Rlcyl0aHJvdyBuZXcgRXJyb3IoIm1pc3NpbmcgaW5mb3JtYXRpb24gaW4gZ3JhcGg6IG5vZGUiKTtmb3IobGV0IHQ9MDt0PGUubm9kZXNMZW5ndGgoKTt0Kyspe2NvbnN0IG49ZS5ub2Rlcyh0KTtsZXQgcj1uLm5hbWUoKTtpZighcilmb3IobGV0IGU9MDtyPWB1bm5hbWVkXyR7bi5vcFR5cGUoKX1fJHtlfWAsaS5oYXMocik7ZSsrKTtpZihpLmhhcyhyKSl0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZWQgbm9kZSBuYW1lOiAke3J9YCk7Y29uc3Qgbz10aGlzLl9ub2Rlcy5wdXNoKG5ldyBjKG4scikpLTE7aS5zZXQocixvKTt9Zm9yKGxldCB0PTA7dDx0aGlzLl9ub2Rlcy5sZW5ndGg7dCsrKXtjb25zdCBuPXRoaXMuX25vZGVzW3RdLHI9ZS5ub2Rlcyh0KTtpZihudWxsPT1yKXRocm93IG5ldyBFcnJvcihgTm8gbm9kZSBleGlzdHMgYXQgaW5kZXggJHt0fWApO2lmKDA9PT0obnVsbD09cj92b2lkIDA6ci5vdXRwdXRzTGVuZ3RoKCkpKXRocm93IG5ldyBFcnJvcihgbWlzc2luZyBvdXRwdXQgZm9yIG5vZGU6ICR7ci5uYW1lfWApO2ZvcihsZXQgZT0wO2U8KG51bGw9PXI/dm9pZCAwOnIub3V0cHV0c0xlbmd0aCgpKTtlKyspe2NvbnN0IGk9bnVsbD09cj92b2lkIDA6ci5vdXRwdXRzKGUpO2xldCBhPW8uZ2V0KGkpO2lmKHZvaWQgMD09PWEmJihhPXRoaXMuX2FsbERhdGEucHVzaChuZXcgbCktMSxvLnNldChpLGEpKSxuLm91dHB1dHMucHVzaChhKSx2b2lkIDAhPT10aGlzLl9hbGxEYXRhW2FdLl9mcm9tKXRocm93IG5ldyBFcnJvcihgbXVsdGlwbGUgbm9kZXMgb3V0cHV0IHRvIG9uZSBkYXRhIHZhbHVlOiAke2F9YCk7aWYodGhpcy5fYWxsRGF0YVthXS5fZnJvbT10LCJDb25zdGFudCI9PT1yLm9wVHlwZSgpKXtpZigxIT09ci5hdHRyaWJ1dGVzTGVuZ3RoKCl8fCFyLmF0dHJpYnV0ZXMoMCkudCgpKXRocm93IG5ldyBFcnJvcigibWlzc2luZyBhdHRyaWJ1dGVzIG9yIG1pc3NpbmcgdGVuc29yIHZhbHVlIGluIGF0dHJpYnV0ZXMgZm9yIHRoaXMgQ29uc3RhbnQgb3BlcmF0b3IiKTtpZigxIT09ci5vdXRwdXRzTGVuZ3RoKCkpdGhyb3cgbmV3IEVycm9yKCJtaXNzaW5nIG91dHB1dCBvciBpbmNvcnJlY3QgbnVtYmVyIG9mIG91dHB1dHMgZm9yIHRoaXMgQ29uc3RhbnQgb3BlcmF0b3IiKTtuLm91dHB1dHMucG9wKCksbi5leGVjdXRlTm9kZT0hMSx0aGlzLl9hbGxEYXRhW2FdLl9mcm9tPS0xLHRoaXMuX2FsbERhdGFbYV0udGVuc29yPXMuVGVuc29yLmZyb21PcnRUZW5zb3Ioci5hdHRyaWJ1dGVzKDApLnQoKSk7fX19Zm9yKGxldCB0PTA7dDx0aGlzLl9ub2Rlcy5sZW5ndGg7dCsrKXtjb25zdCBuPXRoaXMuX25vZGVzW3RdLHI9ZS5ub2Rlcyh0KTtpZigwPT09ci5pbnB1dHNMZW5ndGgoKSl0aHJvdyBuZXcgRXJyb3IoYG1pc3NpbmcgaW5wdXQgZm9yIG5vZGU6ICR7ci5uYW1lfWApO2ZvcihsZXQgZT0wO2U8ci5pbnB1dHNMZW5ndGgoKTtlKyspe2NvbnN0IGk9ci5pbnB1dHMoZSkscz1vLmdldChpKTtpZih2b2lkIDA9PT1zKXRocm93IG5ldyBFcnJvcihgdW5yZWNvZ25pemVkIGlucHV0ICcke2l9JyBmb3Igbm9kZTogJHtyLm5hbWUoKX1gKTtuLmlucHV0cy5wdXNoKHMpLHRoaXMuX2FsbERhdGFbc10uX3RvLnB1c2godCk7fX19Y2hlY2tJc0FjeWNsaWMoKXtjb25zdCBlPW5ldyBTZXQ7dGhpcy5fYWxsSW5wdXRJbmRpY2VzLmZvckVhY2goKHQ9Pnt0aGlzLl9hbGxEYXRhW3RdLl90by5mb3JFYWNoKCh0PT57ZS5hZGQodCk7fSkpO30pKTtjb25zdCB0PUFycmF5LmZyb20oZSksbj1uZXcgQXJyYXkodGhpcy5fbm9kZXMubGVuZ3RoKS5maWxsKCJ3aGl0ZSIpO2Zvcig7dC5sZW5ndGg+MDspe2NvbnN0IGU9dC5wb3AoKTsiZ3JheSI9PT1uW2VdP25bZV09ImJsYWNrIjoodC5wdXNoKGUpLG5bZV09ImdyYXkiLHRoaXMuX25vZGVzW2VdLm91dHB1dHMuZm9yRWFjaCgocj0+e2NvbnN0IG89dGhpcy5fYWxsRGF0YVtyXTtpZih2b2lkIDAhPT1vLnRlbnNvcil0aHJvdyBuZXcgRXJyb3IoIm5vZGUgb3V0cHV0cyBzaG91bGQgbm90IGJlIGluaXRpYWxpemVkIik7aWYoby5fZnJvbSE9PWUpdGhyb3cgbmV3IEVycm9yKCJmcm9tIHByb3BlcnR5IG9mIHRoZSBWYWx1ZSBvYmplY3QgZG9lc24ndCBtYXRjaCBpbmRleCBvZiBOb2RlIGJlaW5nIHByb2Nlc3NlZCIpO28uX3RvLmZvckVhY2goKGU9PntpZigiZ3JheSI9PT1uW2VdKXRocm93IG5ldyBFcnJvcigibW9kZWwgZ3JhcGggaXMgY3ljbGljIik7IndoaXRlIj09PW5bZV0mJnQucHVzaChlKTt9KSk7fSkpKTt9fXRyYW5zZm9ybUdyYXBoKGUpe3RoaXMucmVtb3ZlQWxsSWRlbnRpdHlOb2RlcygpLHRoaXMucmVtb3ZlQWxsRHJvcG91dE5vZGVzKCksdGhpcy5mdXNlQ29udkFjdGl2YXRpb25Ob2RlcygpLGUmJmUudHJhbnNmb3JtR3JhcGgodGhpcyksdGhpcy5maW5hbGl6ZUdyYXBoKCk7fWZpbmFsaXplR3JhcGgoKXtsZXQgZT0wO2NvbnN0IHQ9bmV3IEFycmF5KHRoaXMuX25vZGVzLmxlbmd0aCwwKTtsZXQgbj0wO2ZvcihsZXQgZT0wO2U8dGhpcy5fbm9kZXMubGVuZ3RoO2UrKyl0W2VdPW4sdGhpcy5fbm9kZXNbZV0uZXhlY3V0ZU5vZGU/KG4hPT1lJiYodGhpcy5fbm9kZXNbbl09dGhpcy5fbm9kZXNbZV0pLG4rKyk6dGhpcy5fbm9kZXNbZV0ub3V0cHV0cy5mb3JFYWNoKChlPT57dGhpcy5fYWxsRGF0YVtlXS5fZnJvbT0tMjt9KSk7dGhpcy5fbm9kZXMuc3BsaWNlKG4sdGhpcy5fbm9kZXMubGVuZ3RoLW4pO2ZvcihsZXQgZT0wO2U8dGhpcy5fYWxsRGF0YS5sZW5ndGg7ZSsrKXtjb25zdCBuPXRoaXMuX2FsbERhdGFbZV07dm9pZCAwIT09bi5fZnJvbSYmLTEhPT1uLl9mcm9tJiYtMiE9PW4uX2Zyb20mJihuLl9mcm9tPXRbbi5fZnJvbV0pO2ZvcihsZXQgZT0wO2U8bi5fdG8ubGVuZ3RoO2UrKyl7aWYoIShuLl90b1tlXT49MCkpdGhyb3cgbmV3IEVycm9yKCJUcnlpbmcgdG8gdXBkYXRlIGEgcmVtb3ZlZCBub2RlIik7bi5fdG9bZV09dFtuLl90b1tlXV07fX1lPTA7Zm9yKGxldCB0PTA7dDx0aGlzLl9hbGxEYXRhLmxlbmd0aDt0KyspaWYoLTIhPT10aGlzLl9hbGxEYXRhW3RdLmZyb218fC0xIT09dGhpcy5fYWxsT3V0cHV0SW5kaWNlcy5pbmRleE9mKHQrZSkpe2lmKGU+MCl7bGV0IG49LTE7dm9pZCAwIT09dGhpcy5fYWxsRGF0YVt0XS5mcm9tJiYtMSE9PXRoaXMuX2FsbERhdGFbdF0uZnJvbT8obj10aGlzLl9ub2Rlc1t0aGlzLl9hbGxEYXRhW3RdLmZyb21dLm91dHB1dHMuaW5kZXhPZih0K2UpLC0xIT09biYmKHRoaXMuX25vZGVzW3RoaXMuX2FsbERhdGFbdF0uZnJvbV0ub3V0cHV0c1tuXT10KSk6KG49dGhpcy5fYWxsSW5wdXRJbmRpY2VzLmluZGV4T2YodCtlKSwtMSE9PW4mJih0aGlzLl9hbGxJbnB1dEluZGljZXNbbl09dCkpLHRoaXMuX2FsbERhdGFbdF0udG8uZm9yRWFjaCgocj0+e249dGhpcy5fbm9kZXNbcl0uaW5wdXRzLmluZGV4T2YodCtlKSwtMSE9PW4mJih0aGlzLl9ub2Rlc1tyXS5pbnB1dHNbbl09dCk7fSkpLDA9PT10aGlzLl9hbGxEYXRhW3RdLnRvLmxlbmd0aCYmKG49dGhpcy5fYWxsT3V0cHV0SW5kaWNlcy5pbmRleE9mKHQrZSksLTEhPT1uJiYodGhpcy5fYWxsT3V0cHV0SW5kaWNlc1tuXT10KSk7fX1lbHNlIGUrKyx0aGlzLl9hbGxEYXRhLnNwbGljZSh0LDEpLHQtLTt9ZGVsZXRlTm9kZShlKXtjb25zdCB0PXRoaXMuX25vZGVzW2VdO2lmKHQub3V0cHV0cy5sZW5ndGg+MSlmb3IobGV0IGU9MTtlPHQub3V0cHV0cy5sZW5ndGg7ZSsrKWlmKHRoaXMuX2FsbERhdGFbdC5vdXRwdXRzW2VdXS50by5sZW5ndGg+MCl0aHJvdyBuZXcgRXJyb3IoIk5vZGUgZGVsZXRpb24gd2l0aCBtb3JlIHRoYW4gb25lIG91dHB1dCBjb25uZWN0ZWQgdG8gb3RoZXIgbm9kZXMgaXMgbm90IHN1cHBvcnRlZC4gIik7dC5leGVjdXRlTm9kZT0hMTtjb25zdCBuPXQuaW5wdXRzWzBdLHI9dC5vdXRwdXRzWzBdLG89dGhpcy5fYWxsRGF0YVtyXS50bztmb3IobGV0IG49MDtuPHQuaW5wdXRzLmxlbmd0aDtuKyspe2NvbnN0IHI9dGhpcy5fYWxsRGF0YVt0LmlucHV0c1tuXV0udG8uaW5kZXhPZihlKTtpZigtMT09PXIpdGhyb3cgbmV3IEVycm9yKCJUaGUgVmFsdWUgb2JqZWN0IGRvZXNuJ3QgaGF2ZSB0aGUgY3VycmVudCBOb2RlIGluIGl0J3MgJ3RvJyBwcm9wZXJ0eSAiKTt0aGlzLl9hbGxEYXRhW3QuaW5wdXRzW25dXS50by5zcGxpY2UociwxKTt9dGhpcy5fYWxsRGF0YVtyXS5fdG89W107Y29uc3QgaT10aGlzLl9hbGxPdXRwdXRJbmRpY2VzLmluZGV4T2Yocik7aWYoLTEhPT1pJiYodGhpcy5fYWxsT3V0cHV0SW5kaWNlc1tpXT1uKSxvJiZvLmxlbmd0aD4wKWZvcihjb25zdCBlIG9mIG8pe2NvbnN0IHQ9dGhpcy5fbm9kZXNbZV0uaW5wdXRzLmluZGV4T2Yocik7aWYoLTE9PT10KXRocm93IG5ldyBFcnJvcigiVGhlIE5vZGUgb2JqZWN0IGRvZXNuJ3QgaGF2ZSB0aGUgb3V0cHV0IFZhbHVlIGluIGl0J3MgJ2lucHV0cycgcHJvcGVydHkgIik7dGhpcy5fbm9kZXNbZV0uaW5wdXRzW3RdPW4sdGhpcy5fYWxsRGF0YVtuXS50by5wdXNoKGUpO319cmVtb3ZlQWxsRHJvcG91dE5vZGVzKCl7bGV0IGU9MDtmb3IoY29uc3QgdCBvZiB0aGlzLl9ub2Rlcyl7aWYoIkRyb3BvdXQiPT09dC5vcFR5cGUpe2lmKDEhPT10LmlucHV0cy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJEcm9wb3V0IG5vZGVzIHNob3VsZCBvbmx5IGNvbnRhaW4gb25lIGlucHV0LiAiKTtpZigxIT09dC5vdXRwdXRzLmxlbmd0aCYmMiE9PXQub3V0cHV0cy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJEcm9wb3V0IG5vZGVzIHNob3VsZCBjb250YWluIGVpdGhlciAxIG9yIDIgb3V0cHV0KHMpIik7aWYoMj09PXQub3V0cHV0cy5sZW5ndGgmJjAhPT10aGlzLl9hbGxEYXRhW3Qub3V0cHV0c1sxXV0uX3RvLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkRyb3BvdXQgbm9kZXMncyBzZWNvbmQgb3V0cHV0IHNob3VsZCBub3QgYmUgcmVmZXJlbmNlZCBieSBvdGhlciBub2RlcyIpO3RoaXMuZGVsZXRlTm9kZShlKTt9ZSsrO319cmVtb3ZlQWxsSWRlbnRpdHlOb2Rlcygpe2xldCBlPTA7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fbm9kZXMpIklkZW50aXR5Ij09PXQub3BUeXBlJiZ0aGlzLmRlbGV0ZU5vZGUoZSksZSsrO31pc0FjdGl2YXRpb24oZSl7c3dpdGNoKGUub3BUeXBlKXtjYXNlIlJlbHUiOmNhc2UiU2lnbW9pZCI6Y2FzZSJDbGlwIjpyZXR1cm4gITA7ZGVmYXVsdDpyZXR1cm4gITF9fWZ1c2VDb252QWN0aXZhdGlvbk5vZGVzKCl7Zm9yKGNvbnN0IGUgb2YgdGhpcy5fbm9kZXMpaWYoIkNvbnYiPT09ZS5vcFR5cGUpe2NvbnN0IHQ9dGhpcy5fYWxsRGF0YVtlLm91dHB1dHNbMF1dLl90bztpZigxPT09dC5sZW5ndGgmJnRoaXMuaXNBY3RpdmF0aW9uKHRoaXMuX25vZGVzW3RbMF1dKSl7Y29uc3Qgbj10aGlzLl9ub2Rlc1t0WzBdXTtpZigiQ2xpcCI9PT1uLm9wVHlwZSlpZigxPT09bi5pbnB1dHMubGVuZ3RoKXRyeXtlLmF0dHJpYnV0ZXMuc2V0KCJhY3RpdmF0aW9uX3BhcmFtcyIsImZsb2F0cyIsW24uYXR0cmlidXRlcy5nZXRGbG9hdCgibWluIiksbi5hdHRyaWJ1dGVzLmdldEZsb2F0KCJtYXgiKV0pO31jYXRjaCh0KXtlLmF0dHJpYnV0ZXMuc2V0KCJhY3RpdmF0aW9uX3BhcmFtcyIsImZsb2F0cyIsW2EuTUlOX0NMSVAsYS5NQVhfQ0xJUF0pO31lbHNlIHtpZighKG4uaW5wdXRzLmxlbmd0aD49MyYmdm9pZCAwIT09dGhpcy5fYWxsRGF0YVtuLmlucHV0c1sxXV0udGVuc29yJiZ2b2lkIDAhPT10aGlzLl9hbGxEYXRhW24uaW5wdXRzWzJdXS50ZW5zb3IpKWNvbnRpbnVlO2UuYXR0cmlidXRlcy5zZXQoImFjdGl2YXRpb25fcGFyYW1zIiwiZmxvYXRzIixbdGhpcy5fYWxsRGF0YVtuLmlucHV0c1sxXV0udGVuc29yLmZsb2F0RGF0YVswXSx0aGlzLl9hbGxEYXRhW24uaW5wdXRzWzJdXS50ZW5zb3IuZmxvYXREYXRhWzBdXSk7fWUuYXR0cmlidXRlcy5zZXQoImFjdGl2YXRpb24iLCJzdHJpbmciLG4ub3BUeXBlKSx0aGlzLmRlbGV0ZU5vZGUodFswXSk7fX19fX0sMTMxNTooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0Lm5vdz10LlByb2ZpbGVyPXQuTG9nZ2VyPXZvaWQgMDtjb25zdCBuPXt2ZXJib3NlOjFlMyxpbmZvOjJlMyx3YXJuaW5nOjRlMyxlcnJvcjo1ZTMsZmF0YWw6NmUzfSxyPXtub25lOm5ldyBjbGFzc3tsb2coZSx0LG4pe319LGNvbnNvbGU6bmV3IGNsYXNze2xvZyhlLHQsbil7Y29uc29sZS5sb2coYCR7dGhpcy5jb2xvcihlKX0gJHtuPyIbWzM1bSIrbisiG1swbSAiOiIifSR7dH1gKTt9Y29sb3IoZSl7c3dpdGNoKGUpe2Nhc2UidmVyYm9zZSI6cmV0dXJuICIbWzM0OzQwbXYbWzBtIjtjYXNlImluZm8iOnJldHVybiAiG1szMm1pG1swbSI7Y2FzZSJ3YXJuaW5nIjpyZXR1cm4gIhtbMzA7NDNtdxtbMG0iO2Nhc2UiZXJyb3IiOnJldHVybiAiG1szMTs0MG1lG1swbSI7Y2FzZSJmYXRhbCI6cmV0dXJuICIbWzEwMW1mG1swbSI7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVuc3VwcG9ydGVkIHNldmVyaXR5OiAke2V9YCl9fX19LG89e3Byb3ZpZGVyOiJjb25zb2xlIixtaW5pbWFsU2V2ZXJpdHk6Indhcm5pbmciLGxvZ0RhdGVUaW1lOiEwLGxvZ1NvdXJjZUxvY2F0aW9uOiExfTtsZXQgaT17IiI6b307ZnVuY3Rpb24gcyhlLHQsbixyKXtpZih2b2lkIDA9PT10KXJldHVybiBvPWUse3ZlcmJvc2U6cy52ZXJib3NlLmJpbmQobnVsbCxvKSxpbmZvOnMuaW5mby5iaW5kKG51bGwsbyksd2FybmluZzpzLndhcm5pbmcuYmluZChudWxsLG8pLGVycm9yOnMuZXJyb3IuYmluZChudWxsLG8pLGZhdGFsOnMuZmF0YWwuYmluZChudWxsLG8pfTtpZih2b2lkIDA9PT1uKWEoZSx0KTtlbHNlIGlmKCJudW1iZXIiPT10eXBlb2YgbiYmdm9pZCAwPT09cilhKGUsdCk7ZWxzZSBpZigic3RyaW5nIj09dHlwZW9mIG4mJnZvaWQgMD09PXIpYShlLG4sMCx0KTtlbHNlIHtpZigic3RyaW5nIiE9dHlwZW9mIG58fCJudW1iZXIiIT10eXBlb2Ygcil0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBpcyB2YWxpZCIpO2EoZSxuLDAsdCk7fXZhciBvO31mdW5jdGlvbiBhKGUsdCxvLHMpe2NvbnN0IGE9aVtzfHwiIl18fGlbIiJdO25bZV08blthLm1pbmltYWxTZXZlcml0eV18fChhLmxvZ0RhdGVUaW1lJiYodD1gJHsobmV3IERhdGUpLnRvSVNPU3RyaW5nKCl9fCR7dH1gKSxhLmxvZ1NvdXJjZUxvY2F0aW9uLHJbYS5wcm92aWRlcl0ubG9nKGUsdCxzKSk7fSFmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe2k9e30sbigiIixlfHx7fSk7fWZ1bmN0aW9uIG4oZSxuKXtpZigiKiI9PT1lKXQobik7ZWxzZSB7Y29uc3QgdD1pW2VdfHxvO2lbZV09e3Byb3ZpZGVyOm4ucHJvdmlkZXJ8fHQucHJvdmlkZXIsbWluaW1hbFNldmVyaXR5Om4ubWluaW1hbFNldmVyaXR5fHx0Lm1pbmltYWxTZXZlcml0eSxsb2dEYXRlVGltZTp2b2lkIDA9PT1uLmxvZ0RhdGVUaW1lP3QubG9nRGF0ZVRpbWU6bi5sb2dEYXRlVGltZSxsb2dTb3VyY2VMb2NhdGlvbjp2b2lkIDA9PT1uLmxvZ1NvdXJjZUxvY2F0aW9uP3QubG9nU291cmNlTG9jYXRpb246bi5sb2dTb3VyY2VMb2NhdGlvbn07fX1lLnZlcmJvc2U9ZnVuY3Rpb24odCxuKXtlKCJ2ZXJib3NlIix0LG4pO30sZS5pbmZvPWZ1bmN0aW9uKHQsbil7ZSgiaW5mbyIsdCxuKTt9LGUud2FybmluZz1mdW5jdGlvbih0LG4pe2UoIndhcm5pbmciLHQsbik7fSxlLmVycm9yPWZ1bmN0aW9uKHQsbil7ZSgiZXJyb3IiLHQsbik7fSxlLmZhdGFsPWZ1bmN0aW9uKHQsbil7ZSgiZmF0YWwiLHQsbik7fSxlLnJlc2V0PXQsZS5zZXQ9bixlLnNldFdpdGhFbnY9ZnVuY3Rpb24oZSl7Y29uc3QgdD17fTtlLmxvZ0xldmVsJiYodC5taW5pbWFsU2V2ZXJpdHk9ZS5sb2dMZXZlbCksbigiIix0KTt9O30oc3x8KHM9e30pKSx0LkxvZ2dlcj1zO2NsYXNzIHV7Y29uc3RydWN0b3IoZSx0LG4scixvLGkpe3RoaXMuY2F0ZWdvcnk9ZSx0aGlzLm5hbWU9dCx0aGlzLnN0YXJ0VGltZT1uLHRoaXMuZW5kQ2FsbGJhY2s9cix0aGlzLnRpbWVyPW8sdGhpcy5jdHg9aTt9YXN5bmMgZW5kKCl7cmV0dXJuIHRoaXMuZW5kQ2FsbGJhY2sodGhpcyl9YXN5bmMgY2hlY2tUaW1lcigpe2lmKHZvaWQgMD09PXRoaXMuY3R4fHx2b2lkIDA9PT10aGlzLnRpbWVyKXRocm93IG5ldyBFcnJvcigiTm8gd2ViZ2wgdGltZXIgZm91bmQiKTtyZXR1cm4gdGhpcy5jdHguZW5kVGltZXIoKSx0aGlzLmN0eC53YWl0Rm9yUXVlcnlBbmRHZXRUaW1lKHRoaXMudGltZXIpfX1jbGFzcyBse2NvbnN0cnVjdG9yKGUsdCxuLHIpe3RoaXMuY2F0ZWdvcnk9ZSx0aGlzLm5hbWU9dCx0aGlzLnN0YXJ0VGltZT1uLHRoaXMuZW5kVGltZT1yO319dC5Qcm9maWxlcj1jbGFzc3tzdGF0aWMgY3JlYXRlKGUpe3JldHVybiB2b2lkIDA9PT1lP25ldyB0aGlzOm5ldyB0aGlzKGUubWF4TnVtYmVyRXZlbnRzLGUuZmx1c2hCYXRjaFNpemUsZS5mbHVzaEludGVydmFsSW5NaWxsaXNlY29uZHMpfWNvbnN0cnVjdG9yKGUsdCxuKXt0aGlzLl9zdGFydGVkPSExLHRoaXMuX2ZsdXNoUG9pbnRlcj0wLHRoaXMuX3N0YXJ0ZWQ9ITEsdGhpcy5fbWF4TnVtYmVyRXZlbnRzPXZvaWQgMD09PWU/MWU0OmUsdGhpcy5fZmx1c2hCYXRjaFNpemU9dm9pZCAwPT09dD8xMDp0LHRoaXMuX2ZsdXNoSW50ZXJ2YWxJbk1pbGxpc2Vjb25kcz12b2lkIDA9PT1uPzVlMzpuO31zdGFydCgpe3RoaXMuX3N0YXJ0ZWQ9ITAsdGhpcy5fdGltaW5nRXZlbnRzPVtdLHRoaXMuX2ZsdXNoVGltZT0oMCwgdC5ub3cpKCksdGhpcy5fZmx1c2hQb2ludGVyPTA7fXN0b3AoKXtmb3IodGhpcy5fc3RhcnRlZD0hMTt0aGlzLl9mbHVzaFBvaW50ZXI8dGhpcy5fdGltaW5nRXZlbnRzLmxlbmd0aDt0aGlzLl9mbHVzaFBvaW50ZXIrKyl0aGlzLmxvZ09uZUV2ZW50KHRoaXMuX3RpbWluZ0V2ZW50c1t0aGlzLl9mbHVzaFBvaW50ZXJdKTt9ZXZlbnQoZSx0LG4scil7Y29uc3Qgbz10aGlzLl9zdGFydGVkP3RoaXMuYmVnaW4oZSx0LHIpOnZvaWQgMDtsZXQgaT0hMTtjb25zdCBzPW4oKTtpZihzJiYiZnVuY3Rpb24iPT10eXBlb2Ygcy50aGVuKXJldHVybiBpPSEwLG5ldyBQcm9taXNlKCgoZSx0KT0+e3MudGhlbigoYXN5bmMgdD0+e28mJmF3YWl0IG8uZW5kKCksZSh0KTt9KSwoYXN5bmMgZT0+e28mJmF3YWl0IG8uZW5kKCksdChlKTt9KSk7fSkpO2lmKCFpJiZvKXtjb25zdCBlPW8uZW5kKCk7aWYoZSYmImZ1bmN0aW9uIj09dHlwZW9mIGUudGhlbilyZXR1cm4gbmV3IFByb21pc2UoKCh0LG4pPT57ZS50aGVuKCgoKT0+e3Qocyk7fSksKGU9PntuKGUpO30pKTt9KSl9cmV0dXJuIHN9YmVnaW4oZSxuLHIpe2lmKCF0aGlzLl9zdGFydGVkKXRocm93IG5ldyBFcnJvcigicHJvZmlsZXIgaXMgbm90IHN0YXJ0ZWQgeWV0Iik7aWYodm9pZCAwPT09cil7Y29uc3Qgcj0oMCwgdC5ub3cpKCk7cmV0dXJuIHRoaXMuZmx1c2gociksbmV3IHUoZSxuLHIsKGU9PnRoaXMuZW5kU3luYyhlKSkpfXtjb25zdCB0PXIuYmVnaW5UaW1lcigpO3JldHVybiBuZXcgdShlLG4sMCwoYXN5bmMgZT0+dGhpcy5lbmQoZSkpLHQscil9fWFzeW5jIGVuZChlKXtjb25zdCB0PWF3YWl0IGUuY2hlY2tUaW1lcigpO3RoaXMuX3RpbWluZ0V2ZW50cy5sZW5ndGg8dGhpcy5fbWF4TnVtYmVyRXZlbnRzJiYodGhpcy5fdGltaW5nRXZlbnRzLnB1c2gobmV3IGwoZS5jYXRlZ29yeSxlLm5hbWUsZS5zdGFydFRpbWUsdCkpLHRoaXMuZmx1c2godCkpO31lbmRTeW5jKGUpe2NvbnN0IG49KDAsIHQubm93KSgpO3RoaXMuX3RpbWluZ0V2ZW50cy5sZW5ndGg8dGhpcy5fbWF4TnVtYmVyRXZlbnRzJiYodGhpcy5fdGltaW5nRXZlbnRzLnB1c2gobmV3IGwoZS5jYXRlZ29yeSxlLm5hbWUsZS5zdGFydFRpbWUsbikpLHRoaXMuZmx1c2gobikpO31sb2dPbmVFdmVudChlKXt0LkxvZ2dlci52ZXJib3NlKGBQcm9maWxlci4ke2UuY2F0ZWdvcnl9YCxgJHsoZS5lbmRUaW1lLWUuc3RhcnRUaW1lKS50b0ZpeGVkKDIpfW1zIG9uIGV2ZW50ICcke2UubmFtZX0nIGF0ICR7ZS5lbmRUaW1lLnRvRml4ZWQoMil9YCk7fWZsdXNoKGUpe2lmKHRoaXMuX3RpbWluZ0V2ZW50cy5sZW5ndGgtdGhpcy5fZmx1c2hQb2ludGVyPj10aGlzLl9mbHVzaEJhdGNoU2l6ZXx8ZS10aGlzLl9mbHVzaFRpbWU+PXRoaXMuX2ZsdXNoSW50ZXJ2YWxJbk1pbGxpc2Vjb25kcyl7Zm9yKGNvbnN0IGU9dGhpcy5fZmx1c2hQb2ludGVyO3RoaXMuX2ZsdXNoUG9pbnRlcjxlK3RoaXMuX2ZsdXNoQmF0Y2hTaXplJiZ0aGlzLl9mbHVzaFBvaW50ZXI8dGhpcy5fdGltaW5nRXZlbnRzLmxlbmd0aDt0aGlzLl9mbHVzaFBvaW50ZXIrKyl0aGlzLmxvZ09uZUV2ZW50KHRoaXMuX3RpbWluZ0V2ZW50c1t0aGlzLl9mbHVzaFBvaW50ZXJdKTt0aGlzLl9mbHVzaFRpbWU9KDAsIHQubm93KSgpO319Z2V0IHN0YXJ0ZWQoKXtyZXR1cm4gdGhpcy5fc3RhcnRlZH19LHQubm93PSJ1bmRlZmluZWQiIT10eXBlb2YgcGVyZm9ybWFuY2UmJnBlcmZvcm1hbmNlLm5vdz8oKT0+cGVyZm9ybWFuY2Uubm93KCk6RGF0ZS5ub3c7fSwxNzQ1OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5Nb2RlbD12b2lkIDA7Y29uc3Qgcj1uKDU2ODYpLG89big0NjYyKSxpPW4oNTEyNykscz1uKDI0NDYpLGE9big3MjczKTt2YXIgdT1pLm9ubnhydW50aW1lLmV4cGVyaW1lbnRhbC5mYnM7dC5Nb2RlbD1jbGFzc3tjb25zdHJ1Y3Rvcigpe31sb2FkKGUsdCxuKXtpZighbil0cnl7cmV0dXJuIHZvaWQgdGhpcy5sb2FkRnJvbU9ubnhGb3JtYXQoZSx0KX1jYXRjaChlKXtpZih2b2lkIDAhPT1uKXRocm93IGV9dGhpcy5sb2FkRnJvbU9ydEZvcm1hdChlLHQpO31sb2FkRnJvbU9ubnhGb3JtYXQoZSx0KXtjb25zdCBuPXMub25ueC5Nb2RlbFByb3RvLmRlY29kZShlKTtpZihhLkxvbmdVdGlsLmxvbmdUb051bWJlcihuLmlyVmVyc2lvbik8Myl0aHJvdyBuZXcgRXJyb3IoIm9ubHkgc3VwcG9ydCBPTk5YIG1vZGVsIHdpdGggSVJfVkVSU0lPTj49MyIpO3RoaXMuX29wc2V0cz1uLm9wc2V0SW1wb3J0Lm1hcCgoZT0+KHtkb21haW46ZS5kb21haW4sdmVyc2lvbjphLkxvbmdVdGlsLmxvbmdUb051bWJlcihlLnZlcnNpb24pfSkpKSx0aGlzLl9ncmFwaD1vLkdyYXBoLmZyb20obi5ncmFwaCx0KTt9bG9hZEZyb21PcnRGb3JtYXQoZSx0KXtjb25zdCBuPW5ldyByLmZsYXRidWZmZXJzLkJ5dGVCdWZmZXIoZSksaT11LkluZmVyZW5jZVNlc3Npb24uZ2V0Um9vdEFzSW5mZXJlbmNlU2Vzc2lvbihuKS5tb2RlbCgpO2lmKGEuTG9uZ1V0aWwubG9uZ1RvTnVtYmVyKGkuaXJWZXJzaW9uKCkpPDMpdGhyb3cgbmV3IEVycm9yKCJvbmx5IHN1cHBvcnQgT05OWCBtb2RlbCB3aXRoIElSX1ZFUlNJT04+PTMiKTt0aGlzLl9vcHNldHM9W107Zm9yKGxldCBlPTA7ZTxpLm9wc2V0SW1wb3J0TGVuZ3RoKCk7ZSsrKXtjb25zdCB0PWkub3BzZXRJbXBvcnQoZSk7dGhpcy5fb3BzZXRzLnB1c2goe2RvbWFpbjpudWxsPT10P3ZvaWQgMDp0LmRvbWFpbigpLHZlcnNpb246YS5Mb25nVXRpbC5sb25nVG9OdW1iZXIodC52ZXJzaW9uKCkpfSk7fXRoaXMuX2dyYXBoPW8uR3JhcGguZnJvbShpLmdyYXBoKCksdCk7fWdldCBncmFwaCgpe3JldHVybiB0aGlzLl9ncmFwaH1nZXQgb3BzZXRzKCl7cmV0dXJuIHRoaXMuX29wc2V0c319O30sNjE0NTooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LkZMT0FUX1RZUEVTPXQuSU5UX1RZUEVTPXQuTlVNQkVSX1RZUEVTPXZvaWQgMCx0Lk5VTUJFUl9UWVBFUz1bImZsb2F0MzIiLCJmbG9hdDY0IiwiaW50MzIiLCJpbnQxNiIsImludDgiLCJ1aW50MTYiLCJ1aW50MzIiLCJ1aW50OCJdLHQuSU5UX1RZUEVTPVsiaW50MzIiLCJpbnQxNiIsImludDgiLCJ1aW50MTYiLCJ1aW50MzIiLCJ1aW50OCJdLHQuRkxPQVRfVFlQRVM9WyJmbG9hdDMyIiwiZmxvYXQ2NCJdO30sNTg4MTooZSx0KT0+e2Z1bmN0aW9uIG4oZSx0KXtpZih0LmVuZHNXaXRoKCIrIikpe2NvbnN0IG49TnVtYmVyLnBhcnNlSW50KHQuc3Vic3RyaW5nKDAsdC5sZW5ndGgtMSksMTApO3JldHVybiAhaXNOYU4obikmJm48PWV9aWYoMj09PXQuc3BsaXQoIi0iKS5sZW5ndGgpe2NvbnN0IG49dC5zcGxpdCgiLSIpLHI9TnVtYmVyLnBhcnNlSW50KG5bMF0sMTApLG89TnVtYmVyLnBhcnNlSW50KG5bMV0sMTApO3JldHVybiAhaXNOYU4ocikmJiFpc05hTihvKSYmcjw9ZSYmZTw9b31yZXR1cm4gTnVtYmVyLnBhcnNlSW50KHQsMTApPT09ZX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5yZXNvbHZlT3BlcmF0b3I9dm9pZCAwLHQucmVzb2x2ZU9wZXJhdG9yPWZ1bmN0aW9uKGUsdCxyKXtmb3IoY29uc3QgbyBvZiByKXtjb25zdCByPW9bMF0saT1vWzFdLHM9b1syXSxhPW9bM10sdT1vWzRdO2lmKGUub3BUeXBlPT09cilmb3IoY29uc3QgZSBvZiB0KWlmKChlLmRvbWFpbj09PWl8fCJhaS5vbm54Ij09PWUuZG9tYWluJiYiIj09PWkpJiZuKGUudmVyc2lvbixzKSlyZXR1cm4ge29wSW1wbDphLG9wSW5pdDp1fX10aHJvdyBuZXcgVHlwZUVycm9yKGBjYW5ub3QgcmVzb2x2ZSBvcGVyYXRvciAnJHtlLm9wVHlwZX0nIHdpdGggb3BzZXRzOiAke3QubWFwKChlPT5gJHtlLmRvbWFpbnx8ImFpLm9ubngifSB2JHtlLnZlcnNpb259YCkpLmpvaW4oIiwgIil9YCl9O30sNTEyNzooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQub25ueHJ1bnRpbWU9dm9pZCAwO2NvbnN0IHI9big1Njg2KTt2YXIgbyxpOygoZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpe2VbZS5VTkRFRklORUQ9MF09IlVOREVGSU5FRCIsZVtlLkZMT0FUPTFdPSJGTE9BVCIsZVtlLklOVD0yXT0iSU5UIixlW2UuU1RSSU5HPTNdPSJTVFJJTkciLGVbZS5URU5TT1I9NF09IlRFTlNPUiIsZVtlLkdSQVBIPTVdPSJHUkFQSCIsZVtlLkZMT0FUUz02XT0iRkxPQVRTIixlW2UuSU5UUz03XT0iSU5UUyIsZVtlLlNUUklOR1M9OF09IlNUUklOR1MiLGVbZS5URU5TT1JTPTldPSJURU5TT1JTIixlW2UuR1JBUEhTPTEwXT0iR1JBUEhTIixlW2UuU1BBUlNFX1RFTlNPUj0xMV09IlNQQVJTRV9URU5TT1IiLGVbZS5TUEFSU0VfVEVOU09SUz0xMl09IlNQQVJTRV9URU5TT1JTIjt9KGUuQXR0cmlidXRlVHlwZXx8KGUuQXR0cmlidXRlVHlwZT17fSkpO30pKSgoaT0obz10Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLmV4cGVyaW1lbnRhbHx8KG8uZXhwZXJpbWVudGFsPXt9KSkuZmJzfHwoaS5mYnM9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXtlW2UuVU5LTk9XTj0wXT0iVU5LTk9XTiIsZVtlLlZBTFVFPTFdPSJWQUxVRSIsZVtlLlBBUkFNPTJdPSJQQVJBTSI7fShlLkRpbWVuc2lvblZhbHVlVHlwZXx8KGUuRGltZW5zaW9uVmFsdWVUeXBlPXt9KSk7fShlLmZic3x8KGUuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpe2VbZS5VTkRFRklORUQ9MF09IlVOREVGSU5FRCIsZVtlLkZMT0FUPTFdPSJGTE9BVCIsZVtlLlVJTlQ4PTJdPSJVSU5UOCIsZVtlLklOVDg9M109IklOVDgiLGVbZS5VSU5UMTY9NF09IlVJTlQxNiIsZVtlLklOVDE2PTVdPSJJTlQxNiIsZVtlLklOVDMyPTZdPSJJTlQzMiIsZVtlLklOVDY0PTddPSJJTlQ2NCIsZVtlLlNUUklORz04XT0iU1RSSU5HIixlW2UuQk9PTD05XT0iQk9PTCIsZVtlLkZMT0FUMTY9MTBdPSJGTE9BVDE2IixlW2UuRE9VQkxFPTExXT0iRE9VQkxFIixlW2UuVUlOVDMyPTEyXT0iVUlOVDMyIixlW2UuVUlOVDY0PTEzXT0iVUlOVDY0IixlW2UuQ09NUExFWDY0PTE0XT0iQ09NUExFWDY0IixlW2UuQ09NUExFWDEyOD0xNV09IkNPTVBMRVgxMjgiLGVbZS5CRkxPQVQxNj0xNl09IkJGTE9BVDE2IixlW2UuRkxPQVQ4RTRNM0ZOPTE3XT0iRkxPQVQ4RTRNM0ZOIixlW2UuRkxPQVQ4RTRNM0ZOVVo9MThdPSJGTE9BVDhFNE0zRk5VWiIsZVtlLkZMT0FUOEU1TTI9MTldPSJGTE9BVDhFNU0yIixlW2UuRkxPQVQ4RTVNMkZOVVo9MjBdPSJGTE9BVDhFNU0yRk5VWiI7fShlLlRlbnNvckRhdGFUeXBlfHwoZS5UZW5zb3JEYXRhVHlwZT17fSkpO30oZS5mYnN8fChlLmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXtlW2UuUHJpbWl0aXZlPTBdPSJQcmltaXRpdmUiLGVbZS5GdXNlZD0xXT0iRnVzZWQiO30oZS5Ob2RlVHlwZXx8KGUuTm9kZVR5cGU9e30pKTt9KGUuZmJzfHwoZS5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7ZVtlLk5PTkU9MF09Ik5PTkUiLGVbZS50ZW5zb3JfdHlwZT0xXT0idGVuc29yX3R5cGUiLGVbZS5zZXF1ZW5jZV90eXBlPTJdPSJzZXF1ZW5jZV90eXBlIixlW2UubWFwX3R5cGU9M109Im1hcF90eXBlIjt9KGUuVHlwZUluZm9WYWx1ZXx8KGUuVHlwZUluZm9WYWx1ZT17fSkpO30oZS5mYnN8fChlLmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQpe2NsYXNzIG57Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9c3RhdGljIGdldFJvb3RBc1NoYXBlKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNTaGFwZShlLHQpe3JldHVybiBlLnNldFBvc2l0aW9uKGUucG9zaXRpb24oKStyLmZsYXRidWZmZXJzLlNJWkVfUFJFRklYX0xFTkdUSCksKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9ZGltKHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gcj8obnx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5EaW1lbnNpb24pLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytyKSs0KnQpLHRoaXMuYmIpOm51bGx9ZGltTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXN0YXRpYyBzdGFydFNoYXBlKGUpe2Uuc3RhcnRPYmplY3QoMSk7fXN0YXRpYyBhZGREaW0oZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDAsdCwwKTt9c3RhdGljIGNyZWF0ZURpbVZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnREaW1WZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGVuZFNoYXBlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVTaGFwZShlLHQpe3JldHVybiBuLnN0YXJ0U2hhcGUoZSksbi5hZGREaW0oZSx0KSxuLmVuZFNoYXBlKGUpfX10LlNoYXBlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzRGltZW5zaW9uKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNEaW1lbnNpb24oZSx0KXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLCh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXZhbHVlKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuRGltZW5zaW9uVmFsdWUpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYl9wb3MrbiksdGhpcy5iYik6bnVsbH1kZW5vdGF0aW9uKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9c3RhdGljIHN0YXJ0RGltZW5zaW9uKGUpe2Uuc3RhcnRPYmplY3QoMik7fXN0YXRpYyBhZGRWYWx1ZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgYWRkRGVub3RhdGlvbihlLHQpe2UuYWRkRmllbGRPZmZzZXQoMSx0LDApO31zdGF0aWMgZW5kRGltZW5zaW9uKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVEaW1lbnNpb24oZSx0LHIpe3JldHVybiBuLnN0YXJ0RGltZW5zaW9uKGUpLG4uYWRkVmFsdWUoZSx0KSxuLmFkZERlbm90YXRpb24oZSxyKSxuLmVuZERpbWVuc2lvbihlKX19dC5EaW1lbnNpb249bjt9KHQuZmJzfHwodC5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNEaW1lbnNpb25WYWx1ZShlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzRGltZW5zaW9uVmFsdWUoZSx0KXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLCh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfWRpbVR5cGUoKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDgodGhpcy5iYl9wb3MrdCk6ZS5leHBlcmltZW50YWwuZmJzLkRpbWVuc2lvblZhbHVlVHlwZS5VTktOT1dOfWRpbVZhbHVlKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3BvcytlKTp0aGlzLmJiLmNyZWF0ZUxvbmcoMCwwKX1kaW1QYXJhbShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfXN0YXRpYyBzdGFydERpbWVuc2lvblZhbHVlKGUpe2Uuc3RhcnRPYmplY3QoMyk7fXN0YXRpYyBhZGREaW1UeXBlKHQsbil7dC5hZGRGaWVsZEludDgoMCxuLGUuZXhwZXJpbWVudGFsLmZicy5EaW1lbnNpb25WYWx1ZVR5cGUuVU5LTk9XTik7fXN0YXRpYyBhZGREaW1WYWx1ZShlLHQpe2UuYWRkRmllbGRJbnQ2NCgxLHQsZS5jcmVhdGVMb25nKDAsMCkpO31zdGF0aWMgYWRkRGltUGFyYW0oZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDIsdCwwKTt9c3RhdGljIGVuZERpbWVuc2lvblZhbHVlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVEaW1lbnNpb25WYWx1ZShlLHQscixvKXtyZXR1cm4gbi5zdGFydERpbWVuc2lvblZhbHVlKGUpLG4uYWRkRGltVHlwZShlLHQpLG4uYWRkRGltVmFsdWUoZSxyKSxuLmFkZERpbVBhcmFtKGUsbyksbi5lbmREaW1lbnNpb25WYWx1ZShlKX19dC5EaW1lbnNpb25WYWx1ZT1uO30odC5mYnN8fCh0LmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQpe2NsYXNzIG57Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9c3RhdGljIGdldFJvb3RBc1RlbnNvclR5cGVBbmRTaGFwZShlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzVGVuc29yVHlwZUFuZFNoYXBlKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1lbGVtVHlwZSgpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6ZS5leHBlcmltZW50YWwuZmJzLlRlbnNvckRhdGFUeXBlLlVOREVGSU5FRH1zaGFwZSh0KXtsZXQgbj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiBuPyh0fHxuZXcgZS5leHBlcmltZW50YWwuZmJzLlNoYXBlKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9c3RhdGljIHN0YXJ0VGVuc29yVHlwZUFuZFNoYXBlKGUpe2Uuc3RhcnRPYmplY3QoMik7fXN0YXRpYyBhZGRFbGVtVHlwZSh0LG4pe3QuYWRkRmllbGRJbnQzMigwLG4sZS5leHBlcmltZW50YWwuZmJzLlRlbnNvckRhdGFUeXBlLlVOREVGSU5FRCk7fXN0YXRpYyBhZGRTaGFwZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMSx0LDApO31zdGF0aWMgZW5kVGVuc29yVHlwZUFuZFNoYXBlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVUZW5zb3JUeXBlQW5kU2hhcGUoZSx0LHIpe3JldHVybiBuLnN0YXJ0VGVuc29yVHlwZUFuZFNoYXBlKGUpLG4uYWRkRWxlbVR5cGUoZSx0KSxuLmFkZFNoYXBlKGUsciksbi5lbmRUZW5zb3JUeXBlQW5kU2hhcGUoZSl9fXQuVGVuc29yVHlwZUFuZFNoYXBlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzTWFwVHlwZShlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzTWFwVHlwZShlLHQpe3JldHVybiBlLnNldFBvc2l0aW9uKGUucG9zaXRpb24oKStyLmZsYXRidWZmZXJzLlNJWkVfUFJFRklYX0xFTkdUSCksKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9a2V5VHlwZSgpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6ZS5leHBlcmltZW50YWwuZmJzLlRlbnNvckRhdGFUeXBlLlVOREVGSU5FRH12YWx1ZVR5cGUodCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gbj8odHx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5UeXBlSW5mbykuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytuKSx0aGlzLmJiKTpudWxsfXN0YXRpYyBzdGFydE1hcFR5cGUoZSl7ZS5zdGFydE9iamVjdCgyKTt9c3RhdGljIGFkZEtleVR5cGUodCxuKXt0LmFkZEZpZWxkSW50MzIoMCxuLGUuZXhwZXJpbWVudGFsLmZicy5UZW5zb3JEYXRhVHlwZS5VTkRFRklORUQpO31zdGF0aWMgYWRkVmFsdWVUeXBlKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBlbmRNYXBUeXBlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVNYXBUeXBlKGUsdCxyKXtyZXR1cm4gbi5zdGFydE1hcFR5cGUoZSksbi5hZGRLZXlUeXBlKGUsdCksbi5hZGRWYWx1ZVR5cGUoZSxyKSxuLmVuZE1hcFR5cGUoZSl9fXQuTWFwVHlwZT1uO30odC5mYnN8fCh0LmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQpe2NsYXNzIG57Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9c3RhdGljIGdldFJvb3RBc1NlcXVlbmNlVHlwZShlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzU2VxdWVuY2VUeXBlKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1lbGVtVHlwZSh0KXtsZXQgbj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiBuPyh0fHxuZXcgZS5leHBlcmltZW50YWwuZmJzLlR5cGVJbmZvKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9c3RhdGljIHN0YXJ0U2VxdWVuY2VUeXBlKGUpe2Uuc3RhcnRPYmplY3QoMSk7fXN0YXRpYyBhZGRFbGVtVHlwZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgZW5kU2VxdWVuY2VUeXBlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVTZXF1ZW5jZVR5cGUoZSx0KXtyZXR1cm4gbi5zdGFydFNlcXVlbmNlVHlwZShlKSxuLmFkZEVsZW1UeXBlKGUsdCksbi5lbmRTZXF1ZW5jZVR5cGUoZSl9fXQuU2VxdWVuY2VUeXBlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXsoZS5mYnN8fChlLmZicz17fSkpLkVkZ2VFbmQ9Y2xhc3N7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9bm9kZUluZGV4KCl7cmV0dXJuIHRoaXMuYmIucmVhZFVpbnQzMih0aGlzLmJiX3Bvcyl9c3JjQXJnSW5kZXgoKXtyZXR1cm4gdGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrNCl9ZHN0QXJnSW5kZXgoKXtyZXR1cm4gdGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrOCl9c3RhdGljIGNyZWF0ZUVkZ2VFbmQoZSx0LG4scil7cmV0dXJuIGUucHJlcCg0LDEyKSxlLndyaXRlSW50MzIociksZS53cml0ZUludDMyKG4pLGUud3JpdGVJbnQzMih0KSxlLm9mZnNldCgpfX07fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzTm9kZUVkZ2UoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc05vZGVFZGdlKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1ub2RlSW5kZXgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiBlP3RoaXMuYmIucmVhZFVpbnQzMih0aGlzLmJiX3BvcytlKTowfWlucHV0RWRnZXModCxuKXtsZXQgcj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiByPyhufHxuZXcgZS5leHBlcmltZW50YWwuZmJzLkVkZ2VFbmQpLl9faW5pdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3IpKzEyKnQsdGhpcy5iYik6bnVsbH1pbnB1dEVkZ2VzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfW91dHB1dEVkZ2VzKHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gcj8obnx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5FZGdlRW5kKS5fX2luaXQodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytyKSsxMip0LHRoaXMuYmIpOm51bGx9b3V0cHV0RWRnZXNMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9c3RhdGljIHN0YXJ0Tm9kZUVkZ2UoZSl7ZS5zdGFydE9iamVjdCgzKTt9c3RhdGljIGFkZE5vZGVJbmRleChlLHQpe2UuYWRkRmllbGRJbnQzMigwLHQsMCk7fXN0YXRpYyBhZGRJbnB1dEVkZ2VzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBzdGFydElucHV0RWRnZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDEyLHQsNCk7fXN0YXRpYyBhZGRPdXRwdXRFZGdlcyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMix0LDApO31zdGF0aWMgc3RhcnRPdXRwdXRFZGdlc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoMTIsdCw0KTt9c3RhdGljIGVuZE5vZGVFZGdlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVOb2RlRWRnZShlLHQscixvKXtyZXR1cm4gbi5zdGFydE5vZGVFZGdlKGUpLG4uYWRkTm9kZUluZGV4KGUsdCksbi5hZGRJbnB1dEVkZ2VzKGUsciksbi5hZGRPdXRwdXRFZGdlcyhlLG8pLG4uZW5kTm9kZUVkZ2UoZSl9fXQuTm9kZUVkZ2U9bjt9KHQuZmJzfHwodC5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNOb2RlKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNOb2RlKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1uYW1lKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9ZG9jU3RyaW5nKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9ZG9tYWluKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9c2luY2VWZXJzaW9uKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIGU/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrZSk6MH1pbmRleCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiBlP3RoaXMuYmIucmVhZFVpbnQzMih0aGlzLmJiX3BvcytlKTowfW9wVHlwZShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDE0KTtyZXR1cm4gdD90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK3QsZSk6bnVsbH10eXBlKCl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxNik7cmV0dXJuIHQ/dGhpcy5iYi5yZWFkSW50MzIodGhpcy5iYl9wb3MrdCk6ZS5leHBlcmltZW50YWwuZmJzLk5vZGVUeXBlLlByaW1pdGl2ZX1leGVjdXRpb25Qcm92aWRlclR5cGUoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxOCk7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9aW5wdXRzKGUsdCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyMCk7cmV0dXJuIG4/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK24pKzQqZSx0KTpudWxsfWlucHV0c0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjApO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9b3V0cHV0cyhlLHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjIpO3JldHVybiBuP3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytuKSs0KmUsdCk6bnVsbH1vdXRwdXRzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyMik7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1hdHRyaWJ1dGVzKHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyNCk7cmV0dXJuIHI/KG58fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuQXR0cmlidXRlKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrcikrNCp0KSx0aGlzLmJiKTpudWxsfWF0dHJpYnV0ZXNMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDI0KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfWlucHV0QXJnQ291bnRzKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjYpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrdCkrNCplKTowfWlucHV0QXJnQ291bnRzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyNik7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1pbnB1dEFyZ0NvdW50c0FycmF5KCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyNik7cmV0dXJuIGU/bmV3IEludDMyQXJyYXkodGhpcy5iYi5ieXRlcygpLmJ1ZmZlcix0aGlzLmJiLmJ5dGVzKCkuYnl0ZU9mZnNldCt0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK2UpLHRoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpKTpudWxsfWltcGxpY2l0SW5wdXRzKGUsdCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyOCk7cmV0dXJuIG4/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK24pKzQqZSx0KTpudWxsfWltcGxpY2l0SW5wdXRzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyOCk7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1zdGF0aWMgc3RhcnROb2RlKGUpe2Uuc3RhcnRPYmplY3QoMTMpO31zdGF0aWMgYWRkTmFtZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgYWRkRG9jU3RyaW5nKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBhZGREb21haW4oZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDIsdCwwKTt9c3RhdGljIGFkZFNpbmNlVmVyc2lvbihlLHQpe2UuYWRkRmllbGRJbnQzMigzLHQsMCk7fXN0YXRpYyBhZGRJbmRleChlLHQpe2UuYWRkRmllbGRJbnQzMig0LHQsMCk7fXN0YXRpYyBhZGRPcFR5cGUoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDUsdCwwKTt9c3RhdGljIGFkZFR5cGUodCxuKXt0LmFkZEZpZWxkSW50MzIoNixuLGUuZXhwZXJpbWVudGFsLmZicy5Ob2RlVHlwZS5QcmltaXRpdmUpO31zdGF0aWMgYWRkRXhlY3V0aW9uUHJvdmlkZXJUeXBlKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg3LHQsMCk7fXN0YXRpYyBhZGRJbnB1dHMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDgsdCwwKTt9c3RhdGljIGNyZWF0ZUlucHV0c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRJbnB1dHNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGFkZE91dHB1dHMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDksdCwwKTt9c3RhdGljIGNyZWF0ZU91dHB1dHNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRPZmZzZXQodFtuXSk7cmV0dXJuIGUuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0T3V0cHV0c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkQXR0cmlidXRlcyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMTAsdCwwKTt9c3RhdGljIGNyZWF0ZUF0dHJpYnV0ZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRPZmZzZXQodFtuXSk7cmV0dXJuIGUuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0QXR0cmlidXRlc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkSW5wdXRBcmdDb3VudHMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDExLHQsMCk7fXN0YXRpYyBjcmVhdGVJbnB1dEFyZ0NvdW50c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZEludDMyKHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydElucHV0QXJnQ291bnRzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBhZGRJbXBsaWNpdElucHV0cyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMTIsdCwwKTt9c3RhdGljIGNyZWF0ZUltcGxpY2l0SW5wdXRzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEltcGxpY2l0SW5wdXRzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBlbmROb2RlKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVOb2RlKGUsdCxyLG8saSxzLGEsdSxsLGMscCxkLGYsaCl7cmV0dXJuIG4uc3RhcnROb2RlKGUpLG4uYWRkTmFtZShlLHQpLG4uYWRkRG9jU3RyaW5nKGUsciksbi5hZGREb21haW4oZSxvKSxuLmFkZFNpbmNlVmVyc2lvbihlLGkpLG4uYWRkSW5kZXgoZSxzKSxuLmFkZE9wVHlwZShlLGEpLG4uYWRkVHlwZShlLHUpLG4uYWRkRXhlY3V0aW9uUHJvdmlkZXJUeXBlKGUsbCksbi5hZGRJbnB1dHMoZSxjKSxuLmFkZE91dHB1dHMoZSxwKSxuLmFkZEF0dHJpYnV0ZXMoZSxkKSxuLmFkZElucHV0QXJnQ291bnRzKGUsZiksbi5hZGRJbXBsaWNpdElucHV0cyhlLGgpLG4uZW5kTm9kZShlKX19dC5Ob2RlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzVmFsdWVJbmZvKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNWYWx1ZUluZm8oZSx0KXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLCh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfW5hbWUoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK3QsZSk6bnVsbH1kb2NTdHJpbmcoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gdD90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK3QsZSk6bnVsbH10eXBlKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuVHlwZUluZm8pLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYl9wb3MrbiksdGhpcy5iYik6bnVsbH1zdGF0aWMgc3RhcnRWYWx1ZUluZm8oZSl7ZS5zdGFydE9iamVjdCgzKTt9c3RhdGljIGFkZE5hbWUoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDAsdCwwKTt9c3RhdGljIGFkZERvY1N0cmluZyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMSx0LDApO31zdGF0aWMgYWRkVHlwZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMix0LDApO31zdGF0aWMgZW5kVmFsdWVJbmZvKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVWYWx1ZUluZm8oZSx0LHIsbyl7cmV0dXJuIG4uc3RhcnRWYWx1ZUluZm8oZSksbi5hZGROYW1lKGUsdCksbi5hZGREb2NTdHJpbmcoZSxyKSxuLmFkZFR5cGUoZSxvKSxuLmVuZFZhbHVlSW5mbyhlKX19dC5WYWx1ZUluZm89bjt9KHQuZmJzfHwodC5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNUeXBlSW5mbyhlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzVHlwZUluZm8oZSx0KXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLCh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfWRlbm90YXRpb24oZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gdD90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK3QsZSk6bnVsbH12YWx1ZVR5cGUoKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIucmVhZFVpbnQ4KHRoaXMuYmJfcG9zK3QpOmUuZXhwZXJpbWVudGFsLmZicy5UeXBlSW5mb1ZhbHVlLk5PTkV9dmFsdWUoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gdD90aGlzLmJiLl9fdW5pb24oZSx0aGlzLmJiX3Bvcyt0KTpudWxsfXN0YXRpYyBzdGFydFR5cGVJbmZvKGUpe2Uuc3RhcnRPYmplY3QoMyk7fXN0YXRpYyBhZGREZW5vdGF0aW9uKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgwLHQsMCk7fXN0YXRpYyBhZGRWYWx1ZVR5cGUodCxuKXt0LmFkZEZpZWxkSW50OCgxLG4sZS5leHBlcmltZW50YWwuZmJzLlR5cGVJbmZvVmFsdWUuTk9ORSk7fXN0YXRpYyBhZGRWYWx1ZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMix0LDApO31zdGF0aWMgZW5kVHlwZUluZm8oZSl7cmV0dXJuIGUuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZVR5cGVJbmZvKGUsdCxyLG8pe3JldHVybiBuLnN0YXJ0VHlwZUluZm8oZSksbi5hZGREZW5vdGF0aW9uKGUsdCksbi5hZGRWYWx1ZVR5cGUoZSxyKSxuLmFkZFZhbHVlKGUsbyksbi5lbmRUeXBlSW5mbyhlKX19dC5UeXBlSW5mbz1uO30odC5mYnN8fCh0LmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpe2NsYXNzIHR7Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9c3RhdGljIGdldFJvb3RBc09wZXJhdG9yU2V0SWQoZSxuKXtyZXR1cm4gKG58fG5ldyB0KS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc09wZXJhdG9yU2V0SWQoZSxuKXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLChufHxuZXcgdCkuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfWRvbWFpbihlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfXZlcnNpb24oKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiBlP3RoaXMuYmIucmVhZEludDY0KHRoaXMuYmJfcG9zK2UpOnRoaXMuYmIuY3JlYXRlTG9uZygwLDApfXN0YXRpYyBzdGFydE9wZXJhdG9yU2V0SWQoZSl7ZS5zdGFydE9iamVjdCgyKTt9c3RhdGljIGFkZERvbWFpbihlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgYWRkVmVyc2lvbihlLHQpe2UuYWRkRmllbGRJbnQ2NCgxLHQsZS5jcmVhdGVMb25nKDAsMCkpO31zdGF0aWMgZW5kT3BlcmF0b3JTZXRJZChlKXtyZXR1cm4gZS5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlT3BlcmF0b3JTZXRJZChlLG4scil7cmV0dXJuIHQuc3RhcnRPcGVyYXRvclNldElkKGUpLHQuYWRkRG9tYWluKGUsbiksdC5hZGRWZXJzaW9uKGUsciksdC5lbmRPcGVyYXRvclNldElkKGUpfX1lLk9wZXJhdG9yU2V0SWQ9dDt9KGUuZmJzfHwoZS5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNUZW5zb3IoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc1RlbnNvcihlLHQpe3JldHVybiBlLnNldFBvc2l0aW9uKGUucG9zaXRpb24oKStyLmZsYXRidWZmZXJzLlNJWkVfUFJFRklYX0xFTkdUSCksKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9bmFtZShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfWRvY1N0cmluZyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfWRpbXMoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gdD90aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3QpKzgqZSk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9ZGltc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1kYXRhVHlwZSgpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTApO3JldHVybiB0P3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmJfcG9zK3QpOmUuZXhwZXJpbWVudGFsLmZicy5UZW5zb3JEYXRhVHlwZS5VTkRFRklORUR9cmF3RGF0YShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEyKTtyZXR1cm4gdD90aGlzLmJiLnJlYWRVaW50OCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3QpK2UpOjB9cmF3RGF0YUxlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTIpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9cmF3RGF0YUFycmF5KCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMik7cmV0dXJuIGU/bmV3IFVpbnQ4QXJyYXkodGhpcy5iYi5ieXRlcygpLmJ1ZmZlcix0aGlzLmJiLmJ5dGVzKCkuYnl0ZU9mZnNldCt0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK2UpLHRoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpKTpudWxsfXN0cmluZ0RhdGEoZSx0KXtsZXQgbj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDE0KTtyZXR1cm4gbj90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrbikrNCplLHQpOm51bGx9c3RyaW5nRGF0YUxlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTQpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9c3RhdGljIHN0YXJ0VGVuc29yKGUpe2Uuc3RhcnRPYmplY3QoNik7fXN0YXRpYyBhZGROYW1lKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgwLHQsMCk7fXN0YXRpYyBhZGREb2NTdHJpbmcoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDEsdCwwKTt9c3RhdGljIGFkZERpbXMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDIsdCwwKTt9c3RhdGljIGNyZWF0ZURpbXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDgsdC5sZW5ndGgsOCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRJbnQ2NCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnREaW1zVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig4LHQsOCk7fXN0YXRpYyBhZGREYXRhVHlwZSh0LG4pe3QuYWRkRmllbGRJbnQzMigzLG4sZS5leHBlcmltZW50YWwuZmJzLlRlbnNvckRhdGFUeXBlLlVOREVGSU5FRCk7fXN0YXRpYyBhZGRSYXdEYXRhKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg0LHQsMCk7fXN0YXRpYyBjcmVhdGVSYXdEYXRhVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3RvcigxLHQubGVuZ3RoLDEpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkSW50OCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRSYXdEYXRhVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3RvcigxLHQsMSk7fXN0YXRpYyBhZGRTdHJpbmdEYXRhKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg1LHQsMCk7fXN0YXRpYyBjcmVhdGVTdHJpbmdEYXRhVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydFN0cmluZ0RhdGFWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGVuZFRlbnNvcihlKXtyZXR1cm4gZS5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlVGVuc29yKGUsdCxyLG8saSxzLGEpe3JldHVybiBuLnN0YXJ0VGVuc29yKGUpLG4uYWRkTmFtZShlLHQpLG4uYWRkRG9jU3RyaW5nKGUsciksbi5hZGREaW1zKGUsbyksbi5hZGREYXRhVHlwZShlLGkpLG4uYWRkUmF3RGF0YShlLHMpLG4uYWRkU3RyaW5nRGF0YShlLGEpLG4uZW5kVGVuc29yKGUpfX10LlRlbnNvcj1uO30odC5mYnN8fCh0LmZicz17fSkpO30oZS5leHBlcmltZW50YWx8fChlLmV4cGVyaW1lbnRhbD17fSkpO30odC5vbm54cnVudGltZXx8KHQub25ueHJ1bnRpbWU9e30pKSxmdW5jdGlvbihlKXshZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQpe2NsYXNzIG57Y29uc3RydWN0b3IoKXt0aGlzLmJiPW51bGwsdGhpcy5iYl9wb3M9MDt9X19pbml0KGUsdCl7cmV0dXJuIHRoaXMuYmJfcG9zPWUsdGhpcy5iYj10LHRoaXN9c3RhdGljIGdldFJvb3RBc1NwYXJzZVRlbnNvcihlLHQpe3JldHVybiAodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgZ2V0U2l6ZVByZWZpeGVkUm9vdEFzU3BhcnNlVGVuc29yKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX12YWx1ZXModCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gbj8odHx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5UZW5zb3IpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYl9wb3MrbiksdGhpcy5iYik6bnVsbH1pbmRpY2VzKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuVGVuc29yKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9ZGltcyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDY0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrdCkrOCplKTp0aGlzLmJiLmNyZWF0ZUxvbmcoMCwwKX1kaW1zTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXN0YXRpYyBzdGFydFNwYXJzZVRlbnNvcihlKXtlLnN0YXJ0T2JqZWN0KDMpO31zdGF0aWMgYWRkVmFsdWVzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgwLHQsMCk7fXN0YXRpYyBhZGRJbmRpY2VzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBhZGREaW1zKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgyLHQsMCk7fXN0YXRpYyBjcmVhdGVEaW1zVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig4LHQubGVuZ3RoLDgpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkSW50NjQodFtuXSk7cmV0dXJuIGUuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0RGltc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoOCx0LDgpO31zdGF0aWMgZW5kU3BhcnNlVGVuc29yKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVTcGFyc2VUZW5zb3IoZSx0LHIsbyl7cmV0dXJuIG4uc3RhcnRTcGFyc2VUZW5zb3IoZSksbi5hZGRWYWx1ZXMoZSx0KSxuLmFkZEluZGljZXMoZSxyKSxuLmFkZERpbXMoZSxvKSxuLmVuZFNwYXJzZVRlbnNvcihlKX19dC5TcGFyc2VUZW5zb3I9bjt9KHQuZmJzfHwodC5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNBdHRyaWJ1dGUoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0F0dHJpYnV0ZShlLHQpe3JldHVybiBlLnNldFBvc2l0aW9uKGUucG9zaXRpb24oKStyLmZsYXRidWZmZXJzLlNJWkVfUFJFRklYX0xFTkdUSCksKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9bmFtZShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfWRvY1N0cmluZyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfXR5cGUoKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDMyKHRoaXMuYmJfcG9zK3QpOmUuZXhwZXJpbWVudGFsLmZicy5BdHRyaWJ1dGVUeXBlLlVOREVGSU5FRH1mKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMCk7cmV0dXJuIGU/dGhpcy5iYi5yZWFkRmxvYXQzMih0aGlzLmJiX3BvcytlKTowfWkoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEyKTtyZXR1cm4gZT90aGlzLmJiLnJlYWRJbnQ2NCh0aGlzLmJiX3BvcytlKTp0aGlzLmJiLmNyZWF0ZUxvbmcoMCwwKX1zKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTQpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfXQodCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxNik7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuVGVuc29yKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9Zyh0KXtsZXQgbj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDE4KTtyZXR1cm4gbj8odHx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5HcmFwaCkuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytuKSx0aGlzLmJiKTpudWxsfWZsb2F0cyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDIwKTtyZXR1cm4gdD90aGlzLmJiLnJlYWRGbG9hdDMyKHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrdCkrNCplKTowfWZsb2F0c0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjApO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9ZmxvYXRzQXJyYXkoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDIwKTtyZXR1cm4gZT9uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmIuYnl0ZXMoKS5idWZmZXIsdGhpcy5iYi5ieXRlcygpLmJ5dGVPZmZzZXQrdGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytlKSx0aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKSk6bnVsbH1pbnRzKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjIpO3JldHVybiB0P3RoaXMuYmIucmVhZEludDY0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrdCkrOCplKTp0aGlzLmJiLmNyZWF0ZUxvbmcoMCwwKX1pbnRzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyMik7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1zdHJpbmdzKGUsdCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyNCk7cmV0dXJuIG4/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK24pKzQqZSx0KTpudWxsfXN0cmluZ3NMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDI0KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXRlbnNvcnModCxuKXtsZXQgcj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDI2KTtyZXR1cm4gcj8obnx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5UZW5zb3IpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytyKSs0KnQpLHRoaXMuYmIpOm51bGx9dGVuc29yc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMjYpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9Z3JhcGhzKHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyOCk7cmV0dXJuIHI/KG58fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuR3JhcGgpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytyKSs0KnQpLHRoaXMuYmIpOm51bGx9Z3JhcGhzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyOCk7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1zdGF0aWMgc3RhcnRBdHRyaWJ1dGUoZSl7ZS5zdGFydE9iamVjdCgxMyk7fXN0YXRpYyBhZGROYW1lKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgwLHQsMCk7fXN0YXRpYyBhZGREb2NTdHJpbmcoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDEsdCwwKTt9c3RhdGljIGFkZFR5cGUodCxuKXt0LmFkZEZpZWxkSW50MzIoMixuLGUuZXhwZXJpbWVudGFsLmZicy5BdHRyaWJ1dGVUeXBlLlVOREVGSU5FRCk7fXN0YXRpYyBhZGRGKGUsdCl7ZS5hZGRGaWVsZEZsb2F0MzIoMyx0LDApO31zdGF0aWMgYWRkSShlLHQpe2UuYWRkRmllbGRJbnQ2NCg0LHQsZS5jcmVhdGVMb25nKDAsMCkpO31zdGF0aWMgYWRkUyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoNSx0LDApO31zdGF0aWMgYWRkVChlLHQpe2UuYWRkRmllbGRPZmZzZXQoNix0LDApO31zdGF0aWMgYWRkRyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoNyx0LDApO31zdGF0aWMgYWRkRmxvYXRzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg4LHQsMCk7fXN0YXRpYyBjcmVhdGVGbG9hdHNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRGbG9hdDMyKHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEZsb2F0c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkSW50cyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoOSx0LDApO31zdGF0aWMgY3JlYXRlSW50c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoOCx0Lmxlbmd0aCw4KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZEludDY0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEludHNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDgsdCw4KTt9c3RhdGljIGFkZFN0cmluZ3MoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDEwLHQsMCk7fXN0YXRpYyBjcmVhdGVTdHJpbmdzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydFN0cmluZ3NWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGFkZFRlbnNvcnMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDExLHQsMCk7fXN0YXRpYyBjcmVhdGVUZW5zb3JzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydFRlbnNvcnNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGFkZEdyYXBocyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMTIsdCwwKTt9c3RhdGljIGNyZWF0ZUdyYXBoc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRHcmFwaHNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGVuZEF0dHJpYnV0ZShlKXtyZXR1cm4gZS5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlQXR0cmlidXRlKGUsdCxyLG8saSxzLGEsdSxsLGMscCxkLGYsaCl7cmV0dXJuIG4uc3RhcnRBdHRyaWJ1dGUoZSksbi5hZGROYW1lKGUsdCksbi5hZGREb2NTdHJpbmcoZSxyKSxuLmFkZFR5cGUoZSxvKSxuLmFkZEYoZSxpKSxuLmFkZEkoZSxzKSxuLmFkZFMoZSxhKSxuLmFkZFQoZSx1KSxuLmFkZEcoZSxsKSxuLmFkZEZsb2F0cyhlLGMpLG4uYWRkSW50cyhlLHApLG4uYWRkU3RyaW5ncyhlLGQpLG4uYWRkVGVuc29ycyhlLGYpLG4uYWRkR3JhcGhzKGUsaCksbi5lbmRBdHRyaWJ1dGUoZSl9fXQuQXR0cmlidXRlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzR3JhcGgoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0dyYXBoKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1pbml0aWFsaXplcnModCxuKXtsZXQgcj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiByPyhufHxuZXcgZS5leHBlcmltZW50YWwuZmJzLlRlbnNvcikuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3IpKzQqdCksdGhpcy5iYik6bnVsbH1pbml0aWFsaXplcnNMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9bm9kZUFyZ3ModCxuKXtsZXQgcj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiByPyhufHxuZXcgZS5leHBlcmltZW50YWwuZmJzLlZhbHVlSW5mbykuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3IpKzQqdCksdGhpcy5iYik6bnVsbH1ub2RlQXJnc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1ub2Rlcyh0LG4pe2xldCByPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIHI/KG58fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuTm9kZSkuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3IpKzQqdCksdGhpcy5iYik6bnVsbH1ub2Rlc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsOCk7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1tYXhOb2RlSW5kZXgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEwKTtyZXR1cm4gZT90aGlzLmJiLnJlYWRVaW50MzIodGhpcy5iYl9wb3MrZSk6MH1ub2RlRWRnZXModCxuKXtsZXQgcj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEyKTtyZXR1cm4gcj8obnx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5Ob2RlRWRnZSkuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3IpKzQqdCksdGhpcy5iYik6bnVsbH1ub2RlRWRnZXNMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEyKTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfWlucHV0cyhlLHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTQpO3JldHVybiBuP3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytuKSs0KmUsdCk6bnVsbH1pbnB1dHNMZW5ndGgoKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDE0KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfW91dHB1dHMoZSx0KXtsZXQgbj10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDE2KTtyZXR1cm4gbj90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrbikrNCplLHQpOm51bGx9b3V0cHV0c0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTYpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9c3BhcnNlSW5pdGlhbGl6ZXJzKHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxOCk7cmV0dXJuIHI/KG58fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuU3BhcnNlVGVuc29yKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrcikrNCp0KSx0aGlzLmJiKTpudWxsfXNwYXJzZUluaXRpYWxpemVyc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTgpO3JldHVybiBlP3RoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpOjB9c3RhdGljIHN0YXJ0R3JhcGgoZSl7ZS5zdGFydE9iamVjdCg4KTt9c3RhdGljIGFkZEluaXRpYWxpemVycyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgY3JlYXRlSW5pdGlhbGl6ZXJzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydEluaXRpYWxpemVyc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkTm9kZUFyZ3MoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDEsdCwwKTt9c3RhdGljIGNyZWF0ZU5vZGVBcmdzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydE5vZGVBcmdzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBhZGROb2RlcyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMix0LDApO31zdGF0aWMgY3JlYXRlTm9kZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRPZmZzZXQodFtuXSk7cmV0dXJuIGUuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0Tm9kZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGFkZE1heE5vZGVJbmRleChlLHQpe2UuYWRkRmllbGRJbnQzMigzLHQsMCk7fXN0YXRpYyBhZGROb2RlRWRnZXMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDQsdCwwKTt9c3RhdGljIGNyZWF0ZU5vZGVFZGdlc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnROb2RlRWRnZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGFkZElucHV0cyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoNSx0LDApO31zdGF0aWMgY3JlYXRlSW5wdXRzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydElucHV0c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkT3V0cHV0cyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoNix0LDApO31zdGF0aWMgY3JlYXRlT3V0cHV0c1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRPdXRwdXRzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBhZGRTcGFyc2VJbml0aWFsaXplcnMoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDcsdCwwKTt9c3RhdGljIGNyZWF0ZVNwYXJzZUluaXRpYWxpemVyc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0Lmxlbmd0aCw0KTtmb3IobGV0IG49dC5sZW5ndGgtMTtuPj0wO24tLSllLmFkZE9mZnNldCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRTcGFyc2VJbml0aWFsaXplcnNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdCw0KTt9c3RhdGljIGVuZEdyYXBoKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVHcmFwaChlLHQscixvLGkscyxhLHUsbCl7cmV0dXJuIG4uc3RhcnRHcmFwaChlKSxuLmFkZEluaXRpYWxpemVycyhlLHQpLG4uYWRkTm9kZUFyZ3MoZSxyKSxuLmFkZE5vZGVzKGUsbyksbi5hZGRNYXhOb2RlSW5kZXgoZSxpKSxuLmFkZE5vZGVFZGdlcyhlLHMpLG4uYWRkSW5wdXRzKGUsYSksbi5hZGRPdXRwdXRzKGUsdSksbi5hZGRTcGFyc2VJbml0aWFsaXplcnMoZSxsKSxuLmVuZEdyYXBoKGUpfX10LkdyYXBoPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzTW9kZWwoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc01vZGVsKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1pclZlcnNpb24oKXtsZXQgZT10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiBlP3RoaXMuYmIucmVhZEludDY0KHRoaXMuYmJfcG9zK2UpOnRoaXMuYmIuY3JlYXRlTG9uZygwLDApfW9wc2V0SW1wb3J0KHQsbil7bGV0IHI9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gcj8obnx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5PcGVyYXRvclNldElkKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmIuX192ZWN0b3IodGhpcy5iYl9wb3MrcikrNCp0KSx0aGlzLmJiKTpudWxsfW9wc2V0SW1wb3J0TGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXByb2R1Y2VyTmFtZShlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDgpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfXByb2R1Y2VyVmVyc2lvbihlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDEwKTtyZXR1cm4gdD90aGlzLmJiLl9fc3RyaW5nKHRoaXMuYmJfcG9zK3QsZSk6bnVsbH1kb21haW4oZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxMik7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9bW9kZWxWZXJzaW9uKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywxNCk7cmV0dXJuIGU/dGhpcy5iYi5yZWFkSW50NjQodGhpcy5iYl9wb3MrZSk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9ZG9jU3RyaW5nKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTYpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfWdyYXBoKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsMTgpO3JldHVybiBuPyh0fHxuZXcgZS5leHBlcmltZW50YWwuZmJzLkdyYXBoKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9Z3JhcGhEb2NTdHJpbmcoZSl7bGV0IHQ9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3BvcywyMCk7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9c3RhdGljIHN0YXJ0TW9kZWwoZSl7ZS5zdGFydE9iamVjdCg5KTt9c3RhdGljIGFkZElyVmVyc2lvbihlLHQpe2UuYWRkRmllbGRJbnQ2NCgwLHQsZS5jcmVhdGVMb25nKDAsMCkpO31zdGF0aWMgYWRkT3BzZXRJbXBvcnQoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDEsdCwwKTt9c3RhdGljIGNyZWF0ZU9wc2V0SW1wb3J0VmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQubGVuZ3RoLDQpO2ZvcihsZXQgbj10Lmxlbmd0aC0xO24+PTA7bi0tKWUuYWRkT2Zmc2V0KHRbbl0pO3JldHVybiBlLmVuZFZlY3RvcigpfXN0YXRpYyBzdGFydE9wc2V0SW1wb3J0VmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBhZGRQcm9kdWNlck5hbWUoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDIsdCwwKTt9c3RhdGljIGFkZFByb2R1Y2VyVmVyc2lvbihlLHQpe2UuYWRkRmllbGRPZmZzZXQoMyx0LDApO31zdGF0aWMgYWRkRG9tYWluKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg0LHQsMCk7fXN0YXRpYyBhZGRNb2RlbFZlcnNpb24oZSx0KXtlLmFkZEZpZWxkSW50NjQoNSx0LGUuY3JlYXRlTG9uZygwLDApKTt9c3RhdGljIGFkZERvY1N0cmluZyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoNix0LDApO31zdGF0aWMgYWRkR3JhcGgoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDcsdCwwKTt9c3RhdGljIGFkZEdyYXBoRG9jU3RyaW5nKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCg4LHQsMCk7fXN0YXRpYyBlbmRNb2RlbChlKXtyZXR1cm4gZS5lbmRPYmplY3QoKX1zdGF0aWMgY3JlYXRlTW9kZWwoZSx0LHIsbyxpLHMsYSx1LGwsYyl7cmV0dXJuIG4uc3RhcnRNb2RlbChlKSxuLmFkZElyVmVyc2lvbihlLHQpLG4uYWRkT3BzZXRJbXBvcnQoZSxyKSxuLmFkZFByb2R1Y2VyTmFtZShlLG8pLG4uYWRkUHJvZHVjZXJWZXJzaW9uKGUsaSksbi5hZGREb21haW4oZSxzKSxuLmFkZE1vZGVsVmVyc2lvbihlLGEpLG4uYWRkRG9jU3RyaW5nKGUsdSksbi5hZGRHcmFwaChlLGwpLG4uYWRkR3JhcGhEb2NTdHJpbmcoZSxjKSxuLmVuZE1vZGVsKGUpfX10Lk1vZGVsPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbihlKXshZnVuY3Rpb24oZSl7Y2xhc3MgdHtjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzS2VybmVsQ3JlYXRlSW5mb3MoZSxuKXtyZXR1cm4gKG58fG5ldyB0KS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc0tlcm5lbENyZWF0ZUluZm9zKGUsbil7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwobnx8bmV3IHQpLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1ub2RlSW5kaWNlcyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIucmVhZFVpbnQzMih0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3QpKzQqZSk6MH1ub2RlSW5kaWNlc0xlbmd0aCgpe2xldCBlPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIGU/dGhpcy5iYi5fX3ZlY3Rvcl9sZW4odGhpcy5iYl9wb3MrZSk6MH1ub2RlSW5kaWNlc0FycmF5KCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gZT9uZXcgVWludDMyQXJyYXkodGhpcy5iYi5ieXRlcygpLmJ1ZmZlcix0aGlzLmJiLmJ5dGVzKCkuYnl0ZU9mZnNldCt0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK2UpLHRoaXMuYmIuX192ZWN0b3JfbGVuKHRoaXMuYmJfcG9zK2UpKTpudWxsfWtlcm5lbERlZkhhc2hlcyhlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDYpO3JldHVybiB0P3RoaXMuYmIucmVhZFVpbnQ2NCh0aGlzLmJiLl9fdmVjdG9yKHRoaXMuYmJfcG9zK3QpKzgqZSk6dGhpcy5iYi5jcmVhdGVMb25nKDAsMCl9a2VybmVsRGVmSGFzaGVzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXN0YXRpYyBzdGFydEtlcm5lbENyZWF0ZUluZm9zKGUpe2Uuc3RhcnRPYmplY3QoMik7fXN0YXRpYyBhZGROb2RlSW5kaWNlcyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgY3JlYXRlTm9kZUluZGljZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRJbnQzMih0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnROb2RlSW5kaWNlc1ZlY3RvcihlLHQpe2Uuc3RhcnRWZWN0b3IoNCx0LDQpO31zdGF0aWMgYWRkS2VybmVsRGVmSGFzaGVzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBjcmVhdGVLZXJuZWxEZWZIYXNoZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDgsdC5sZW5ndGgsOCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRJbnQ2NCh0W25dKTtyZXR1cm4gZS5lbmRWZWN0b3IoKX1zdGF0aWMgc3RhcnRLZXJuZWxEZWZIYXNoZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDgsdCw4KTt9c3RhdGljIGVuZEtlcm5lbENyZWF0ZUluZm9zKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBjcmVhdGVLZXJuZWxDcmVhdGVJbmZvcyhlLG4scil7cmV0dXJuIHQuc3RhcnRLZXJuZWxDcmVhdGVJbmZvcyhlKSx0LmFkZE5vZGVJbmRpY2VzKGUsbiksdC5hZGRLZXJuZWxEZWZIYXNoZXMoZSxyKSx0LmVuZEtlcm5lbENyZWF0ZUluZm9zKGUpfX1lLktlcm5lbENyZWF0ZUluZm9zPXQ7fShlLmZic3x8KGUuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzU3ViR3JhcGhTZXNzaW9uU3RhdGUoZSx0KXtyZXR1cm4gKHR8fG5ldyBuKS5fX2luaXQoZS5yZWFkSW50MzIoZS5wb3NpdGlvbigpKStlLnBvc2l0aW9uKCksZSl9c3RhdGljIGdldFNpemVQcmVmaXhlZFJvb3RBc1N1YkdyYXBoU2Vzc2lvblN0YXRlKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1ncmFwaElkKGUpe2xldCB0PXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNCk7cmV0dXJuIHQ/dGhpcy5iYi5fX3N0cmluZyh0aGlzLmJiX3Bvcyt0LGUpOm51bGx9c2Vzc2lvblN0YXRlKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuU2Vzc2lvblN0YXRlKS5fX2luaXQodGhpcy5iYi5fX2luZGlyZWN0KHRoaXMuYmJfcG9zK24pLHRoaXMuYmIpOm51bGx9c3RhdGljIHN0YXJ0U3ViR3JhcGhTZXNzaW9uU3RhdGUoZSl7ZS5zdGFydE9iamVjdCgyKTt9c3RhdGljIGFkZEdyYXBoSWQoZSx0KXtlLmFkZEZpZWxkT2Zmc2V0KDAsdCwwKTt9c3RhdGljIGFkZFNlc3Npb25TdGF0ZShlLHQpe2UuYWRkRmllbGRPZmZzZXQoMSx0LDApO31zdGF0aWMgZW5kU3ViR3JhcGhTZXNzaW9uU3RhdGUoZSl7bGV0IHQ9ZS5lbmRPYmplY3QoKTtyZXR1cm4gZS5yZXF1aXJlZEZpZWxkKHQsNCksdH1zdGF0aWMgY3JlYXRlU3ViR3JhcGhTZXNzaW9uU3RhdGUoZSx0LHIpe3JldHVybiBuLnN0YXJ0U3ViR3JhcGhTZXNzaW9uU3RhdGUoZSksbi5hZGRHcmFwaElkKGUsdCksbi5hZGRTZXNzaW9uU3RhdGUoZSxyKSxuLmVuZFN1YkdyYXBoU2Vzc2lvblN0YXRlKGUpfX10LlN1YkdyYXBoU2Vzc2lvblN0YXRlPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpLGZ1bmN0aW9uKGUpeyFmdW5jdGlvbih0KXshZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcigpe3RoaXMuYmI9bnVsbCx0aGlzLmJiX3Bvcz0wO31fX2luaXQoZSx0KXtyZXR1cm4gdGhpcy5iYl9wb3M9ZSx0aGlzLmJiPXQsdGhpc31zdGF0aWMgZ2V0Um9vdEFzU2Vzc2lvblN0YXRlKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNTZXNzaW9uU3RhdGUoZSx0KXtyZXR1cm4gZS5zZXRQb3NpdGlvbihlLnBvc2l0aW9uKCkrci5mbGF0YnVmZmVycy5TSVpFX1BSRUZJWF9MRU5HVEgpLCh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfWtlcm5lbHModCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw0KTtyZXR1cm4gbj8odHx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5LZXJuZWxDcmVhdGVJbmZvcykuX19pbml0KHRoaXMuYmIuX19pbmRpcmVjdCh0aGlzLmJiX3BvcytuKSx0aGlzLmJiKTpudWxsfXN1YkdyYXBoU2Vzc2lvblN0YXRlcyh0LG4pe2xldCByPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIHI/KG58fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuU3ViR3JhcGhTZXNzaW9uU3RhdGUpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYi5fX3ZlY3Rvcih0aGlzLmJiX3BvcytyKSs0KnQpLHRoaXMuYmIpOm51bGx9c3ViR3JhcGhTZXNzaW9uU3RhdGVzTGVuZ3RoKCl7bGV0IGU9dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw2KTtyZXR1cm4gZT90aGlzLmJiLl9fdmVjdG9yX2xlbih0aGlzLmJiX3BvcytlKTowfXN0YXRpYyBzdGFydFNlc3Npb25TdGF0ZShlKXtlLnN0YXJ0T2JqZWN0KDIpO31zdGF0aWMgYWRkS2VybmVscyhlLHQpe2UuYWRkRmllbGRPZmZzZXQoMCx0LDApO31zdGF0aWMgYWRkU3ViR3JhcGhTZXNzaW9uU3RhdGVzKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgxLHQsMCk7fXN0YXRpYyBjcmVhdGVTdWJHcmFwaFNlc3Npb25TdGF0ZXNWZWN0b3IoZSx0KXtlLnN0YXJ0VmVjdG9yKDQsdC5sZW5ndGgsNCk7Zm9yKGxldCBuPXQubGVuZ3RoLTE7bj49MDtuLS0pZS5hZGRPZmZzZXQodFtuXSk7cmV0dXJuIGUuZW5kVmVjdG9yKCl9c3RhdGljIHN0YXJ0U3ViR3JhcGhTZXNzaW9uU3RhdGVzVmVjdG9yKGUsdCl7ZS5zdGFydFZlY3Rvcig0LHQsNCk7fXN0YXRpYyBlbmRTZXNzaW9uU3RhdGUoZSl7cmV0dXJuIGUuZW5kT2JqZWN0KCl9c3RhdGljIGNyZWF0ZVNlc3Npb25TdGF0ZShlLHQscil7cmV0dXJuIG4uc3RhcnRTZXNzaW9uU3RhdGUoZSksbi5hZGRLZXJuZWxzKGUsdCksbi5hZGRTdWJHcmFwaFNlc3Npb25TdGF0ZXMoZSxyKSxuLmVuZFNlc3Npb25TdGF0ZShlKX19dC5TZXNzaW9uU3RhdGU9bjt9KHQuZmJzfHwodC5mYnM9e30pKTt9KGUuZXhwZXJpbWVudGFsfHwoZS5leHBlcmltZW50YWw9e30pKTt9KHQub25ueHJ1bnRpbWV8fCh0Lm9ubnhydW50aW1lPXt9KSksZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXtjbGFzcyBue2NvbnN0cnVjdG9yKCl7dGhpcy5iYj1udWxsLHRoaXMuYmJfcG9zPTA7fV9faW5pdChlLHQpe3JldHVybiB0aGlzLmJiX3Bvcz1lLHRoaXMuYmI9dCx0aGlzfXN0YXRpYyBnZXRSb290QXNJbmZlcmVuY2VTZXNzaW9uKGUsdCl7cmV0dXJuICh0fHxuZXcgbikuX19pbml0KGUucmVhZEludDMyKGUucG9zaXRpb24oKSkrZS5wb3NpdGlvbigpLGUpfXN0YXRpYyBnZXRTaXplUHJlZml4ZWRSb290QXNJbmZlcmVuY2VTZXNzaW9uKGUsdCl7cmV0dXJuIGUuc2V0UG9zaXRpb24oZS5wb3NpdGlvbigpK3IuZmxhdGJ1ZmZlcnMuU0laRV9QUkVGSVhfTEVOR1RIKSwodHx8bmV3IG4pLl9faW5pdChlLnJlYWRJbnQzMihlLnBvc2l0aW9uKCkpK2UucG9zaXRpb24oKSxlKX1zdGF0aWMgYnVmZmVySGFzSWRlbnRpZmllcihlKXtyZXR1cm4gZS5fX2hhc19pZGVudGlmaWVyKCJPUlRNIil9b3J0VmVyc2lvbihlKXtsZXQgdD10aGlzLmJiLl9fb2Zmc2V0KHRoaXMuYmJfcG9zLDQpO3JldHVybiB0P3RoaXMuYmIuX19zdHJpbmcodGhpcy5iYl9wb3MrdCxlKTpudWxsfW1vZGVsKHQpe2xldCBuPXRoaXMuYmIuX19vZmZzZXQodGhpcy5iYl9wb3MsNik7cmV0dXJuIG4/KHR8fG5ldyBlLmV4cGVyaW1lbnRhbC5mYnMuTW9kZWwpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYl9wb3MrbiksdGhpcy5iYik6bnVsbH1zZXNzaW9uU3RhdGUodCl7bGV0IG49dGhpcy5iYi5fX29mZnNldCh0aGlzLmJiX3Bvcyw4KTtyZXR1cm4gbj8odHx8bmV3IGUuZXhwZXJpbWVudGFsLmZicy5TZXNzaW9uU3RhdGUpLl9faW5pdCh0aGlzLmJiLl9faW5kaXJlY3QodGhpcy5iYl9wb3MrbiksdGhpcy5iYik6bnVsbH1zdGF0aWMgc3RhcnRJbmZlcmVuY2VTZXNzaW9uKGUpe2Uuc3RhcnRPYmplY3QoMyk7fXN0YXRpYyBhZGRPcnRWZXJzaW9uKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgwLHQsMCk7fXN0YXRpYyBhZGRNb2RlbChlLHQpe2UuYWRkRmllbGRPZmZzZXQoMSx0LDApO31zdGF0aWMgYWRkU2Vzc2lvblN0YXRlKGUsdCl7ZS5hZGRGaWVsZE9mZnNldCgyLHQsMCk7fXN0YXRpYyBlbmRJbmZlcmVuY2VTZXNzaW9uKGUpe3JldHVybiBlLmVuZE9iamVjdCgpfXN0YXRpYyBmaW5pc2hJbmZlcmVuY2VTZXNzaW9uQnVmZmVyKGUsdCl7ZS5maW5pc2godCwiT1JUTSIpO31zdGF0aWMgZmluaXNoU2l6ZVByZWZpeGVkSW5mZXJlbmNlU2Vzc2lvbkJ1ZmZlcihlLHQpe2UuZmluaXNoKHQsIk9SVE0iLCEwKTt9c3RhdGljIGNyZWF0ZUluZmVyZW5jZVNlc3Npb24oZSx0LHIsbyl7cmV0dXJuIG4uc3RhcnRJbmZlcmVuY2VTZXNzaW9uKGUpLG4uYWRkT3J0VmVyc2lvbihlLHQpLG4uYWRkTW9kZWwoZSxyKSxuLmFkZFNlc3Npb25TdGF0ZShlLG8pLG4uZW5kSW5mZXJlbmNlU2Vzc2lvbihlKX19dC5JbmZlcmVuY2VTZXNzaW9uPW47fSh0LmZic3x8KHQuZmJzPXt9KSk7fShlLmV4cGVyaW1lbnRhbHx8KGUuZXhwZXJpbWVudGFsPXt9KSk7fSh0Lm9ubnhydW50aW1lfHwodC5vbm54cnVudGltZT17fSkpO30sMTcyMzooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuT25ueGpzU2Vzc2lvbkhhbmRsZXI9dm9pZCAwO2NvbnN0IHI9bigyMjM1KSxvPW4oOTI0MCk7dC5Pbm54anNTZXNzaW9uSGFuZGxlcj1jbGFzc3tjb25zdHJ1Y3RvcihlKXt0aGlzLnNlc3Npb249ZSx0aGlzLmlucHV0TmFtZXM9dGhpcy5zZXNzaW9uLmlucHV0TmFtZXMsdGhpcy5vdXRwdXROYW1lcz10aGlzLnNlc3Npb24ub3V0cHV0TmFtZXM7fWFzeW5jIGRpc3Bvc2UoKXt9YXN5bmMgcnVuKGUsdCxuKXtjb25zdCBpPW5ldyBNYXA7Zm9yKGNvbnN0IHQgaW4gZSlpZihPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpKXtjb25zdCBuPWVbdF07aS5zZXQodCxuZXcgby5UZW5zb3Iobi5kaW1zLG4udHlwZSx2b2lkIDAsdm9pZCAwLG4uZGF0YSkpO31jb25zdCBzPWF3YWl0IHRoaXMuc2Vzc2lvbi5ydW4oaSksYT17fTtyZXR1cm4gcy5mb3JFYWNoKCgoZSx0KT0+e2FbdF09bmV3IHIuVGVuc29yKGUudHlwZSxlLmRhdGEsZS5kaW1zKTt9KSksYX1zdGFydFByb2ZpbGluZygpe3RoaXMuc2Vzc2lvbi5zdGFydFByb2ZpbGluZygpO31lbmRQcm9maWxpbmcoKXt0aGlzLnNlc3Npb24uZW5kUHJvZmlsaW5nKCk7fX07fSw2MDI3OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5TZXNzaW9uPXZvaWQgMDtjb25zdCByPW4oNzA2Nyksbz1uKDEyOTYpLGk9bigxOTc1KSxzPW4oNjQ5NiksYT1uKDEzMTUpLHU9bigxNzQ1KTt0LlNlc3Npb249Y2xhc3N7Y29uc3RydWN0b3IoZT17fSl7dGhpcy5faW5pdGlhbGl6ZWQ9ITEsdGhpcy5iYWNrZW5kSGludD1lLmJhY2tlbmRIaW50LHRoaXMucHJvZmlsZXI9YS5Qcm9maWxlci5jcmVhdGUoZS5wcm9maWxlciksdGhpcy5jb250ZXh0PXtwcm9maWxlcjp0aGlzLnByb2ZpbGVyLGdyYXBoSW5wdXRUeXBlczpbXSxncmFwaElucHV0RGltczpbXX07fWdldCBpbnB1dE5hbWVzKCl7cmV0dXJuIHRoaXMuX21vZGVsLmdyYXBoLmdldElucHV0TmFtZXMoKX1nZXQgb3V0cHV0TmFtZXMoKXtyZXR1cm4gdGhpcy5fbW9kZWwuZ3JhcGguZ2V0T3V0cHV0TmFtZXMoKX1zdGFydFByb2ZpbGluZygpe3RoaXMucHJvZmlsZXIuc3RhcnQoKTt9ZW5kUHJvZmlsaW5nKCl7dGhpcy5wcm9maWxlci5zdG9wKCk7fWFzeW5jIGxvYWRNb2RlbChlLHQsbil7YXdhaXQgdGhpcy5wcm9maWxlci5ldmVudCgic2Vzc2lvbiIsIlNlc3Npb24ubG9hZE1vZGVsIiwoYXN5bmMoKT0+e2NvbnN0IHM9YXdhaXQoMCwgaS5yZXNvbHZlQmFja2VuZCkodGhpcy5iYWNrZW5kSGludCk7aWYodGhpcy5zZXNzaW9uSGFuZGxlcj1zLmNyZWF0ZVNlc3Npb25IYW5kbGVyKHRoaXMuY29udGV4dCksdGhpcy5fbW9kZWw9bmV3IHUuTW9kZWwsInN0cmluZyI9PXR5cGVvZiBlKXtjb25zdCB0PWUuZW5kc1dpdGgoIi5vcnQiKTtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHByb2Nlc3MmJnByb2Nlc3MudmVyc2lvbnMmJnByb2Nlc3MudmVyc2lvbnMubm9kZSl7Y29uc3Qgbj1hd2FpdCgwLCBvLnByb21pc2lmeSkoci5yZWFkRmlsZSkoZSk7dGhpcy5pbml0aWFsaXplKG4sdCk7fWVsc2Uge2NvbnN0IG49YXdhaXQgZmV0Y2goZSkscj1hd2FpdCBuLmFycmF5QnVmZmVyKCk7dGhpcy5pbml0aWFsaXplKG5ldyBVaW50OEFycmF5KHIpLHQpO319ZWxzZSBpZihBcnJheUJ1ZmZlci5pc1ZpZXcoZSkpdGhpcy5pbml0aWFsaXplKGUpO2Vsc2Uge2NvbnN0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0fHwwLG58fGUuYnl0ZUxlbmd0aCk7dGhpcy5pbml0aWFsaXplKHIpO319KSk7fWluaXRpYWxpemUoZSx0KXtpZih0aGlzLl9pbml0aWFsaXplZCl0aHJvdyBuZXcgRXJyb3IoImFscmVhZHkgaW5pdGlhbGl6ZWQiKTt0aGlzLnByb2ZpbGVyLmV2ZW50KCJzZXNzaW9uIiwiU2Vzc2lvbi5pbml0aWFsaXplIiwoKCk9Pntjb25zdCBuPXRoaXMuc2Vzc2lvbkhhbmRsZXIudHJhbnNmb3JtR3JhcGg/dGhpcy5zZXNzaW9uSGFuZGxlcjp2b2lkIDA7dGhpcy5fbW9kZWwubG9hZChlLG4sdCksdGhpcy5zZXNzaW9uSGFuZGxlci5vbkdyYXBoSW5pdGlhbGl6ZWQmJnRoaXMuc2Vzc2lvbkhhbmRsZXIub25HcmFwaEluaXRpYWxpemVkKHRoaXMuX21vZGVsLmdyYXBoKSx0aGlzLmluaXRpYWxpemVPcHModGhpcy5fbW9kZWwuZ3JhcGgpLHRoaXMuX2V4ZWN1dGlvblBsYW49bmV3IHMuRXhlY3V0aW9uUGxhbih0aGlzLl9tb2RlbC5ncmFwaCx0aGlzLl9vcHMsdGhpcy5wcm9maWxlcik7fSkpLHRoaXMuX2luaXRpYWxpemVkPSEwO31hc3luYyBydW4oZSl7aWYoIXRoaXMuX2luaXRpYWxpemVkKXRocm93IG5ldyBFcnJvcigic2Vzc2lvbiBub3QgaW5pdGlhbGl6ZWQgeWV0Iik7cmV0dXJuIHRoaXMucHJvZmlsZXIuZXZlbnQoInNlc3Npb24iLCJTZXNzaW9uLnJ1biIsKGFzeW5jKCk9Pntjb25zdCB0PXRoaXMubm9ybWFsaXplQW5kVmFsaWRhdGVJbnB1dHMoZSksbj1hd2FpdCB0aGlzLl9leGVjdXRpb25QbGFuLmV4ZWN1dGUodGhpcy5zZXNzaW9uSGFuZGxlcix0KTtyZXR1cm4gdGhpcy5jcmVhdGVPdXRwdXQobil9KSl9bm9ybWFsaXplQW5kVmFsaWRhdGVJbnB1dHMoZSl7Y29uc3QgdD10aGlzLl9tb2RlbC5ncmFwaC5nZXRJbnB1dE5hbWVzKCk7aWYoQXJyYXkuaXNBcnJheShlKSl7aWYoZS5sZW5ndGghPT10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoYGluY29ycmVjdCBpbnB1dCBhcnJheSBsZW5ndGg6IGV4cGVjdGVkICR7dC5sZW5ndGh9IGJ1dCBnb3QgJHtlLmxlbmd0aH1gKX1lbHNlIHtpZihlLnNpemUhPT10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoYGluY29ycmVjdCBpbnB1dCBtYXAgc2l6ZTogZXhwZWN0ZWQgJHt0Lmxlbmd0aH0gYnV0IGdvdCAke2Uuc2l6ZX1gKTtjb25zdCBuPW5ldyBBcnJheShlLnNpemUpO2xldCByPTA7Zm9yKGxldCBvPTA7bzx0Lmxlbmd0aDsrK28pe2NvbnN0IGk9ZS5nZXQodFtvXSk7aWYoIWkpdGhyb3cgbmV3IEVycm9yKGBtaXNzaW5nIGlucHV0IHRlbnNvciBmb3I6ICcke25hbWV9J2ApO25bcisrXT1pO31lPW47fWlmKHRoaXMuY29udGV4dC5ncmFwaElucHV0VHlwZXMmJjAhPT10aGlzLmNvbnRleHQuZ3JhcGhJbnB1dFR5cGVzLmxlbmd0aCYmdGhpcy5jb250ZXh0LmdyYXBoSW5wdXREaW1zJiYwIT09dGhpcy5jb250ZXh0LmdyYXBoSW5wdXREaW1zLmxlbmd0aCl0aGlzLnZhbGlkYXRlSW5wdXRUZW5zb3JEaW1zKHRoaXMuY29udGV4dC5ncmFwaElucHV0RGltcyxlLCExKTtlbHNlIHtjb25zdCB0PXRoaXMuX21vZGVsLmdyYXBoLmdldElucHV0SW5kaWNlcygpLG49dGhpcy5fbW9kZWwuZ3JhcGguZ2V0VmFsdWVzKCkscj1uZXcgQXJyYXkodC5sZW5ndGgpO2ZvcihsZXQgbz0wO288dC5sZW5ndGg7KytvKXtjb25zdCBpPW5bdFtvXV07cltvXT1pLnR5cGUuc2hhcGUuZGltcyx0aGlzLmNvbnRleHQuZ3JhcGhJbnB1dFR5cGVzLnB1c2goaS50eXBlLnRlbnNvclR5cGUpLHRoaXMuY29udGV4dC5ncmFwaElucHV0RGltcy5wdXNoKGVbb10uZGltcyk7fXRoaXMudmFsaWRhdGVJbnB1dFRlbnNvckRpbXMocixlLCEwKTt9cmV0dXJuIHRoaXMudmFsaWRhdGVJbnB1dFRlbnNvclR5cGVzKHRoaXMuY29udGV4dC5ncmFwaElucHV0VHlwZXMsZSksZX12YWxpZGF0ZUlucHV0VGVuc29yVHlwZXMoZSx0KXtmb3IobGV0IG49MDtuPHQubGVuZ3RoO24rKyl7Y29uc3Qgcj1lW25dLG89dFtuXS50eXBlO2lmKHIhPT1vKXRocm93IG5ldyBFcnJvcihgaW5wdXQgdGVuc29yWyR7bn1dIGNoZWNrIGZhaWxlZDogZXhwZWN0ZWQgdHlwZSAnJHtyfScgYnV0IGdvdCAke299YCl9fXZhbGlkYXRlSW5wdXRUZW5zb3JEaW1zKGUsdCxuKXtmb3IobGV0IHI9MDtyPHQubGVuZ3RoO3IrKyl7Y29uc3Qgbz1lW3JdLGk9dFtyXS5kaW1zO2lmKCF0aGlzLmNvbXBhcmVUZW5zb3JEaW1zKG8saSxuKSl0aHJvdyBuZXcgRXJyb3IoYGlucHV0IHRlbnNvclske3J9XSBjaGVjayBmYWlsZWQ6IGV4cGVjdGVkIHNoYXBlICdbJHtvLmpvaW4oIiwiKX1dJyBidXQgZ290IFske2kuam9pbigiLCIpfV1gKX19Y29tcGFyZVRlbnNvckRpbXMoZSx0LG4pe2lmKGUubGVuZ3RoIT09dC5sZW5ndGgpcmV0dXJuICExO2ZvcihsZXQgcj0wO3I8ZS5sZW5ndGg7KytyKWlmKGVbcl0hPT10W3JdJiYoIW58fDAhPT1lW3JdKSlyZXR1cm4gITE7cmV0dXJuICEwfWNyZWF0ZU91dHB1dChlKXtjb25zdCB0PXRoaXMuX21vZGVsLmdyYXBoLmdldE91dHB1dE5hbWVzKCk7aWYoZS5sZW5ndGghPT10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImV4cGVjdGVkIG51bWJlciBvZiBvdXRwdXRzIGRvIG5vdCBtYXRjaCBudW1iZXIgb2YgZ2VuZXJhdGVkIG91dHB1dHMiKTtjb25zdCBuPW5ldyBNYXA7Zm9yKGxldCByPTA7cjx0Lmxlbmd0aDsrK3Ipbi5zZXQodFtyXSxlW3JdKTtyZXR1cm4gbn1pbml0aWFsaXplT3BzKGUpe2NvbnN0IHQ9ZS5nZXROb2RlcygpO3RoaXMuX29wcz1uZXcgQXJyYXkodC5sZW5ndGgpO2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKXRoaXMuX29wc1tuXT10aGlzLnNlc3Npb25IYW5kbGVyLnJlc29sdmUodFtuXSx0aGlzLl9tb2RlbC5vcHNldHMsZSk7fX07fSw5MjQwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5UZW5zb3I9dm9pZCAwO2NvbnN0IG89bigzNDQyKSxpPXIobigxNTgzKSkscz1uKDUxMjcpLGE9bigyNDQ2KSx1PW4oNzI3Myk7dmFyIGw9cy5vbm54cnVudGltZS5leHBlcmltZW50YWwuZmJzO2NsYXNzIGN7Z2V0IGRhdGEoKXtpZih2b2lkIDA9PT10aGlzLmNhY2hlKXtjb25zdCBlPXRoaXMuZGF0YVByb3ZpZGVyKHRoaXMuZGF0YUlkKTtpZihlLmxlbmd0aCE9PXRoaXMuc2l6ZSl0aHJvdyBuZXcgRXJyb3IoIkxlbmd0aCBvZiBkYXRhIHByb3ZpZGVkIGJ5IHRoZSBEYXRhIFByb3ZpZGVyIGlzIGluY29uc2lzdGVudCB3aXRoIHRoZSBkaW1zIG9mIHRoaXMgVGVuc29yLiIpO3RoaXMuY2FjaGU9ZTt9cmV0dXJuIHRoaXMuY2FjaGV9Z2V0IHN0cmluZ0RhdGEoKXtpZigic3RyaW5nIiE9PXRoaXMudHlwZSl0aHJvdyBuZXcgVHlwZUVycm9yKCJkYXRhIHR5cGUgaXMgbm90IHN0cmluZyIpO3JldHVybiB0aGlzLmRhdGF9Z2V0IGludGVnZXJEYXRhKCl7c3dpdGNoKHRoaXMudHlwZSl7Y2FzZSJ1aW50OCI6Y2FzZSJpbnQ4IjpjYXNlInVpbnQxNiI6Y2FzZSJpbnQxNiI6Y2FzZSJpbnQzMiI6Y2FzZSJ1aW50MzIiOmNhc2UiYm9vbCI6cmV0dXJuIHRoaXMuZGF0YTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoImRhdGEgdHlwZSBpcyBub3QgaW50ZWdlciAodWludDgsIGludDgsIHVpbnQxNiwgaW50MTYsIGludDMyLCB1aW50MzIsIGJvb2wpIil9fWdldCBmbG9hdERhdGEoKXtzd2l0Y2godGhpcy50eXBlKXtjYXNlImZsb2F0MzIiOmNhc2UiZmxvYXQ2NCI6cmV0dXJuIHRoaXMuZGF0YTtkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoImRhdGEgdHlwZSBpcyBub3QgZmxvYXQgKGZsb2F0MzIsIGZsb2F0NjQpIil9fWdldCBudW1iZXJEYXRhKCl7aWYoInN0cmluZyIhPT10aGlzLnR5cGUpcmV0dXJuIHRoaXMuZGF0YTt0aHJvdyBuZXcgVHlwZUVycm9yKCJ0eXBlIGNhbm5vdCBiZSBub24tbnVtYmVyIChzdHJpbmcpIil9Z2V0KGUpe3JldHVybiB0aGlzLmRhdGFbdS5TaGFwZVV0aWwuaW5kaWNlc1RvT2Zmc2V0KGUsdGhpcy5zdHJpZGVzKV19c2V0KGUsdCl7dGhpcy5kYXRhW3UuU2hhcGVVdGlsLmluZGljZXNUb09mZnNldChlLHRoaXMuc3RyaWRlcyldPXQ7fWFzeW5jIGdldERhdGEoKXtyZXR1cm4gdm9pZCAwPT09dGhpcy5jYWNoZSYmKHRoaXMuY2FjaGU9YXdhaXQgdGhpcy5hc3luY0RhdGFQcm92aWRlcih0aGlzLmRhdGFJZCkpLHRoaXMuY2FjaGV9Z2V0IHN0cmlkZXMoKXtyZXR1cm4gdGhpcy5fc3RyaWRlc3x8KHRoaXMuX3N0cmlkZXM9dS5TaGFwZVV0aWwuY29tcHV0ZVN0cmlkZXModGhpcy5kaW1zKSksdGhpcy5fc3RyaWRlc31jb25zdHJ1Y3RvcihlLHQsbixyLGkscz1vLkd1aWQuY3JlYXRlKCkpe3RoaXMuZGltcz1lLHRoaXMudHlwZT10LHRoaXMuZGF0YVByb3ZpZGVyPW4sdGhpcy5hc3luY0RhdGFQcm92aWRlcj1yLHRoaXMuY2FjaGU9aSx0aGlzLmRhdGFJZD1zLHRoaXMuc2l6ZT11LlNoYXBlVXRpbC52YWxpZGF0ZURpbXNBbmRDYWxjU2l6ZShlKTtjb25zdCBhPXRoaXMuc2l6ZSxsPXZvaWQgMD09PW4mJnZvaWQgMD09PXImJnZvaWQgMD09PWk7aWYodm9pZCAwIT09aSYmaS5sZW5ndGghPT1hKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbnB1dCBkaW1zIGRvZXNuJ3QgbWF0Y2ggZGF0YSBsZW5ndGguIik7aWYoInN0cmluZyI9PT10KXtpZighKHZvaWQgMD09PWl8fEFycmF5LmlzQXJyYXkoaSkmJmkuZXZlcnkoKGU9PiJzdHJpbmciPT10eXBlb2YgZSkpKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJjYWNoZSBzaG91bGQgYmUgYSBzdHJpbmcgYXJyYXkiKTtsJiYodGhpcy5jYWNoZT1uZXcgQXJyYXkoYSkpO31lbHNlIHtpZih2b2lkIDAhPT1pKXtjb25zdCBlPWQodCk7aWYoIShpIGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihgY2FjaGUgc2hvdWxkIGJlIHR5cGUgJHtlLm5hbWV9YCl9aWYobCl7Y29uc3QgZT1uZXcgQXJyYXlCdWZmZXIoYSpmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSJib29sIjpjYXNlImludDgiOmNhc2UidWludDgiOnJldHVybiAxO2Nhc2UiaW50MTYiOmNhc2UidWludDE2IjpyZXR1cm4gMjtjYXNlImludDMyIjpjYXNlInVpbnQzMiI6Y2FzZSJmbG9hdDMyIjpyZXR1cm4gNDtjYXNlImZsb2F0NjQiOnJldHVybiA4O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBjYW5ub3QgY2FsY3VsYXRlIHNpemVvZigpIG9uIHR5cGUgJHtlfWApfX0odCkpO3RoaXMuY2FjaGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbmV3KGQodCkpKGUpfShlLHQpO319fXN0YXRpYyBmcm9tUHJvdG8oZSl7aWYoIWUpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgY29uc3RydWN0IFZhbHVlIGZyb20gYW4gZW1wdHkgdGVuc29yIik7Y29uc3QgdD11LlByb3RvVXRpbC50ZW5zb3JEYXRhVHlwZUZyb21Qcm90byhlLmRhdGFUeXBlKSxuPXUuUHJvdG9VdGlsLnRlbnNvckRpbXNGcm9tUHJvdG8oZS5kaW1zKSxyPW5ldyBjKG4sdCk7aWYoInN0cmluZyI9PT10KWUuc3RyaW5nRGF0YS5mb3JFYWNoKCgoZSx0KT0+e3IuZGF0YVt0XT0oMCwgdS5kZWNvZGVVdGY4U3RyaW5nKShlKTt9KSk7ZWxzZSBpZihlLnJhd0RhdGEmJiJudW1iZXIiPT10eXBlb2YgZS5yYXdEYXRhLmJ5dGVMZW5ndGgmJmUucmF3RGF0YS5ieXRlTGVuZ3RoPjApe2NvbnN0IHQ9ci5kYXRhLG49bmV3IERhdGFWaWV3KGUucmF3RGF0YS5idWZmZXIsZS5yYXdEYXRhLmJ5dGVPZmZzZXQsZS5yYXdEYXRhLmJ5dGVMZW5ndGgpLG89cChlLmRhdGFUeXBlKSxpPWUucmF3RGF0YS5ieXRlTGVuZ3RoL287aWYoZS5yYXdEYXRhLmJ5dGVMZW5ndGglbyE9MCl0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgYnVmZmVyIGxlbmd0aCIpO2lmKHQubGVuZ3RoIT09aSl0aHJvdyBuZXcgRXJyb3IoImJ1ZmZlciBsZW5ndGggbWlzbWF0Y2giKTtmb3IobGV0IHI9MDtyPGk7cisrKXtjb25zdCBpPWgobixlLmRhdGFUeXBlLHIqbyk7dFtyXT1pO319ZWxzZSB7bGV0IHQ7c3dpdGNoKGUuZGF0YVR5cGUpe2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkZMT0FUOnQ9ZS5mbG9hdERhdGE7YnJlYWs7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuSU5UMzI6Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuSU5UMTY6Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDE2OmNhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDg6Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDg6Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuQk9PTDp0PWUuaW50MzJEYXRhO2JyZWFrO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDY0OnQ9ZS5pbnQ2NERhdGE7YnJlYWs7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuRE9VQkxFOnQ9ZS5kb3VibGVEYXRhO2JyZWFrO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLlVJTlQzMjpjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UNjQ6dD1lLnVpbnQ2NERhdGE7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInVuc3BlY2lmaWMgZXJyb3IiKX1pZihudWxsPT10KXRocm93IG5ldyBFcnJvcigiZmFpbGVkIHRvIHBvcHVsYXRlIGRhdGEgZnJvbSBhIHRlbnNvcnByb3RvIHZhbHVlIik7Y29uc3Qgbj1yLmRhdGE7aWYobi5sZW5ndGghPT10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImFycmF5IGxlbmd0aCBtaXNtYXRjaCIpO2ZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXtjb25zdCBvPXRbcl07aS5kZWZhdWx0LmlzTG9uZyhvKT9uW3JdPWYobyxlLmRhdGFUeXBlKTpuW3JdPW87fX1yZXR1cm4gcn1zdGF0aWMgZnJvbURhdGEoZSx0LG4pe3JldHVybiBuZXcgYyh0LG4sdm9pZCAwLHZvaWQgMCxlKX1zdGF0aWMgZnJvbU9ydFRlbnNvcihlKXtpZighZSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBjb25zdHJ1Y3QgVmFsdWUgZnJvbSBhbiBlbXB0eSB0ZW5zb3IiKTtjb25zdCB0PXUuUHJvdG9VdGlsLnRlbnNvckRpbXNGcm9tT1JURm9ybWF0KGUpLG49dS5Qcm90b1V0aWwudGVuc29yRGF0YVR5cGVGcm9tUHJvdG8oZS5kYXRhVHlwZSgpKSxyPW5ldyBjKHQsbik7aWYoInN0cmluZyI9PT1uKWZvcihsZXQgdD0wO3Q8ZS5zdHJpbmdEYXRhTGVuZ3RoKCk7dCsrKXIuZGF0YVt0XT1lLnN0cmluZ0RhdGEodCk7ZWxzZSBpZihlLnJhd0RhdGFBcnJheSgpJiYibnVtYmVyIj09dHlwZW9mIGUucmF3RGF0YUxlbmd0aCgpJiZlLnJhd0RhdGFMZW5ndGgoKT4wKXtjb25zdCB0PXIuZGF0YSxuPW5ldyBEYXRhVmlldyhlLnJhd0RhdGFBcnJheSgpLmJ1ZmZlcixlLnJhd0RhdGFBcnJheSgpLmJ5dGVPZmZzZXQsZS5yYXdEYXRhTGVuZ3RoKCkpLG89cChlLmRhdGFUeXBlKCkpLGk9ZS5yYXdEYXRhTGVuZ3RoKCkvbztpZihlLnJhd0RhdGFMZW5ndGgoKSVvIT0wKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBidWZmZXIgbGVuZ3RoIik7aWYodC5sZW5ndGghPT1pKXRocm93IG5ldyBFcnJvcigiYnVmZmVyIGxlbmd0aCBtaXNtYXRjaCIpO2ZvcihsZXQgcj0wO3I8aTtyKyspe2NvbnN0IGk9aChuLGUuZGF0YVR5cGUoKSxyKm8pO3Rbcl09aTt9fXJldHVybiByfX1mdW5jdGlvbiBwKGUpe3N3aXRjaChlKXtjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UODpjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ4OmNhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkJPT0w6cmV0dXJuIDE7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDE2OmNhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDE2OnJldHVybiAyO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkZMT0FUOmNhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDMyOmNhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLlVJTlQzMjpyZXR1cm4gNDtjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ2NDpjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5ET1VCTEU6Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDY0OnJldHVybiA4O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBjYW5ub3QgY2FsY3VsYXRlIHNpemVvZigpIG9uIHR5cGUgJHthLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGVbZV19YCl9fWZ1bmN0aW9uIGQoZSl7c3dpdGNoKGUpe2Nhc2UiYm9vbCI6Y2FzZSJ1aW50OCI6cmV0dXJuIFVpbnQ4QXJyYXk7Y2FzZSJpbnQ4IjpyZXR1cm4gSW50OEFycmF5O2Nhc2UiaW50MTYiOnJldHVybiBJbnQxNkFycmF5O2Nhc2UidWludDE2IjpyZXR1cm4gVWludDE2QXJyYXk7Y2FzZSJpbnQzMiI6cmV0dXJuIEludDMyQXJyYXk7Y2FzZSJ1aW50MzIiOnJldHVybiBVaW50MzJBcnJheTtjYXNlImludDY0IjpyZXR1cm4gQmlnSW50NjRBcnJheTtjYXNlImZsb2F0MzIiOnJldHVybiBGbG9hdDMyQXJyYXk7Y2FzZSJmbG9hdDY0IjpyZXR1cm4gRmxvYXQ2NEFycmF5O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJ1bnNwZWNpZmllZCBlcnJvciIpfX1mdW5jdGlvbiBmKGUsdCl7aWYodD09PWEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ2NHx8dD09PWwuVGVuc29yRGF0YVR5cGUuSU5UNjQpe2lmKGUuZ3JlYXRlclRoYW5PckVxdWFsKDIxNDc0ODM2NDgpfHxlLmxlc3NUaGFuKC0yMTQ3NDgzNjQ4KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnQ2NCBpcyBub3Qgc3VwcG9ydGVkIil9ZWxzZSB7aWYodCE9PWEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UMzImJnQhPT1sLlRlbnNvckRhdGFUeXBlLlVJTlQzMiYmdCE9PWEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UNjQmJnQhPT1sLlRlbnNvckRhdGFUeXBlLlVJTlQ2NCl0aHJvdyBuZXcgVHlwZUVycm9yKGBub3QgYSBMT05HIHR5cGU6ICR7YS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlW3RdfWApO2lmKGUuZ3JlYXRlclRoYW5PckVxdWFsKDQyOTQ5NjcyOTYpfHxlLmxlc3NUaGFuKDApKXRocm93IG5ldyBUeXBlRXJyb3IoInVpbnQ2NCBpcyBub3Qgc3VwcG9ydGVkIil9cmV0dXJuIGUudG9OdW1iZXIoKX1mdW5jdGlvbiBoKGUsdCxuKXtzd2l0Y2godCl7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuQk9PTDpjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UODpyZXR1cm4gZS5nZXRVaW50OChuKTtjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ4OnJldHVybiBlLmdldEludDgobik7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDE2OnJldHVybiBlLmdldFVpbnQxNihuLCEwKTtjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQxNjpyZXR1cm4gZS5nZXRJbnQxNihuLCEwKTtjYXNlIGEub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5GTE9BVDpyZXR1cm4gZS5nZXRGbG9hdDMyKG4sITApO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDMyOnJldHVybiBlLmdldEludDMyKG4sITApO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLlVJTlQzMjpyZXR1cm4gZS5nZXRVaW50MzIobiwhMCk7Y2FzZSBhLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuSU5UNjQ6cmV0dXJuIGYoaS5kZWZhdWx0LmZyb21CaXRzKGUuZ2V0VWludDMyKG4sITApLGUuZ2V0VWludDMyKG4rNCwhMCksITEpLHQpO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkRPVUJMRTpyZXR1cm4gZS5nZXRGbG9hdDY0KG4sITApO2Nhc2UgYS5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLlVJTlQ2NDpyZXR1cm4gZihpLmRlZmF1bHQuZnJvbUJpdHMoZS5nZXRVaW50MzIobiwhMCksZS5nZXRVaW50MzIobis0LCEwKSwhMCksdCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGNhbm5vdCByZWFkIGZyb20gRGF0YVZpZXcgZm9yIHR5cGUgJHthLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGVbdF19YCl9fXQuVGVuc29yPWM7fSw3MjczOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzJiZ0aGlzLl9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5kZWNvZGVVdGY4U3RyaW5nPXQuTUFYX0NMSVA9dC5NSU5fQ0xJUD10LlBvb2xDb252VXRpbD10LlJlZHVjZVV0aWw9dC5TcGxpdFV0aWw9dC5NYXRoVXRpbD10LlNoYXBlVXRpbD10LkxvbmdVdGlsPXQuUHJvdG9VdGlsPXQuR2VtbVV0aWw9dC5hcnJheUNvcHlIZWxwZXI9dC5Ccm9hZGNhc3RVdGlsPXQuTWF0TXVsVXRpbD10LkFycmF5VXRpbD10LmFzc2VydD10LmNoZWNrSW5wdXRzU2hhcGU9dm9pZCAwO2NvbnN0IG89big1Njg2KSxpPXIobigxNTgzKSkscz1uKDI0NDYpLGE9big5MjQwKTt0LmNoZWNrSW5wdXRzU2hhcGU9ZnVuY3Rpb24oZSwuLi50KXtpZighZXx8ZS5sZW5ndGghPT10Lmxlbmd0aClyZXR1cm4gITE7Zm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspaWYoIWVbbl0uZGltc3x8ZVtuXS5kaW1zLmxlbmd0aCE9PXRbbl0pcmV0dXJuICExO3JldHVybiAhMH0sdC5hc3NlcnQ9ZnVuY3Rpb24oZSx0KXtpZighZSl0aHJvdyBuZXcgRXJyb3IoInN0cmluZyI9PXR5cGVvZiB0P3Q6dCgpKX0sdC5BcnJheVV0aWw9Y2xhc3N7c3RhdGljIGFycmF5c0VxdWFsKGUsdCl7aWYoZS5sZW5ndGghPT10Lmxlbmd0aClyZXR1cm4gITE7Zm9yKGxldCBuPTA7bjxlLmxlbmd0aDtuKyspaWYoZVtuXSE9PXRbbl0pcmV0dXJuICExO3JldHVybiAhMH19O2NsYXNzIHV7c3RhdGljIHByZXByb2Nlc3NJbnB1dFNoYXBlcyhlLHQpe3JldHVybiBbMT09PWUubGVuZ3RoP1sxLGVbMF1dOmUsMT09PXQubGVuZ3RoP1t0WzBdLDFdOnRdfXN0YXRpYyBwb3N0cHJvY2Vzc091dHB1dFNoYXBlKGUsdCxuKXsxPT09dCYmZS5zcGxpY2UoZS5sZW5ndGgtMiwxKSwxPT09biYmZS5wb3AoKTt9c3RhdGljIGNhbGNNYXRNdWxTaGFwZShlLHQpe3JldHVybiBlWzFdIT09dFswXT92b2lkIDA6W2VbMF0sdFsxXV19fXQuTWF0TXVsVXRpbD11O2NsYXNzIGx7c3RhdGljIGNhbGNTaGFwZShlLHQsbj0hMSl7Y29uc3Qgcj1lLmxlbmd0aCxvPXQubGVuZ3RoO2lmKDA9PT1yKXJldHVybiB0O2lmKDA9PT1vKXJldHVybiBlO2NvbnN0IGk9TWF0aC5tYXgoZS5sZW5ndGgsdC5sZW5ndGgpLHM9bmV3IEFycmF5KGkpO2lmKG4pe2lmKHI8Mnx8bzwyKXJldHVybjtjb25zdCBuPXUuY2FsY01hdE11bFNoYXBlKFtlW3ItMl0sZVtyLTFdXSxbdFtvLTJdLHRbby0xXV0pO2lmKHZvaWQgMD09PW4pcmV0dXJuO1tzW2ktMl0sc1tpLTFdXT1uO31mb3IobGV0IGE9bj8zOjE7YTw9aTthKyspe2NvbnN0IG49ci1hPDA/MTplW3ItYV0sdT1vLWE8MD8xOnRbby1hXTtpZihuIT09dSYmbj4xJiZ1PjEpcmV0dXJuO3NbaS1hXT1NYXRoLm1heChuLHUpO31yZXR1cm4gc31zdGF0aWMgaW5kZXgoZSx0KXtjb25zdCBuPW5ldyBBcnJheSh0Lmxlbmd0aCk7cmV0dXJuIGwuZmlsbEluZGV4KGUsdCxuKSxufXN0YXRpYyBmaWxsSW5kZXgoZSx0LG4pe2NvbnN0IHI9ZS5sZW5ndGgtdC5sZW5ndGg7Zm9yKGxldCBvPTA7bzx0Lmxlbmd0aDtvKyspbltvXT1lW3Irb10ldFtvXTt9c3RhdGljIGNhbGMoZSx0LG4scixvKXtjb25zdCBpPWwuY2FsY1NoYXBlKGUuZGltcyx0LmRpbXMpO2lmKGkpe2lmKHImJiFkLmFyZUVxdWFsKGksZS5kaW1zKSlyZXR1cm47Y29uc3Qgcz1kLnNpemUoaSksdT1yP2U6bmV3IGEuVGVuc29yKGksb3x8ZS50eXBlKTtpZigwPT09aS5sZW5ndGgpdS5zZXQoW10sbihlLmdldChbXSksdC5nZXQoW10pKSk7ZWxzZSB7Y29uc3Qgcj1uZXcgQXJyYXkoaS5sZW5ndGgpLG89bmV3IEFycmF5KGUuZGltcy5sZW5ndGgpLGE9bmV3IEFycmF5KHQuZGltcy5sZW5ndGgpO2xldCBjLHA9MCxkPTAsZj0hMSxoPSExOzA9PT1lLmRpbXMubGVuZ3RoJiYocD1lLmdldChbXSksZj0hMCksMD09PXQuZGltcy5sZW5ndGgmJihkPXQuZ2V0KFtdKSxoPSEwKTtmb3IobGV0IGc9MDtnPHM7ZysrKXtjPWc7Zm9yKGxldCBlPWkubGVuZ3RoLTE7ZT49MDtlLS0pcltlXT1jJWlbZV0sYz1NYXRoLmZsb29yKGMvaVtlXSk7Znx8KGwuZmlsbEluZGV4KHIsZS5kaW1zLG8pLHA9ZS5nZXQobykpLGh8fChsLmZpbGxJbmRleChyLHQuZGltcyxhKSxkPXQuZ2V0KGEpKSx1LnNldChyLG4ocCxkKSk7fX1yZXR1cm4gdX19c3RhdGljIGlzVmFsaWRCcm9hZGNhc3QoZSx0KXtjb25zdCBuPWUubGVuZ3RoLHI9dC5sZW5ndGg7aWYobj5yKXJldHVybiAhMTtmb3IobGV0IG89MTtvPD1uO28rKylpZigxIT09ZVtuLW9dJiZlW24tb10hPT10W3Itb10pcmV0dXJuICExO3JldHVybiAhMH1zdGF0aWMgZ2V0QnJvYWRjYXN0RGltcyhlLHQpe2NvbnN0IG49ZS5sZW5ndGgscj1bXTtmb3IobGV0IG89MDtvPG47bysrKXtjb25zdCBpPW4tMS1vLHM9ZVtpXXx8MTsodFt0Lmxlbmd0aC0xLW9dfHwxKT4xJiYxPT09cyYmci51bnNoaWZ0KGkpO31yZXR1cm4gcn19dC5Ccm9hZGNhc3RVdGlsPWwsdC5hcnJheUNvcHlIZWxwZXI9ZnVuY3Rpb24oZSx0LG4scixvKXtpZihyPDB8fHI+PXQubGVuZ3RoKXRocm93IG5ldyBFcnJvcigic291cmNlSW5kZXggb3V0IG9mIGJvdW5kcyIpO2lmKG48MHx8bj49ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0YXJnZXRJbmRleCBvdXQgb2YgYm91bmRzIik7aWYocitvPnQubGVuZ3RoKXRocm93IG5ldyBFcnJvcigic291cmNlIGluZGljZXMgdG8gYmUgY29waWVkIGFyZSBvdXRzaWRlIGJvdW5kcyIpO2lmKG4rbz5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInRhcmdldCBhcnJheSBpcyB0b28gc21hbGwgdG8gaG9sZCByZXN1bHQiKTtmb3IobGV0IGk9MDtpPG87aSsrKWVbbitpXT10W3IraV07fSx0LkdlbW1VdGlsPWNsYXNze3N0YXRpYyBnZXRTaGFwZU9mR2VtbVJlc3VsdChlLHQsbixyLG8pe2lmKDIhPT1lLmxlbmd0aHx8MiE9PW4ubGVuZ3RoKXRocm93IG5ldyBFcnJvcigic2hhcGUgbmVlZCB0byBiZSBvZiBzaXplIDIiKTtsZXQgaSxzLGE7dD8oaT1lWzFdLHM9ZVswXSk6KGk9ZVswXSxzPWVbMV0pO2xldCB1PS0xO2lmKHI/KGE9blswXSx1PTEpOihhPW5bMV0sdT0wKSxuW3VdIT09cyl0aHJvdyBuZXcgRXJyb3IoImRpbWVuc2lvbiBtaXNtYXRjaCIpO2lmKGk8PTB8fGE8PTB8fHM8PTApdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIHNoYXBlIHNwZWNpZmllZCIpO2lmKG8mJiFsLmlzVmFsaWRCcm9hZGNhc3QobyxbaSxhXSkpdGhyb3cgbmV3IEVycm9yKCJnZW1tOiBpbnZhbGlkIGJpYXMgc2hhcGUgZm9yIGJyb2FkY2FzdCIpO3JldHVybiBbaSxhLHNdfX07Y2xhc3MgY3tzdGF0aWMgdGVuc29yRGF0YVR5cGVGcm9tUHJvdG8oZSl7c3dpdGNoKGUpe2Nhc2Ugcy5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLklOVDg6cmV0dXJuICJpbnQ4IjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UODpyZXR1cm4gInVpbnQ4IjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5CT09MOnJldHVybiAiYm9vbCI7Y2FzZSBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuSU5UMTY6cmV0dXJuICJpbnQxNiI7Y2FzZSBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDE2OnJldHVybiAidWludDE2IjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQzMjpyZXR1cm4gImludDMyIjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UMzI6cmV0dXJuICJ1aW50MzIiO2Nhc2Ugcy5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkZMT0FUOnJldHVybiAiZmxvYXQzMiI7Y2FzZSBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuRE9VQkxFOnJldHVybiAiZmxvYXQ2NCI7Y2FzZSBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuU1RSSU5HOnJldHVybiAic3RyaW5nIjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ2NDpyZXR1cm4gImludDMyIjtjYXNlIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UNjQ6cmV0dXJuICJ1aW50MzIiO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICR7cy5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlW2VdfWApfX1zdGF0aWMgdGVuc29yRGF0YVR5cGVTdHJpbmdUb0VudW0oZSl7c3dpdGNoKGUpe2Nhc2UiaW50OCI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQ4O2Nhc2UidWludDgiOnJldHVybiBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDg7Y2FzZSJib29sIjpyZXR1cm4gcy5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkJPT0w7Y2FzZSJpbnQxNiI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQxNjtjYXNlInVpbnQxNiI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UMTY7Y2FzZSJpbnQzMiI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5JTlQzMjtjYXNlInVpbnQzMiI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5VSU5UMzI7Y2FzZSJmbG9hdDMyIjpyZXR1cm4gcy5vbm54LlRlbnNvclByb3RvLkRhdGFUeXBlLkZMT0FUO2Nhc2UiZmxvYXQ2NCI6cmV0dXJuIHMub25ueC5UZW5zb3JQcm90by5EYXRhVHlwZS5ET1VCTEU7Y2FzZSJzdHJpbmciOnJldHVybiBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuU1RSSU5HO2Nhc2UiaW50NjQiOnJldHVybiBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuSU5UNjQ7Y2FzZSJ1aW50NjQiOnJldHVybiBzLm9ubnguVGVuc29yUHJvdG8uRGF0YVR5cGUuVUlOVDY0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICR7ZX1gKX19c3RhdGljIHRlbnNvckRpbXNGcm9tUHJvdG8oZSl7cmV0dXJuIGUubWFwKChlPT5pLmRlZmF1bHQuaXNMb25nKGUpP2UudG9OdW1iZXIoKTplKSl9c3RhdGljIHRlbnNvclZhbHVlVHlwZUZyb21Qcm90byhlKXtyZXR1cm4ge3RlbnNvclR5cGU6Yy50ZW5zb3JEYXRhVHlwZUZyb21Qcm90byhlLmVsZW1UeXBlKSxzaGFwZTp7ZGltczpjLnRlbnNvckRpbXNGcm9tUHJvdG8oZS5zaGFwZS5kaW0ubWFwKChlPT5lLmRpbVZhbHVlKSkpfX19c3RhdGljIHRlbnNvckRpbXNGcm9tT1JURm9ybWF0KGUpe2NvbnN0IHQ9W107Zm9yKGxldCBuPTA7bjxlLmRpbXNMZW5ndGgoKTtuKyspdC5wdXNoKHAubG9uZ1RvTnVtYmVyKGUuZGltcyhuKSkpO3JldHVybiB0fXN0YXRpYyB0ZW5zb3JBdHRyaWJ1dGVzRnJvbU9SVEZvcm1hdChlKXtjb25zdCB0PVtdO2ZvcihsZXQgbj0wO248ZS5hdHRyaWJ1dGVzTGVuZ3RoKCk7bisrKXQucHVzaChlLmF0dHJpYnV0ZXMobikpO3JldHVybiB0fX10LlByb3RvVXRpbD1jO2NsYXNzIHB7c3RhdGljIGxvbmdUb051bWJlcihlLHQpe3JldHVybiBpLmRlZmF1bHQuaXNMb25nKGUpP2UudG9OdW1iZXIoKTplIGluc3RhbmNlb2Ygby5mbGF0YnVmZmVycy5Mb25nP2kuZGVmYXVsdC5mcm9tVmFsdWUoe2xvdzplLmxvdyxoaWdoOmUuaGlnaCx1bnNpZ25lZDpudWxsIT10JiZ0fSkudG9OdW1iZXIoKTplfXN0YXRpYyBpc0xvbmcoZSl7cmV0dXJuIGkuZGVmYXVsdC5pc0xvbmcoZSl8fGUgaW5zdGFuY2VvZiBvLmZsYXRidWZmZXJzLkxvbmd9fXQuTG9uZ1V0aWw9cDtjbGFzcyBke3N0YXRpYyBzaXplKGUpe3JldHVybiBkLmdldFNpemVGcm9tRGltZW5zaW9uUmFuZ2UoZSwwLGUubGVuZ3RoKX1zdGF0aWMgc2l6ZUZyb21EaW1lbnNpb24oZSx0KXtpZih0PDB8fHQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGRpbWVuc2lvbiBvZiAke3R9IGZvciBzaXplRnJvbURpbWVuc2lvbiBhcyBUZW5zb3IgaGFzICR7ZS5sZW5ndGh9IGRpbWVuc2lvbnMuYCk7cmV0dXJuIGQuZ2V0U2l6ZUZyb21EaW1lbnNpb25SYW5nZShlLHQsZS5sZW5ndGgpfXN0YXRpYyBzaXplVG9EaW1lbnNpb24oZSx0KXtpZih0PDB8fHQ+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGRpbWVuc2lvbiBvZiAke3R9IGZvciBzaXplVG9EaW1lbnNpb24gYXMgVGVuc29yIGhhcyAke2UubGVuZ3RofSBkaW1lbnNpb25zLmApO3JldHVybiBkLmdldFNpemVGcm9tRGltZW5zaW9uUmFuZ2UoZSwwLHQpfXN0YXRpYyBnZXRTaXplRnJvbURpbWVuc2lvblJhbmdlKGUsdCxuKXtsZXQgcj0xO2ZvcihsZXQgbz10O288bjtvKyspe2lmKGVbb108PTApdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZ2V0IHZhbGlkIHNpemUgZnJvbSBzcGVjaWZpZWQgZGltZW5zaW9uIHJhbmdlLiBNb3N0IGxpa2VseSB0aGUgcmFuZ2UgY29udGFpbnMgMCBvciBuZWdhdGl2ZSB2YWx1ZXMgaW4gdGhlbS4iKTtyKj1lW29dO31yZXR1cm4gcn1zdGF0aWMgY29tcHV0ZVN0cmlkZXMoZSl7Y29uc3QgdD1lLmxlbmd0aDtpZigwPT09dClyZXR1cm4gW107aWYoMT09PXQpcmV0dXJuIFsxXTtjb25zdCBuPW5ldyBBcnJheSh0KTtuW3QtMV09MSxuW3QtMl09ZVt0LTFdO2ZvcihsZXQgcj10LTM7cj49MDstLXIpbltyXT1uW3IrMV0qZVtyKzFdO3JldHVybiBufXN0YXRpYyB0cmFuc3Bvc2UoZSl7cmV0dXJuIGUuc2xpY2UoKS5yZXZlcnNlKCl9c3RhdGljIGluZGljZXNUb09mZnNldChlLHQsbil7dm9pZCAwPT09biYmKG49ZS5sZW5ndGgpO2xldCByPTA7Zm9yKGxldCBvPTA7bzxuOysrbylyKz10W29dKmVbb107cmV0dXJuIHJ9c3RhdGljIG9mZnNldFRvSW5kaWNlcyhlLHQpe2NvbnN0IG49dC5sZW5ndGg7aWYoMD09PW4pcmV0dXJuIFtdO2lmKDE9PT1uKXJldHVybiBbZSp0WzBdXTtjb25zdCByPW5ldyBBcnJheSh0Lmxlbmd0aCk7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aC0xOysrbilyW25dPU1hdGguZmxvb3IoZS90W25dKSxlLT1yW25dKnRbbl07cmV0dXJuIHJbci5sZW5ndGgtMV09ZSxyfXN0YXRpYyBub3JtYWxpemVBeGlzKGUsdCl7aWYoZTwtdCYmZT49dCl0aHJvdyBuZXcgRXJyb3IoInVuc3VwcG9ydGVkIGF4aXMgZm9yIHRoaXMgb3BlcmF0aW9uLiIpO3JldHVybiBlPDA/ZSt0OmV9c3RhdGljIG5vcm1hbGl6ZUF4ZXMoZSx0KXtyZXR1cm4gZS5tYXAoKGU9PnRoaXMubm9ybWFsaXplQXhpcyhlLHQpKSl9c3RhdGljIGluY3JlbWVudEluZGV4KGUsdCxuKXtpZigwPT09dC5sZW5ndGh8fDA9PT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIkluZGV4IGluY3JlbWVudGluZyB1bnN1cHBvcnRlZCBmb3Igc2NhbGFyIFRlbnNvciIpO2lmKHZvaWQgMD09PW4pbj10Lmxlbmd0aDtlbHNlIGlmKG48PTB8fG4+dC5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJJbmNvcnJlY3QgYXhpcyB0byBpbmNyZW1lbnQgb24iKTtmb3IobGV0IHI9bi0xO3I+PTAmJihlW3JdKyssIShlW3JdPHRbcl0pKTstLXIpZVtyXT0wO31zdGF0aWMgY2FsY3VsYXRlUmVzaGFwZWREaW1zKGUsdCl7aWYoMD09PXQubGVuZ3RoKXtpZigwPT09ZS5sZW5ndGh8fDE9PT1kLnNpemUoZSkpcmV0dXJuIFtdO3Rocm93IG5ldyBFcnJvcigiY2Fubm90IHJlc2hhcGUgdG8gYSBzY2FsYXIgVGVuc29yIil9Y29uc3Qgbj10Lmxlbmd0aCxyPW5ldyBBcnJheShuKTtsZXQgbz0tMSxpPTE7Zm9yKGxldCBzPTA7czxuO3MrKyl7aWYodFtzXTwtMSl0aHJvdyBuZXcgRXJyb3IoImEgZGltZW5zaW9uIGluIHNoYXBlIGhpbnRzIGNhbm5vdCBiZSBsZXNzIHRoYW4gLTEiKTtpZigtMT09PXRbc10pe2lmKC0xIT09byl0aHJvdyBuZXcgRXJyb3IoImF0IG1vc3Qgb25lIGRpbWVuc2lvbiBpbiBzaGFwZSBoaW50cyBjYW4gYmUgLTEiKTtvPXM7fWVsc2Uge2lmKDA9PT10W3NdKXtpZihzPj1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInRoZSBkaW1lbnNpb24gd2l0aCB2YWx1ZSB6ZXJvIGV4Y2VlZHMgdGhlIGRpbWVuc2lvbiBzaXplIG9mIHRoZSBpbnB1dCB0ZW5zb3IiKTtyW3NdPWVbc107fWVsc2UgcltzXT10W3NdO2kqPXJbc107fX1jb25zdCBzPWQuc2l6ZShlKTtpZigtMSE9PW8pe2lmKHMlaSE9MCl0aHJvdyBuZXcgRXJyb3IoYHRoZSBpbnB1dCB0ZW5zb3IgY2Fubm90IGJlIHJlc2hhcGVkIHRvIHRoZSByZXF1ZXN0ZWQgc2hhcGUuIElucHV0IHNoYXBlOiBbJHtlfV0gT3V0cHV0IHNoYXBlOiBbJHt0fV1gKTtyW29dPXMvaTt9ZWxzZSBpZihpIT09cyl0aHJvdyBuZXcgRXJyb3IoInJlc2hhcGVkRGltcyBhbmQgb3JpZ2luYWxEaW1zIGRvbid0IGhhdmUgbWF0Y2hpbmcgc2l6ZXMiKTtyZXR1cm4gcn1zdGF0aWMgc29ydEJhc2VkT25QZXJtKGUsdCl7cmV0dXJuIHQ/dC5tYXAoKHQ9PmVbdF0pKTplLnNsaWNlKCkucmV2ZXJzZSgpfXN0YXRpYyBwYWRTaGFwZShlLHQpe2NvbnN0IG49ZS5sZW5ndGg7cmV0dXJuIGUubWFwKCgoZSxyKT0+ZSt0W3JdK3RbcituXSkpfXN0YXRpYyBhcmVFcXVhbChlLHQpe3JldHVybiBlLmxlbmd0aD09PXQubGVuZ3RoJiZlLmV2ZXJ5KCgoZSxuKT0+ZT09PXRbbl0pKX1zdGF0aWMgdmFsaWRhdGVEaW1zQW5kQ2FsY1NpemUoZSl7aWYoZS5sZW5ndGg+Nil0aHJvdyBuZXcgVHlwZUVycm9yKCJPbmx5IHJhbmsgMCB0byA2IGlzIHN1cHBvcnRlZCBmb3IgdGVuc29yIHNoYXBlLiIpO2xldCB0PTE7Zm9yKGNvbnN0IG4gb2YgZSl7aWYoIU51bWJlci5pc0ludGVnZXIobikpdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCBzaGFwZTogJHtufSBpcyBub3QgYW4gaW50ZWdlcmApO2lmKG48MHx8bj4yMTQ3NDgzNjQ3KXRocm93IG5ldyBUeXBlRXJyb3IoYEludmFsaWQgc2hhcGU6IGxlbmd0aCAke259IGlzIG5vdCBhbGxvd2VkYCk7dCo9bjt9cmV0dXJuIHR9c3RhdGljIGZsYXR0ZW5TaGFwZShlLHQpe3Q8MCYmKHQrPWUubGVuZ3RoKTtjb25zdCBuPWUucmVkdWNlKCgoZSx0KT0+ZSp0KSwxKSxyPWUuc2xpY2UodCkucmVkdWNlKCgoZSx0KT0+ZSp0KSwxKTtyZXR1cm4gW24vcixyXX1zdGF0aWMgc3F1ZWV6ZVNoYXBlKGUsdCl7Y29uc3Qgbj1uZXcgQXJyYXk7dD1kLm5vcm1hbGl6ZUF4ZXModCxlLmxlbmd0aCk7Zm9yKGxldCByPTA7cjxlLmxlbmd0aDtyKyspe2NvbnN0IG89dC5pbmRleE9mKHIpPj0wO2lmKG8mJjEhPT1lW3JdKXRocm93IG5ldyBFcnJvcigic3F1ZWV6ZSBhbiBheGlzIG9mIHNpemUgZGlmZmVyZW50IHRoYW4gMSIpOygwPT09dC5sZW5ndGgmJmVbcl0+MXx8dC5sZW5ndGg+MCYmIW8pJiZuLnB1c2goZVtyXSk7fXJldHVybiBufXN0YXRpYyB1bnNxdWVlemVTaGFwZShlLHQpe2NvbnN0IG49bmV3IEFycmF5KGUubGVuZ3RoK3QubGVuZ3RoKTtuLmZpbGwoMCk7Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspe2NvbnN0IHI9ZC5ub3JtYWxpemVBeGlzKHRbZV0sbi5sZW5ndGgpO2lmKHI+PW4ubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiJ2F4ZXMnIGhhcyBhbiBvdXQgb2YgcmFuZ2UgYXhpcyIpO2lmKDAhPT1uW3JdKXRocm93IG5ldyBFcnJvcigiJ2F4ZXMnIGhhcyBhIGR1cGxpY2F0ZSBheGlzIik7bltyXT0xO31sZXQgcj0wO2ZvcihsZXQgdD0wO3Q8bi5sZW5ndGg7dCsrKTA9PT1uW3RdJiYoblt0XT1lW3IrK10pO2lmKHIhPT1lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInRoZSB1bnNxdWVlemVkIGRpbWVuc2lvbiBjb3VsZCBub3QgYmUgZXN0YWJsaXNoZWQiKTtyZXR1cm4gbn19dC5TaGFwZVV0aWw9ZCx0Lk1hdGhVdGlsPWNsYXNze3N0YXRpYyBzcXIoZSx0LG4scixvKXtpZihyPDB8fHI+PXQubGVuZ3RoKXRocm93IG5ldyBFcnJvcigic291cmNlSW5kZXggb3V0IG9mIGJvdW5kcyIpO2lmKG48MHx8bj49ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0YXJnZXRJbmRleCBvdXQgb2YgYm91bmRzIik7aWYocitvPnQubGVuZ3RoKXRocm93IG5ldyBFcnJvcigic291cmNlIGluZGljZXMgdG8gYmUgY29waWVkIGFyZSBvdXRzaWRlIGJvdW5kcyIpO2lmKG4rbz5lLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInRhcmdldCBhcnJheSBpcyB0b28gc21hbGwgdG8gaG9sZCByZXN1bHQiKTtmb3IobGV0IGk9MDtpPG87aSsrKWVbbitpXSs9TWF0aC5wb3codFtyK2ldLDIpO31zdGF0aWMgYXhweShlLHQsbixyLG8saSl7aWYocjwwfHxyPj10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZUluZGV4IG91dCBvZiBib3VuZHMiKTtpZihuPDB8fG4+PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigidGFyZ2V0SW5kZXggb3V0IG9mIGJvdW5kcyIpO2lmKHIrbz50Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZSBpbmRpY2VzIHRvIGJlIGNvcGllZCBhcmUgb3V0c2lkZSBib3VuZHMiKTtpZihuK28+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0YXJnZXQgYXJyYXkgaXMgdG9vIHNtYWxsIHRvIGhvbGQgcmVzdWx0Iik7Zm9yKGxldCBzPTA7czxvO3MrKyllW24rc10rPWkqdFtyK3NdO31zdGF0aWMgcG93eChlLHQsbixyLG8saSl7aWYocjwwfHxyPj10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZUluZGV4IG91dCBvZiBib3VuZHMiKTtpZihuPDB8fG4+PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigidGFyZ2V0SW5kZXggb3V0IG9mIGJvdW5kcyIpO2lmKHIrbz50Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZSBpbmRpY2VzIHRvIGJlIGNvcGllZCBhcmUgb3V0c2lkZSBib3VuZHMiKTtpZihuK28+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0YXJnZXQgYXJyYXkgaXMgdG9vIHNtYWxsIHRvIGhvbGQgcmVzdWx0Iik7Zm9yKGxldCBzPTA7czxvO3MrKyllW24rc109TWF0aC5wb3codFtyK3NdLGkpO31zdGF0aWMgbXVsKGUsdCxuLHIsbyl7aWYocjwwfHxyPj10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZUluZGV4IG91dCBvZiBib3VuZHMiKTtpZihuPDB8fG4+PWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcigidGFyZ2V0SW5kZXggb3V0IG9mIGJvdW5kcyIpO2lmKHIrbz50Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoInNvdXJjZSBpbmRpY2VzIHRvIGJlIGNvcGllZCBhcmUgb3V0c2lkZSBib3VuZHMiKTtpZihuK28+ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJ0YXJnZXQgYXJyYXkgaXMgdG9vIHNtYWxsIHRvIGhvbGQgcmVzdWx0Iik7Zm9yKGxldCBpPTA7aTxvO2krKyllW24raV09dFtyK2ldKmVbbitpXTt9fTtjbGFzcyBme3N0YXRpYyBzcGxpdFNoYXBlKGUsdCxuLHIpe2lmKDA9PT1uLmxlbmd0aCl7aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJuZWVkIHRvIGtub3cgbnVtYmVyIG9mIG91dHB1dHMgd2hlbiB0aGUgJ3NwbGl0JyBhdHRyaWJ1dGUgaXMgbm90IHNwZWNpZmllZCIpO2YuZGV0ZXJtaW5lU3BsaXQoZVt0XSxyLG4pO31jb25zdCBvPVtdLGk9WzBdO2ZvcihsZXQgcj0wO3I8bi5sZW5ndGg7KytyKXswIT09ciYmaS5wdXNoKGlbci0xXStuW3ItMV0pO2NvbnN0IHM9ZS5zbGljZSgpO3NbdF09bltyXSxvLnB1c2gocyk7fXJldHVybiBbbyxpXX1zdGF0aWMgZGV0ZXJtaW5lU3BsaXQoZSx0LG4pe2lmKGUldCE9MCl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBzcGxpdCB0ZW5zb3IgdG8gZXF1YWwgc2l6ZWQgcGFydHMiKTtmb3IobGV0IHI9MDtyPHQ7KytyKW4ucHVzaChlL3QpO319dC5TcGxpdFV0aWw9ZjtjbGFzcyBoe3N0YXRpYyBjYWxjUmVkdWNlKGUsdCxuLHIsbyl7Y29uc3QgaT1lLmRpbXMuc2xpY2UoMCk7MD09PXQubGVuZ3RoJiZpLmZvckVhY2goKChlLG4pPT50LnB1c2gobikpKTtjb25zdCBzPWguY2FsY1JlZHVjZVNoYXBlKGksdCwhMCksdT1kLnNpemUocyksYz1uZXcgYS5UZW5zb3IocyxlLnR5cGUpLHA9ZC5jb21wdXRlU3RyaWRlcyhzKSxmPWQuY29tcHV0ZVN0cmlkZXMoaSksZz1uZXcgQXJyYXkoaS5sZW5ndGgpO2ZvcihsZXQgbj0wO248dTtuKyspe2NvbnN0IHM9ZC5vZmZzZXRUb0luZGljZXMobixwKTtsLmZpbGxJbmRleChzLGksZyksYy5zZXQocyxoLmNhbGNSZWR1Y2VCeUF4aXMoZS5udW1iZXJEYXRhLHQsaSwwLGQuaW5kaWNlc1RvT2Zmc2V0KGcsZikscixvKSk7fXJldHVybiBuP2M6bmV3IGEuVGVuc29yKGguY2FsY1JlZHVjZVNoYXBlKGksdCxuKSxjLnR5cGUsdm9pZCAwLHZvaWQgMCxjLmRhdGEsYy5kYXRhSWQpfXN0YXRpYyBjYWxjUmVkdWNlQnlBeGlzKGUsdCxuLHIsbyxpLHMpe2xldCBhPTA7aWYocj49dC5sZW5ndGgpcmV0dXJuIGkoZVtvXSk7Y29uc3QgdT10W3JdLGw9dT49bi5sZW5ndGg/MTpkLnNpemUobi5zbGljZSh1KzEpKTtmb3IobGV0IGM9MDtjPG5bdV07YysrKWE9MD09PWM/aC5jYWxjUmVkdWNlQnlBeGlzKGUsdCxuLHIrMSxvLGkscyk6cyhhLGguY2FsY1JlZHVjZUJ5QXhpcyhlLHQsbixyKzEsbyxpLHMpKSxvKz1sO3JldHVybiBhfXN0YXRpYyBjYWxjUmVkdWNlU2hhcGUoZSx0LG4pe2NvbnN0IHI9ZS5zbGljZSgpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXJbdFtlXV09bj8xOjA7cmV0dXJuIHIuZmlsdGVyKChlPT4wIT09ZSkpfX10LlJlZHVjZVV0aWw9aDtjbGFzcyBne3N0YXRpYyBhZGp1c3RQb29sQXR0cmlidXRlcyhlLHQsbixyLG8saSl7aWYoIWUmJm4ubGVuZ3RoIT09dC5sZW5ndGgtMil0aHJvdyBuZXcgRXJyb3IoImxlbmd0aCBvZiBzcGVjaWZpZWQga2VybmVsIHNoYXBlcyBzaG91bGQgYmUgMiBsZXNzIHRoYW4gbGVuZ3RoIG9mIGlucHV0IGRpbWVuc2lvbnMiKTtpZihlKWZvcihsZXQgZT0wO2U8dC5sZW5ndGgtMjtlKyspZT49bi5sZW5ndGg/bi5wdXNoKHRbZSsyXSk6bltlXT10W2UrMl07Zm9yKGxldCBlPTA7ZTxuLmxlbmd0aDtlKyspaWYoZTxyLmxlbmd0aCl7aWYocltlXTwwKXRocm93IG5ldyBFcnJvcigic3RyaWRlcyBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDEiKX1lbHNlIHIucHVzaCgxKTtmb3IobGV0IGU9MDtlPG4ubGVuZ3RoO2UrKylpZihlPG8ubGVuZ3RoKXtpZihvW2VdPDApdGhyb3cgbmV3IEVycm9yKCJkaWxhdGlvbnMgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAxIil9ZWxzZSBvLnB1c2goMSk7Zm9yKGxldCBlPTA7ZTwyKm4ubGVuZ3RoO2UrKylpZihlPGkubGVuZ3RoKXtpZihpW2VdPDApdGhyb3cgbmV3IEVycm9yKCJwYWQgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAxIil9ZWxzZSBpLnB1c2goMCk7Zm9yKGxldCBlPTA7ZTxuLmxlbmd0aDtlKyspe2lmKG5bZV08PTApdGhyb3cgbmV3IEVycm9yKCJrZXJuZWwgc2hhcGVzIG5lZWQgdG8gYmUgZ3JlYXRlciB0aGFuIDAiKTtpZihpW2VdPj1uW2VdfHxpW2Urbi5sZW5ndGhdPj1uW2VdKXRocm93IG5ldyBFcnJvcigicGFkcyBzaG91bGQgYmUgc21hbGxlciB0aGFuIGtlcm5lbCIpfX1zdGF0aWMgYWRqdXN0UGFkc0Jhc2VkT25BdXRvUGFkKGUsdCxuLHIsbyxpKXtpZihpKXtpZihvLmxlbmd0aCE9PTIqKGUubGVuZ3RoLTIpKXRocm93IG5ldyBFcnJvcigibGVuZ3RoIG9mIHBhZHMgc2hvdWxkIGJlIHR3aWNlIHRoZSBsZW5ndGggb2YgZGF0YSBkaW1lbnNpb25zIik7aWYodC5sZW5ndGghPT1lLmxlbmd0aC0yKXRocm93IG5ldyBFcnJvcigibGVuZ3RoIG9mIHN0cmlkZXMgc2hvdWxkIGJlIHRoZSBsZW5ndGggb2YgZGF0YSBkaW1lbnNpb25zIik7aWYoci5sZW5ndGghPT1lLmxlbmd0aC0yKXRocm93IG5ldyBFcnJvcigibGVuZ3RoIG9mIGtlcm5lbCBzaGFwZXMgc2hvdWxkIGJlIHRoZSBsZW5ndGggb2YgZGF0YSBkaW1lbnNpb25zIik7Zm9yKGxldCBzPTA7czxlLmxlbmd0aC0yO3MrKylnLmFkanVzdFBhZEFuZFJldHVyblNoYXBlKGVbcysyXSx0W3NdLG5bc10scltzXSxvLHMscytlLmxlbmd0aC0yLGkpO319c3RhdGljIGNvbXB1dGVQb29sT3V0cHV0U2hhcGUoZSx0LG4scixvLGkscyl7aWYodC5sZW5ndGg8PTApdGhyb3cgbmV3IEVycm9yKCJpbnB1dCBzaGFwZSBtdXN0IGJlIG9mIHNpemUgZ3JlYXRlciB0aGFuIDAiKTtjb25zdCBhPVt0WzBdLHRbMV1dO3JldHVybiBnLmNvbXB1dGVTaGFwZUhlbHBlcihlLHQsYSxuLHIsbyxpLHMpLGF9c3RhdGljIGNvbXB1dGVDb252T3V0cHV0U2hhcGUoZSx0LG4scixvLGkscyl7aWYoZS5sZW5ndGg8PTB8fHQubGVuZ3RoPD0wKXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBpbnB1dCB0ZW5zb3IgZGltcyBvciBpbnZhbGlkIGZpbHRlciB0ZW5zb3IgZGltcyIpO2NvbnN0IGE9W2VbMF0sdFswXV07cmV0dXJuIGcuY29tcHV0ZVNoYXBlSGVscGVyKCExLGUsYSxuLHIsbyxpLHMpLGF9c3RhdGljIGNvbXB1dGVTaGFwZUhlbHBlcihlLHQsbixyLG8saSxzLGEpe2lmKGUpZm9yKGxldCBlPTA7ZTx0Lmxlbmd0aC0yO2UrKyluLnB1c2goMSk7ZWxzZSBmb3IobGV0IGU9MDtlPHQubGVuZ3RoLTI7ZSsrKW4ucHVzaChnLmFkanVzdFBhZEFuZFJldHVyblNoYXBlKHRbZSsyXSxyW2VdLG9bZV0saVtlXSxzLGUsZSt0Lmxlbmd0aC0yLGEpKTt9c3RhdGljIGFkanVzdFBhZEFuZFJldHVyblNoYXBlKGUsdCxuLHIsbyxpLHMsYSl7Y29uc3QgdT1uKihyLTEpKzE7aWYoIWF8fCJOT1RTRVQiPT09YSlyZXR1cm4gTWF0aC5mbG9vcigoZStvW2ldK29bc10tdSkvdCsxKTtzd2l0Y2goYSl7Y2FzZSJWQUxJRCI6cmV0dXJuIG9baV09MCxvW3NdPTAsTWF0aC5mbG9vcigoZS11KS90KzEpO2Nhc2UiU0FNRV9MT1dFUiI6Y2FzZSJTQU1FX1VQUEVSIjppZigxIT09bil0aHJvdyBuZXcgRXJyb3IoIkRpbGF0aW9uIG5vdCBzdXBwb3J0ZWQgZm9yIFNBTUVfVVBQRVIgb3IgU0FNRV9MT1dFUiIpO3tjb25zdCBuPSgoZSt0LTEpL3QtMSkqdCtyLWU7cmV0dXJuIG9baV09IlNBTUVfTE9XRVIiPT09YT9NYXRoLmZsb29yKChuKzEpLzIpOk1hdGguZmxvb3Iobi8yKSxvW3NdPW4tb1tpXSxNYXRoLmZsb29yKChlK24tcikvdCsxKX1kZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgQXV0b1BhZCB0eXBlIil9fX10LlBvb2xDb252VXRpbD1nLHQuTUlOX0NMSVA9LTM0MDI4MjM0NjYzODUyODg2ZTIyLHQuTUFYX0NMSVA9MzQwMjgyMzQ2NjM4NTI4ODZlMjIsdC5kZWNvZGVVdGY4U3RyaW5nPWZ1bmN0aW9uKGUpe3JldHVybiAobmV3IFRleHREZWNvZGVyKS5kZWNvZGUoZSl9O30sODQwODooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnZlcnNpb249dm9pZCAwLHQudmVyc2lvbj0iMS4xNi4zIjt9LDk1NDQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLG89dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pO3ZhciBvPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTtvJiYhKCJnZXQiaW4gbz8hdC5fX2VzTW9kdWxlOm8ud3JpdGFibGV8fG8uY29uZmlndXJhYmxlKXx8KG89e2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRbbl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscixvKTt9OmZ1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pLGVbcl09dFtuXTt9KSxpPXRoaXMmJnRoaXMuX19zZXRNb2R1bGVEZWZhdWx0fHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbihlLHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJkZWZhdWx0Iix7ZW51bWVyYWJsZTohMCx2YWx1ZTp0fSk7fTpmdW5jdGlvbihlLHQpe2UuZGVmYXVsdD10O30pLHM9dGhpcyYmdGhpcy5fX2ltcG9ydFN0YXJ8fGZ1bmN0aW9uKGUpe2lmKGUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgdD17fTtpZihudWxsIT1lKWZvcih2YXIgbiBpbiBlKSJkZWZhdWx0IiE9PW4mJk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZvKHQsZSxuKTtyZXR1cm4gaSh0LGUpLHR9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmVuZFByb2ZpbGluZz10LnJ1bj10LnJlbGVhc2VTZXNzaW9uPXQuY3JlYXRlU2Vzc2lvbj10LmNyZWF0ZVNlc3Npb25GaW5hbGl6ZT10LmNyZWF0ZVNlc3Npb25BbGxvY2F0ZT10LmluaXRpYWxpemVSdW50aW1lPXQuaW5pdGlhbGl6ZVdlYkFzc2VtYmx5SW5zdGFuY2U9dm9pZCAwO2NvbnN0IGE9bigyMjM1KSx1PXMobigxMjU5KSksbD1uKDI2MyksYz0oKT0+ISFhLmVudi53YXNtLnByb3h5JiYidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50O2xldCBwLGQsZixoPSExLGc9ITEsYj0hMTtjb25zdCBtPVtdLHk9W10sdj1bXSxfPVtdLHc9W10sVD1bXSx4PSgpPT57aWYoaHx8IWd8fGJ8fCFwKXRocm93IG5ldyBFcnJvcigid29ya2VyIG5vdCByZWFkeSIpfSxPPWU9Pntzd2l0Y2goZS5kYXRhLnR5cGUpe2Nhc2UiaW5pdC13YXNtIjpoPSExLGUuZGF0YS5lcnI/KGI9ITAsZFsxXShlLmRhdGEuZXJyKSk6KGc9ITAsZFswXSgpKTticmVhaztjYXNlImluaXQtb3J0IjplLmRhdGEuZXJyP2ZbMV0oZS5kYXRhLmVycik6ZlswXSgpO2JyZWFrO2Nhc2UiY3JlYXRlX2FsbG9jYXRlIjplLmRhdGEuZXJyP20uc2hpZnQoKVsxXShlLmRhdGEuZXJyKTptLnNoaWZ0KClbMF0oZS5kYXRhLm91dCk7YnJlYWs7Y2FzZSJjcmVhdGVfZmluYWxpemUiOmUuZGF0YS5lcnI/eS5zaGlmdCgpWzFdKGUuZGF0YS5lcnIpOnkuc2hpZnQoKVswXShlLmRhdGEub3V0KTticmVhaztjYXNlImNyZWF0ZSI6ZS5kYXRhLmVycj92LnNoaWZ0KClbMV0oZS5kYXRhLmVycik6di5zaGlmdCgpWzBdKGUuZGF0YS5vdXQpO2JyZWFrO2Nhc2UicmVsZWFzZSI6ZS5kYXRhLmVycj9fLnNoaWZ0KClbMV0oZS5kYXRhLmVycik6Xy5zaGlmdCgpWzBdKCk7YnJlYWs7Y2FzZSJydW4iOmUuZGF0YS5lcnI/dy5zaGlmdCgpWzFdKGUuZGF0YS5lcnIpOncuc2hpZnQoKVswXShlLmRhdGEub3V0KTticmVhaztjYXNlImVuZC1wcm9maWxpbmciOmUuZGF0YS5lcnI/VC5zaGlmdCgpWzFdKGUuZGF0YS5lcnIpOlQuc2hpZnQoKVswXSgpO319LFM9InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudD9udWxsPT09KHI9bnVsbD09PWRvY3VtZW50fHx2b2lkIDA9PT1kb2N1bWVudD92b2lkIDA6ZG9jdW1lbnQuY3VycmVudFNjcmlwdCl8fHZvaWQgMD09PXI/dm9pZCAwOnIuc3JjOnZvaWQgMDt0LmluaXRpYWxpemVXZWJBc3NlbWJseUluc3RhbmNlPWFzeW5jKCk9PntpZihjKCkpe2lmKGcpcmV0dXJuO2lmKGgpdGhyb3cgbmV3IEVycm9yKCJtdWx0aXBsZSBjYWxscyB0byAnaW5pdFdhc20oKScgZGV0ZWN0ZWQuIik7aWYoYil0aHJvdyBuZXcgRXJyb3IoInByZXZpb3VzIGNhbGwgdG8gJ2luaXRXYXNtKCknIGZhaWxlZC4iKTtyZXR1cm4gaD0hMCx2b2lkIDA9PT1hLmVudi53YXNtLndhc21QYXRocyYmUyYmMCE9PVMuaW5kZXhPZigiYmxvYjoiKSYmKGEuZW52Lndhc20ud2FzbVBhdGhzPVMuc3Vic3RyKDAsK1MubGFzdEluZGV4T2YoIi8iKSsxKSksbmV3IFByb21pc2UoKChlLHQpPT57bnVsbD09cHx8cC50ZXJtaW5hdGUoKSxwPW4oODA1MCkuWigpLHAub25tZXNzYWdlPU8sZD1bZSx0XTtjb25zdCByPXt0eXBlOiJpbml0LXdhc20iLGluOmEuZW52Lndhc219O3AucG9zdE1lc3NhZ2Uocik7fSkpfXJldHVybiAoMCwgbC5pbml0aWFsaXplV2ViQXNzZW1ibHkpKGEuZW52Lndhc20pfSx0LmluaXRpYWxpemVSdW50aW1lPWFzeW5jIGU9PntpZihjKCkpcmV0dXJuIHgoKSxuZXcgUHJvbWlzZSgoKHQsbik9PntmPVt0LG5dO2NvbnN0IHI9e3R5cGU6ImluaXQtb3J0IixpbjplfTtwLnBvc3RNZXNzYWdlKHIpO30pKTthd2FpdCB1LmluaXRSdW50aW1lKGUpO30sdC5jcmVhdGVTZXNzaW9uQWxsb2NhdGU9YXN5bmMgZT0+YygpPyh4KCksbmV3IFByb21pc2UoKCh0LG4pPT57bS5wdXNoKFt0LG5dKTtjb25zdCByPXt0eXBlOiJjcmVhdGVfYWxsb2NhdGUiLGluOnttb2RlbDplfX07cC5wb3N0TWVzc2FnZShyLFtlLmJ1ZmZlcl0pO30pKSk6dS5jcmVhdGVTZXNzaW9uQWxsb2NhdGUoZSksdC5jcmVhdGVTZXNzaW9uRmluYWxpemU9YXN5bmMoZSx0KT0+YygpPyh4KCksbmV3IFByb21pc2UoKChuLHIpPT57eS5wdXNoKFtuLHJdKTtjb25zdCBvPXt0eXBlOiJjcmVhdGVfZmluYWxpemUiLGluOnttb2RlbGRhdGE6ZSxvcHRpb25zOnR9fTtwLnBvc3RNZXNzYWdlKG8pO30pKSk6dS5jcmVhdGVTZXNzaW9uRmluYWxpemUoZSx0KSx0LmNyZWF0ZVNlc3Npb249YXN5bmMoZSx0KT0+YygpPyh4KCksbmV3IFByb21pc2UoKChuLHIpPT57di5wdXNoKFtuLHJdKTtjb25zdCBvPXt0eXBlOiJjcmVhdGUiLGluOnttb2RlbDplLG9wdGlvbnM6dH19O3AucG9zdE1lc3NhZ2UobyxbZS5idWZmZXJdKTt9KSkpOnUuY3JlYXRlU2Vzc2lvbihlLHQpLHQucmVsZWFzZVNlc3Npb249YXN5bmMgZT0+e2lmKGMoKSlyZXR1cm4geCgpLG5ldyBQcm9taXNlKCgodCxuKT0+e18ucHVzaChbdCxuXSk7Y29uc3Qgcj17dHlwZToicmVsZWFzZSIsaW46ZX07cC5wb3N0TWVzc2FnZShyKTt9KSk7dS5yZWxlYXNlU2Vzc2lvbihlKTt9LHQucnVuPWFzeW5jKGUsdCxuLHIsbyk9PmMoKT8oeCgpLG5ldyBQcm9taXNlKCgoaSxzKT0+e3cucHVzaChbaSxzXSk7Y29uc3QgYT17dHlwZToicnVuIixpbjp7c2Vzc2lvbklkOmUsaW5wdXRJbmRpY2VzOnQsaW5wdXRzOm4sb3V0cHV0SW5kaWNlczpyLG9wdGlvbnM6b319O3AucG9zdE1lc3NhZ2UoYSx1LmV4dHJhY3RUcmFuc2ZlcmFibGVCdWZmZXJzKG4pKTt9KSkpOnUucnVuKGUsdCxuLHIsbyksdC5lbmRQcm9maWxpbmc9YXN5bmMgZT0+e2lmKGMoKSlyZXR1cm4geCgpLG5ldyBQcm9taXNlKCgodCxuKT0+e1QucHVzaChbdCxuXSk7Y29uc3Qgcj17dHlwZToiZW5kLXByb2ZpbGluZyIsaW46ZX07cC5wb3N0TWVzc2FnZShyKTt9KSk7dS5lbmRQcm9maWxpbmcoZSk7fTt9LDc5MTg6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnNldFJ1bk9wdGlvbnM9dm9pZCAwO2NvbnN0IHI9bigyNjMpLG89bigxNDk3KTt0LnNldFJ1bk9wdGlvbnM9ZT0+e2NvbnN0IHQ9KDAsIHIuZ2V0SW5zdGFuY2UpKCk7bGV0IG49MDtjb25zdCBpPVtdLHM9ZXx8e307dHJ5e2lmKHZvaWQgMD09PShudWxsPT1lP3ZvaWQgMDplLmxvZ1NldmVyaXR5TGV2ZWwpKXMubG9nU2V2ZXJpdHlMZXZlbD0yO2Vsc2UgaWYoIm51bWJlciIhPXR5cGVvZiBlLmxvZ1NldmVyaXR5TGV2ZWx8fCFOdW1iZXIuaXNJbnRlZ2VyKGUubG9nU2V2ZXJpdHlMZXZlbCl8fGUubG9nU2V2ZXJpdHlMZXZlbDwwfHxlLmxvZ1NldmVyaXR5TGV2ZWw+NCl0aHJvdyBuZXcgRXJyb3IoYGxvZyBzZXJ2ZXJpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke2UubG9nU2V2ZXJpdHlMZXZlbH1gKTtpZih2b2lkIDA9PT0obnVsbD09ZT92b2lkIDA6ZS5sb2dWZXJib3NpdHlMZXZlbCkpcy5sb2dWZXJib3NpdHlMZXZlbD0wO2Vsc2UgaWYoIm51bWJlciIhPXR5cGVvZiBlLmxvZ1ZlcmJvc2l0eUxldmVsfHwhTnVtYmVyLmlzSW50ZWdlcihlLmxvZ1ZlcmJvc2l0eUxldmVsKSl0aHJvdyBuZXcgRXJyb3IoYGxvZyB2ZXJib3NpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke2UubG9nVmVyYm9zaXR5TGV2ZWx9YCk7dm9pZCAwPT09KG51bGw9PWU/dm9pZCAwOmUudGVybWluYXRlKSYmKHMudGVybWluYXRlPSExKTtsZXQgcj0wO3JldHVybiB2b2lkIDAhPT0obnVsbD09ZT92b2lkIDA6ZS50YWcpJiYocj0oMCxvLmFsbG9jV2FzbVN0cmluZykoZS50YWcsaSkpLG49dC5fT3J0Q3JlYXRlUnVuT3B0aW9ucyhzLmxvZ1NldmVyaXR5TGV2ZWwscy5sb2dWZXJib3NpdHlMZXZlbCwhIXMudGVybWluYXRlLHIpLDA9PT1uJiYoMCxvLmNoZWNrTGFzdEVycm9yKSgiQ2FuJ3QgY3JlYXRlIHJ1biBvcHRpb25zLiIpLHZvaWQgMCE9PShudWxsPT1lP3ZvaWQgMDplLmV4dHJhKSYmKDAsby5pdGVyYXRlRXh0cmFPcHRpb25zKShlLmV4dHJhLCIiLG5ldyBXZWFrU2V0LCgoZSxyKT0+e2NvbnN0IHM9KDAsby5hbGxvY1dhc21TdHJpbmcpKGUsaSksYT0oMCxvLmFsbG9jV2FzbVN0cmluZykocixpKTswIT09dC5fT3J0QWRkUnVuQ29uZmlnRW50cnkobixzLGEpJiYoMCxvLmNoZWNrTGFzdEVycm9yKShgQ2FuJ3Qgc2V0IGEgcnVuIGNvbmZpZyBlbnRyeTogJHtlfSAtICR7cn0uYCk7fSkpLFtuLGldfWNhdGNoKGUpe3Rocm93IDAhPT1uJiZ0Ll9PcnRSZWxlYXNlUnVuT3B0aW9ucyhuKSxpLmZvckVhY2goKGU9PnQuX2ZyZWUoZSkpKSxlfX07fSw2NjQwOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5Pbm54cnVudGltZVdlYkFzc2VtYmx5U2Vzc2lvbkhhbmRsZXI9dm9pZCAwO2NvbnN0IHI9bigyODA2KSxvPW4oMjIzNSksaT1uKDI4NTApLHM9big5NTQ0KTtsZXQgYTt0Lk9ubnhydW50aW1lV2ViQXNzZW1ibHlTZXNzaW9uSGFuZGxlcj1jbGFzc3thc3luYyBjcmVhdGVTZXNzaW9uQWxsb2NhdGUoZSl7Y29uc3QgdD1hd2FpdCBmZXRjaChlKTtpZigyMDAhPT10LnN0YXR1cyl0aHJvdyBuZXcgRXJyb3IoYGZhaWxlZCB0byBsb2FkIG1vZGVsOiAke2V9YCk7Y29uc3Qgbj1hd2FpdCB0LmFycmF5QnVmZmVyKCk7cmV0dXJuICgwLCBzLmNyZWF0ZVNlc3Npb25BbGxvY2F0ZSkobmV3IFVpbnQ4QXJyYXkobikpfWFzeW5jIGxvYWRNb2RlbChlLHQpe2lmKGF8fChhd2FpdCgwLCBzLmluaXRpYWxpemVSdW50aW1lKShvLmVudiksYT0hMCksInN0cmluZyI9PXR5cGVvZiBlKWlmKCJ1bmRlZmluZWQiIT10eXBlb2YgcHJvY2VzcyYmcHJvY2Vzcy52ZXJzaW9ucyYmcHJvY2Vzcy52ZXJzaW9ucy5ub2RlKXtjb25zdCBuPWF3YWl0KDAsIGkucHJvbWlzaWZ5KShyLnJlYWRGaWxlKShlKTtbdGhpcy5zZXNzaW9uSWQsdGhpcy5pbnB1dE5hbWVzLHRoaXMub3V0cHV0TmFtZXNdPWF3YWl0KDAsIHMuY3JlYXRlU2Vzc2lvbikobix0KTt9ZWxzZSB7Y29uc3Qgbj1hd2FpdCB0aGlzLmNyZWF0ZVNlc3Npb25BbGxvY2F0ZShlKTtbdGhpcy5zZXNzaW9uSWQsdGhpcy5pbnB1dE5hbWVzLHRoaXMub3V0cHV0TmFtZXNdPWF3YWl0KDAsIHMuY3JlYXRlU2Vzc2lvbkZpbmFsaXplKShuLHQpO31lbHNlIFt0aGlzLnNlc3Npb25JZCx0aGlzLmlucHV0TmFtZXMsdGhpcy5vdXRwdXROYW1lc109YXdhaXQoMCwgcy5jcmVhdGVTZXNzaW9uKShlLHQpO31hc3luYyBkaXNwb3NlKCl7cmV0dXJuICgwLCBzLnJlbGVhc2VTZXNzaW9uKSh0aGlzLnNlc3Npb25JZCl9YXN5bmMgcnVuKGUsdCxuKXtjb25zdCByPVtdLGk9W107T2JqZWN0LmVudHJpZXMoZSkuZm9yRWFjaCgoZT0+e2NvbnN0IHQ9ZVswXSxuPWVbMV0sbz10aGlzLmlucHV0TmFtZXMuaW5kZXhPZih0KTtpZigtMT09PW8pdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGlucHV0ICcke3R9J2ApO3IucHVzaChuKSxpLnB1c2gobyk7fSkpO2NvbnN0IGE9W107T2JqZWN0LmVudHJpZXModCkuZm9yRWFjaCgoZT0+e2NvbnN0IHQ9ZVswXSxuPXRoaXMub3V0cHV0TmFtZXMuaW5kZXhPZih0KTtpZigtMT09PW4pdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG91dHB1dCAnJHt0fSdgKTthLnB1c2gobik7fSkpO2NvbnN0IHU9YXdhaXQoMCwgcy5ydW4pKHRoaXMuc2Vzc2lvbklkLGksci5tYXAoKGU9PltlLnR5cGUsZS5kaW1zLGUuZGF0YV0pKSxhLG4pLGw9e307Zm9yKGxldCBlPTA7ZTx1Lmxlbmd0aDtlKyspbFt0aGlzLm91dHB1dE5hbWVzW2FbZV1dXT1uZXcgby5UZW5zb3IodVtlXVswXSx1W2VdWzJdLHVbZV1bMV0pO3JldHVybiBsfXN0YXJ0UHJvZmlsaW5nKCl7fWVuZFByb2ZpbGluZygpeygwLCBzLmVuZFByb2ZpbGluZykodGhpcy5zZXNzaW9uSWQpO319O30sNzYyMjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuc2V0U2Vzc2lvbk9wdGlvbnM9dm9pZCAwO2NvbnN0IHI9bigyNjMpLG89bigxNDk3KTt0LnNldFNlc3Npb25PcHRpb25zPWU9Pnt2YXIgdCxuLGkscztjb25zdCBhPSgwLCByLmdldEluc3RhbmNlKSgpO2xldCB1PTA7Y29uc3QgbD1bXSxjPWV8fHt9OyhlPT57ZS5leHRyYXx8KGUuZXh0cmE9e30pLGUuZXh0cmEuc2Vzc2lvbnx8KGUuZXh0cmEuc2Vzc2lvbj17fSk7Y29uc3QgdD1lLmV4dHJhLnNlc3Npb247dC51c2Vfb3J0X21vZGVsX2J5dGVzX2RpcmVjdGx5fHwodC51c2Vfb3J0X21vZGVsX2J5dGVzX2RpcmVjdGx5PSIxIiksZS5leGVjdXRpb25Qcm92aWRlcnMmJmUuZXhlY3V0aW9uUHJvdmlkZXJzLnNvbWUoKGU9PiJ3ZWJncHUiPT09KCJzdHJpbmciPT10eXBlb2YgZT9lOmUubmFtZSkpKSYmKGUuZW5hYmxlTWVtUGF0dGVybj0hMSk7fSkoYyk7dHJ5e2NvbnN0IGU9KGU9Pntzd2l0Y2goZSl7Y2FzZSJkaXNhYmxlZCI6cmV0dXJuIDA7Y2FzZSJiYXNpYyI6cmV0dXJuIDE7Y2FzZSJleHRlbmRlZCI6cmV0dXJuIDI7Y2FzZSJhbGwiOnJldHVybiA5OTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgZ3JhcGggb3B0aW1pemF0aW9uIGxldmVsOiAke2V9YCl9fSkobnVsbCE9PSh0PWMuZ3JhcGhPcHRpbWl6YXRpb25MZXZlbCkmJnZvaWQgMCE9PXQ/dDoiYWxsIikscD0oZT0+e3N3aXRjaChlKXtjYXNlInNlcXVlbnRpYWwiOnJldHVybiAwO2Nhc2UicGFyYWxsZWwiOnJldHVybiAxO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBleGVjdXRpb24gbW9kZTogJHtlfWApfX0pKG51bGwhPT0obj1jLmV4ZWN1dGlvbk1vZGUpJiZ2b2lkIDAhPT1uP246InNlcXVlbnRpYWwiKSxkPSJzdHJpbmciPT10eXBlb2YgYy5sb2dJZD8oMCxvLmFsbG9jV2FzbVN0cmluZykoYy5sb2dJZCxsKTowLGY9bnVsbCE9PShpPWMubG9nU2V2ZXJpdHlMZXZlbCkmJnZvaWQgMCE9PWk/aToyO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKGYpfHxmPDB8fGY+NCl0aHJvdyBuZXcgRXJyb3IoYGxvZyBzZXJ2ZXJpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke2Z9YCk7Y29uc3QgaD1udWxsIT09KHM9Yy5sb2dWZXJib3NpdHlMZXZlbCkmJnZvaWQgMCE9PXM/czowO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKGgpfHxoPDB8fGg+NCl0aHJvdyBuZXcgRXJyb3IoYGxvZyB2ZXJib3NpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke2h9YCk7Y29uc3QgZz0ic3RyaW5nIj09dHlwZW9mIGMub3B0aW1pemVkTW9kZWxGaWxlUGF0aD8oMCxvLmFsbG9jV2FzbVN0cmluZykoYy5vcHRpbWl6ZWRNb2RlbEZpbGVQYXRoLGwpOjA7cmV0dXJuIHU9YS5fT3J0Q3JlYXRlU2Vzc2lvbk9wdGlvbnMoZSwhIWMuZW5hYmxlQ3B1TWVtQXJlbmEsISFjLmVuYWJsZU1lbVBhdHRlcm4scCwhIWMuZW5hYmxlUHJvZmlsaW5nLDAsZCxmLGgsZyksMD09PXUmJigwLG8uY2hlY2tMYXN0RXJyb3IpKCJDYW4ndCBjcmVhdGUgc2Vzc2lvbiBvcHRpb25zLiIpLGMuZXhlY3V0aW9uUHJvdmlkZXJzJiYoKGUsdCxuKT0+e2Zvcihjb25zdCBpIG9mIHQpe2xldCB0PSJzdHJpbmciPT10eXBlb2YgaT9pOmkubmFtZTtzd2l0Y2godCl7Y2FzZSJ4bm5wYWNrIjp0PSJYTk5QQUNLIjticmVhaztjYXNlIndlYm5uIjppZih0PSJXRUJOTiIsInN0cmluZyIhPXR5cGVvZiBpKXtjb25zdCB0PWk7aWYobnVsbD09dD92b2lkIDA6dC5kZXZpY2VUeXBlKXtjb25zdCBpPSgwLG8uYWxsb2NXYXNtU3RyaW5nKSgiZGV2aWNlVHlwZSIsbikscz0oMCxvLmFsbG9jV2FzbVN0cmluZykodC5kZXZpY2VUeXBlLG4pOzAhPT0oMCxyLmdldEluc3RhbmNlKSgpLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnkoZSxpLHMpJiYoMCxvLmNoZWNrTGFzdEVycm9yKShgQ2FuJ3Qgc2V0IGEgc2Vzc2lvbiBjb25maWcgZW50cnk6ICdkZXZpY2VUeXBlJyAtICR7dC5kZXZpY2VUeXBlfS5gKTt9aWYobnVsbD09dD92b2lkIDA6dC5wb3dlclByZWZlcmVuY2Upe2NvbnN0IGk9KDAsby5hbGxvY1dhc21TdHJpbmcpKCJwb3dlclByZWZlcmVuY2UiLG4pLHM9KDAsby5hbGxvY1dhc21TdHJpbmcpKHQucG93ZXJQcmVmZXJlbmNlLG4pOzAhPT0oMCxyLmdldEluc3RhbmNlKSgpLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnkoZSxpLHMpJiYoMCxvLmNoZWNrTGFzdEVycm9yKShgQ2FuJ3Qgc2V0IGEgc2Vzc2lvbiBjb25maWcgZW50cnk6ICdwb3dlclByZWZlcmVuY2UnIC0gJHt0LnBvd2VyUHJlZmVyZW5jZX0uYCk7fX1icmVhaztjYXNlIndlYmdwdSI6dD0iSlMiO2JyZWFrO2Nhc2Uid2FzbSI6Y2FzZSJjcHUiOmNvbnRpbnVlO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBub3Qgc3VwcG9ydGVkIGV4ZWN1dGlvbiBwcm92aWRlcjogJHt0fWApfWNvbnN0IHM9KDAsby5hbGxvY1dhc21TdHJpbmcpKHQsbik7MCE9PSgwLHIuZ2V0SW5zdGFuY2UpKCkuX09ydEFwcGVuZEV4ZWN1dGlvblByb3ZpZGVyKGUscykmJigwLG8uY2hlY2tMYXN0RXJyb3IpKGBDYW4ndCBhcHBlbmQgZXhlY3V0aW9uIHByb3ZpZGVyOiAke3R9LmApO319KSh1LGMuZXhlY3V0aW9uUHJvdmlkZXJzLGwpLHZvaWQgMCE9PWMuZXh0cmEmJigwLG8uaXRlcmF0ZUV4dHJhT3B0aW9ucykoYy5leHRyYSwiIixuZXcgV2Vha1NldCwoKGUsdCk9Pntjb25zdCBuPSgwLG8uYWxsb2NXYXNtU3RyaW5nKShlLGwpLHI9KDAsby5hbGxvY1dhc21TdHJpbmcpKHQsbCk7MCE9PWEuX09ydEFkZFNlc3Npb25Db25maWdFbnRyeSh1LG4scikmJigwLG8uY2hlY2tMYXN0RXJyb3IpKGBDYW4ndCBzZXQgYSBzZXNzaW9uIGNvbmZpZyBlbnRyeTogJHtlfSAtICR7dH0uYCk7fSkpLFt1LGxdfWNhdGNoKGUpe3Rocm93IDAhPT11JiZhLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnModSksbC5mb3JFYWNoKChlPT5hLl9mcmVlKGUpKSksZX19O30sNzkxNzooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmxvZ0xldmVsU3RyaW5nVG9FbnVtPXQudGVuc29yVHlwZVRvVHlwZWRBcnJheUNvbnN0cnVjdG9yPXQuZ2V0VGVuc29yRWxlbWVudFNpemU9dC50ZW5zb3JEYXRhVHlwZUVudW1Ub1N0cmluZz10LnRlbnNvckRhdGFUeXBlU3RyaW5nVG9FbnVtPXZvaWQgMCx0LnRlbnNvckRhdGFUeXBlU3RyaW5nVG9FbnVtPWU9Pntzd2l0Y2goZSl7Y2FzZSJpbnQ4IjpyZXR1cm4gMztjYXNlInVpbnQ4IjpyZXR1cm4gMjtjYXNlImJvb2wiOnJldHVybiA5O2Nhc2UiaW50MTYiOnJldHVybiA1O2Nhc2UidWludDE2IjpyZXR1cm4gNDtjYXNlImludDMyIjpyZXR1cm4gNjtjYXNlInVpbnQzMiI6cmV0dXJuIDEyO2Nhc2UiZmxvYXQxNiI6cmV0dXJuIDEwO2Nhc2UiZmxvYXQzMiI6cmV0dXJuIDE7Y2FzZSJmbG9hdDY0IjpyZXR1cm4gMTE7Y2FzZSJzdHJpbmciOnJldHVybiA4O2Nhc2UiaW50NjQiOnJldHVybiA3O2Nhc2UidWludDY0IjpyZXR1cm4gMTM7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJHtlfWApfX0sdC50ZW5zb3JEYXRhVHlwZUVudW1Ub1N0cmluZz1lPT57c3dpdGNoKGUpe2Nhc2UgMzpyZXR1cm4gImludDgiO2Nhc2UgMjpyZXR1cm4gInVpbnQ4IjtjYXNlIDk6cmV0dXJuICJib29sIjtjYXNlIDU6cmV0dXJuICJpbnQxNiI7Y2FzZSA0OnJldHVybiAidWludDE2IjtjYXNlIDY6cmV0dXJuICJpbnQzMiI7Y2FzZSAxMjpyZXR1cm4gInVpbnQzMiI7Y2FzZSAxMDpyZXR1cm4gImZsb2F0MTYiO2Nhc2UgMTpyZXR1cm4gImZsb2F0MzIiO2Nhc2UgMTE6cmV0dXJuICJmbG9hdDY0IjtjYXNlIDg6cmV0dXJuICJzdHJpbmciO2Nhc2UgNzpyZXR1cm4gImludDY0IjtjYXNlIDEzOnJldHVybiAidWludDY0IjtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgZGF0YSB0eXBlOiAke2V9YCl9fSx0LmdldFRlbnNvckVsZW1lbnRTaXplPWU9Plt2b2lkIDAsNCwxLDEsMiwyLDQsOCx2b2lkIDAsMSwyLDgsNCw4LHZvaWQgMCx2b2lkIDAsdm9pZCAwXVtlXSx0LnRlbnNvclR5cGVUb1R5cGVkQXJyYXlDb25zdHJ1Y3Rvcj1lPT57c3dpdGNoKGUpe2Nhc2UiZmxvYXQxNiI6Y2FzZSJ1aW50MTYiOnJldHVybiBVaW50MTZBcnJheTtjYXNlImZsb2F0MzIiOnJldHVybiBGbG9hdDMyQXJyYXk7Y2FzZSJ1aW50OCI6Y2FzZSJib29sIjpyZXR1cm4gVWludDhBcnJheTtjYXNlImludDgiOnJldHVybiBJbnQ4QXJyYXk7Y2FzZSJpbnQxNiI6cmV0dXJuIEludDE2QXJyYXk7Y2FzZSJpbnQzMiI6cmV0dXJuIEludDMyQXJyYXk7Y2FzZSJmbG9hdDY0IjpyZXR1cm4gRmxvYXQ2NEFycmF5O2Nhc2UidWludDMyIjpyZXR1cm4gVWludDMyQXJyYXk7Y2FzZSJpbnQ2NCI6cmV0dXJuIEJpZ0ludDY0QXJyYXk7Y2FzZSJ1aW50NjQiOnJldHVybiBCaWdVaW50NjRBcnJheTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgdHlwZTogJHtlfWApfX0sdC5sb2dMZXZlbFN0cmluZ1RvRW51bT1lPT57c3dpdGNoKGUpe2Nhc2UidmVyYm9zZSI6cmV0dXJuIDA7Y2FzZSJpbmZvIjpyZXR1cm4gMTtjYXNlIndhcm5pbmciOnJldHVybiAyO2Nhc2UiZXJyb3IiOnJldHVybiAzO2Nhc2UiZmF0YWwiOnJldHVybiA0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBsb2dnaW5nIGxldmVsOiAke2V9YCl9fTt9LDEyNTk6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmV4dHJhY3RUcmFuc2ZlcmFibGVCdWZmZXJzPXQuZW5kUHJvZmlsaW5nPXQucnVuPXQucmVsZWFzZVNlc3Npb249dC5jcmVhdGVTZXNzaW9uPXQuY3JlYXRlU2Vzc2lvbkZpbmFsaXplPXQuY3JlYXRlU2Vzc2lvbkFsbG9jYXRlPXQuaW5pdFJ1bnRpbWU9dm9pZCAwO2NvbnN0IHI9big3OTE4KSxvPW4oNzYyMiksaT1uKDc5MTcpLHM9bigyNjMpLGE9bigxNDk3KTt0LmluaXRSdW50aW1lPWFzeW5jIGU9Pnt2YXIgdCxuO3Q9ZS53YXNtLm51bVRocmVhZHMsbj0oMCwgaS5sb2dMZXZlbFN0cmluZ1RvRW51bSkoZS5sb2dMZXZlbCksMCE9PSgwLCBzLmdldEluc3RhbmNlKSgpLl9PcnRJbml0KHQsbikmJigwLCBhLmNoZWNrTGFzdEVycm9yKSgiQ2FuJ3QgaW5pdGlhbGl6ZSBvbm54cnVudGltZS4iKTt9O2NvbnN0IHU9bmV3IE1hcDt0LmNyZWF0ZVNlc3Npb25BbGxvY2F0ZT1lPT57Y29uc3QgdD0oMCwgcy5nZXRJbnN0YW5jZSkoKSxuPXQuX21hbGxvYyhlLmJ5dGVMZW5ndGgpO2lmKDA9PT1uKXRocm93IG5ldyBFcnJvcihgQ2FuJ3QgY3JlYXRlIGEgc2Vzc2lvbi4gZmFpbGVkIHRvIGFsbG9jYXRlIGEgYnVmZmVyIG9mIHNpemUgJHtlLmJ5dGVMZW5ndGh9LmApO3JldHVybiB0LkhFQVBVOC5zZXQoZSxuKSxbbixlLmJ5dGVMZW5ndGhdfSx0LmNyZWF0ZVNlc3Npb25GaW5hbGl6ZT0oZSx0KT0+e2NvbnN0IG49KDAsIHMuZ2V0SW5zdGFuY2UpKCk7bGV0IHI9MCxpPTAsbD1bXTtjb25zdCBjPVtdLHA9W107dHJ5e1tpLGxdPSgwLG8uc2V0U2Vzc2lvbk9wdGlvbnMpKHQpLHI9bi5fT3J0Q3JlYXRlU2Vzc2lvbihlWzBdLGVbMV0saSksMD09PXImJigwLGEuY2hlY2tMYXN0RXJyb3IpKCJDYW4ndCBjcmVhdGUgYSBzZXNzaW9uLiIpO2NvbnN0W2QsZl09KGU9Pntjb25zdCB0PSgwLHMuZ2V0SW5zdGFuY2UpKCksbj10LnN0YWNrU2F2ZSgpO3RyeXtjb25zdCBuPXQuc3RhY2tBbGxvYyg4KTtyZXR1cm4gMCE9PXQuX09ydEdldElucHV0T3V0cHV0Q291bnQoZSxuLG4rNCkmJigwLGEuY2hlY2tMYXN0RXJyb3IpKCJDYW4ndCBnZXQgc2Vzc2lvbiBpbnB1dC9vdXRwdXQgY291bnQuIiksW3QuSEVBUDMyW24vNF0sdC5IRUFQMzJbbi80KzFdXX1maW5hbGx5e3Quc3RhY2tSZXN0b3JlKG4pO319KShyKSxoPVtdLGc9W107Zm9yKGxldCBlPTA7ZTxkO2UrKyl7Y29uc3QgdD1uLl9PcnRHZXRJbnB1dE5hbWUocixlKTswPT09dCYmKDAsYS5jaGVja0xhc3RFcnJvcikoIkNhbid0IGdldCBhbiBpbnB1dCBuYW1lLiIpLGMucHVzaCh0KSxoLnB1c2gobi5VVEY4VG9TdHJpbmcodCkpO31mb3IobGV0IGU9MDtlPGY7ZSsrKXtjb25zdCB0PW4uX09ydEdldE91dHB1dE5hbWUocixlKTswPT09dCYmKDAsYS5jaGVja0xhc3RFcnJvcikoIkNhbid0IGdldCBhbiBvdXRwdXQgbmFtZS4iKSxwLnB1c2godCksZy5wdXNoKG4uVVRGOFRvU3RyaW5nKHQpKTt9cmV0dXJuIHUuc2V0KHIsW3IsYyxwXSksW3IsaCxnXX1jYXRjaChlKXt0aHJvdyBjLmZvckVhY2goKGU9Pm4uX09ydEZyZWUoZSkpKSxwLmZvckVhY2goKGU9Pm4uX09ydEZyZWUoZSkpKSwwIT09ciYmbi5fT3J0UmVsZWFzZVNlc3Npb24ociksZX1maW5hbGx5e24uX2ZyZWUoZVswXSksMCE9PWkmJm4uX09ydFJlbGVhc2VTZXNzaW9uT3B0aW9ucyhpKSxsLmZvckVhY2goKGU9Pm4uX2ZyZWUoZSkpKTt9fSx0LmNyZWF0ZVNlc3Npb249KGUsbik9Pntjb25zdCByPSgwLCB0LmNyZWF0ZVNlc3Npb25BbGxvY2F0ZSkoZSk7cmV0dXJuICgwLCB0LmNyZWF0ZVNlc3Npb25GaW5hbGl6ZSkocixuKX0sdC5yZWxlYXNlU2Vzc2lvbj1lPT57Y29uc3QgdD0oMCwgcy5nZXRJbnN0YW5jZSkoKSxuPXUuZ2V0KGUpO2lmKCFuKXRocm93IG5ldyBFcnJvcihgY2Fubm90IHJlbGVhc2Ugc2Vzc2lvbi4gaW52YWxpZCBzZXNzaW9uIGlkOiAke2V9YCk7Y29uc3RbcixvLGldPW47by5mb3JFYWNoKChlPT50Ll9PcnRGcmVlKGUpKSksaS5mb3JFYWNoKChlPT50Ll9PcnRGcmVlKGUpKSksdC5fT3J0UmVsZWFzZVNlc3Npb24ociksdS5kZWxldGUoZSk7fSx0LnJ1bj1hc3luYyhlLHQsbixvLGwpPT57Y29uc3QgYz0oMCwgcy5nZXRJbnN0YW5jZSkoKSxwPXUuZ2V0KGUpO2lmKCFwKXRocm93IG5ldyBFcnJvcihgY2Fubm90IHJ1biBpbmZlcmVuY2UuIGludmFsaWQgc2Vzc2lvbiBpZDogJHtlfWApO2NvbnN0W2QsZixoXT1wLGc9dC5sZW5ndGgsYj1vLmxlbmd0aDtsZXQgbT0wLHk9W107Y29uc3Qgdj1bXSxfPVtdO3RyeXtbbSx5XT0oMCxyLnNldFJ1bk9wdGlvbnMpKGwpO2ZvcihsZXQgZT0wO2U8ZztlKyspe2NvbnN0IHQ9bltlXVswXSxyPW5bZV1bMV0sbz1uW2VdWzJdO2xldCBzLHU7aWYoQXJyYXkuaXNBcnJheShvKSl7dT00Km8ubGVuZ3RoLHM9Yy5fbWFsbG9jKHUpLF8ucHVzaChzKTtsZXQgZT1zLzQ7Zm9yKGxldCB0PTA7dDxvLmxlbmd0aDt0Kyspe2lmKCJzdHJpbmciIT10eXBlb2Ygb1t0XSl0aHJvdyBuZXcgVHlwZUVycm9yKGB0ZW5zb3IgZGF0YSBhdCBpbmRleCAke3R9IGlzIG5vdCBhIHN0cmluZ2ApO2MuSEVBUFUzMltlKytdPSgwLGEuYWxsb2NXYXNtU3RyaW5nKShvW3RdLF8pO319ZWxzZSB1PW8uYnl0ZUxlbmd0aCxzPWMuX21hbGxvYyh1KSxfLnB1c2gocyksYy5IRUFQVTguc2V0KG5ldyBVaW50OEFycmF5KG8uYnVmZmVyLG8uYnl0ZU9mZnNldCx1KSxzKTtjb25zdCBsPWMuc3RhY2tTYXZlKCkscD1jLnN0YWNrQWxsb2MoNCpyLmxlbmd0aCk7dHJ5e2xldCBuPXAvNDtyLmZvckVhY2goKGU9PmMuSEVBUDMyW24rK109ZSkpO2NvbnN0IG89Yy5fT3J0Q3JlYXRlVGVuc29yKCgwLGkudGVuc29yRGF0YVR5cGVTdHJpbmdUb0VudW0pKHQpLHMsdSxwLHIubGVuZ3RoKTswPT09byYmKDAsYS5jaGVja0xhc3RFcnJvcikoYENhbid0IGNyZWF0ZSB0ZW5zb3IgZm9yIGlucHV0WyR7ZX1dLmApLHYucHVzaChvKTt9ZmluYWxseXtjLnN0YWNrUmVzdG9yZShsKTt9fWNvbnN0IGU9Yy5zdGFja1NhdmUoKSxzPWMuc3RhY2tBbGxvYyg0KmcpLHU9Yy5zdGFja0FsbG9jKDQqZykscD1jLnN0YWNrQWxsb2MoNCpiKSx3PWMuc3RhY2tBbGxvYyg0KmIpO3RyeXtsZXQgZT1zLzQsbj11LzQscj1wLzQsbD13LzQ7Zm9yKGxldCByPTA7cjxnO3IrKyljLkhFQVBVMzJbZSsrXT12W3JdLGMuSEVBUFUzMltuKytdPWZbdFtyXV07Zm9yKGxldCBlPTA7ZTxiO2UrKyljLkhFQVBVMzJbcisrXT0wLGMuSEVBUFUzMltsKytdPWhbb1tlXV07bGV0IHk9Yy5fT3J0UnVuKGQsdSxzLGcsdyxiLHAsbSk7Y29uc3QgXz1jLmpzZXBSdW5Qcm9taXNlO18mJnZvaWQgMCE9PV8udGhlbiYmKHk9YXdhaXQgXyk7Y29uc3QgVD1bXTswIT09eSYmKDAsYS5jaGVja0xhc3RFcnJvcikoImZhaWxlZCB0byBjYWxsIE9ydFJ1bigpLiIpO2ZvcihsZXQgZT0wO2U8YjtlKyspe2NvbnN0IHQ9Yy5IRUFQVTMyW3AvNCtlXSxuPWMuc3RhY2tTYXZlKCkscj1jLnN0YWNrQWxsb2MoMTYpO2xldCBvLHM9MDt0cnl7eT1jLl9PcnRHZXRUZW5zb3JEYXRhKHQscixyKzQscis4LHIrMTIpLDAhPT15JiYoMCxhLmNoZWNrTGFzdEVycm9yKShgQ2FuJ3QgYWNjZXNzIG91dHB1dCB0ZW5zb3IgZGF0YSBvbiBpbmRleCAke2V9LmApO2xldCBuPXIvNDtjb25zdCB1PWMuSEVBUFUzMltuKytdO3M9Yy5IRUFQVTMyW24rK107Y29uc3QgbD1jLkhFQVBVMzJbbisrXSxwPWMuSEVBUFUzMltuKytdLGQ9W107Zm9yKGxldCBlPTA7ZTxwO2UrKylkLnB1c2goYy5IRUFQVTMyW2wvNCtlXSk7Yy5fT3J0RnJlZShsKTtjb25zdCBmPTA9PT1kLmxlbmd0aD8xOmQucmVkdWNlKCgoZSx0KT0+ZSp0KSk7aWYobz0oMCxpLnRlbnNvckRhdGFUeXBlRW51bVRvU3RyaW5nKSh1KSwic3RyaW5nIj09PW8pe2NvbnN0IGU9W107bGV0IHQ9cy80O2ZvcihsZXQgbj0wO248ZjtuKyspe2NvbnN0IHI9Yy5IRUFQVTMyW3QrK10sbz1uPT09Zi0xP3ZvaWQgMDpjLkhFQVBVMzJbdF0tcjtlLnB1c2goYy5VVEY4VG9TdHJpbmcocixvKSk7fVQucHVzaChbbyxkLGVdKTt9ZWxzZSB7Y29uc3QgZT1uZXcoKDAsaS50ZW5zb3JUeXBlVG9UeXBlZEFycmF5Q29uc3RydWN0b3IpKG8pKShmKTtuZXcgVWludDhBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQsZS5ieXRlTGVuZ3RoKS5zZXQoYy5IRUFQVTguc3ViYXJyYXkocyxzK2UuYnl0ZUxlbmd0aCkpLFQucHVzaChbbyxkLGVdKTt9fWZpbmFsbHl7Yy5zdGFja1Jlc3RvcmUobiksInN0cmluZyI9PT1vJiZzJiZjLl9mcmVlKHMpLGMuX09ydFJlbGVhc2VUZW5zb3IodCk7fX1yZXR1cm4gVH1maW5hbGx5e2Muc3RhY2tSZXN0b3JlKGUpO319ZmluYWxseXt2LmZvckVhY2goKGU9PmMuX09ydFJlbGVhc2VUZW5zb3IoZSkpKSxfLmZvckVhY2goKGU9PmMuX2ZyZWUoZSkpKSwwIT09bSYmYy5fT3J0UmVsZWFzZVJ1bk9wdGlvbnMobSkseS5mb3JFYWNoKChlPT5jLl9mcmVlKGUpKSk7fX0sdC5lbmRQcm9maWxpbmc9ZT0+e2NvbnN0IHQ9KDAsIHMuZ2V0SW5zdGFuY2UpKCksbj11LmdldChlKTtpZighbil0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgc2Vzc2lvbiBpZCIpO2NvbnN0IHI9blswXSxvPXQuX09ydEVuZFByb2ZpbGluZyhyKTswPT09byYmKDAsIGEuY2hlY2tMYXN0RXJyb3IpKCJDYW4ndCBnZXQgYW4gcHJvZmlsZSBmaWxlIG5hbWUuIiksdC5fT3J0RnJlZShvKTt9LHQuZXh0cmFjdFRyYW5zZmVyYWJsZUJ1ZmZlcnM9ZT0+e2NvbnN0IHQ9W107Zm9yKGNvbnN0IG4gb2YgZSl7Y29uc3QgZT1uWzJdOyFBcnJheS5pc0FycmF5KGUpJiZlLmJ1ZmZlciYmdC5wdXNoKGUuYnVmZmVyKTt9cmV0dXJuIHR9O30sMjYzOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzJiZ0aGlzLl9fY3JlYXRlQmluZGluZ3x8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24oZSx0LG4scil7dm9pZCAwPT09ciYmKHI9bik7dmFyIG89T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LG4pO28mJiEoImdldCJpbiBvPyF0Ll9fZXNNb2R1bGU6by53cml0YWJsZXx8by5jb25maWd1cmFibGUpfHwobz17ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdFtuXX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLG8pO306ZnVuY3Rpb24oZSx0LG4scil7dm9pZCAwPT09ciYmKHI9biksZVtyXT10W25dO30pLG89dGhpcyYmdGhpcy5fX3NldE1vZHVsZURlZmF1bHR8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsImRlZmF1bHQiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOnR9KTt9OmZ1bmN0aW9uKGUsdCl7ZS5kZWZhdWx0PXQ7fSksaT10aGlzJiZ0aGlzLl9faW1wb3J0U3Rhcnx8ZnVuY3Rpb24oZSl7aWYoZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciB0PXt9O2lmKG51bGwhPWUpZm9yKHZhciBuIGluIGUpImRlZmF1bHQiIT09biYmT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnIodCxlLG4pO3JldHVybiBvKHQsZSksdH07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZGlzcG9zZT10LmdldEluc3RhbmNlPXQuaW5pdGlhbGl6ZVdlYkFzc2VtYmx5PXZvaWQgMDtjb25zdCBzPWkobig2NDQ5KSksYT1uKDkzMiksdT1uKDM0NzQpO2xldCBsLGM9ITEscD0hMSxkPSExO3QuaW5pdGlhbGl6ZVdlYkFzc2VtYmx5PWFzeW5jIGU9PntpZihjKXJldHVybiBQcm9taXNlLnJlc29sdmUoKTtpZihwKXRocm93IG5ldyBFcnJvcigibXVsdGlwbGUgY2FsbHMgdG8gJ2luaXRpYWxpemVXZWJBc3NlbWJseSgpJyBkZXRlY3RlZC4iKTtpZihkKXRocm93IG5ldyBFcnJvcigicHJldmlvdXMgY2FsbCB0byAnaW5pdGlhbGl6ZVdlYkFzc2VtYmx5KCknIGZhaWxlZC4iKTtwPSEwO2NvbnN0IHQ9ZS5pbml0VGltZW91dCxyPWUubnVtVGhyZWFkcyxvPWUuc2ltZCxpPXI+MSYmKCgpPT57dHJ5e3JldHVybiAidW5kZWZpbmVkIiE9dHlwZW9mIFNoYXJlZEFycmF5QnVmZmVyJiYoInVuZGVmaW5lZCIhPXR5cGVvZiBNZXNzYWdlQ2hhbm5lbCYmKG5ldyBNZXNzYWdlQ2hhbm5lbCkucG9ydDEucG9zdE1lc3NhZ2UobmV3IFNoYXJlZEFycmF5QnVmZmVyKDEpKSxXZWJBc3NlbWJseS52YWxpZGF0ZShuZXcgVWludDhBcnJheShbMCw5NywxMTUsMTA5LDEsMCwwLDAsMSw0LDEsOTYsMCwwLDMsMiwxLDAsNSw0LDEsMywxLDEsMTAsMTEsMSw5LDAsNjUsMCwyNTQsMTYsMiwwLDI2LDExXSkpKX1jYXRjaChlKXtyZXR1cm4gITF9fSkoKSxmPW8mJigoKT0+e3RyeXtyZXR1cm4gV2ViQXNzZW1ibHkudmFsaWRhdGUobmV3IFVpbnQ4QXJyYXkoWzAsOTcsMTE1LDEwOSwxLDAsMCwwLDEsNCwxLDk2LDAsMCwzLDIsMSwwLDEwLDMwLDEsMjgsMCw2NSwwLDI1MywxNSwyNTMsMTIsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNTMsMTg2LDEsMjYsMTFdKSl9Y2F0Y2goZSl7cmV0dXJuICExfX0pKCksaD1lLndhc21QYXRocyxnPSJzdHJpbmciPT10eXBlb2YgaD9oOnZvaWQgMCxiPSgoZSx0KT0+dD9lPyJvcnQtd2FzbS1zaW1kLXRocmVhZGVkLndhc20iOiJvcnQtd2FzbS10aHJlYWRlZC53YXNtIjplPyJvcnQtd2FzbS1zaW1kLndhc20iOiJvcnQtd2FzbS53YXNtIikoZixpKSxtPSJvYmplY3QiPT10eXBlb2YgaD9oW2JdOnZvaWQgMDtsZXQgeT0hMTtjb25zdCB2PVtdO2lmKHQ+MCYmdi5wdXNoKG5ldyBQcm9taXNlKChlPT57c2V0VGltZW91dCgoKCk9Pnt5PSEwLGUoKTt9KSx0KTt9KSkpLHYucHVzaChuZXcgUHJvbWlzZSgoKGUsdCk9Pntjb25zdCByPWk/dTphLG89e2xvY2F0ZUZpbGU6KGUsdCk9PmkmJmUuZW5kc1dpdGgoIi53b3JrZXIuanMiKSYmInVuZGVmaW5lZCIhPXR5cGVvZiBCbG9iP1VSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW24oNDE1NCldLHt0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSkpOmUuZW5kc1dpdGgoIi53YXNtIik/bXx8KG51bGwhPWc/Zzp0KStiOnQrZX07aWYoaSlpZigidW5kZWZpbmVkIj09dHlwZW9mIEJsb2Ipby5tYWluU2NyaXB0VXJsT3JCbG9iPXMuam9pbihfX2Rpcm5hbWUsIm9ydC13YXNtLXRocmVhZGVkLmpzIik7ZWxzZSB7Y29uc3QgZT1gdmFyIG9ydFdhc21UaHJlYWRlZD0oZnVuY3Rpb24oKXt2YXIgX3NjcmlwdERpcjtyZXR1cm4gJHtyLnRvU3RyaW5nKCl9fSkoKTtgO28ubWFpblNjcmlwdFVybE9yQmxvYj1uZXcgQmxvYihbZV0se3R5cGU6InRleHQvamF2YXNjcmlwdCJ9KTt9cihvKS50aGVuKCh0PT57cD0hMSxjPSEwLGw9dCxlKCk7fSksKGU9PntwPSExLGQ9ITAsdChlKTt9KSk7fSkpKSxhd2FpdCBQcm9taXNlLnJhY2UodikseSl0aHJvdyBuZXcgRXJyb3IoYFdlYkFzc2VtYmx5IGJhY2tlbmQgaW5pdGlhbGl6aW5nIGZhaWxlZCBkdWUgdG8gdGltZW91dDogJHt0fW1zYCl9LHQuZ2V0SW5zdGFuY2U9KCk9PntpZihjJiZsKXJldHVybiBsO3Rocm93IG5ldyBFcnJvcigiV2ViQXNzZW1ibHkgaXMgbm90IGluaXRpYWxpemVkIHlldC4iKX0sdC5kaXNwb3NlPSgpPT57dmFyIGU7IWN8fHB8fGR8fChwPSEwLG51bGw9PT0oZT1sLlBUaHJlYWQpfHx2b2lkIDA9PT1lfHxlLnRlcm1pbmF0ZUFsbFRocmVhZHMoKSxsPXZvaWQgMCxwPSExLGM9ITEsZD0hMCk7fTt9LDE0OTc6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmNoZWNrTGFzdEVycm9yPXQuaXRlcmF0ZUV4dHJhT3B0aW9ucz10LmFsbG9jV2FzbVN0cmluZz12b2lkIDA7Y29uc3Qgcj1uKDI2Myk7dC5hbGxvY1dhc21TdHJpbmc9KGUsdCk9Pntjb25zdCBuPSgwLCByLmdldEluc3RhbmNlKSgpLG89bi5sZW5ndGhCeXRlc1VURjgoZSkrMSxpPW4uX21hbGxvYyhvKTtyZXR1cm4gbi5zdHJpbmdUb1VURjgoZSxpLG8pLHQucHVzaChpKSxpfSx0Lml0ZXJhdGVFeHRyYU9wdGlvbnM9KGUsbixyLG8pPT57aWYoIm9iamVjdCI9PXR5cGVvZiBlJiZudWxsIT09ZSl7aWYoci5oYXMoZSkpdGhyb3cgbmV3IEVycm9yKCJDaXJjdWxhciByZWZlcmVuY2UgaW4gb3B0aW9ucyIpO3IuYWRkKGUpO31PYmplY3QuZW50cmllcyhlKS5mb3JFYWNoKCgoW2UsaV0pPT57Y29uc3Qgcz1uP24rZTplO2lmKCJvYmplY3QiPT10eXBlb2YgaSkoMCwgdC5pdGVyYXRlRXh0cmFPcHRpb25zKShpLHMrIi4iLHIsbyk7ZWxzZSBpZigic3RyaW5nIj09dHlwZW9mIGl8fCJudW1iZXIiPT10eXBlb2YgaSlvKHMsaS50b1N0cmluZygpKTtlbHNlIHtpZigiYm9vbGVhbiIhPXR5cGVvZiBpKXRocm93IG5ldyBFcnJvcigiQ2FuJ3QgaGFuZGxlIGV4dHJhIGNvbmZpZyB0eXBlOiAiK3R5cGVvZiBpKTtvKHMsaT8iMSI6IjAiKTt9fSkpO30sdC5jaGVja0xhc3RFcnJvcj1lPT57Y29uc3QgdD0oMCwgci5nZXRJbnN0YW5jZSkoKSxuPXQuc3RhY2tTYXZlKCk7dHJ5e2NvbnN0IG49dC5zdGFja0FsbG9jKDgpO3QuX09ydEdldExhc3RFcnJvcihuLG4rNCk7Y29uc3Qgcj10LkhFQVAzMltuLzRdLG89dC5IRUFQVTMyW24vNCsxXSxpPW8/dC5VVEY4VG9TdHJpbmcobyk6IiI7dGhyb3cgbmV3IEVycm9yKGAke2V9IEVSUk9SX0NPREU6ICR7cn0sIEVSUk9SX01FU1NBR0U6ICR7aX1gKX1maW5hbGx5e3Quc3RhY2tSZXN0b3JlKG4pO319O30sODA1MDooZSx0LG4pPT57bi5kKHQse1o6KCk9Pml9KTt2YXIgcj1uKDY2MTQpLG89bi5uKHIpO2Z1bmN0aW9uIGkoKXtyZXR1cm4gbygpKCcvKiFcbiogT05OWCBSdW50aW1lIFdlYiB2MS4xNi4zXG4qIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXG4qL1xuKCgpPT57dmFyIGU9ezkxODooZSx0LHIpPT57InVzZSBzdHJpY3QiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnNldFJ1bk9wdGlvbnM9dm9pZCAwO2NvbnN0IG49cigyNjMpLGE9cig0OTcpO3Quc2V0UnVuT3B0aW9ucz1lPT57Y29uc3QgdD0oMCxuLmdldEluc3RhbmNlKSgpO2xldCByPTA7Y29uc3Qgbz1bXSxpPWV8fHt9O3RyeXtpZih2b2lkIDA9PT0obnVsbD09ZT92b2lkIDA6ZS5sb2dTZXZlcml0eUxldmVsKSlpLmxvZ1NldmVyaXR5TGV2ZWw9MjtlbHNlIGlmKCJudW1iZXIiIT10eXBlb2YgZS5sb2dTZXZlcml0eUxldmVsfHwhTnVtYmVyLmlzSW50ZWdlcihlLmxvZ1NldmVyaXR5TGV2ZWwpfHxlLmxvZ1NldmVyaXR5TGV2ZWw8MHx8ZS5sb2dTZXZlcml0eUxldmVsPjQpdGhyb3cgbmV3IEVycm9yKGBsb2cgc2VydmVyaXR5IGxldmVsIGlzIG5vdCB2YWxpZDogJHtlLmxvZ1NldmVyaXR5TGV2ZWx9YCk7aWYodm9pZCAwPT09KG51bGw9PWU/dm9pZCAwOmUubG9nVmVyYm9zaXR5TGV2ZWwpKWkubG9nVmVyYm9zaXR5TGV2ZWw9MDtlbHNlIGlmKCJudW1iZXIiIT10eXBlb2YgZS5sb2dWZXJib3NpdHlMZXZlbHx8IU51bWJlci5pc0ludGVnZXIoZS5sb2dWZXJib3NpdHlMZXZlbCkpdGhyb3cgbmV3IEVycm9yKGBsb2cgdmVyYm9zaXR5IGxldmVsIGlzIG5vdCB2YWxpZDogJHtlLmxvZ1ZlcmJvc2l0eUxldmVsfWApO3ZvaWQgMD09PShudWxsPT1lP3ZvaWQgMDplLnRlcm1pbmF0ZSkmJihpLnRlcm1pbmF0ZT0hMSk7bGV0IG49MDtyZXR1cm4gdm9pZCAwIT09KG51bGw9PWU/dm9pZCAwOmUudGFnKSYmKG49KDAsYS5hbGxvY1dhc21TdHJpbmcpKGUudGFnLG8pKSxyPXQuX09ydENyZWF0ZVJ1bk9wdGlvbnMoaS5sb2dTZXZlcml0eUxldmVsLGkubG9nVmVyYm9zaXR5TGV2ZWwsISFpLnRlcm1pbmF0ZSxuKSwwPT09ciYmKDAsYS5jaGVja0xhc3RFcnJvcikoIkNhblwndCBjcmVhdGUgcnVuIG9wdGlvbnMuIiksdm9pZCAwIT09KG51bGw9PWU/dm9pZCAwOmUuZXh0cmEpJiYoMCxhLml0ZXJhdGVFeHRyYU9wdGlvbnMpKGUuZXh0cmEsIiIsbmV3IFdlYWtTZXQsKChlLG4pPT57Y29uc3QgaT0oMCxhLmFsbG9jV2FzbVN0cmluZykoZSxvKSxzPSgwLGEuYWxsb2NXYXNtU3RyaW5nKShuLG8pOzAhPT10Ll9PcnRBZGRSdW5Db25maWdFbnRyeShyLGkscykmJigwLGEuY2hlY2tMYXN0RXJyb3IpKGBDYW5cJ3Qgc2V0IGEgcnVuIGNvbmZpZyBlbnRyeTogJHtlfSAtICR7bn0uYCl9KSksW3Isb119Y2F0Y2goZSl7dGhyb3cgMCE9PXImJnQuX09ydFJlbGVhc2VSdW5PcHRpb25zKHIpLG8uZm9yRWFjaCgoZT0+dC5fZnJlZShlKSkpLGV9fX0sNjIyOihlLHQscik9PnsidXNlIHN0cmljdCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuc2V0U2Vzc2lvbk9wdGlvbnM9dm9pZCAwO2NvbnN0IG49cigyNjMpLGE9cig0OTcpO3Quc2V0U2Vzc2lvbk9wdGlvbnM9ZT0+e3ZhciB0LHIsbyxpO2NvbnN0IHM9KDAsbi5nZXRJbnN0YW5jZSkoKTtsZXQgdT0wO2NvbnN0IGM9W10sbD1lfHx7fTsoZT0+e2UuZXh0cmF8fChlLmV4dHJhPXt9KSxlLmV4dHJhLnNlc3Npb258fChlLmV4dHJhLnNlc3Npb249e30pO2NvbnN0IHQ9ZS5leHRyYS5zZXNzaW9uO3QudXNlX29ydF9tb2RlbF9ieXRlc19kaXJlY3RseXx8KHQudXNlX29ydF9tb2RlbF9ieXRlc19kaXJlY3RseT0iMSIpLGUuZXhlY3V0aW9uUHJvdmlkZXJzJiZlLmV4ZWN1dGlvblByb3ZpZGVycy5zb21lKChlPT4id2ViZ3B1Ij09PSgic3RyaW5nIj09dHlwZW9mIGU/ZTplLm5hbWUpKSkmJihlLmVuYWJsZU1lbVBhdHRlcm49ITEpfSkobCk7dHJ5e2NvbnN0IGU9KGU9Pntzd2l0Y2goZSl7Y2FzZSJkaXNhYmxlZCI6cmV0dXJuIDA7Y2FzZSJiYXNpYyI6cmV0dXJuIDE7Y2FzZSJleHRlbmRlZCI6cmV0dXJuIDI7Y2FzZSJhbGwiOnJldHVybiA5OTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgZ3JhcGggb3B0aW1pemF0aW9uIGxldmVsOiAke2V9YCl9fSkobnVsbCE9PSh0PWwuZ3JhcGhPcHRpbWl6YXRpb25MZXZlbCkmJnZvaWQgMCE9PXQ/dDoiYWxsIiksZj0oZT0+e3N3aXRjaChlKXtjYXNlInNlcXVlbnRpYWwiOnJldHVybiAwO2Nhc2UicGFyYWxsZWwiOnJldHVybiAxO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBleGVjdXRpb24gbW9kZTogJHtlfWApfX0pKG51bGwhPT0ocj1sLmV4ZWN1dGlvbk1vZGUpJiZ2b2lkIDAhPT1yP3I6InNlcXVlbnRpYWwiKSxkPSJzdHJpbmciPT10eXBlb2YgbC5sb2dJZD8oMCxhLmFsbG9jV2FzbVN0cmluZykobC5sb2dJZCxjKTowLHA9bnVsbCE9PShvPWwubG9nU2V2ZXJpdHlMZXZlbCkmJnZvaWQgMCE9PW8/bzoyO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKHApfHxwPDB8fHA+NCl0aHJvdyBuZXcgRXJyb3IoYGxvZyBzZXJ2ZXJpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke3B9YCk7Y29uc3QgZz1udWxsIT09KGk9bC5sb2dWZXJib3NpdHlMZXZlbCkmJnZvaWQgMCE9PWk/aTowO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKGcpfHxnPDB8fGc+NCl0aHJvdyBuZXcgRXJyb3IoYGxvZyB2ZXJib3NpdHkgbGV2ZWwgaXMgbm90IHZhbGlkOiAke2d9YCk7Y29uc3QgaD0ic3RyaW5nIj09dHlwZW9mIGwub3B0aW1pemVkTW9kZWxGaWxlUGF0aD8oMCxhLmFsbG9jV2FzbVN0cmluZykobC5vcHRpbWl6ZWRNb2RlbEZpbGVQYXRoLGMpOjA7cmV0dXJuIHU9cy5fT3J0Q3JlYXRlU2Vzc2lvbk9wdGlvbnMoZSwhIWwuZW5hYmxlQ3B1TWVtQXJlbmEsISFsLmVuYWJsZU1lbVBhdHRlcm4sZiwhIWwuZW5hYmxlUHJvZmlsaW5nLDAsZCxwLGcsaCksMD09PXUmJigwLGEuY2hlY2tMYXN0RXJyb3IpKCJDYW5cJ3QgY3JlYXRlIHNlc3Npb24gb3B0aW9ucy4iKSxsLmV4ZWN1dGlvblByb3ZpZGVycyYmKChlLHQscik9Pntmb3IoY29uc3QgbyBvZiB0KXtsZXQgdD0ic3RyaW5nIj09dHlwZW9mIG8/bzpvLm5hbWU7c3dpdGNoKHQpe2Nhc2UieG5ucGFjayI6dD0iWE5OUEFDSyI7YnJlYWs7Y2FzZSJ3ZWJubiI6aWYodD0iV0VCTk4iLCJzdHJpbmciIT10eXBlb2Ygbyl7Y29uc3QgdD1vO2lmKG51bGw9PXQ/dm9pZCAwOnQuZGV2aWNlVHlwZSl7Y29uc3Qgbz0oMCxhLmFsbG9jV2FzbVN0cmluZykoImRldmljZVR5cGUiLHIpLGk9KDAsYS5hbGxvY1dhc21TdHJpbmcpKHQuZGV2aWNlVHlwZSxyKTswIT09KDAsbi5nZXRJbnN0YW5jZSkoKS5fT3J0QWRkU2Vzc2lvbkNvbmZpZ0VudHJ5KGUsbyxpKSYmKDAsYS5jaGVja0xhc3RFcnJvcikoYENhblwndCBzZXQgYSBzZXNzaW9uIGNvbmZpZyBlbnRyeTogXCdkZXZpY2VUeXBlXCcgLSAke3QuZGV2aWNlVHlwZX0uYCl9aWYobnVsbD09dD92b2lkIDA6dC5wb3dlclByZWZlcmVuY2Upe2NvbnN0IG89KDAsYS5hbGxvY1dhc21TdHJpbmcpKCJwb3dlclByZWZlcmVuY2UiLHIpLGk9KDAsYS5hbGxvY1dhc21TdHJpbmcpKHQucG93ZXJQcmVmZXJlbmNlLHIpOzAhPT0oMCxuLmdldEluc3RhbmNlKSgpLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnkoZSxvLGkpJiYoMCxhLmNoZWNrTGFzdEVycm9yKShgQ2FuXCd0IHNldCBhIHNlc3Npb24gY29uZmlnIGVudHJ5OiBcJ3Bvd2VyUHJlZmVyZW5jZVwnIC0gJHt0LnBvd2VyUHJlZmVyZW5jZX0uYCl9fWJyZWFrO2Nhc2Uid2ViZ3B1Ijp0PSJKUyI7YnJlYWs7Y2FzZSJ3YXNtIjpjYXNlImNwdSI6Y29udGludWU7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYG5vdCBzdXBwb3J0ZWQgZXhlY3V0aW9uIHByb3ZpZGVyOiAke3R9YCl9Y29uc3QgaT0oMCxhLmFsbG9jV2FzbVN0cmluZykodCxyKTswIT09KDAsbi5nZXRJbnN0YW5jZSkoKS5fT3J0QXBwZW5kRXhlY3V0aW9uUHJvdmlkZXIoZSxpKSYmKDAsYS5jaGVja0xhc3RFcnJvcikoYENhblwndCBhcHBlbmQgZXhlY3V0aW9uIHByb3ZpZGVyOiAke3R9LmApfX0pKHUsbC5leGVjdXRpb25Qcm92aWRlcnMsYyksdm9pZCAwIT09bC5leHRyYSYmKDAsYS5pdGVyYXRlRXh0cmFPcHRpb25zKShsLmV4dHJhLCIiLG5ldyBXZWFrU2V0LCgoZSx0KT0+e2NvbnN0IHI9KDAsYS5hbGxvY1dhc21TdHJpbmcpKGUsYyksbj0oMCxhLmFsbG9jV2FzbVN0cmluZykodCxjKTswIT09cy5fT3J0QWRkU2Vzc2lvbkNvbmZpZ0VudHJ5KHUscixuKSYmKDAsYS5jaGVja0xhc3RFcnJvcikoYENhblwndCBzZXQgYSBzZXNzaW9uIGNvbmZpZyBlbnRyeTogJHtlfSAtICR7dH0uYCl9KSksW3UsY119Y2F0Y2goZSl7dGhyb3cgMCE9PXUmJnMuX09ydFJlbGVhc2VTZXNzaW9uT3B0aW9ucyh1KSxjLmZvckVhY2goKGU9PnMuX2ZyZWUoZSkpKSxlfX19LDkxNzooZSx0KT0+eyJ1c2Ugc3RyaWN0IjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5sb2dMZXZlbFN0cmluZ1RvRW51bT10LnRlbnNvclR5cGVUb1R5cGVkQXJyYXlDb25zdHJ1Y3Rvcj10LmdldFRlbnNvckVsZW1lbnRTaXplPXQudGVuc29yRGF0YVR5cGVFbnVtVG9TdHJpbmc9dC50ZW5zb3JEYXRhVHlwZVN0cmluZ1RvRW51bT12b2lkIDAsdC50ZW5zb3JEYXRhVHlwZVN0cmluZ1RvRW51bT1lPT57c3dpdGNoKGUpe2Nhc2UiaW50OCI6cmV0dXJuIDM7Y2FzZSJ1aW50OCI6cmV0dXJuIDI7Y2FzZSJib29sIjpyZXR1cm4gOTtjYXNlImludDE2IjpyZXR1cm4gNTtjYXNlInVpbnQxNiI6cmV0dXJuIDQ7Y2FzZSJpbnQzMiI6cmV0dXJuIDY7Y2FzZSJ1aW50MzIiOnJldHVybiAxMjtjYXNlImZsb2F0MTYiOnJldHVybiAxMDtjYXNlImZsb2F0MzIiOnJldHVybiAxO2Nhc2UiZmxvYXQ2NCI6cmV0dXJuIDExO2Nhc2Uic3RyaW5nIjpyZXR1cm4gODtjYXNlImludDY0IjpyZXR1cm4gNztjYXNlInVpbnQ2NCI6cmV0dXJuIDEzO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICR7ZX1gKX19LHQudGVuc29yRGF0YVR5cGVFbnVtVG9TdHJpbmc9ZT0+e3N3aXRjaChlKXtjYXNlIDM6cmV0dXJuImludDgiO2Nhc2UgMjpyZXR1cm4idWludDgiO2Nhc2UgOTpyZXR1cm4iYm9vbCI7Y2FzZSA1OnJldHVybiJpbnQxNiI7Y2FzZSA0OnJldHVybiJ1aW50MTYiO2Nhc2UgNjpyZXR1cm4iaW50MzIiO2Nhc2UgMTI6cmV0dXJuInVpbnQzMiI7Y2FzZSAxMDpyZXR1cm4iZmxvYXQxNiI7Y2FzZSAxOnJldHVybiJmbG9hdDMyIjtjYXNlIDExOnJldHVybiJmbG9hdDY0IjtjYXNlIDg6cmV0dXJuInN0cmluZyI7Y2FzZSA3OnJldHVybiJpbnQ2NCI7Y2FzZSAxMzpyZXR1cm4idWludDY0IjtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgZGF0YSB0eXBlOiAke2V9YCl9fSx0LmdldFRlbnNvckVsZW1lbnRTaXplPWU9Plt2b2lkIDAsNCwxLDEsMiwyLDQsOCx2b2lkIDAsMSwyLDgsNCw4LHZvaWQgMCx2b2lkIDAsdm9pZCAwXVtlXSx0LnRlbnNvclR5cGVUb1R5cGVkQXJyYXlDb25zdHJ1Y3Rvcj1lPT57c3dpdGNoKGUpe2Nhc2UiZmxvYXQxNiI6Y2FzZSJ1aW50MTYiOnJldHVybiBVaW50MTZBcnJheTtjYXNlImZsb2F0MzIiOnJldHVybiBGbG9hdDMyQXJyYXk7Y2FzZSJ1aW50OCI6Y2FzZSJib29sIjpyZXR1cm4gVWludDhBcnJheTtjYXNlImludDgiOnJldHVybiBJbnQ4QXJyYXk7Y2FzZSJpbnQxNiI6cmV0dXJuIEludDE2QXJyYXk7Y2FzZSJpbnQzMiI6cmV0dXJuIEludDMyQXJyYXk7Y2FzZSJmbG9hdDY0IjpyZXR1cm4gRmxvYXQ2NEFycmF5O2Nhc2UidWludDMyIjpyZXR1cm4gVWludDMyQXJyYXk7Y2FzZSJpbnQ2NCI6cmV0dXJuIEJpZ0ludDY0QXJyYXk7Y2FzZSJ1aW50NjQiOnJldHVybiBCaWdVaW50NjRBcnJheTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihgdW5zdXBwb3J0ZWQgdHlwZTogJHtlfWApfX0sdC5sb2dMZXZlbFN0cmluZ1RvRW51bT1lPT57c3dpdGNoKGUpe2Nhc2UidmVyYm9zZSI6cmV0dXJuIDA7Y2FzZSJpbmZvIjpyZXR1cm4gMTtjYXNlIndhcm5pbmciOnJldHVybiAyO2Nhc2UiZXJyb3IiOnJldHVybiAzO2Nhc2UiZmF0YWwiOnJldHVybiA0O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBsb2dnaW5nIGxldmVsOiAke2V9YCl9fX0sMjU5OihlLHQscik9PnsidXNlIHN0cmljdCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZXh0cmFjdFRyYW5zZmVyYWJsZUJ1ZmZlcnM9dC5lbmRQcm9maWxpbmc9dC5ydW49dC5yZWxlYXNlU2Vzc2lvbj10LmNyZWF0ZVNlc3Npb249dC5jcmVhdGVTZXNzaW9uRmluYWxpemU9dC5jcmVhdGVTZXNzaW9uQWxsb2NhdGU9dC5pbml0UnVudGltZT12b2lkIDA7Y29uc3Qgbj1yKDkxOCksYT1yKDYyMiksbz1yKDkxNyksaT1yKDI2Mykscz1yKDQ5Nyk7dC5pbml0UnVudGltZT1hc3luYyBlPT57dmFyIHQscjt0PWUud2FzbS5udW1UaHJlYWRzLHI9KDAsby5sb2dMZXZlbFN0cmluZ1RvRW51bSkoZS5sb2dMZXZlbCksMCE9PSgwLGkuZ2V0SW5zdGFuY2UpKCkuX09ydEluaXQodCxyKSYmKDAscy5jaGVja0xhc3RFcnJvcikoIkNhblwndCBpbml0aWFsaXplIG9ubnhydW50aW1lLiIpfTtjb25zdCB1PW5ldyBNYXA7dC5jcmVhdGVTZXNzaW9uQWxsb2NhdGU9ZT0+e2NvbnN0IHQ9KDAsaS5nZXRJbnN0YW5jZSkoKSxyPXQuX21hbGxvYyhlLmJ5dGVMZW5ndGgpO2lmKDA9PT1yKXRocm93IG5ldyBFcnJvcihgQ2FuXCd0IGNyZWF0ZSBhIHNlc3Npb24uIGZhaWxlZCB0byBhbGxvY2F0ZSBhIGJ1ZmZlciBvZiBzaXplICR7ZS5ieXRlTGVuZ3RofS5gKTtyZXR1cm4gdC5IRUFQVTguc2V0KGUsciksW3IsZS5ieXRlTGVuZ3RoXX0sdC5jcmVhdGVTZXNzaW9uRmluYWxpemU9KGUsdCk9Pntjb25zdCByPSgwLGkuZ2V0SW5zdGFuY2UpKCk7bGV0IG49MCxvPTAsYz1bXTtjb25zdCBsPVtdLGY9W107dHJ5e1tvLGNdPSgwLGEuc2V0U2Vzc2lvbk9wdGlvbnMpKHQpLG49ci5fT3J0Q3JlYXRlU2Vzc2lvbihlWzBdLGVbMV0sbyksMD09PW4mJigwLHMuY2hlY2tMYXN0RXJyb3IpKCJDYW5cJ3QgY3JlYXRlIGEgc2Vzc2lvbi4iKTtjb25zdFtkLHBdPShlPT57Y29uc3QgdD0oMCxpLmdldEluc3RhbmNlKSgpLHI9dC5zdGFja1NhdmUoKTt0cnl7Y29uc3Qgcj10LnN0YWNrQWxsb2MoOCk7cmV0dXJuIDAhPT10Ll9PcnRHZXRJbnB1dE91dHB1dENvdW50KGUscixyKzQpJiYoMCxzLmNoZWNrTGFzdEVycm9yKSgiQ2FuXCd0IGdldCBzZXNzaW9uIGlucHV0L291dHB1dCBjb3VudC4iKSxbdC5IRUFQMzJbci80XSx0LkhFQVAzMltyLzQrMV1dfWZpbmFsbHl7dC5zdGFja1Jlc3RvcmUocil9fSkobiksZz1bXSxoPVtdO2ZvcihsZXQgZT0wO2U8ZDtlKyspe2NvbnN0IHQ9ci5fT3J0R2V0SW5wdXROYW1lKG4sZSk7MD09PXQmJigwLHMuY2hlY2tMYXN0RXJyb3IpKCJDYW5cJ3QgZ2V0IGFuIGlucHV0IG5hbWUuIiksbC5wdXNoKHQpLGcucHVzaChyLlVURjhUb1N0cmluZyh0KSl9Zm9yKGxldCBlPTA7ZTxwO2UrKyl7Y29uc3QgdD1yLl9PcnRHZXRPdXRwdXROYW1lKG4sZSk7MD09PXQmJigwLHMuY2hlY2tMYXN0RXJyb3IpKCJDYW5cJ3QgZ2V0IGFuIG91dHB1dCBuYW1lLiIpLGYucHVzaCh0KSxoLnB1c2goci5VVEY4VG9TdHJpbmcodCkpfXJldHVybiB1LnNldChuLFtuLGwsZl0pLFtuLGcsaF19Y2F0Y2goZSl7dGhyb3cgbC5mb3JFYWNoKChlPT5yLl9PcnRGcmVlKGUpKSksZi5mb3JFYWNoKChlPT5yLl9PcnRGcmVlKGUpKSksMCE9PW4mJnIuX09ydFJlbGVhc2VTZXNzaW9uKG4pLGV9ZmluYWxseXtyLl9mcmVlKGVbMF0pLDAhPT1vJiZyLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnMobyksYy5mb3JFYWNoKChlPT5yLl9mcmVlKGUpKSl9fSx0LmNyZWF0ZVNlc3Npb249KGUscik9Pntjb25zdCBuPSgwLHQuY3JlYXRlU2Vzc2lvbkFsbG9jYXRlKShlKTtyZXR1cm4oMCx0LmNyZWF0ZVNlc3Npb25GaW5hbGl6ZSkobixyKX0sdC5yZWxlYXNlU2Vzc2lvbj1lPT57Y29uc3QgdD0oMCxpLmdldEluc3RhbmNlKSgpLHI9dS5nZXQoZSk7aWYoIXIpdGhyb3cgbmV3IEVycm9yKGBjYW5ub3QgcmVsZWFzZSBzZXNzaW9uLiBpbnZhbGlkIHNlc3Npb24gaWQ6ICR7ZX1gKTtjb25zdFtuLGEsb109cjthLmZvckVhY2goKGU9PnQuX09ydEZyZWUoZSkpKSxvLmZvckVhY2goKGU9PnQuX09ydEZyZWUoZSkpKSx0Ll9PcnRSZWxlYXNlU2Vzc2lvbihuKSx1LmRlbGV0ZShlKX0sdC5ydW49YXN5bmMoZSx0LHIsYSxjKT0+e2NvbnN0IGw9KDAsaS5nZXRJbnN0YW5jZSkoKSxmPXUuZ2V0KGUpO2lmKCFmKXRocm93IG5ldyBFcnJvcihgY2Fubm90IHJ1biBpbmZlcmVuY2UuIGludmFsaWQgc2Vzc2lvbiBpZDogJHtlfWApO2NvbnN0W2QscCxnXT1mLGg9dC5sZW5ndGgsbT1hLmxlbmd0aDtsZXQgeT0wLHY9W107Y29uc3QgYj1bXSx3PVtdO3RyeXtbeSx2XT0oMCxuLnNldFJ1bk9wdGlvbnMpKGMpO2ZvcihsZXQgZT0wO2U8aDtlKyspe2NvbnN0IHQ9cltlXVswXSxuPXJbZV1bMV0sYT1yW2VdWzJdO2xldCBpLHU7aWYoQXJyYXkuaXNBcnJheShhKSl7dT00KmEubGVuZ3RoLGk9bC5fbWFsbG9jKHUpLHcucHVzaChpKTtsZXQgZT1pLzQ7Zm9yKGxldCB0PTA7dDxhLmxlbmd0aDt0Kyspe2lmKCJzdHJpbmciIT10eXBlb2YgYVt0XSl0aHJvdyBuZXcgVHlwZUVycm9yKGB0ZW5zb3IgZGF0YSBhdCBpbmRleCAke3R9IGlzIG5vdCBhIHN0cmluZ2ApO2wuSEVBUFUzMltlKytdPSgwLHMuYWxsb2NXYXNtU3RyaW5nKShhW3RdLHcpfX1lbHNlIHU9YS5ieXRlTGVuZ3RoLGk9bC5fbWFsbG9jKHUpLHcucHVzaChpKSxsLkhFQVBVOC5zZXQobmV3IFVpbnQ4QXJyYXkoYS5idWZmZXIsYS5ieXRlT2Zmc2V0LHUpLGkpO2NvbnN0IGM9bC5zdGFja1NhdmUoKSxmPWwuc3RhY2tBbGxvYyg0Km4ubGVuZ3RoKTt0cnl7bGV0IHI9Zi80O24uZm9yRWFjaCgoZT0+bC5IRUFQMzJbcisrXT1lKSk7Y29uc3QgYT1sLl9PcnRDcmVhdGVUZW5zb3IoKDAsby50ZW5zb3JEYXRhVHlwZVN0cmluZ1RvRW51bSkodCksaSx1LGYsbi5sZW5ndGgpOzA9PT1hJiYoMCxzLmNoZWNrTGFzdEVycm9yKShgQ2FuXCd0IGNyZWF0ZSB0ZW5zb3IgZm9yIGlucHV0WyR7ZX1dLmApLGIucHVzaChhKX1maW5hbGx5e2wuc3RhY2tSZXN0b3JlKGMpfX1jb25zdCBlPWwuc3RhY2tTYXZlKCksaT1sLnN0YWNrQWxsb2MoNCpoKSx1PWwuc3RhY2tBbGxvYyg0KmgpLGY9bC5zdGFja0FsbG9jKDQqbSksXz1sLnN0YWNrQWxsb2MoNCptKTt0cnl7bGV0IGU9aS80LHI9dS80LG49Zi80LGM9Xy80O2ZvcihsZXQgbj0wO248aDtuKyspbC5IRUFQVTMyW2UrK109YltuXSxsLkhFQVBVMzJbcisrXT1wW3Rbbl1dO2ZvcihsZXQgZT0wO2U8bTtlKyspbC5IRUFQVTMyW24rK109MCxsLkhFQVBVMzJbYysrXT1nW2FbZV1dO2xldCB2PWwuX09ydFJ1bihkLHUsaSxoLF8sbSxmLHkpO2NvbnN0IHc9bC5qc2VwUnVuUHJvbWlzZTt3JiZ2b2lkIDAhPT13LnRoZW4mJih2PWF3YWl0IHcpO2NvbnN0IE89W107MCE9PXYmJigwLHMuY2hlY2tMYXN0RXJyb3IpKCJmYWlsZWQgdG8gY2FsbCBPcnRSdW4oKS4iKTtmb3IobGV0IGU9MDtlPG07ZSsrKXtjb25zdCB0PWwuSEVBUFUzMltmLzQrZV0scj1sLnN0YWNrU2F2ZSgpLG49bC5zdGFja0FsbG9jKDE2KTtsZXQgYSxpPTA7dHJ5e3Y9bC5fT3J0R2V0VGVuc29yRGF0YSh0LG4sbis0LG4rOCxuKzEyKSwwIT09diYmKDAscy5jaGVja0xhc3RFcnJvcikoYENhblwndCBhY2Nlc3Mgb3V0cHV0IHRlbnNvciBkYXRhIG9uIGluZGV4ICR7ZX0uYCk7bGV0IHI9bi80O2NvbnN0IHU9bC5IRUFQVTMyW3IrK107aT1sLkhFQVBVMzJbcisrXTtjb25zdCBjPWwuSEVBUFUzMltyKytdLGY9bC5IRUFQVTMyW3IrK10sZD1bXTtmb3IobGV0IGU9MDtlPGY7ZSsrKWQucHVzaChsLkhFQVBVMzJbYy80K2VdKTtsLl9PcnRGcmVlKGMpO2NvbnN0IHA9MD09PWQubGVuZ3RoPzE6ZC5yZWR1Y2UoKChlLHQpPT5lKnQpKTtpZihhPSgwLG8udGVuc29yRGF0YVR5cGVFbnVtVG9TdHJpbmcpKHUpLCJzdHJpbmciPT09YSl7Y29uc3QgZT1bXTtsZXQgdD1pLzQ7Zm9yKGxldCByPTA7cjxwO3IrKyl7Y29uc3Qgbj1sLkhFQVBVMzJbdCsrXSxhPXI9PT1wLTE/dm9pZCAwOmwuSEVBUFUzMlt0XS1uO2UucHVzaChsLlVURjhUb1N0cmluZyhuLGEpKX1PLnB1c2goW2EsZCxlXSl9ZWxzZXtjb25zdCBlPW5ldygoMCxvLnRlbnNvclR5cGVUb1R5cGVkQXJyYXlDb25zdHJ1Y3RvcikoYSkpKHApO25ldyBVaW50OEFycmF5KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCxlLmJ5dGVMZW5ndGgpLnNldChsLkhFQVBVOC5zdWJhcnJheShpLGkrZS5ieXRlTGVuZ3RoKSksTy5wdXNoKFthLGQsZV0pfX1maW5hbGx5e2wuc3RhY2tSZXN0b3JlKHIpLCJzdHJpbmciPT09YSYmaSYmbC5fZnJlZShpKSxsLl9PcnRSZWxlYXNlVGVuc29yKHQpfX1yZXR1cm4gT31maW5hbGx5e2wuc3RhY2tSZXN0b3JlKGUpfX1maW5hbGx5e2IuZm9yRWFjaCgoZT0+bC5fT3J0UmVsZWFzZVRlbnNvcihlKSkpLHcuZm9yRWFjaCgoZT0+bC5fZnJlZShlKSkpLDAhPT15JiZsLl9PcnRSZWxlYXNlUnVuT3B0aW9ucyh5KSx2LmZvckVhY2goKGU9PmwuX2ZyZWUoZSkpKX19LHQuZW5kUHJvZmlsaW5nPWU9Pntjb25zdCB0PSgwLGkuZ2V0SW5zdGFuY2UpKCkscj11LmdldChlKTtpZighcil0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgc2Vzc2lvbiBpZCIpO2NvbnN0IG49clswXSxhPXQuX09ydEVuZFByb2ZpbGluZyhuKTswPT09YSYmKDAscy5jaGVja0xhc3RFcnJvcikoIkNhblwndCBnZXQgYW4gcHJvZmlsZSBmaWxlIG5hbWUuIiksdC5fT3J0RnJlZShhKX0sdC5leHRyYWN0VHJhbnNmZXJhYmxlQnVmZmVycz1lPT57Y29uc3QgdD1bXTtmb3IoY29uc3QgciBvZiBlKXtjb25zdCBlPXJbMl07IUFycmF5LmlzQXJyYXkoZSkmJmUuYnVmZmVyJiZ0LnB1c2goZS5idWZmZXIpfXJldHVybiB0fX0sMjYzOmZ1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCxyLG4pe3ZvaWQgMD09PW4mJihuPXIpO3ZhciBhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxyKTthJiYhKCJnZXQiaW4gYT8hdC5fX2VzTW9kdWxlOmEud3JpdGFibGV8fGEuY29uZmlndXJhYmxlKXx8KGE9e2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRbcl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsbixhKX06ZnVuY3Rpb24oZSx0LHIsbil7dm9pZCAwPT09biYmKG49ciksZVtuXT10W3JdfSksYT10aGlzJiZ0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdHx8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24oZSx0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwiZGVmYXVsdCIse2VudW1lcmFibGU6ITAsdmFsdWU6dH0pfTpmdW5jdGlvbihlLHQpe2UuZGVmYXVsdD10fSksbz10aGlzJiZ0aGlzLl9faW1wb3J0U3Rhcnx8ZnVuY3Rpb24oZSl7aWYoZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciB0PXt9O2lmKG51bGwhPWUpZm9yKHZhciByIGluIGUpImRlZmF1bHQiIT09ciYmT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUscikmJm4odCxlLHIpO3JldHVybiBhKHQsZSksdH07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuZGlzcG9zZT10LmdldEluc3RhbmNlPXQuaW5pdGlhbGl6ZVdlYkFzc2VtYmx5PXZvaWQgMDtjb25zdCBpPW8ocig0NDkpKSxzPXIoOTMyKSx1PXIoNDc0KTtsZXQgYyxsPSExLGY9ITEsZD0hMTt0LmluaXRpYWxpemVXZWJBc3NlbWJseT1hc3luYyBlPT57aWYobClyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7aWYoZil0aHJvdyBuZXcgRXJyb3IoIm11bHRpcGxlIGNhbGxzIHRvIFwnaW5pdGlhbGl6ZVdlYkFzc2VtYmx5KClcJyBkZXRlY3RlZC4iKTtpZihkKXRocm93IG5ldyBFcnJvcigicHJldmlvdXMgY2FsbCB0byBcJ2luaXRpYWxpemVXZWJBc3NlbWJseSgpXCcgZmFpbGVkLiIpO2Y9ITA7Y29uc3QgdD1lLmluaXRUaW1lb3V0LG49ZS5udW1UaHJlYWRzLGE9ZS5zaW1kLG89bj4xJiYoKCk9Pnt0cnl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBTaGFyZWRBcnJheUJ1ZmZlciYmKCJ1bmRlZmluZWQiIT10eXBlb2YgTWVzc2FnZUNoYW5uZWwmJihuZXcgTWVzc2FnZUNoYW5uZWwpLnBvcnQxLnBvc3RNZXNzYWdlKG5ldyBTaGFyZWRBcnJheUJ1ZmZlcigxKSksV2ViQXNzZW1ibHkudmFsaWRhdGUobmV3IFVpbnQ4QXJyYXkoWzAsOTcsMTE1LDEwOSwxLDAsMCwwLDEsNCwxLDk2LDAsMCwzLDIsMSwwLDUsNCwxLDMsMSwxLDEwLDExLDEsOSwwLDY1LDAsMjU0LDE2LDIsMCwyNiwxMV0pKSl9Y2F0Y2goZSl7cmV0dXJuITF9fSkoKSxwPWEmJigoKT0+e3RyeXtyZXR1cm4gV2ViQXNzZW1ibHkudmFsaWRhdGUobmV3IFVpbnQ4QXJyYXkoWzAsOTcsMTE1LDEwOSwxLDAsMCwwLDEsNCwxLDk2LDAsMCwzLDIsMSwwLDEwLDMwLDEsMjgsMCw2NSwwLDI1MywxNSwyNTMsMTIsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNTMsMTg2LDEsMjYsMTFdKSl9Y2F0Y2goZSl7cmV0dXJuITF9fSkoKSxnPWUud2FzbVBhdGhzLGg9InN0cmluZyI9PXR5cGVvZiBnP2c6dm9pZCAwLG09KChlLHQpPT50P2U/Im9ydC13YXNtLXNpbWQtdGhyZWFkZWQud2FzbSI6Im9ydC13YXNtLXRocmVhZGVkLndhc20iOmU/Im9ydC13YXNtLXNpbWQud2FzbSI6Im9ydC13YXNtLndhc20iKShwLG8pLHk9Im9iamVjdCI9PXR5cGVvZiBnP2dbbV06dm9pZCAwO2xldCB2PSExO2NvbnN0IGI9W107aWYodD4wJiZiLnB1c2gobmV3IFByb21pc2UoKGU9PntzZXRUaW1lb3V0KCgoKT0+e3Y9ITAsZSgpfSksdCl9KSkpLGIucHVzaChuZXcgUHJvbWlzZSgoKGUsdCk9Pntjb25zdCBuPW8/dTpzLGE9e2xvY2F0ZUZpbGU6KGUsdCk9Pm8mJmUuZW5kc1dpdGgoIi53b3JrZXIuanMiKSYmInVuZGVmaW5lZCIhPXR5cGVvZiBCbG9iP1VSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3IoMTU0KV0se3R5cGU6InRleHQvamF2YXNjcmlwdCJ9KSk6ZS5lbmRzV2l0aCgiLndhc20iKT95fHwobnVsbCE9aD9oOnQpK206dCtlfTtpZihvKWlmKCJ1bmRlZmluZWQiPT10eXBlb2YgQmxvYilhLm1haW5TY3JpcHRVcmxPckJsb2I9aS5qb2luKF9fZGlybmFtZSwib3J0LXdhc20tdGhyZWFkZWQuanMiKTtlbHNle2NvbnN0IGU9YHZhciBvcnRXYXNtVGhyZWFkZWQ9KGZ1bmN0aW9uKCl7dmFyIF9zY3JpcHREaXI7cmV0dXJuICR7bi50b1N0cmluZygpfX0pKCk7YDthLm1haW5TY3JpcHRVcmxPckJsb2I9bmV3IEJsb2IoW2VdLHt0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSl9bihhKS50aGVuKCh0PT57Zj0hMSxsPSEwLGM9dCxlKCl9KSwoZT0+e2Y9ITEsZD0hMCx0KGUpfSkpfSkpKSxhd2FpdCBQcm9taXNlLnJhY2UoYiksdil0aHJvdyBuZXcgRXJyb3IoYFdlYkFzc2VtYmx5IGJhY2tlbmQgaW5pdGlhbGl6aW5nIGZhaWxlZCBkdWUgdG8gdGltZW91dDogJHt0fW1zYCl9LHQuZ2V0SW5zdGFuY2U9KCk9PntpZihsJiZjKXJldHVybiBjO3Rocm93IG5ldyBFcnJvcigiV2ViQXNzZW1ibHkgaXMgbm90IGluaXRpYWxpemVkIHlldC4iKX0sdC5kaXNwb3NlPSgpPT57dmFyIGU7IWx8fGZ8fGR8fChmPSEwLG51bGw9PT0oZT1jLlBUaHJlYWQpfHx2b2lkIDA9PT1lfHxlLnRlcm1pbmF0ZUFsbFRocmVhZHMoKSxjPXZvaWQgMCxmPSExLGw9ITEsZD0hMCl9fSw0OTc6KGUsdCxyKT0+eyJ1c2Ugc3RyaWN0IjtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5jaGVja0xhc3RFcnJvcj10Lml0ZXJhdGVFeHRyYU9wdGlvbnM9dC5hbGxvY1dhc21TdHJpbmc9dm9pZCAwO2NvbnN0IG49cigyNjMpO3QuYWxsb2NXYXNtU3RyaW5nPShlLHQpPT57Y29uc3Qgcj0oMCxuLmdldEluc3RhbmNlKSgpLGE9ci5sZW5ndGhCeXRlc1VURjgoZSkrMSxvPXIuX21hbGxvYyhhKTtyZXR1cm4gci5zdHJpbmdUb1VURjgoZSxvLGEpLHQucHVzaChvKSxvfSx0Lml0ZXJhdGVFeHRyYU9wdGlvbnM9KGUscixuLGEpPT57aWYoIm9iamVjdCI9PXR5cGVvZiBlJiZudWxsIT09ZSl7aWYobi5oYXMoZSkpdGhyb3cgbmV3IEVycm9yKCJDaXJjdWxhciByZWZlcmVuY2UgaW4gb3B0aW9ucyIpO24uYWRkKGUpfU9iamVjdC5lbnRyaWVzKGUpLmZvckVhY2goKChbZSxvXSk9Pntjb25zdCBpPXI/citlOmU7aWYoIm9iamVjdCI9PXR5cGVvZiBvKSgwLHQuaXRlcmF0ZUV4dHJhT3B0aW9ucykobyxpKyIuIixuLGEpO2Vsc2UgaWYoInN0cmluZyI9PXR5cGVvZiBvfHwibnVtYmVyIj09dHlwZW9mIG8pYShpLG8udG9TdHJpbmcoKSk7ZWxzZXtpZigiYm9vbGVhbiIhPXR5cGVvZiBvKXRocm93IG5ldyBFcnJvcigiQ2FuXCd0IGhhbmRsZSBleHRyYSBjb25maWcgdHlwZTogIit0eXBlb2Ygbyk7YShpLG8/IjEiOiIwIil9fSkpfSx0LmNoZWNrTGFzdEVycm9yPWU9Pntjb25zdCB0PSgwLG4uZ2V0SW5zdGFuY2UpKCkscj10LnN0YWNrU2F2ZSgpO3RyeXtjb25zdCByPXQuc3RhY2tBbGxvYyg4KTt0Ll9PcnRHZXRMYXN0RXJyb3IocixyKzQpO2NvbnN0IG49dC5IRUFQMzJbci80XSxhPXQuSEVBUFUzMltyLzQrMV0sbz1hP3QuVVRGOFRvU3RyaW5nKGEpOiIiO3Rocm93IG5ldyBFcnJvcihgJHtlfSBFUlJPUl9DT0RFOiAke259LCBFUlJPUl9NRVNTQUdFOiAke299YCl9ZmluYWxseXt0LnN0YWNrUmVzdG9yZShyKX19fSw0NzQ6KGUsdCxyKT0+e3ZhciBfc2NyaXB0RGlyLG49KF9zY3JpcHREaXI9InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmZG9jdW1lbnQuY3VycmVudFNjcmlwdD9kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYzp2b2lkIDAsInVuZGVmaW5lZCIhPXR5cGVvZiBfX2ZpbGVuYW1lJiYoX3NjcmlwdERpcj1fc2NyaXB0RGlyfHxfX2ZpbGVuYW1lKSxmdW5jdGlvbihlPXt9KXtmdW5jdGlvbiB0KCl7cmV0dXJuIGsuYnVmZmVyIT14LmJ1ZmZlciYmWSgpLHh9ZnVuY3Rpb24gbigpe3JldHVybiBrLmJ1ZmZlciE9eC5idWZmZXImJlkoKSxJfWZ1bmN0aW9uIGEoKXtyZXR1cm4gay5idWZmZXIhPXguYnVmZmVyJiZZKCksVX1mdW5jdGlvbiBvKCl7cmV0dXJuIGsuYnVmZmVyIT14LmJ1ZmZlciYmWSgpLEx9ZnVuY3Rpb24gaSgpe3JldHVybiBrLmJ1ZmZlciE9eC5idWZmZXImJlkoKSxXfXZhciBzLHUsYz1lO2MucmVhZHk9bmV3IFByb21pc2UoKChlLHQpPT57cz1lLHU9dH0pKTt2YXIgbCxmLGQscD1PYmplY3QuYXNzaWduKHt9LGMpLGc9Ii4vdGhpcy5wcm9ncmFtIixoPShlLHQpPT57dGhyb3cgdH0sbT0ib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyx5PSJmdW5jdGlvbiI9PXR5cGVvZiBpbXBvcnRTY3JpcHRzLHY9Im9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiYib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MudmVyc2lvbnMmJiJzdHJpbmciPT10eXBlb2YgcHJvY2Vzcy52ZXJzaW9ucy5ub2RlLGI9Yy5FTlZJUk9OTUVOVF9JU19QVEhSRUFEfHwhMSx3PSIiO2Z1bmN0aW9uIF8oZSl7cmV0dXJuIGMubG9jYXRlRmlsZT9jLmxvY2F0ZUZpbGUoZSx3KTp3K2V9aWYodil7dmFyIE89cigzODQpLFM9cig5MDgpO2xldCB0O3c9eT9TLmRpcm5hbWUodykrIi8iOl9fZGlybmFtZSsiLyIsbD0oZSx0KT0+KGU9ZS5zdGFydHNXaXRoKCJmaWxlOi8vIik/bmV3IFVSTChlKTpTLm5vcm1hbGl6ZShlKSxPLnJlYWRGaWxlU3luYyhlLHQ/dm9pZCAwOiJ1dGY4IikpLGQ9ZT0+KChlPWwoZSwhMCkpLmJ1ZmZlcnx8KGU9bmV3IFVpbnQ4QXJyYXkoZSkpLGUpLGY9KGUsdCxyLG49ITApPT57ZT1lLnN0YXJ0c1dpdGgoImZpbGU6Ly8iKT9uZXcgVVJMKGUpOlMubm9ybWFsaXplKGUpLE8ucmVhZEZpbGUoZSxuP3ZvaWQgMDoidXRmOCIsKChlLGEpPT57ZT9yKGUpOnQobj9hLmJ1ZmZlcjphKX0pKX0sIWMudGhpc1Byb2dyYW0mJjE8cHJvY2Vzcy5hcmd2Lmxlbmd0aCYmKGc9cHJvY2Vzcy5hcmd2WzFdLnJlcGxhY2UoL1xcXFwvZywiLyIpKSxwcm9jZXNzLmFyZ3Yuc2xpY2UoMiksaD0oZSx0KT0+e3Rocm93IHByb2Nlc3MuZXhpdENvZGU9ZSx0fSxjLmluc3BlY3Q9KCk9PiJbRW1zY3JpcHRlbiBNb2R1bGUgb2JqZWN0XSI7dHJ5e3Q9cig5MjUpfWNhdGNoKGUpe3Rocm93IGNvbnNvbGUuZXJyb3IoXCdUaGUgIndvcmtlcl90aHJlYWRzIiBtb2R1bGUgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIG5vZGUuanMgYnVpbGQgLSBwZXJoYXBzIGEgbmV3ZXIgdmVyc2lvbiBpcyBuZWVkZWQ/XCcpLGV9Z2xvYmFsLldvcmtlcj10Lldvcmtlcn1lbHNlKG18fHkpJiYoeT93PXNlbGYubG9jYXRpb24uaHJlZjoidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5jdXJyZW50U2NyaXB0JiYodz1kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYyksX3NjcmlwdERpciYmKHc9X3NjcmlwdERpciksdz0wIT09dy5pbmRleE9mKCJibG9iOiIpP3cuc3Vic3RyKDAsdy5yZXBsYWNlKC9bPyNdLiovLCIiKS5sYXN0SW5kZXhPZigiLyIpKzEpOiIiLHZ8fChsPWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQobnVsbCksdC5yZXNwb25zZVRleHR9LHkmJihkPWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLHQuc2VuZChudWxsKSxuZXcgVWludDhBcnJheSh0LnJlc3BvbnNlKX0pLGY9KGUsdCxyKT0+e3ZhciBuPW5ldyBYTUxIdHRwUmVxdWVzdDtuLm9wZW4oIkdFVCIsZSwhMCksbi5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixuLm9ubG9hZD0oKT0+ezIwMD09bi5zdGF0dXN8fDA9PW4uc3RhdHVzJiZuLnJlc3BvbnNlP3Qobi5yZXNwb25zZSk6cigpfSxuLm9uZXJyb3I9cixuLnNlbmQobnVsbCl9KSk7diYmInVuZGVmaW5lZCI9PXR5cGVvZiBwZXJmb3JtYW5jZSYmKGdsb2JhbC5wZXJmb3JtYW5jZT1yKDk1MykucGVyZm9ybWFuY2UpO3ZhciBFPWNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksQT1jb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSk7diYmKEU9KC4uLmUpPT5PLndyaXRlU3luYygxLGUuam9pbigiICIpKyJcXG4iKSxBPSguLi5lKT0+Ty53cml0ZVN5bmMoMixlLmpvaW4oIiAiKSsiXFxuIikpO3ZhciBULE09Yy5wcmludHx8RSxSPWMucHJpbnRFcnJ8fEE7T2JqZWN0LmFzc2lnbihjLHApLHA9bnVsbCxjLnRoaXNQcm9ncmFtJiYoZz1jLnRoaXNQcm9ncmFtKSxjLnF1aXQmJihoPWMucXVpdCksYy53YXNtQmluYXJ5JiYoVD1jLndhc21CaW5hcnkpO3ZhciBGPWMubm9FeGl0UnVudGltZXx8ITA7Im9iamVjdCIhPXR5cGVvZiBXZWJBc3NlbWJseSYmdGUoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKTt2YXIgayxDLFAsRCx4LEksVSxMLFcsSD0hMTtmdW5jdGlvbiBZKCl7dmFyIGU9ay5idWZmZXI7Yy5IRUFQOD14PW5ldyBJbnQ4QXJyYXkoZSksYy5IRUFQMTY9bmV3IEludDE2QXJyYXkoZSksYy5IRUFQMzI9VT1uZXcgSW50MzJBcnJheShlKSxjLkhFQVBVOD1JPW5ldyBVaW50OEFycmF5KGUpLGMuSEVBUFUxNj1uZXcgVWludDE2QXJyYXkoZSksYy5IRUFQVTMyPUw9bmV3IFVpbnQzMkFycmF5KGUpLGMuSEVBUEYzMj1uZXcgRmxvYXQzMkFycmF5KGUpLGMuSEVBUEY2ND1XPW5ldyBGbG9hdDY0QXJyYXkoZSl9dmFyIGo9Yy5JTklUSUFMX01FTU9SWXx8MTY3NzcyMTY7aWYoNTI0Mjg4MDw9anx8dGUoIklOSVRJQUxfTUVNT1JZIHNob3VsZCBiZSBsYXJnZXIgdGhhbiBTVEFDS19TSVpFLCB3YXMgIitqKyIhIChTVEFDS19TSVpFPTUyNDI4ODApIiksYilrPWMud2FzbU1lbW9yeTtlbHNlIGlmKGMud2FzbU1lbW9yeSlrPWMud2FzbU1lbW9yeTtlbHNlIGlmKCEoKGs9bmV3IFdlYkFzc2VtYmx5Lk1lbW9yeSh7aW5pdGlhbDpqLzY1NTM2LG1heGltdW06NjU1MzYsc2hhcmVkOiEwfSkpLmJ1ZmZlciBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyKSl0aHJvdyBSKCJyZXF1ZXN0ZWQgYSBzaGFyZWQgV2ViQXNzZW1ibHkuTWVtb3J5IGJ1dCB0aGUgcmV0dXJuZWQgYnVmZmVyIGlzIG5vdCBhIFNoYXJlZEFycmF5QnVmZmVyLCBpbmRpY2F0aW5nIHRoYXQgd2hpbGUgdGhlIGJyb3dzZXIgaGFzIFNoYXJlZEFycmF5QnVmZmVyIGl0IGRvZXMgbm90IGhhdmUgV2ViQXNzZW1ibHkgdGhyZWFkcyBzdXBwb3J0IC0geW91IG1heSBuZWVkIHRvIHNldCBhIGZsYWciKSx2JiZSKCIob24gbm9kZSB5b3UgbWF5IG5lZWQ6IC0tZXhwZXJpbWVudGFsLXdhc20tdGhyZWFkcyAtLWV4cGVyaW1lbnRhbC13YXNtLWJ1bGstbWVtb3J5IGFuZC9vciByZWNlbnQgdmVyc2lvbikiKSxFcnJvcigiYmFkIG1lbW9yeSIpO1koKSxqPWsuYnVmZmVyLmJ5dGVMZW5ndGg7dmFyIHosRz1bXSxOPVtdLEI9W10sJD0wO2Z1bmN0aW9uIHEoKXtyZXR1cm4gRnx8MDwkfXZhciBWLEosWD0wLEs9bnVsbCxaPW51bGw7ZnVuY3Rpb24gUSgpe1grKyxjLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmMubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhYKX1mdW5jdGlvbiBlZSgpe2lmKFgtLSxjLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmMubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhYKSwwPT1YJiYobnVsbCE9PUsmJihjbGVhckludGVydmFsKEspLEs9bnVsbCksWikpe3ZhciBlPVo7Wj1udWxsLGUoKX19ZnVuY3Rpb24gdGUoZSl7dGhyb3cgYy5vbkFib3J0JiZjLm9uQWJvcnQoZSksUihlPSJBYm9ydGVkKCIrZSsiKSIpLEg9ITAsRD0xLGU9bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcihlKyIuIEJ1aWxkIHdpdGggLXNBU1NFUlRJT05TIGZvciBtb3JlIGluZm8uIiksdShlKSxlfWZ1bmN0aW9uIHJlKGUpe3JldHVybiBlLnN0YXJ0c1dpdGgoImRhdGE6YXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtO2Jhc2U2NCwiKX1mdW5jdGlvbiBuZShlKXtpZihlPT1WJiZUKXJldHVybiBuZXcgVWludDhBcnJheShUKTtpZihkKXJldHVybiBkKGUpO3Rocm93ImJvdGggYXN5bmMgYW5kIHN5bmMgZmV0Y2hpbmcgb2YgdGhlIHdhc20gZmFpbGVkIn1mdW5jdGlvbiBhZShlLHQscil7cmV0dXJuIGZ1bmN0aW9uKGUpe2lmKCFUJiYobXx8eSkpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBmZXRjaCYmIWUuc3RhcnRzV2l0aCgiZmlsZTovLyIpKXJldHVybiBmZXRjaChlLHtjcmVkZW50aWFsczoic2FtZS1vcmlnaW4ifSkudGhlbigodD0+e2lmKCF0Lm9rKXRocm93ImZhaWxlZCB0byBsb2FkIHdhc20gYmluYXJ5IGZpbGUgYXQgXCciK2UrIlwnIjtyZXR1cm4gdC5hcnJheUJ1ZmZlcigpfSkpLmNhdGNoKCgoKT0+bmUoZSkpKTtpZihmKXJldHVybiBuZXcgUHJvbWlzZSgoKHQscik9PntmKGUsKGU9PnQobmV3IFVpbnQ4QXJyYXkoZSkpKSxyKX0pKX1yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKCk9Pm5lKGUpKSl9KGUpLnRoZW4oKGU9PldlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGUsdCkpKS50aGVuKChlPT5lKSkudGhlbihyLChlPT57UigiZmFpbGVkIHRvIGFzeW5jaHJvbm91c2x5IHByZXBhcmUgd2FzbTogIitlKSx0ZShlKX0pKX1mdW5jdGlvbiBvZShlKXt0aGlzLm5hbWU9IkV4aXRTdGF0dXMiLHRoaXMubWVzc2FnZT1gUHJvZ3JhbSB0ZXJtaW5hdGVkIHdpdGggZXhpdCgke2V9KWAsdGhpcy5zdGF0dXM9ZX1mdW5jdGlvbiBpZShlKXtlLnRlcm1pbmF0ZSgpLGUub25tZXNzYWdlPSgpPT57fX1mdW5jdGlvbiBzZShlKXsoZT1nZS5GYVtlXSl8fHRlKCksZ2UuZmIoZSl9ZnVuY3Rpb24gdWUoZSl7dmFyIHQ9Z2UuWmEoKTtpZighdClyZXR1cm4gNjtnZS5JYS5wdXNoKHQpLGdlLkZhW2UuSGFdPXQsdC5IYT1lLkhhO3ZhciByPXtjbWQ6InJ1biIsc3RhcnRfcm91dGluZTplLmdiLGFyZzplLllhLHB0aHJlYWRfcHRyOmUuSGF9O3JldHVybiB2JiZ0LnVucmVmKCksdC5wb3N0TWVzc2FnZShyLGUubWIpLDB9cmUoVj0ib3J0LXdhc20tdGhyZWFkZWQud2FzbSIpfHwoVj1fKFYpKTt2YXIgY2U9InVuZGVmaW5lZCIhPXR5cGVvZiBUZXh0RGVjb2Rlcj9uZXcgVGV4dERlY29kZXIoInV0ZjgiKTp2b2lkIDAsbGU9KGUsdCxyKT0+e3ZhciBuPSh0Pj4+PTApK3I7Zm9yKHI9dDtlW3JdJiYhKHI+PW4pOykrK3I7aWYoMTY8ci10JiZlLmJ1ZmZlciYmY2UpcmV0dXJuIGNlLmRlY29kZShlLmJ1ZmZlciBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyP2Uuc2xpY2UodCxyKTplLnN1YmFycmF5KHQscikpO2ZvcihuPSIiO3Q8cjspe3ZhciBhPWVbdCsrXTtpZigxMjgmYSl7dmFyIG89NjMmZVt0KytdO2lmKDE5Mj09KDIyNCZhKSluKz1TdHJpbmcuZnJvbUNoYXJDb2RlKCgzMSZhKTw8NnxvKTtlbHNle3ZhciBpPTYzJmVbdCsrXTs2NTUzNj4oYT0yMjQ9PSgyNDAmYSk/KDE1JmEpPDwxMnxvPDw2fGk6KDcmYSk8PDE4fG88PDEyfGk8PDZ8NjMmZVt0KytdKT9uKz1TdHJpbmcuZnJvbUNoYXJDb2RlKGEpOihhLT02NTUzNixuKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2fGE+PjEwLDU2MzIwfDEwMjMmYSkpfX1lbHNlIG4rPVN0cmluZy5mcm9tQ2hhckNvZGUoYSl9cmV0dXJuIG59LGZlPShlLHQpPT4oZT4+Pj0wKT9sZShuKCksZSx0KToiIjtmdW5jdGlvbiBkZShlKXtpZihiKXJldHVybiBxZSgxLDEsZSk7RD1lLHEoKXx8KGdlLmhiKCksYy5vbkV4aXQmJmMub25FeGl0KGUpLEg9ITApLGgoZSxuZXcgb2UoZSkpfXZhciBwZT1lPT57aWYoRD1lLGIpdGhyb3cgbWUoZSksInVud2luZCI7ZGUoZSl9LGdlPXtMYTpbXSxJYTpbXSxUYTpbXSxGYTp7fSxQYTpmdW5jdGlvbigpe2I/Z2UuYWIoKTpnZS4kYSgpfSwkYTpmdW5jdGlvbigpe0cudW5zaGlmdCgoKCk9PntRKCksZ2UuYmIoKCgpPT5lZSgpKSl9KSl9LGFiOmZ1bmN0aW9uKCl7Z2UucmVjZWl2ZU9iamVjdFRyYW5zZmVyPWdlLmViLGdlLnRocmVhZEluaXRUTFM9Z2UuU2EsZ2Uuc2V0RXhpdFN0YXR1cz1nZS5SYSxGPSExfSxSYTpmdW5jdGlvbihlKXtEPWV9LHJiOlsiJHRlcm1pbmF0ZVdvcmtlciJdLGhiOmZ1bmN0aW9uKCl7Zm9yKHZhciBlIG9mIGdlLklhKWllKGUpO2ZvcihlIG9mIGdlLkxhKWllKGUpO2dlLkxhPVtdLGdlLklhPVtdLGdlLkZhPVtdfSxmYjpmdW5jdGlvbihlKXt2YXIgdD1lLkhhO2RlbGV0ZSBnZS5GYVt0XSxnZS5MYS5wdXNoKGUpLGdlLklhLnNwbGljZShnZS5JYS5pbmRleE9mKGUpLDEpLGUuSGE9MCx5dCh0KX0sZWI6ZnVuY3Rpb24oKXt9LFNhOmZ1bmN0aW9uKCl7Z2UuVGEuZm9yRWFjaCgoZT0+ZSgpKSl9LGNiOmU9Pm5ldyBQcm9taXNlKCh0PT57ZS5vbm1lc3NhZ2U9cj0+e3ZhciBuPShyPXIuZGF0YSkuY21kO2lmKHIudGFyZ2V0VGhyZWFkJiZyLnRhcmdldFRocmVhZCE9ZHQoKSl7dmFyIGE9Z2UuRmFbci5xYl07YT9hLnBvc3RNZXNzYWdlKHIsci50cmFuc2Zlckxpc3QpOlIoXCdJbnRlcm5hbCBlcnJvciEgV29ya2VyIHNlbnQgYSBtZXNzYWdlICJcJytuK1wnIiB0byB0YXJnZXQgcHRocmVhZCBcJytyLnRhcmdldFRocmVhZCsiLCBidXQgdGhhdCB0aHJlYWQgbm8gbG9uZ2VyIGV4aXN0cyEiKX1lbHNlImNoZWNrTWFpbGJveCI9PT1uP0hlKCk6InNwYXduVGhyZWFkIj09PW4/dWUocik6ImNsZWFudXBUaHJlYWQiPT09bj9zZShyLnRocmVhZCk6ImtpbGxUaHJlYWQiPT09bj8ocj1yLnRocmVhZCxuPWdlLkZhW3JdLGRlbGV0ZSBnZS5GYVtyXSxpZShuKSx5dChyKSxnZS5JYS5zcGxpY2UoZ2UuSWEuaW5kZXhPZihuKSwxKSxuLkhhPTApOiJjYW5jZWxUaHJlYWQiPT09bj9nZS5GYVtyLnRocmVhZF0ucG9zdE1lc3NhZ2Uoe2NtZDoiY2FuY2VsIn0pOiJsb2FkZWQiPT09bj8oZS5sb2FkZWQ9ITAsdChlKSk6ImFsZXJ0Ij09PW4/YWxlcnQoIlRocmVhZCAiK3IudGhyZWFkSWQrIjogIityLnRleHQpOiJzZXRpbW1lZGlhdGUiPT09ci50YXJnZXQ/ZS5wb3N0TWVzc2FnZShyKToiY2FsbEhhbmRsZXIiPT09bj9jW3IuaGFuZGxlcl0oLi4uci5hcmdzKTpuJiZSKCJ3b3JrZXIgc2VudCBhbiB1bmtub3duIGNvbW1hbmQgIituKX0sZS5vbmVycm9yPWU9Pnt0aHJvdyBSKCJ3b3JrZXIgc2VudCBhbiBlcnJvciEgIitlLmZpbGVuYW1lKyI6IitlLmxpbmVubysiOiAiK2UubWVzc2FnZSksZX0sdiYmKGUub24oIm1lc3NhZ2UiLChmdW5jdGlvbih0KXtlLm9ubWVzc2FnZSh7ZGF0YTp0fSl9KSksZS5vbigiZXJyb3IiLChmdW5jdGlvbih0KXtlLm9uZXJyb3IodCl9KSkpO3ZhciByLG49W107Zm9yKHIgb2ZbIm9uRXhpdCIsIm9uQWJvcnQiLCJwcmludCIsInByaW50RXJyIl0pYy5oYXNPd25Qcm9wZXJ0eShyKSYmbi5wdXNoKHIpO2UucG9zdE1lc3NhZ2Uoe2NtZDoibG9hZCIsaGFuZGxlcnM6bix1cmxPckJsb2I6Yy5tYWluU2NyaXB0VXJsT3JCbG9ifHxfc2NyaXB0RGlyLHdhc21NZW1vcnk6ayx3YXNtTW9kdWxlOlB9KX0pKSxiYjpmdW5jdGlvbihlKXtlKCl9LFhhOmZ1bmN0aW9uKCl7dmFyIGU9Xygib3J0LXdhc20tdGhyZWFkZWQud29ya2VyLmpzIik7ZT1uZXcgV29ya2VyKGUpLGdlLkxhLnB1c2goZSl9LFphOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PWdlLkxhLmxlbmd0aCYmKGdlLlhhKCksZ2UuY2IoZ2UuTGFbMF0pKSxnZS5MYS5wb3AoKX19O2MuUFRocmVhZD1nZTt2YXIgaGU9ZT0+e2Zvcig7MDxlLmxlbmd0aDspZS5zaGlmdCgpKGMpfTtmdW5jdGlvbiBtZShlKXtpZihiKXJldHVybiBxZSgyLDAsZSk7cGUoZSl9Yy5lc3RhYmxpc2hTdGFja1NwYWNlPWZ1bmN0aW9uKCl7dmFyIGU9ZHQoKSx0PWEoKVtlKzUyPj4yPj4+MF07ZT1hKClbZSs1Nj4+Mj4+PjBdLF90KHQsdC1lKSxTdCh0KX07dmFyIHllPVtdO2Z1bmN0aW9uIHZlKGUpe3RoaXMuT2E9ZS0yNCx0aGlzLldhPWZ1bmN0aW9uKGUpe28oKVt0aGlzLk9hKzQ+PjI+Pj4wXT1lfSx0aGlzLlZhPWZ1bmN0aW9uKGUpe28oKVt0aGlzLk9hKzg+PjI+Pj4wXT1lfSx0aGlzLlBhPWZ1bmN0aW9uKGUsdCl7dGhpcy5VYSgpLHRoaXMuV2EoZSksdGhpcy5WYSh0KX0sdGhpcy5VYT1mdW5jdGlvbigpe28oKVt0aGlzLk9hKzE2Pj4yPj4+MF09MH19ZnVuY3Rpb24gYmUoZSx0LHIsbil7cmV0dXJuIGI/cWUoMywxLGUsdCxyLG4pOndlKGUsdCxyLG4pfWZ1bmN0aW9uIHdlKGUsdCxyLG4pe2lmKGU+Pj49MCx0Pj4+PTAscj4+Pj0wLG4+Pj49MCwidW5kZWZpbmVkIj09dHlwZW9mIFNoYXJlZEFycmF5QnVmZmVyKXJldHVybiBSKCJDdXJyZW50IGVudmlyb25tZW50IGRvZXMgbm90IHN1cHBvcnQgU2hhcmVkQXJyYXlCdWZmZXIsIHB0aHJlYWRzIGFyZSBub3QgYXZhaWxhYmxlISIpLDY7dmFyIGE9W107cmV0dXJuIGImJjA9PT1hLmxlbmd0aD9iZShlLHQscixuKTooZT17Z2I6cixIYTplLFlhOm4sbWI6YX0sYj8oZS5vYj0ic3Bhd25UaHJlYWQiLHBvc3RNZXNzYWdlKGUsYSksMCk6dWUoZSkpfWZ1bmN0aW9uIF9lKGUsdCxyKXtyZXR1cm4gYj9xZSg0LDEsZSx0LHIpOjB9ZnVuY3Rpb24gT2UoZSx0KXtpZihiKXJldHVybiBxZSg1LDEsZSx0KX1jLmludm9rZUVudHJ5UG9pbnQ9ZnVuY3Rpb24oZSx0KXt2YXIgcj15ZVtlXTtyfHwoZT49eWUubGVuZ3RoJiYoeWUubGVuZ3RoPWUrMSkseWVbZV09cj16LmdldChlKSksZT1yKHQpLHEoKT9nZS5SYShlKTp2dChlKX07dmFyIFNlPWU9Pntmb3IodmFyIHQ9MCxyPTA7cjxlLmxlbmd0aDsrK3Ipe3ZhciBuPWUuY2hhckNvZGVBdChyKTsxMjc+PW4/dCsrOjIwNDc+PW4/dCs9Mjo1NTI5Njw9biYmNTczNDM+PW4/KHQrPTQsKytyKTp0Kz0zfXJldHVybiB0fSxFZT0oZSx0LHIsbik9PntpZighKDA8bikpcmV0dXJuIDA7dmFyIGE9cj4+Pj0wO249cituLTE7Zm9yKHZhciBvPTA7bzxlLmxlbmd0aDsrK28pe3ZhciBpPWUuY2hhckNvZGVBdChvKTtpZig1NTI5Njw9aSYmNTczNDM+PWkmJihpPTY1NTM2KygoMTAyMyZpKTw8MTApfDEwMjMmZS5jaGFyQ29kZUF0KCsrbykpLDEyNz49aSl7aWYocj49bilicmVhazt0W3IrKz4+PjBdPWl9ZWxzZXtpZigyMDQ3Pj1pKXtpZihyKzE+PW4pYnJlYWs7dFtyKys+Pj4wXT0xOTJ8aT4+Nn1lbHNle2lmKDY1NTM1Pj1pKXtpZihyKzI+PW4pYnJlYWs7dFtyKys+Pj4wXT0yMjR8aT4+MTJ9ZWxzZXtpZihyKzM+PW4pYnJlYWs7dFtyKys+Pj4wXT0yNDB8aT4+MTgsdFtyKys+Pj4wXT0xMjh8aT4+MTImNjN9dFtyKys+Pj4wXT0xMjh8aT4+NiY2M310W3IrKz4+PjBdPTEyOHw2MyZpfX1yZXR1cm4gdFtyPj4+MF09MCxyLWF9LEFlPShlLHQscik9PkVlKGUsbigpLHQscik7ZnVuY3Rpb24gVGUoZSx0KXtpZihiKXJldHVybiBxZSg2LDEsZSx0KX1mdW5jdGlvbiBNZShlLHQscil7aWYoYilyZXR1cm4gcWUoNywxLGUsdCxyKX1mdW5jdGlvbiBSZShlLHQscil7cmV0dXJuIGI/cWUoOCwxLGUsdCxyKTowfWZ1bmN0aW9uIEZlKGUsdCl7aWYoYilyZXR1cm4gcWUoOSwxLGUsdCl9ZnVuY3Rpb24ga2UoZSx0LHIpe2lmKGIpcmV0dXJuIHFlKDEwLDEsZSx0LHIpfWZ1bmN0aW9uIENlKGUsdCxyLG4pe2lmKGIpcmV0dXJuIHFlKDExLDEsZSx0LHIsbil9ZnVuY3Rpb24gUGUoZSx0LHIsbil7aWYoYilyZXR1cm4gcWUoMTIsMSxlLHQscixuKX1mdW5jdGlvbiBEZShlLHQscixuKXtpZihiKXJldHVybiBxZSgxMywxLGUsdCxyLG4pfWZ1bmN0aW9uIHhlKGUpe2lmKGIpcmV0dXJuIHFlKDE0LDEsZSl9ZnVuY3Rpb24gSWUoZSx0KXtpZihiKXJldHVybiBxZSgxNSwxLGUsdCl9ZnVuY3Rpb24gVWUoZSx0LHIpe2lmKGIpcmV0dXJuIHFlKDE2LDEsZSx0LHIpfXZhciBMZT1lPT57aWYoIUgpdHJ5e2lmKGUoKSwhcSgpKXRyeXtiP3Z0KEQpOnBlKEQpfWNhdGNoKGUpe2UgaW5zdGFuY2VvZiBvZXx8InVud2luZCI9PWV8fGgoMSxlKX19Y2F0Y2goZSl7ZSBpbnN0YW5jZW9mIG9lfHwidW53aW5kIj09ZXx8aCgxLGUpfX07ZnVuY3Rpb24gV2UoZSl7ZT4+Pj0wLCJmdW5jdGlvbiI9PXR5cGVvZiBBdG9taWNzLm5iJiYoQXRvbWljcy5uYihhKCksZT4+MixlKS52YWx1ZS50aGVuKEhlKSxlKz0xMjgsQXRvbWljcy5zdG9yZShhKCksZT4+MiwxKSl9ZnVuY3Rpb24gSGUoKXt2YXIgZT1kdCgpO2UmJihXZShlKSxMZSgoKCk9PmJ0KCkpKSl9Yy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX21haWxib3hfYXdhaXQ9V2UsYy5jaGVja01haWxib3g9SGU7dmFyIFllPWU9PjA9PWUlNCYmKDAhPWUlMTAwfHwwPT1lJTQwMCksamU9WzAsMzEsNjAsOTEsMTIxLDE1MiwxODIsMjEzLDI0NCwyNzQsMzA1LDMzNV0semU9WzAsMzEsNTksOTAsMTIwLDE1MSwxODEsMjEyLDI0MywyNzMsMzA0LDMzNF07ZnVuY3Rpb24gR2UoZSx0LHIsbixhLG8saSxzKXtyZXR1cm4gYj9xZSgxNywxLGUsdCxyLG4sYSxvLGkscyk6LTUyfWZ1bmN0aW9uIE5lKGUsdCxyLG4sYSxvLGkpe2lmKGIpcmV0dXJuIHFlKDE4LDEsZSx0LHIsbixhLG8saSl9dmFyIEJlPWU9Pnt2YXIgdD1TZShlKSsxLHI9cHQodCk7cmV0dXJuIHImJkFlKGUscix0KSxyfSwkZT1lPT57dmFyIHQ9T3QoKTtyZXR1cm4gZT1lKCksU3QodCksZX07ZnVuY3Rpb24gcWUoZSx0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoLTIsbj1hcmd1bWVudHM7cmV0dXJuICRlKCgoKT0+e2Zvcih2YXIgYT1FdCg4KnIpLG89YT4+MyxzPTA7czxyO3MrKyl7dmFyIHU9blsyK3NdO2koKVtvK3M+Pj4wXT11fXJldHVybiBtdChlLHIsYSx0KX0pKX12YXIgVmUsSmU9W10sWGU9e30sS2U9KCk9PntpZighVmUpe3ZhciBlLHQ9e1VTRVI6IndlYl91c2VyIixMT0dOQU1FOiJ3ZWJfdXNlciIsUEFUSDoiLyIsUFdEOiIvIixIT01FOiIvaG9tZS93ZWJfdXNlciIsTEFORzooIm9iamVjdCI9PXR5cGVvZiBuYXZpZ2F0b3ImJm5hdmlnYXRvci5sYW5ndWFnZXMmJm5hdmlnYXRvci5sYW5ndWFnZXNbMF18fCJDIikucmVwbGFjZSgiLSIsIl8iKSsiLlVURi04IixfOmd8fCIuL3RoaXMucHJvZ3JhbSJ9O2ZvcihlIGluIFhlKXZvaWQgMD09PVhlW2VdP2RlbGV0ZSB0W2VdOnRbZV09WGVbZV07dmFyIHI9W107Zm9yKGUgaW4gdClyLnB1c2goYCR7ZX09JHt0W2VdfWApO1ZlPXJ9cmV0dXJuIFZlfTtmdW5jdGlvbiBaZShlLHIpe2lmKGIpcmV0dXJuIHFlKDE5LDEsZSxyKTtlPj4+PTAscj4+Pj0wO3ZhciBuPTA7cmV0dXJuIEtlKCkuZm9yRWFjaCgoZnVuY3Rpb24oYSxpKXt2YXIgcz1yK247Zm9yKGk9bygpW2UrNCppPj4yPj4+MF09cyxzPTA7czxhLmxlbmd0aDsrK3MpdCgpW2krKz4+MD4+PjBdPWEuY2hhckNvZGVBdChzKTt0KClbaT4+MD4+PjBdPTAsbis9YS5sZW5ndGgrMX0pKSwwfWZ1bmN0aW9uIFFlKGUsdCl7aWYoYilyZXR1cm4gcWUoMjAsMSxlLHQpO2U+Pj49MCx0Pj4+PTA7dmFyIHI9S2UoKTtvKClbZT4+Mj4+PjBdPXIubGVuZ3RoO3ZhciBuPTA7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bis9ZS5sZW5ndGgrMX0pKSxvKClbdD4+Mj4+PjBdPW4sMH1mdW5jdGlvbiBldChlKXtyZXR1cm4gYj9xZSgyMSwxLGUpOjUyfWZ1bmN0aW9uIHR0KGUsdCxyLG4pe3JldHVybiBiP3FlKDIyLDEsZSx0LHIsbik6NTJ9ZnVuY3Rpb24gcnQoZSx0LHIsbixhKXtyZXR1cm4gYj9xZSgyMywxLGUsdCxyLG4sYSk6NzB9dmFyIG50PVtudWxsLFtdLFtdXTtmdW5jdGlvbiBhdChlLHQscixhKXtpZihiKXJldHVybiBxZSgyNCwxLGUsdCxyLGEpO3Q+Pj49MCxyPj4+PTAsYT4+Pj0wO2Zvcih2YXIgaT0wLHM9MDtzPHI7cysrKXt2YXIgdT1vKClbdD4+Mj4+PjBdLGM9bygpW3QrND4+Mj4+PjBdO3QrPTg7Zm9yKHZhciBsPTA7bDxjO2wrKyl7dmFyIGY9bigpW3UrbD4+PjBdLGQ9bnRbZV07MD09PWZ8fDEwPT09Zj8oKDE9PT1lP006UikobGUoZCwwKSksZC5sZW5ndGg9MCk6ZC5wdXNoKGYpfWkrPWN9cmV0dXJuIG8oKVthPj4yPj4+MF09aSwwfXZhciBvdD1lPT4ob3Q9KCgpPT57aWYoIm9iamVjdCI9PXR5cGVvZiBjcnlwdG8mJiJmdW5jdGlvbiI9PXR5cGVvZiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKXJldHVybiBlPT4oZS5zZXQoY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShlLmJ5dGVMZW5ndGgpKSksZSk7aWYodil0cnl7dmFyIGU9cig3NjApO2lmKGUucmFuZG9tRmlsbFN5bmMpcmV0dXJuIHQ9PmUucmFuZG9tRmlsbFN5bmModCk7dmFyIHQ9ZS5yYW5kb21CeXRlcztyZXR1cm4gZT0+KGUuc2V0KHQoZS5ieXRlTGVuZ3RoKSksZSl9Y2F0Y2goZSl7fXRlKCJpbml0UmFuZG9tRGV2aWNlIil9KSgpKShlKSxpdD1bMzEsMjksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLHN0PVszMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV0sdXQ9KGUscik9Pnt0KCkuc2V0KGUscj4+PjApfTtmdW5jdGlvbiBjdChlLHQscixuKXtmdW5jdGlvbiBvKGUsdCxyKXtmb3IoZT0ibnVtYmVyIj09dHlwZW9mIGU/ZS50b1N0cmluZygpOmV8fCIiO2UubGVuZ3RoPHQ7KWU9clswXStlO3JldHVybiBlfWZ1bmN0aW9uIGkoZSx0KXtyZXR1cm4gbyhlLHQsIjAiKX1mdW5jdGlvbiBzKGUsdCl7ZnVuY3Rpb24gcihlKXtyZXR1cm4gMD5lPy0xOjA8ZT8xOjB9dmFyIG47cmV0dXJuIDA9PT0obj1yKGUuZ2V0RnVsbFllYXIoKS10LmdldEZ1bGxZZWFyKCkpKSYmMD09PShuPXIoZS5nZXRNb250aCgpLXQuZ2V0TW9udGgoKSkpJiYobj1yKGUuZ2V0RGF0ZSgpLXQuZ2V0RGF0ZSgpKSksbn1mdW5jdGlvbiB1KGUpe3N3aXRjaChlLmdldERheSgpKXtjYXNlIDA6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDI5KTtjYXNlIDE6cmV0dXJuIGU7Y2FzZSAyOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwzKTtjYXNlIDM6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDIpO2Nhc2UgNDpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMSk7Y2FzZSA1OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwzMSk7Y2FzZSA2OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwzMCl9fWZ1bmN0aW9uIGMoZSl7dmFyIHQ9ZS5KYTtmb3IoZT1uZXcgRGF0ZShuZXcgRGF0ZShlLkthKzE5MDAsMCwxKS5nZXRUaW1lKCkpOzA8dDspe3ZhciByPWUuZ2V0TW9udGgoKSxuPShZZShlLmdldEZ1bGxZZWFyKCkpP2l0OnN0KVtyXTtpZighKHQ+bi1lLmdldERhdGUoKSkpe2Uuc2V0RGF0ZShlLmdldERhdGUoKSt0KTticmVha310LT1uLWUuZ2V0RGF0ZSgpKzEsZS5zZXREYXRlKDEpLDExPnI/ZS5zZXRNb250aChyKzEpOihlLnNldE1vbnRoKDApLGUuc2V0RnVsbFllYXIoZS5nZXRGdWxsWWVhcigpKzEpKX1yZXR1cm4gcj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCkrMSwwLDQpLHQ9dShuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCw0KSkscj11KHIpLDA+PXModCxlKT8wPj1zKHIsZSk/ZS5nZXRGdWxsWWVhcigpKzE6ZS5nZXRGdWxsWWVhcigpOmUuZ2V0RnVsbFllYXIoKS0xfWU+Pj49MCx0Pj4+PTAscj4+Pj0wLG4+Pj49MDt2YXIgbD1hKClbbis0MD4+Mj4+PjBdO2Zvcih2YXIgZiBpbiBuPXtrYjphKClbbj4+Mj4+PjBdLGpiOmEoKVtuKzQ+PjI+Pj4wXSxNYTphKClbbis4Pj4yPj4+MF0sUWE6YSgpW24rMTI+PjI+Pj4wXSxOYTphKClbbisxNj4+Mj4+PjBdLEthOmEoKVtuKzIwPj4yPj4+MF0sR2E6YSgpW24rMjQ+PjI+Pj4wXSxKYTphKClbbisyOD4+Mj4+PjBdLHNiOmEoKVtuKzMyPj4yPj4+MF0saWI6YSgpW24rMzY+PjI+Pj4wXSxsYjpsP2ZlKGwpOiIifSxyPWZlKHIpLGw9eyIlYyI6IiVhICViICVkICVIOiVNOiVTICVZIiwiJUQiOiIlbS8lZC8leSIsIiVGIjoiJVktJW0tJWQiLCIlaCI6IiViIiwiJXIiOiIlSTolTTolUyAlcCIsIiVSIjoiJUg6JU0iLCIlVCI6IiVIOiVNOiVTIiwiJXgiOiIlbS8lZC8leSIsIiVYIjoiJUg6JU06JVMiLCIlRWMiOiIlYyIsIiVFQyI6IiVDIiwiJUV4IjoiJW0vJWQvJXkiLCIlRVgiOiIlSDolTTolUyIsIiVFeSI6IiV5IiwiJUVZIjoiJVkiLCIlT2QiOiIlZCIsIiVPZSI6IiVlIiwiJU9IIjoiJUgiLCIlT0kiOiIlSSIsIiVPbSI6IiVtIiwiJU9NIjoiJU0iLCIlT1MiOiIlUyIsIiVPdSI6IiV1IiwiJU9VIjoiJVUiLCIlT1YiOiIlViIsIiVPdyI6IiV3IiwiJU9XIjoiJVciLCIlT3kiOiIleSJ9KXI9ci5yZXBsYWNlKG5ldyBSZWdFeHAoZiwiZyIpLGxbZl0pO3ZhciBkPSJTdW5kYXkgTW9uZGF5IFR1ZXNkYXkgV2VkbmVzZGF5IFRodXJzZGF5IEZyaWRheSBTYXR1cmRheSIuc3BsaXQoIiAiKSxwPSJKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyIi5zcGxpdCgiICIpO2ZvcihmIGluIGw9eyIlYSI6ZT0+ZFtlLkdhXS5zdWJzdHJpbmcoMCwzKSwiJUEiOmU9PmRbZS5HYV0sIiViIjplPT5wW2UuTmFdLnN1YnN0cmluZygwLDMpLCIlQiI6ZT0+cFtlLk5hXSwiJUMiOmU9PmkoKGUuS2ErMTkwMCkvMTAwfDAsMiksIiVkIjplPT5pKGUuUWEsMiksIiVlIjplPT5vKGUuUWEsMiwiICIpLCIlZyI6ZT0+YyhlKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJUciOmU9PmMoZSksIiVIIjplPT5pKGUuTWEsMiksIiVJIjplPT4oMD09KGU9ZS5NYSk/ZT0xMjoxMjxlJiYoZS09MTIpLGkoZSwyKSksIiVqIjplPT57Zm9yKHZhciB0PTAscj0wO3I8PWUuTmEtMTt0Kz0oWWUoZS5LYSsxOTAwKT9pdDpzdClbcisrXSk7cmV0dXJuIGkoZS5RYSt0LDMpfSwiJW0iOmU9PmkoZS5OYSsxLDIpLCIlTSI6ZT0+aShlLmpiLDIpLCIlbiI6KCk9PiJcXG4iLCIlcCI6ZT0+MDw9ZS5NYSYmMTI+ZS5NYT8iQU0iOiJQTSIsIiVTIjplPT5pKGUua2IsMiksIiV0IjooKT0+IlxcdCIsIiV1IjplPT5lLkdhfHw3LCIlVSI6ZT0+aShNYXRoLmZsb29yKChlLkphKzctZS5HYSkvNyksMiksIiVWIjplPT57dmFyIHQ9TWF0aC5mbG9vcigoZS5KYSs3LShlLkdhKzYpJTcpLzcpO2lmKDI+PShlLkdhKzM3MS1lLkphLTIpJTcmJnQrKyx0KTUzPT10JiYoND09KHI9KGUuR2ErMzcxLWUuSmEpJTcpfHwzPT1yJiZZZShlLkthKXx8KHQ9MSkpO2Vsc2V7dD01Mjt2YXIgcj0oZS5HYSs3LWUuSmEtMSklNzsoND09cnx8NT09ciYmWWUoZS5LYSU0MDAtMSkpJiZ0Kyt9cmV0dXJuIGkodCwyKX0sIiV3IjplPT5lLkdhLCIlVyI6ZT0+aShNYXRoLmZsb29yKChlLkphKzctKGUuR2ErNiklNykvNyksMiksIiV5IjplPT4oZS5LYSsxOTAwKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJVkiOmU9PmUuS2ErMTkwMCwiJXoiOmU9Pnt2YXIgdD0wPD0oZT1lLmliKTtyZXR1cm4gZT1NYXRoLmFicyhlKS82MCwodD8iKyI6Ii0iKStTdHJpbmcoIjAwMDAiKyhlLzYwKjEwMCtlJTYwKSkuc2xpY2UoLTQpfSwiJVoiOmU9PmUubGIsIiUlIjooKT0+IiUifSxyPXIucmVwbGFjZSgvJSUvZywiXFwwXFwwIiksbClyLmluY2x1ZGVzKGYpJiYocj1yLnJlcGxhY2UobmV3IFJlZ0V4cChmLCJnIiksbFtmXShuKSkpO3JldHVybiBmPWZ1bmN0aW9uKGUpe3ZhciB0PUFycmF5KFNlKGUpKzEpO3JldHVybiBFZShlLHQsMCx0Lmxlbmd0aCksdH0ocj1yLnJlcGxhY2UoL1xcMFxcMC9nLCIlIikpLGYubGVuZ3RoPnQ/MDoodXQoZixlKSxmLmxlbmd0aC0xKX1nZS5QYSgpO3ZhciBsdD1bbnVsbCxkZSxtZSxiZSxfZSxPZSxUZSxNZSxSZSxGZSxrZSxDZSxQZSxEZSx4ZSxJZSxVZSxHZSxOZSxaZSxRZSxldCx0dCxydCxhdF0sZnQ9e2I6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IG5ldyB2ZShlPj4+PTApLlBhKHQ+Pj4wLHI+Pj4wKSxlfSxOOmZ1bmN0aW9uKGUpe2d0KGU+Pj4wLCF5LDEsIW0sMTMxMDcyLCExKSxnZS5TYSgpfSxrOmZ1bmN0aW9uKGUpe2U+Pj49MCxiP3Bvc3RNZXNzYWdlKHtjbWQ6ImNsZWFudXBUaHJlYWQiLHRocmVhZDplfSk6c2UoZSl9LEk6d2UsaDpfZSxUOk9lLEU6VGUsRzpNZSxVOlJlLFI6RmUsSjprZSxROkNlLG86UGUsRjpEZSxDOnhlLFM6SWUsRDpVZSxxOigpPT4hMCxBOmZ1bmN0aW9uKGUsdCl7KGU+Pj49MCk9PXQ+Pj4wP3NldFRpbWVvdXQoKCgpPT5IZSgpKSk6Yj9wb3N0TWVzc2FnZSh7dGFyZ2V0VGhyZWFkOmUsY21kOiJjaGVja01haWxib3gifSk6KGU9Z2UuRmFbZV0pJiZlLnBvc3RNZXNzYWdlKHtjbWQ6ImNoZWNrTWFpbGJveCJ9KX0sTDpmdW5jdGlvbigpe3JldHVybi0xfSxNOldlLHA6ZnVuY3Rpb24oZSl7diYmZ2UuRmFbZT4+PjBdLnJlZigpfSx0OmZ1bmN0aW9uKGUsdCxyKXtlPXQrMjA5NzE1Mj4+PjA8NDE5NDMwNS0hIWU/KGU+Pj4wKSs0Mjk0OTY3Mjk2KnQ6TmFOLHI+Pj49MCxlPW5ldyBEYXRlKDFlMyplKSxhKClbcj4+Mj4+PjBdPWUuZ2V0VVRDU2Vjb25kcygpLGEoKVtyKzQ+PjI+Pj4wXT1lLmdldFVUQ01pbnV0ZXMoKSxhKClbcis4Pj4yPj4+MF09ZS5nZXRVVENIb3VycygpLGEoKVtyKzEyPj4yPj4+MF09ZS5nZXRVVENEYXRlKCksYSgpW3IrMTY+PjI+Pj4wXT1lLmdldFVUQ01vbnRoKCksYSgpW3IrMjA+PjI+Pj4wXT1lLmdldFVUQ0Z1bGxZZWFyKCktMTkwMCxhKClbcisyND4+Mj4+PjBdPWUuZ2V0VVRDRGF5KCksZT0oZS5nZXRUaW1lKCktRGF0ZS5VVEMoZS5nZXRVVENGdWxsWWVhcigpLDAsMSwwLDAsMCwwKSkvODY0ZTV8MCxhKClbcisyOD4+Mj4+PjBdPWV9LHU6ZnVuY3Rpb24oZSx0LHIpe2U9dCsyMDk3MTUyPj4+MDw0MTk0MzA1LSEhZT8oZT4+PjApKzQyOTQ5NjcyOTYqdDpOYU4scj4+Pj0wLGU9bmV3IERhdGUoMWUzKmUpLGEoKVtyPj4yPj4+MF09ZS5nZXRTZWNvbmRzKCksYSgpW3IrND4+Mj4+PjBdPWUuZ2V0TWludXRlcygpLGEoKVtyKzg+PjI+Pj4wXT1lLmdldEhvdXJzKCksYSgpW3IrMTI+PjI+Pj4wXT1lLmdldERhdGUoKSxhKClbcisxNj4+Mj4+PjBdPWUuZ2V0TW9udGgoKSxhKClbcisyMD4+Mj4+PjBdPWUuZ2V0RnVsbFllYXIoKS0xOTAwLGEoKVtyKzI0Pj4yPj4+MF09ZS5nZXREYXkoKSx0PShZZShlLmdldEZ1bGxZZWFyKCkpP2plOnplKVtlLmdldE1vbnRoKCldK2UuZ2V0RGF0ZSgpLTF8MCxhKClbcisyOD4+Mj4+PjBdPXQsYSgpW3IrMzY+PjI+Pj4wXT0tNjAqZS5nZXRUaW1lem9uZU9mZnNldCgpLHQ9bmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgbj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwxKS5nZXRUaW1lem9uZU9mZnNldCgpO2U9MHwodCE9biYmZS5nZXRUaW1lem9uZU9mZnNldCgpPT1NYXRoLm1pbihuLHQpKSxhKClbciszMj4+Mj4+PjBdPWV9LHY6ZnVuY3Rpb24oZSl7ZT4+Pj0wO3ZhciB0PW5ldyBEYXRlKGEoKVtlKzIwPj4yPj4+MF0rMTkwMCxhKClbZSsxNj4+Mj4+PjBdLGEoKVtlKzEyPj4yPj4+MF0sYSgpW2UrOD4+Mj4+PjBdLGEoKVtlKzQ+PjI+Pj4wXSxhKClbZT4+Mj4+PjBdLDApLHI9YSgpW2UrMzI+PjI+Pj4wXSxuPXQuZ2V0VGltZXpvbmVPZmZzZXQoKSxvPW5ldyBEYXRlKHQuZ2V0RnVsbFllYXIoKSw2LDEpLmdldFRpbWV6b25lT2Zmc2V0KCksaT1uZXcgRGF0ZSh0LmdldEZ1bGxZZWFyKCksMCwxKS5nZXRUaW1lem9uZU9mZnNldCgpLHM9TWF0aC5taW4oaSxvKTtyZXR1cm4gMD5yP2EoKVtlKzMyPj4yPj4+MF09TnVtYmVyKG8hPWkmJnM9PW4pOjA8ciE9KHM9PW4pJiYobz1NYXRoLm1heChpLG8pLHQuc2V0VGltZSh0LmdldFRpbWUoKSs2ZTQqKCgwPHI/czpvKS1uKSkpLGEoKVtlKzI0Pj4yPj4+MF09dC5nZXREYXkoKSxyPShZZSh0LmdldEZ1bGxZZWFyKCkpP2plOnplKVt0LmdldE1vbnRoKCldK3QuZ2V0RGF0ZSgpLTF8MCxhKClbZSsyOD4+Mj4+PjBdPXIsYSgpW2U+PjI+Pj4wXT10LmdldFNlY29uZHMoKSxhKClbZSs0Pj4yPj4+MF09dC5nZXRNaW51dGVzKCksYSgpW2UrOD4+Mj4+PjBdPXQuZ2V0SG91cnMoKSxhKClbZSsxMj4+Mj4+PjBdPXQuZ2V0RGF0ZSgpLGEoKVtlKzE2Pj4yPj4+MF09dC5nZXRNb250aCgpLGEoKVtlKzIwPj4yPj4+MF09dC5nZXRZZWFyKCksZT10LmdldFRpbWUoKS8xZTMsd3QoKEo9ZSwxPD0rTWF0aC5hYnMoSik/MDxKPytNYXRoLmZsb29yKEovNDI5NDk2NzI5Nik+Pj4wOn5+K01hdGguY2VpbCgoSi0rKH5+Sj4+PjApKS80Mjk0OTY3Mjk2KT4+PjA6MCkpLGU+Pj4wfSxyOkdlLHM6TmUsejpmdW5jdGlvbihlLHQscil7ZnVuY3Rpb24gbihlKXtyZXR1cm4oZT1lLnRvVGltZVN0cmluZygpLm1hdGNoKC9cXCgoW0EtWmEteiBdKylcXCkkLykpP2VbMV06IkdNVCJ9ZT4+Pj0wLHQ+Pj49MCxyPj4+PTA7dmFyIGk9KG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpLHM9bmV3IERhdGUoaSwwLDEpLHU9bmV3IERhdGUoaSw2LDEpO2k9cy5nZXRUaW1lem9uZU9mZnNldCgpO3ZhciBjPXUuZ2V0VGltZXpvbmVPZmZzZXQoKSxsPU1hdGgubWF4KGksYyk7bygpW2U+PjI+Pj4wXT02MCpsLGEoKVt0Pj4yPj4+MF09TnVtYmVyKGkhPWMpLGU9bihzKSx0PW4odSksZT1CZShlKSx0PUJlKHQpLGM8aT8obygpW3I+PjI+Pj4wXT1lLG8oKVtyKzQ+PjI+Pj4wXT10KToobygpW3I+PjI+Pj4wXT10LG8oKVtyKzQ+PjI+Pj4wXT1lKX0sYzooKT0+e3RlKCIiKX0sbDpmdW5jdGlvbigpe30saTpmdW5jdGlvbigpe3JldHVybiBEYXRlLm5vdygpfSxWOigpPT57dGhyb3cgJCs9MSwidW53aW5kIn0sQjpmdW5jdGlvbigpe3JldHVybiA0Mjk0OTAxNzYwfSxlOigpPT5wZXJmb3JtYW5jZS50aW1lT3JpZ2luK3BlcmZvcm1hbmNlLm5vdygpLGY6ZnVuY3Rpb24oKXtyZXR1cm4gdj9yKDk5MykuY3B1cygpLmxlbmd0aDpuYXZpZ2F0b3IuaGFyZHdhcmVDb25jdXJyZW5jeX0sSzpmdW5jdGlvbihlLHQscixuKXtmb3IoZ2UucGI9dD4+PjAsSmUubGVuZ3RoPXIsdD1uPj4+MD4+MyxuPTA7bjxyO24rKylKZVtuXT1pKClbdCtuPj4+MF07cmV0dXJuIGx0W2VdLmFwcGx5KG51bGwsSmUpfSx5OmZ1bmN0aW9uKGUpe2U+Pj49MDt2YXIgdD1uKCkubGVuZ3RoO2lmKGU8PXR8fDQyOTQ5MDE3NjA8ZSlyZXR1cm4hMTtmb3IodmFyIHI9MTs0Pj1yO3IqPTIpe3ZhciBhPXQqKDErLjIvcik7YT1NYXRoLm1pbihhLGUrMTAwNjYzMjk2KTt2YXIgbz1NYXRoO2E9TWF0aC5tYXgoZSxhKTtlOntvPW8ubWluLmNhbGwobyw0Mjk0OTAxNzYwLGErKDY1NTM2LWElNjU1MzYpJTY1NTM2KS1rLmJ1ZmZlci5ieXRlTGVuZ3RoKzY1NTM1Pj4+MTY7dHJ5e2suZ3JvdyhvKSxZKCk7dmFyIGk9MTticmVhayBlfWNhdGNoKGUpe31pPXZvaWQgMH1pZihpKXJldHVybiEwfXJldHVybiExfSxPOlplLFA6UWUsajpwZSxnOmV0LG46dHQsdzpydCxtOmF0LHg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT4+Pj0wLHQ+Pj49MCxvdChuKCkuc3ViYXJyYXkoZT4+PjAsZSt0Pj4+MCkpLDB9LGE6a3x8Yy53YXNtTWVtb3J5LEg6Y3QsZDpmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gY3QoZT4+PjAsdD4+PjAscj4+PjAsbj4+PjApfX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3JldHVybiBlPWUuZXhwb3J0cyxDPWU9ZnVuY3Rpb24oZSl7dmFyIHQ9ZT0+KCk9PmUoKT4+PjAscj1lPT50PT5lKHQpPj4+MDtyZXR1cm4oZT1PYmplY3QuYXNzaWduKHt9LGUpKS5fX2Vycm5vX2xvY2F0aW9uPXQoZS5fX2Vycm5vX2xvY2F0aW9uKSxlLnB0aHJlYWRfc2VsZj10KGUucHRocmVhZF9zZWxmKSxlLm1hbGxvYz1yKGUubWFsbG9jKSxlLnN0YWNrU2F2ZT10KGUuc3RhY2tTYXZlKSxlLnN0YWNrQWxsb2M9cihlLnN0YWNrQWxsb2MpLGV9KGUpLGdlLlRhLnB1c2goQy5zYSksej1DLnRhLE4udW5zaGlmdChDLlcpLFA9dCxlZSgpLGV9dmFyIHQ9e2E6ZnR9O2lmKFEoKSxjLmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIGMuaW5zdGFudGlhdGVXYXNtKHQsZSl9Y2F0Y2goZSl7UigiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIitlKSx1KGUpfShmdW5jdGlvbihlLHQpe3ZhciByPVY7cmV0dXJuIFR8fCJmdW5jdGlvbiIhPXR5cGVvZiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZ3x8cmUocil8fHIuc3RhcnRzV2l0aCgiZmlsZTovLyIpfHx2fHwiZnVuY3Rpb24iIT10eXBlb2YgZmV0Y2g/YWUocixlLHQpOmZldGNoKHIse2NyZWRlbnRpYWxzOiJzYW1lLW9yaWdpbiJ9KS50aGVuKChuPT5XZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZyhuLGUpLnRoZW4odCwoZnVuY3Rpb24obil7cmV0dXJuIFIoIndhc20gc3RyZWFtaW5nIGNvbXBpbGUgZmFpbGVkOiAiK24pLFIoImZhbGxpbmcgYmFjayB0byBBcnJheUJ1ZmZlciBpbnN0YW50aWF0aW9uIiksYWUocixlLHQpfSkpKSl9KSh0LChmdW5jdGlvbih0KXtlKHQuaW5zdGFuY2UsdC5tb2R1bGUpfSkpLmNhdGNoKHUpfSgpLGMuX09ydEluaXQ9KGUsdCk9PihjLl9PcnRJbml0PUMuWCkoZSx0KSxjLl9PcnRHZXRMYXN0RXJyb3I9KGUsdCk9PihjLl9PcnRHZXRMYXN0RXJyb3I9Qy5ZKShlLHQpLGMuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPShlLHQscixuLGEsbyxpLHMsdSxsKT0+KGMuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPUMuWikoZSx0LHIsbixhLG8saSxzLHUsbCksYy5fT3J0QXBwZW5kRXhlY3V0aW9uUHJvdmlkZXI9KGUsdCk9PihjLl9PcnRBcHBlbmRFeGVjdXRpb25Qcm92aWRlcj1DLl8pKGUsdCksYy5fT3J0QWRkU2Vzc2lvbkNvbmZpZ0VudHJ5PShlLHQscik9PihjLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnk9Qy4kKShlLHQsciksYy5fT3J0UmVsZWFzZVNlc3Npb25PcHRpb25zPWU9PihjLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnM9Qy5hYSkoZSksYy5fT3J0Q3JlYXRlU2Vzc2lvbj0oZSx0LHIpPT4oYy5fT3J0Q3JlYXRlU2Vzc2lvbj1DLmJhKShlLHQsciksYy5fT3J0UmVsZWFzZVNlc3Npb249ZT0+KGMuX09ydFJlbGVhc2VTZXNzaW9uPUMuY2EpKGUpLGMuX09ydEdldElucHV0T3V0cHV0Q291bnQ9KGUsdCxyKT0+KGMuX09ydEdldElucHV0T3V0cHV0Q291bnQ9Qy5kYSkoZSx0LHIpLGMuX09ydEdldElucHV0TmFtZT0oZSx0KT0+KGMuX09ydEdldElucHV0TmFtZT1DLmVhKShlLHQpLGMuX09ydEdldE91dHB1dE5hbWU9KGUsdCk9PihjLl9PcnRHZXRPdXRwdXROYW1lPUMuZmEpKGUsdCksYy5fT3J0RnJlZT1lPT4oYy5fT3J0RnJlZT1DLmdhKShlKSxjLl9PcnRDcmVhdGVUZW5zb3I9KGUsdCxyLG4sYSk9PihjLl9PcnRDcmVhdGVUZW5zb3I9Qy5oYSkoZSx0LHIsbixhKSxjLl9PcnRHZXRUZW5zb3JEYXRhPShlLHQscixuLGEpPT4oYy5fT3J0R2V0VGVuc29yRGF0YT1DLmlhKShlLHQscixuLGEpLGMuX09ydFJlbGVhc2VUZW5zb3I9ZT0+KGMuX09ydFJlbGVhc2VUZW5zb3I9Qy5qYSkoZSksYy5fT3J0Q3JlYXRlUnVuT3B0aW9ucz0oZSx0LHIsbik9PihjLl9PcnRDcmVhdGVSdW5PcHRpb25zPUMua2EpKGUsdCxyLG4pLGMuX09ydEFkZFJ1bkNvbmZpZ0VudHJ5PShlLHQscik9PihjLl9PcnRBZGRSdW5Db25maWdFbnRyeT1DLmxhKShlLHQsciksYy5fT3J0UmVsZWFzZVJ1bk9wdGlvbnM9ZT0+KGMuX09ydFJlbGVhc2VSdW5PcHRpb25zPUMubWEpKGUpLGMuX09ydFJ1bj0oZSx0LHIsbixhLG8saSxzKT0+KGMuX09ydFJ1bj1DLm5hKShlLHQscixuLGEsbyxpLHMpLGMuX09ydEVuZFByb2ZpbGluZz1lPT4oYy5fT3J0RW5kUHJvZmlsaW5nPUMub2EpKGUpO3ZhciBkdD1jLl9wdGhyZWFkX3NlbGY9KCk9PihkdD1jLl9wdGhyZWFkX3NlbGY9Qy5wYSkoKSxwdD1jLl9tYWxsb2M9ZT0+KHB0PWMuX21hbGxvYz1DLnFhKShlKTtjLl9mcmVlPWU9PihjLl9mcmVlPUMucmEpKGUpLGMuX19lbXNjcmlwdGVuX3Rsc19pbml0PSgpPT4oYy5fX2Vtc2NyaXB0ZW5fdGxzX2luaXQ9Qy5zYSkoKTt2YXIgZ3Q9Yy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2luaXQ9KGUsdCxyLG4sYSxvKT0+KGd0PWMuX19lbXNjcmlwdGVuX3RocmVhZF9pbml0PUMudWEpKGUsdCxyLG4sYSxvKTtjLl9fZW1zY3JpcHRlbl90aHJlYWRfY3Jhc2hlZD0oKT0+KGMuX19lbXNjcmlwdGVuX3RocmVhZF9jcmFzaGVkPUMudmEpKCk7dmFyIGh0LG10PShlLHQscixuKT0+KG10PUMud2EpKGUsdCxyLG4pLHl0PWU9Pih5dD1DLnhhKShlKSx2dD1jLl9fZW1zY3JpcHRlbl90aHJlYWRfZXhpdD1lPT4odnQ9Yy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2V4aXQ9Qy55YSkoZSksYnQ9Yy5fX2Vtc2NyaXB0ZW5fY2hlY2tfbWFpbGJveD0oKT0+KGJ0PWMuX19lbXNjcmlwdGVuX2NoZWNrX21haWxib3g9Qy56YSkoKSx3dD1lPT4od3Q9Qy5BYSkoZSksX3Q9KGUsdCk9PihfdD1DLkJhKShlLHQpLE90PSgpPT4oT3Q9Qy5DYSkoKSxTdD1lPT4oU3Q9Qy5EYSkoZSksRXQ9ZT0+KEV0PUMuRWEpKGUpO2Z1bmN0aW9uIEF0KCl7ZnVuY3Rpb24gZSgpe2lmKCFodCYmKGh0PSEwLGMuY2FsbGVkUnVuPSEwLCFIKSYmKGJ8fGhlKE4pLHMoYyksYy5vblJ1bnRpbWVJbml0aWFsaXplZCYmYy5vblJ1bnRpbWVJbml0aWFsaXplZCgpLCFiKSl7aWYoYy5wb3N0UnVuKWZvcigiZnVuY3Rpb24iPT10eXBlb2YgYy5wb3N0UnVuJiYoYy5wb3N0UnVuPVtjLnBvc3RSdW5dKTtjLnBvc3RSdW4ubGVuZ3RoOyl7dmFyIGU9Yy5wb3N0UnVuLnNoaWZ0KCk7Qi51bnNoaWZ0KGUpfWhlKEIpfX1pZighKDA8WCkpaWYoYilzKGMpLGJ8fGhlKE4pLHN0YXJ0V29ya2VyKGMpO2Vsc2V7aWYoYy5wcmVSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBjLnByZVJ1biYmKGMucHJlUnVuPVtjLnByZVJ1bl0pO2MucHJlUnVuLmxlbmd0aDspRy51bnNoaWZ0KGMucHJlUnVuLnNoaWZ0KCkpO2hlKEcpLDA8WHx8KGMuc2V0U3RhdHVzPyhjLnNldFN0YXR1cygiUnVubmluZy4uLiIpLHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7c2V0VGltZW91dCgoZnVuY3Rpb24oKXtjLnNldFN0YXR1cygiIil9KSwxKSxlKCl9KSwxKSk6ZSgpKX19aWYoYy5rZWVwUnVudGltZUFsaXZlPXEsYy53YXNtTWVtb3J5PWssYy5zdGFja0FsbG9jPUV0LGMuc3RhY2tTYXZlPU90LGMuc3RhY2tSZXN0b3JlPVN0LGMuVVRGOFRvU3RyaW5nPWZlLGMuc3RyaW5nVG9VVEY4PUFlLGMubGVuZ3RoQnl0ZXNVVEY4PVNlLGMuRXhpdFN0YXR1cz1vZSxjLlBUaHJlYWQ9Z2UsWj1mdW5jdGlvbiBlKCl7aHR8fEF0KCksaHR8fChaPWUpfSxjLnByZUluaXQpZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBjLnByZUluaXQmJihjLnByZUluaXQ9W2MucHJlSW5pdF0pOzA8Yy5wcmVJbml0Lmxlbmd0aDspYy5wcmVJbml0LnBvcCgpKCk7cmV0dXJuIEF0KCksZS5yZWFkeX0pO2UuZXhwb3J0cz1ufSw5MzI6KGUsdCxyKT0+e3ZhciBfc2NyaXB0RGlyLG49KF9zY3JpcHREaXI9InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmZG9jdW1lbnQuY3VycmVudFNjcmlwdD9kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYzp2b2lkIDAsInVuZGVmaW5lZCIhPXR5cGVvZiBfX2ZpbGVuYW1lJiYoX3NjcmlwdERpcj1fc2NyaXB0RGlyfHxfX2ZpbGVuYW1lKSxmdW5jdGlvbihlPXt9KXt2YXIgdCxuLGE9ZTthLnJlYWR5PW5ldyBQcm9taXNlKCgoZSxyKT0+e3Q9ZSxuPXJ9KSk7dmFyIG8saSxzLHU9T2JqZWN0LmFzc2lnbih7fSxhKSxjPSIuL3RoaXMucHJvZ3JhbSIsbD0oZSx0KT0+e3Rocm93IHR9LGY9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3csZD0iZnVuY3Rpb24iPT10eXBlb2YgaW1wb3J0U2NyaXB0cyxwPSJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzLnZlcnNpb25zJiYic3RyaW5nIj09dHlwZW9mIHByb2Nlc3MudmVyc2lvbnMubm9kZSxnPSIiO2lmKHApe3ZhciBoPXIoMzg0KSxtPXIoOTA4KTtnPWQ/bS5kaXJuYW1lKGcpKyIvIjpfX2Rpcm5hbWUrIi8iLG89KGUsdCk9PihlPWUuc3RhcnRzV2l0aCgiZmlsZTovLyIpP25ldyBVUkwoZSk6bS5ub3JtYWxpemUoZSksaC5yZWFkRmlsZVN5bmMoZSx0P3ZvaWQgMDoidXRmOCIpKSxzPWU9PigoZT1vKGUsITApKS5idWZmZXJ8fChlPW5ldyBVaW50OEFycmF5KGUpKSxlKSxpPShlLHQscixuPSEwKT0+e2U9ZS5zdGFydHNXaXRoKCJmaWxlOi8vIik/bmV3IFVSTChlKTptLm5vcm1hbGl6ZShlKSxoLnJlYWRGaWxlKGUsbj92b2lkIDA6InV0ZjgiLCgoZSxhKT0+e2U/cihlKTp0KG4/YS5idWZmZXI6YSl9KSl9LCFhLnRoaXNQcm9ncmFtJiYxPHByb2Nlc3MuYXJndi5sZW5ndGgmJihjPXByb2Nlc3MuYXJndlsxXS5yZXBsYWNlKC9cXFxcL2csIi8iKSkscHJvY2Vzcy5hcmd2LnNsaWNlKDIpLGw9KGUsdCk9Pnt0aHJvdyBwcm9jZXNzLmV4aXRDb2RlPWUsdH0sYS5pbnNwZWN0PSgpPT4iW0Vtc2NyaXB0ZW4gTW9kdWxlIG9iamVjdF0ifWVsc2UoZnx8ZCkmJihkP2c9c2VsZi5sb2NhdGlvbi5ocmVmOiJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQmJmRvY3VtZW50LmN1cnJlbnRTY3JpcHQmJihnPWRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjKSxfc2NyaXB0RGlyJiYoZz1fc2NyaXB0RGlyKSxnPTAhPT1nLmluZGV4T2YoImJsb2I6Iik/Zy5zdWJzdHIoMCxnLnJlcGxhY2UoL1s/I10uKi8sIiIpLmxhc3RJbmRleE9mKCIvIikrMSk6IiIsbz1lPT57dmFyIHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiB0Lm9wZW4oIkdFVCIsZSwhMSksdC5zZW5kKG51bGwpLHQucmVzcG9uc2VUZXh0fSxkJiYocz1lPT57dmFyIHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiB0Lm9wZW4oIkdFVCIsZSwhMSksdC5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIix0LnNlbmQobnVsbCksbmV3IFVpbnQ4QXJyYXkodC5yZXNwb25zZSl9KSxpPShlLHQscik9Pnt2YXIgbj1uZXcgWE1MSHR0cFJlcXVlc3Q7bi5vcGVuKCJHRVQiLGUsITApLG4ucmVzcG9uc2VUeXBlPSJhcnJheWJ1ZmZlciIsbi5vbmxvYWQ9KCk9PnsyMDA9PW4uc3RhdHVzfHwwPT1uLnN0YXR1cyYmbi5yZXNwb25zZT90KG4ucmVzcG9uc2UpOnIoKX0sbi5vbmVycm9yPXIsbi5zZW5kKG51bGwpfSk7dmFyIHksdj1hLnByaW50fHxjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLGI9YS5wcmludEVycnx8Y29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpO09iamVjdC5hc3NpZ24oYSx1KSx1PW51bGwsYS50aGlzUHJvZ3JhbSYmKGM9YS50aGlzUHJvZ3JhbSksYS5xdWl0JiYobD1hLnF1aXQpLGEud2FzbUJpbmFyeSYmKHk9YS53YXNtQmluYXJ5KTt2YXIgdz1hLm5vRXhpdFJ1bnRpbWV8fCEwOyJvYmplY3QiIT10eXBlb2YgV2ViQXNzZW1ibHkmJlcoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKTt2YXIgXyxPLFMsRSxBLFQsTT0hMTtmdW5jdGlvbiBSKCl7dmFyIGU9Xy5idWZmZXI7YS5IRUFQOD1TPW5ldyBJbnQ4QXJyYXkoZSksYS5IRUFQMTY9bmV3IEludDE2QXJyYXkoZSksYS5IRUFQMzI9QT1uZXcgSW50MzJBcnJheShlKSxhLkhFQVBVOD1FPW5ldyBVaW50OEFycmF5KGUpLGEuSEVBUFUxNj1uZXcgVWludDE2QXJyYXkoZSksYS5IRUFQVTMyPVQ9bmV3IFVpbnQzMkFycmF5KGUpLGEuSEVBUEYzMj1uZXcgRmxvYXQzMkFycmF5KGUpLGEuSEVBUEY2ND1uZXcgRmxvYXQ2NEFycmF5KGUpfXZhciBGPVtdLGs9W10sQz1bXTtmdW5jdGlvbiBQKCl7dmFyIGU9YS5wcmVSdW4uc2hpZnQoKTtGLnVuc2hpZnQoZSl9dmFyIEQseCxJPTAsVT1udWxsLEw9bnVsbDtmdW5jdGlvbiBXKGUpe3Rocm93IGEub25BYm9ydCYmYS5vbkFib3J0KGUpLGIoZT0iQWJvcnRlZCgiK2UrIikiKSxNPSEwLGU9bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcihlKyIuIEJ1aWxkIHdpdGggLXNBU1NFUlRJT05TIGZvciBtb3JlIGluZm8uIiksbihlKSxlfWZ1bmN0aW9uIEgoZSl7cmV0dXJuIGUuc3RhcnRzV2l0aCgiZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCIpfWlmKCFIKEQ9Im9ydC13YXNtLndhc20iKSl7dmFyIFk9RDtEPWEubG9jYXRlRmlsZT9hLmxvY2F0ZUZpbGUoWSxnKTpnK1l9ZnVuY3Rpb24gaihlKXtpZihlPT1EJiZ5KXJldHVybiBuZXcgVWludDhBcnJheSh5KTtpZihzKXJldHVybiBzKGUpO3Rocm93ImJvdGggYXN5bmMgYW5kIHN5bmMgZmV0Y2hpbmcgb2YgdGhlIHdhc20gZmFpbGVkIn1mdW5jdGlvbiB6KGUsdCxyKXtyZXR1cm4gZnVuY3Rpb24oZSl7aWYoIXkmJihmfHxkKSl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGZldGNoJiYhZS5zdGFydHNXaXRoKCJmaWxlOi8vIikpcmV0dXJuIGZldGNoKGUse2NyZWRlbnRpYWxzOiJzYW1lLW9yaWdpbiJ9KS50aGVuKCh0PT57aWYoIXQub2spdGhyb3ciZmFpbGVkIHRvIGxvYWQgd2FzbSBiaW5hcnkgZmlsZSBhdCBcJyIrZSsiXCciO3JldHVybiB0LmFycmF5QnVmZmVyKCl9KSkuY2F0Y2goKCgpPT5qKGUpKSk7aWYoaSlyZXR1cm4gbmV3IFByb21pc2UoKCh0LHIpPT57aShlLChlPT50KG5ldyBVaW50OEFycmF5KGUpKSkscil9KSl9cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCgpPT5qKGUpKSl9KGUpLnRoZW4oKGU9PldlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGUsdCkpKS50aGVuKChlPT5lKSkudGhlbihyLChlPT57YigiZmFpbGVkIHRvIGFzeW5jaHJvbm91c2x5IHByZXBhcmUgd2FzbTogIitlKSxXKGUpfSkpfWZ1bmN0aW9uIEcoZSl7dGhpcy5uYW1lPSJFeGl0U3RhdHVzIix0aGlzLm1lc3NhZ2U9YFByb2dyYW0gdGVybWluYXRlZCB3aXRoIGV4aXQoJHtlfSlgLHRoaXMuc3RhdHVzPWV9dmFyIE49ZT0+e2Zvcig7MDxlLmxlbmd0aDspZS5zaGlmdCgpKGEpfTtmdW5jdGlvbiBCKGUpe3RoaXMucWE9ZS0yNCx0aGlzLnZhPWZ1bmN0aW9uKGUpe1RbdGhpcy5xYSs0Pj4yPj4+MF09ZX0sdGhpcy51YT1mdW5jdGlvbihlKXtUW3RoaXMucWErOD4+Mj4+PjBdPWV9LHRoaXMuc2E9ZnVuY3Rpb24oZSx0KXt0aGlzLnRhKCksdGhpcy52YShlKSx0aGlzLnVhKHQpfSx0aGlzLnRhPWZ1bmN0aW9uKCl7VFt0aGlzLnFhKzE2Pj4yPj4+MF09MH19dmFyICQscT0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMCxWPShlLHQscik9Pnt2YXIgbj0odD4+Pj0wKStyO2ZvcihyPXQ7ZVtyXSYmIShyPj1uKTspKytyO2lmKDE2PHItdCYmZS5idWZmZXImJnEpcmV0dXJuIHEuZGVjb2RlKGUuc3ViYXJyYXkodCxyKSk7Zm9yKG49IiI7dDxyOyl7dmFyIGE9ZVt0KytdO2lmKDEyOCZhKXt2YXIgbz02MyZlW3QrK107aWYoMTkyPT0oMjI0JmEpKW4rPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJmEpPDw2fG8pO2Vsc2V7dmFyIGk9NjMmZVt0KytdOzY1NTM2PihhPTIyND09KDI0MCZhKT8oMTUmYSk8PDEyfG88PDZ8aTooNyZhKTw8MTh8bzw8MTJ8aTw8Nnw2MyZlW3QrK10pP24rPVN0cmluZy5mcm9tQ2hhckNvZGUoYSk6KGEtPTY1NTM2LG4rPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8YT4+MTAsNTYzMjB8MTAyMyZhKSl9fWVsc2Ugbis9U3RyaW5nLmZyb21DaGFyQ29kZShhKX1yZXR1cm4gbn0sSj0oZSx0KT0+KGU+Pj49MCk/VihFLGUsdCk6IiIsWD1lPT57Zm9yKHZhciB0PTAscj0wO3I8ZS5sZW5ndGg7KytyKXt2YXIgbj1lLmNoYXJDb2RlQXQocik7MTI3Pj1uP3QrKzoyMDQ3Pj1uP3QrPTI6NTUyOTY8PW4mJjU3MzQzPj1uPyh0Kz00LCsrcik6dCs9M31yZXR1cm4gdH0sSz0oZSx0LHIsbik9PntpZighKDA8bikpcmV0dXJuIDA7dmFyIGE9cj4+Pj0wO249cituLTE7Zm9yKHZhciBvPTA7bzxlLmxlbmd0aDsrK28pe3ZhciBpPWUuY2hhckNvZGVBdChvKTtpZig1NTI5Njw9aSYmNTczNDM+PWkmJihpPTY1NTM2KygoMTAyMyZpKTw8MTApfDEwMjMmZS5jaGFyQ29kZUF0KCsrbykpLDEyNz49aSl7aWYocj49bilicmVhazt0W3IrKz4+PjBdPWl9ZWxzZXtpZigyMDQ3Pj1pKXtpZihyKzE+PW4pYnJlYWs7dFtyKys+Pj4wXT0xOTJ8aT4+Nn1lbHNle2lmKDY1NTM1Pj1pKXtpZihyKzI+PW4pYnJlYWs7dFtyKys+Pj4wXT0yMjR8aT4+MTJ9ZWxzZXtpZihyKzM+PW4pYnJlYWs7dFtyKys+Pj4wXT0yNDB8aT4+MTgsdFtyKys+Pj4wXT0xMjh8aT4+MTImNjN9dFtyKys+Pj4wXT0xMjh8aT4+NiY2M310W3IrKz4+PjBdPTEyOHw2MyZpfX1yZXR1cm4gdFtyPj4+MF09MCxyLWF9LFo9ZT0+MD09ZSU0JiYoMCE9ZSUxMDB8fDA9PWUlNDAwKSxRPVswLDMxLDYwLDkxLDEyMSwxNTIsMTgyLDIxMywyNDQsMjc0LDMwNSwzMzVdLGVlPVswLDMxLDU5LDkwLDEyMCwxNTEsMTgxLDIxMiwyNDMsMjczLDMwNCwzMzRdLHRlPWU9Pnt2YXIgdD1YKGUpKzEscj1sZSh0KTtyZXR1cm4gciYmSyhlLEUscix0KSxyfSxyZT17fSxuZT0oKT0+e2lmKCEkKXt2YXIgZSx0PXtVU0VSOiJ3ZWJfdXNlciIsTE9HTkFNRToid2ViX3VzZXIiLFBBVEg6Ii8iLFBXRDoiLyIsSE9NRToiL2hvbWUvd2ViX3VzZXIiLExBTkc6KCJvYmplY3QiPT10eXBlb2YgbmF2aWdhdG9yJiZuYXZpZ2F0b3IubGFuZ3VhZ2VzJiZuYXZpZ2F0b3IubGFuZ3VhZ2VzWzBdfHwiQyIpLnJlcGxhY2UoIi0iLCJfIikrIi5VVEYtOCIsXzpjfHwiLi90aGlzLnByb2dyYW0ifTtmb3IoZSBpbiByZSl2b2lkIDA9PT1yZVtlXT9kZWxldGUgdFtlXTp0W2VdPXJlW2VdO3ZhciByPVtdO2ZvcihlIGluIHQpci5wdXNoKGAke2V9PSR7dFtlXX1gKTskPXJ9cmV0dXJuICR9LGFlPVtudWxsLFtdLFtdXSxvZT1lPT4ob2U9KCgpPT57aWYoIm9iamVjdCI9PXR5cGVvZiBjcnlwdG8mJiJmdW5jdGlvbiI9PXR5cGVvZiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKXJldHVybiBlPT5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGUpO2lmKHApdHJ5e3ZhciBlPXIoNzYwKTtpZihlLnJhbmRvbUZpbGxTeW5jKXJldHVybiB0PT5lLnJhbmRvbUZpbGxTeW5jKHQpO3ZhciB0PWUucmFuZG9tQnl0ZXM7cmV0dXJuIGU9PihlLnNldCh0KGUuYnl0ZUxlbmd0aCkpLGUpfWNhdGNoKGUpe31XKCJpbml0UmFuZG9tRGV2aWNlIil9KSgpKShlKSxpZT1bMzEsMjksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLHNlPVszMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV07ZnVuY3Rpb24gdWUoZSx0LHIsbil7ZnVuY3Rpb24gYShlLHQscil7Zm9yKGU9Im51bWJlciI9PXR5cGVvZiBlP2UudG9TdHJpbmcoKTplfHwiIjtlLmxlbmd0aDx0OyllPXJbMF0rZTtyZXR1cm4gZX1mdW5jdGlvbiBvKGUsdCl7cmV0dXJuIGEoZSx0LCIwIil9ZnVuY3Rpb24gaShlLHQpe2Z1bmN0aW9uIHIoZSl7cmV0dXJuIDA+ZT8tMTowPGU/MTowfXZhciBuO3JldHVybiAwPT09KG49cihlLmdldEZ1bGxZZWFyKCktdC5nZXRGdWxsWWVhcigpKSkmJjA9PT0obj1yKGUuZ2V0TW9udGgoKS10LmdldE1vbnRoKCkpKSYmKG49cihlLmdldERhdGUoKS10LmdldERhdGUoKSkpLG59ZnVuY3Rpb24gcyhlKXtzd2l0Y2goZS5nZXREYXkoKSl7Y2FzZSAwOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCktMSwxMSwyOSk7Y2FzZSAxOnJldHVybiBlO2Nhc2UgMjpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMyk7Y2FzZSAzOnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwyKTtjYXNlIDQ6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDEpO2Nhc2UgNTpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMzEpO2Nhc2UgNjpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMzApfX1mdW5jdGlvbiB1KGUpe3ZhciB0PWUubWE7Zm9yKGU9bmV3IERhdGUobmV3IERhdGUoZS5uYSsxOTAwLDAsMSkuZ2V0VGltZSgpKTswPHQ7KXt2YXIgcj1lLmdldE1vbnRoKCksbj0oWihlLmdldEZ1bGxZZWFyKCkpP2llOnNlKVtyXTtpZighKHQ+bi1lLmdldERhdGUoKSkpe2Uuc2V0RGF0ZShlLmdldERhdGUoKSt0KTticmVha310LT1uLWUuZ2V0RGF0ZSgpKzEsZS5zZXREYXRlKDEpLDExPnI/ZS5zZXRNb250aChyKzEpOihlLnNldE1vbnRoKDApLGUuc2V0RnVsbFllYXIoZS5nZXRGdWxsWWVhcigpKzEpKX1yZXR1cm4gcj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCkrMSwwLDQpLHQ9cyhuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCw0KSkscj1zKHIpLDA+PWkodCxlKT8wPj1pKHIsZSk/ZS5nZXRGdWxsWWVhcigpKzE6ZS5nZXRGdWxsWWVhcigpOmUuZ2V0RnVsbFllYXIoKS0xfWU+Pj49MCx0Pj4+PTAscj4+Pj0wO3ZhciBjPUFbNDArKG4+Pj49MCk+PjI+Pj4wXTtmb3IodmFyIGwgaW4gbj17eWE6QVtuPj4yPj4+MF0seGE6QVtuKzQ+PjI+Pj4wXSxvYTpBW24rOD4+Mj4+PjBdLHJhOkFbbisxMj4+Mj4+PjBdLHBhOkFbbisxNj4+Mj4+PjBdLG5hOkFbbisyMD4+Mj4+PjBdLGhhOkFbbisyND4+Mj4+PjBdLG1hOkFbbisyOD4+Mj4+PjBdLEFhOkFbbiszMj4+Mj4+PjBdLHdhOkFbbiszNj4+Mj4+PjBdLHphOmM/SihjKToiIn0scj1KKHIpLGM9eyIlYyI6IiVhICViICVkICVIOiVNOiVTICVZIiwiJUQiOiIlbS8lZC8leSIsIiVGIjoiJVktJW0tJWQiLCIlaCI6IiViIiwiJXIiOiIlSTolTTolUyAlcCIsIiVSIjoiJUg6JU0iLCIlVCI6IiVIOiVNOiVTIiwiJXgiOiIlbS8lZC8leSIsIiVYIjoiJUg6JU06JVMiLCIlRWMiOiIlYyIsIiVFQyI6IiVDIiwiJUV4IjoiJW0vJWQvJXkiLCIlRVgiOiIlSDolTTolUyIsIiVFeSI6IiV5IiwiJUVZIjoiJVkiLCIlT2QiOiIlZCIsIiVPZSI6IiVlIiwiJU9IIjoiJUgiLCIlT0kiOiIlSSIsIiVPbSI6IiVtIiwiJU9NIjoiJU0iLCIlT1MiOiIlUyIsIiVPdSI6IiV1IiwiJU9VIjoiJVUiLCIlT1YiOiIlViIsIiVPdyI6IiV3IiwiJU9XIjoiJVciLCIlT3kiOiIleSJ9KXI9ci5yZXBsYWNlKG5ldyBSZWdFeHAobCwiZyIpLGNbbF0pO3ZhciBmPSJTdW5kYXkgTW9uZGF5IFR1ZXNkYXkgV2VkbmVzZGF5IFRodXJzZGF5IEZyaWRheSBTYXR1cmRheSIuc3BsaXQoIiAiKSxkPSJKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyIi5zcGxpdCgiICIpO2ZvcihsIGluIGM9eyIlYSI6ZT0+ZltlLmhhXS5zdWJzdHJpbmcoMCwzKSwiJUEiOmU9PmZbZS5oYV0sIiViIjplPT5kW2UucGFdLnN1YnN0cmluZygwLDMpLCIlQiI6ZT0+ZFtlLnBhXSwiJUMiOmU9Pm8oKGUubmErMTkwMCkvMTAwfDAsMiksIiVkIjplPT5vKGUucmEsMiksIiVlIjplPT5hKGUucmEsMiwiICIpLCIlZyI6ZT0+dShlKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJUciOmU9PnUoZSksIiVIIjplPT5vKGUub2EsMiksIiVJIjplPT4oMD09KGU9ZS5vYSk/ZT0xMjoxMjxlJiYoZS09MTIpLG8oZSwyKSksIiVqIjplPT57Zm9yKHZhciB0PTAscj0wO3I8PWUucGEtMTt0Kz0oWihlLm5hKzE5MDApP2llOnNlKVtyKytdKTtyZXR1cm4gbyhlLnJhK3QsMyl9LCIlbSI6ZT0+byhlLnBhKzEsMiksIiVNIjplPT5vKGUueGEsMiksIiVuIjooKT0+IlxcbiIsIiVwIjplPT4wPD1lLm9hJiYxMj5lLm9hPyJBTSI6IlBNIiwiJVMiOmU9Pm8oZS55YSwyKSwiJXQiOigpPT4iXFx0IiwiJXUiOmU9PmUuaGF8fDcsIiVVIjplPT5vKE1hdGguZmxvb3IoKGUubWErNy1lLmhhKS83KSwyKSwiJVYiOmU9Pnt2YXIgdD1NYXRoLmZsb29yKChlLm1hKzctKGUuaGErNiklNykvNyk7aWYoMj49KGUuaGErMzcxLWUubWEtMiklNyYmdCsrLHQpNTM9PXQmJig0PT0ocj0oZS5oYSszNzEtZS5tYSklNyl8fDM9PXImJlooZS5uYSl8fCh0PTEpKTtlbHNle3Q9NTI7dmFyIHI9KGUuaGErNy1lLm1hLTEpJTc7KDQ9PXJ8fDU9PXImJlooZS5uYSU0MDAtMSkpJiZ0Kyt9cmV0dXJuIG8odCwyKX0sIiV3IjplPT5lLmhhLCIlVyI6ZT0+byhNYXRoLmZsb29yKChlLm1hKzctKGUuaGErNiklNykvNyksMiksIiV5IjplPT4oZS5uYSsxOTAwKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJVkiOmU9PmUubmErMTkwMCwiJXoiOmU9Pnt2YXIgdD0wPD0oZT1lLndhKTtyZXR1cm4gZT1NYXRoLmFicyhlKS82MCwodD8iKyI6Ii0iKStTdHJpbmcoIjAwMDAiKyhlLzYwKjEwMCtlJTYwKSkuc2xpY2UoLTQpfSwiJVoiOmU9PmUuemEsIiUlIjooKT0+IiUifSxyPXIucmVwbGFjZSgvJSUvZywiXFwwXFwwIiksYylyLmluY2x1ZGVzKGwpJiYocj1yLnJlcGxhY2UobmV3IFJlZ0V4cChsLCJnIiksY1tsXShuKSkpO3JldHVybiBsPWZ1bmN0aW9uKGUpe3ZhciB0PUFycmF5KFgoZSkrMSk7cmV0dXJuIEsoZSx0LDAsdC5sZW5ndGgpLHR9KHI9ci5yZXBsYWNlKC9cXDBcXDAvZywiJSIpKSxsLmxlbmd0aD50PzA6KFMuc2V0KGwsZT4+PjApLGwubGVuZ3RoLTEpfXZhciBjZT17YTpmdW5jdGlvbihlLHQscil7dGhyb3cgbmV3IEIoZT4+Pj0wKS5zYSh0Pj4+MCxyPj4+MCksZX0sZTpmdW5jdGlvbigpe3JldHVybiAwfSxJOmZ1bmN0aW9uKCl7fSx5OmZ1bmN0aW9uKCl7fSxBOmZ1bmN0aW9uKCl7fSxLOmZ1bmN0aW9uKCl7cmV0dXJuIDB9LEc6ZnVuY3Rpb24oKXt9LEI6ZnVuY3Rpb24oKXt9LEY6ZnVuY3Rpb24oKXt9LGc6ZnVuY3Rpb24oKXt9LHo6ZnVuY3Rpb24oKXt9LHc6ZnVuY3Rpb24oKXt9LEg6ZnVuY3Rpb24oKXt9LHg6ZnVuY3Rpb24oKXt9LGs6KCk9PiEwLG46ZnVuY3Rpb24oZSx0LHIpe2U9dCsyMDk3MTUyPj4+MDw0MTk0MzA1LSEhZT8oZT4+PjApKzQyOTQ5NjcyOTYqdDpOYU4scj4+Pj0wLGU9bmV3IERhdGUoMWUzKmUpLEFbcj4+Mj4+PjBdPWUuZ2V0VVRDU2Vjb25kcygpLEFbcis0Pj4yPj4+MF09ZS5nZXRVVENNaW51dGVzKCksQVtyKzg+PjI+Pj4wXT1lLmdldFVUQ0hvdXJzKCksQVtyKzEyPj4yPj4+MF09ZS5nZXRVVENEYXRlKCksQVtyKzE2Pj4yPj4+MF09ZS5nZXRVVENNb250aCgpLEFbcisyMD4+Mj4+PjBdPWUuZ2V0VVRDRnVsbFllYXIoKS0xOTAwLEFbcisyND4+Mj4+PjBdPWUuZ2V0VVRDRGF5KCksQVtyKzI4Pj4yPj4+MF09KGUuZ2V0VGltZSgpLURhdGUuVVRDKGUuZ2V0VVRDRnVsbFllYXIoKSwwLDEsMCwwLDAsMCkpLzg2NGU1fDB9LG86ZnVuY3Rpb24oZSx0LHIpe2U9dCsyMDk3MTUyPj4+MDw0MTk0MzA1LSEhZT8oZT4+PjApKzQyOTQ5NjcyOTYqdDpOYU4scj4+Pj0wLGU9bmV3IERhdGUoMWUzKmUpLEFbcj4+Mj4+PjBdPWUuZ2V0U2Vjb25kcygpLEFbcis0Pj4yPj4+MF09ZS5nZXRNaW51dGVzKCksQVtyKzg+PjI+Pj4wXT1lLmdldEhvdXJzKCksQVtyKzEyPj4yPj4+MF09ZS5nZXREYXRlKCksQVtyKzE2Pj4yPj4+MF09ZS5nZXRNb250aCgpLEFbcisyMD4+Mj4+PjBdPWUuZ2V0RnVsbFllYXIoKS0xOTAwLEFbcisyND4+Mj4+PjBdPWUuZ2V0RGF5KCksQVtyKzI4Pj4yPj4+MF09KFooZS5nZXRGdWxsWWVhcigpKT9ROmVlKVtlLmdldE1vbnRoKCldK2UuZ2V0RGF0ZSgpLTF8MCxBW3IrMzY+PjI+Pj4wXT0tNjAqZS5nZXRUaW1lem9uZU9mZnNldCgpLHQ9bmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgbj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwxKS5nZXRUaW1lem9uZU9mZnNldCgpO0FbciszMj4+Mj4+PjBdPTB8KHQhPW4mJmUuZ2V0VGltZXpvbmVPZmZzZXQoKT09TWF0aC5taW4obix0KSl9LHA6ZnVuY3Rpb24oZSl7ZT4+Pj0wO3ZhciB0PW5ldyBEYXRlKEFbZSsyMD4+Mj4+PjBdKzE5MDAsQVtlKzE2Pj4yPj4+MF0sQVtlKzEyPj4yPj4+MF0sQVtlKzg+PjI+Pj4wXSxBW2UrND4+Mj4+PjBdLEFbZT4+Mj4+PjBdLDApLHI9QVtlKzMyPj4yPj4+MF0sbj10LmdldFRpbWV6b25lT2Zmc2V0KCksYT1uZXcgRGF0ZSh0LmdldEZ1bGxZZWFyKCksNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpLG89bmV3IERhdGUodC5nZXRGdWxsWWVhcigpLDAsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKSxpPU1hdGgubWluKG8sYSk7cmV0dXJuIDA+cj9BW2UrMzI+PjI+Pj4wXT1OdW1iZXIoYSE9byYmaT09bik6MDxyIT0oaT09bikmJihhPU1hdGgubWF4KG8sYSksdC5zZXRUaW1lKHQuZ2V0VGltZSgpKzZlNCooKDA8cj9pOmEpLW4pKSksQVtlKzI0Pj4yPj4+MF09dC5nZXREYXkoKSxBW2UrMjg+PjI+Pj4wXT0oWih0LmdldEZ1bGxZZWFyKCkpP1E6ZWUpW3QuZ2V0TW9udGgoKV0rdC5nZXREYXRlKCktMXwwLEFbZT4+Mj4+PjBdPXQuZ2V0U2Vjb25kcygpLEFbZSs0Pj4yPj4+MF09dC5nZXRNaW51dGVzKCksQVtlKzg+PjI+Pj4wXT10LmdldEhvdXJzKCksQVtlKzEyPj4yPj4+MF09dC5nZXREYXRlKCksQVtlKzE2Pj4yPj4+MF09dC5nZXRNb250aCgpLEFbZSsyMD4+Mj4+PjBdPXQuZ2V0WWVhcigpLGU9dC5nZXRUaW1lKCkvMWUzLGRlKCh4PWUsMTw9K01hdGguYWJzKHgpPzA8eD8rTWF0aC5mbG9vcih4LzQyOTQ5NjcyOTYpPj4+MDp+fitNYXRoLmNlaWwoKHgtKyh+fng+Pj4wKSkvNDI5NDk2NzI5Nik+Pj4wOjApKSxlPj4+MH0sbDpmdW5jdGlvbigpe3JldHVybi01Mn0sbTpmdW5jdGlvbigpe30sdTpmdW5jdGlvbihlLHQscil7ZnVuY3Rpb24gbihlKXtyZXR1cm4oZT1lLnRvVGltZVN0cmluZygpLm1hdGNoKC9cXCgoW0EtWmEteiBdKylcXCkkLykpP2VbMV06IkdNVCJ9cj4+Pj0wO3ZhciBhPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSxvPW5ldyBEYXRlKGEsMCwxKSxpPW5ldyBEYXRlKGEsNiwxKTthPW8uZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgcz1pLmdldFRpbWV6b25lT2Zmc2V0KCk7VFtlPj4+MD4+Mj4+PjBdPTYwKk1hdGgubWF4KGEscyksQVt0Pj4+MD4+Mj4+PjBdPU51bWJlcihhIT1zKSxlPW4obyksdD1uKGkpLGU9dGUoZSksdD10ZSh0KSxzPGE/KFRbcj4+Mj4+PjBdPWUsVFtyKzQ+PjI+Pj4wXT10KTooVFtyPj4yPj4+MF09dCxUW3IrND4+Mj4+PjBdPWUpfSxkOigpPT57VygiIil9LGg6ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3coKX0sdjpmdW5jdGlvbigpe3JldHVybiA0Mjk0OTAxNzYwfSxiOigpPT5wZXJmb3JtYW5jZS5ub3coKSxKOmZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gdD4+Pj0wLEUuY29weVdpdGhpbihlPj4+MD4+PjAsdD4+PjAsdCsocj4+PjApPj4+MCl9LHQ6ZnVuY3Rpb24oZSl7ZT4+Pj0wO3ZhciB0PUUubGVuZ3RoO2lmKDQyOTQ5MDE3NjA8ZSlyZXR1cm4hMTtmb3IodmFyIHI9MTs0Pj1yO3IqPTIpe3ZhciBuPXQqKDErLjIvcik7bj1NYXRoLm1pbihuLGUrMTAwNjYzMjk2KTt2YXIgYT1NYXRoO249TWF0aC5tYXgoZSxuKTtlOnthPWEubWluLmNhbGwoYSw0Mjk0OTAxNzYwLG4rKDY1NTM2LW4lNjU1MzYpJTY1NTM2KS1fLmJ1ZmZlci5ieXRlTGVuZ3RoKzY1NTM1Pj4+MTY7dHJ5e18uZ3JvdyhhKSxSKCk7dmFyIG89MTticmVhayBlfWNhdGNoKGUpe31vPXZvaWQgMH1pZihvKXJldHVybiEwfXJldHVybiExfSxEOmZ1bmN0aW9uKGUsdCl7ZT4+Pj0wLHQ+Pj49MDt2YXIgcj0wO3JldHVybiBuZSgpLmZvckVhY2goKGZ1bmN0aW9uKG4sYSl7dmFyIG89dCtyO2ZvcihhPVRbZSs0KmE+PjI+Pj4wXT1vLG89MDtvPG4ubGVuZ3RoOysrbylTW2ErKz4+MD4+PjBdPW4uY2hhckNvZGVBdChvKTtTW2E+PjA+Pj4wXT0wLHIrPW4ubGVuZ3RoKzF9KSksMH0sRTpmdW5jdGlvbihlLHQpe2U+Pj49MCx0Pj4+PTA7dmFyIHI9bmUoKTtUW2U+PjI+Pj4wXT1yLmxlbmd0aDt2YXIgbj0wO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKGUpe24rPWUubGVuZ3RoKzF9KSksVFt0Pj4yPj4+MF09biwwfSxzOmU9Pnt3fHwoYS5vbkV4aXQmJmEub25FeGl0KGUpLE09ITApLGwoZSxuZXcgRyhlKSl9LGY6KCk9PjUyLGo6ZnVuY3Rpb24oKXtyZXR1cm4gNTJ9LHE6ZnVuY3Rpb24oKXtyZXR1cm4gNzB9LGk6ZnVuY3Rpb24oZSx0LHIsbil7dD4+Pj0wLHI+Pj49MCxuPj4+PTA7Zm9yKHZhciBhPTAsbz0wO288cjtvKyspe3ZhciBpPVRbdD4+Mj4+PjBdLHM9VFt0KzQ+PjI+Pj4wXTt0Kz04O2Zvcih2YXIgdT0wO3U8czt1Kyspe3ZhciBjPUVbaSt1Pj4+MF0sbD1hZVtlXTswPT09Y3x8MTA9PT1jPygoMT09PWU/djpiKShWKGwsMCkpLGwubGVuZ3RoPTApOmwucHVzaChjKX1hKz1zfXJldHVybiBUW24+PjI+Pj4wXT1hLDB9LHI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT4+Pj0wLG9lKEUuc3ViYXJyYXkoZT4+PjAsZSsodD4+PjApPj4+MCkpLDB9LEM6dWUsYzpmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gdWUoZT4+PjAsdD4+PjAscj4+PjAsbj4+PjApfX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZihlPWUuZXhwb3J0cyxPPWU9ZnVuY3Rpb24oZSl7dmFyIHQ9ZT0+KCk9PmUoKT4+PjAscj1lPT50PT5lKHQpPj4+MDtyZXR1cm4oZT1PYmplY3QuYXNzaWduKHt9LGUpKS5fX2Vycm5vX2xvY2F0aW9uPXQoZS5fX2Vycm5vX2xvY2F0aW9uKSxlLm1hbGxvYz1yKGUubWFsbG9jKSxlLnN0YWNrU2F2ZT10KGUuc3RhY2tTYXZlKSxlLnN0YWNrQWxsb2M9cihlLnN0YWNrQWxsb2MpLGV9KGUpLF89Ty5MLFIoKSxrLnVuc2hpZnQoTy5NKSxJLS0sYS5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZhLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoSSksMD09SSYmKG51bGwhPT1VJiYoY2xlYXJJbnRlcnZhbChVKSxVPW51bGwpLEwpKXt2YXIgdD1MO0w9bnVsbCx0KCl9cmV0dXJuIGV9dmFyIHQ9e2E6Y2V9O2lmKEkrKyxhLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmEubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhJKSxhLmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIGEuaW5zdGFudGlhdGVXYXNtKHQsZSl9Y2F0Y2goZSl7YigiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIitlKSxuKGUpfShmdW5jdGlvbihlLHQpe3ZhciByPUQ7cmV0dXJuIHl8fCJmdW5jdGlvbiIhPXR5cGVvZiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZ3x8SChyKXx8ci5zdGFydHNXaXRoKCJmaWxlOi8vIil8fHB8fCJmdW5jdGlvbiIhPXR5cGVvZiBmZXRjaD96KHIsZSx0KTpmZXRjaChyLHtjcmVkZW50aWFsczoic2FtZS1vcmlnaW4ifSkudGhlbigobj0+V2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmcobixlKS50aGVuKHQsKGZ1bmN0aW9uKG4pe3JldHVybiBiKCJ3YXNtIHN0cmVhbWluZyBjb21waWxlIGZhaWxlZDogIituKSxiKCJmYWxsaW5nIGJhY2sgdG8gQXJyYXlCdWZmZXIgaW5zdGFudGlhdGlvbiIpLHoocixlLHQpfSkpKSl9KSh0LChmdW5jdGlvbih0KXtlKHQuaW5zdGFuY2UpfSkpLmNhdGNoKG4pfSgpLGEuX09ydEluaXQ9KGUsdCk9PihhLl9PcnRJbml0PU8uTikoZSx0KSxhLl9PcnRHZXRMYXN0RXJyb3I9KGUsdCk9PihhLl9PcnRHZXRMYXN0RXJyb3I9Ty5PKShlLHQpLGEuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPShlLHQscixuLG8saSxzLHUsYyxsKT0+KGEuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPU8uUCkoZSx0LHIsbixvLGkscyx1LGMsbCksYS5fT3J0QXBwZW5kRXhlY3V0aW9uUHJvdmlkZXI9KGUsdCk9PihhLl9PcnRBcHBlbmRFeGVjdXRpb25Qcm92aWRlcj1PLlEpKGUsdCksYS5fT3J0QWRkU2Vzc2lvbkNvbmZpZ0VudHJ5PShlLHQscik9PihhLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnk9Ty5SKShlLHQsciksYS5fT3J0UmVsZWFzZVNlc3Npb25PcHRpb25zPWU9PihhLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnM9Ty5TKShlKSxhLl9PcnRDcmVhdGVTZXNzaW9uPShlLHQscik9PihhLl9PcnRDcmVhdGVTZXNzaW9uPU8uVCkoZSx0LHIpLGEuX09ydFJlbGVhc2VTZXNzaW9uPWU9PihhLl9PcnRSZWxlYXNlU2Vzc2lvbj1PLlUpKGUpLGEuX09ydEdldElucHV0T3V0cHV0Q291bnQ9KGUsdCxyKT0+KGEuX09ydEdldElucHV0T3V0cHV0Q291bnQ9Ty5WKShlLHQsciksYS5fT3J0R2V0SW5wdXROYW1lPShlLHQpPT4oYS5fT3J0R2V0SW5wdXROYW1lPU8uVykoZSx0KSxhLl9PcnRHZXRPdXRwdXROYW1lPShlLHQpPT4oYS5fT3J0R2V0T3V0cHV0TmFtZT1PLlgpKGUsdCksYS5fT3J0RnJlZT1lPT4oYS5fT3J0RnJlZT1PLlkpKGUpLGEuX09ydENyZWF0ZVRlbnNvcj0oZSx0LHIsbixvKT0+KGEuX09ydENyZWF0ZVRlbnNvcj1PLlopKGUsdCxyLG4sbyksYS5fT3J0R2V0VGVuc29yRGF0YT0oZSx0LHIsbixvKT0+KGEuX09ydEdldFRlbnNvckRhdGE9Ty5fKShlLHQscixuLG8pLGEuX09ydFJlbGVhc2VUZW5zb3I9ZT0+KGEuX09ydFJlbGVhc2VUZW5zb3I9Ty4kKShlKSxhLl9PcnRDcmVhdGVSdW5PcHRpb25zPShlLHQscixuKT0+KGEuX09ydENyZWF0ZVJ1bk9wdGlvbnM9Ty5hYSkoZSx0LHIsbiksYS5fT3J0QWRkUnVuQ29uZmlnRW50cnk9KGUsdCxyKT0+KGEuX09ydEFkZFJ1bkNvbmZpZ0VudHJ5PU8uYmEpKGUsdCxyKSxhLl9PcnRSZWxlYXNlUnVuT3B0aW9ucz1lPT4oYS5fT3J0UmVsZWFzZVJ1bk9wdGlvbnM9Ty5jYSkoZSksYS5fT3J0UnVuPShlLHQscixuLG8saSxzLHUpPT4oYS5fT3J0UnVuPU8uZGEpKGUsdCxyLG4sbyxpLHMsdSksYS5fT3J0RW5kUHJvZmlsaW5nPWU9PihhLl9PcnRFbmRQcm9maWxpbmc9Ty5lYSkoZSk7dmFyIGxlPWEuX21hbGxvYz1lPT4obGU9YS5fbWFsbG9jPU8uZmEpKGUpO2EuX2ZyZWU9ZT0+KGEuX2ZyZWU9Ty5nYSkoZSk7dmFyIGZlLGRlPWU9PihkZT1PLmlhKShlKSxwZT0oKT0+KHBlPU8uamEpKCksZ2U9ZT0+KGdlPU8ua2EpKGUpLGhlPWU9PihoZT1PLmxhKShlKTtmdW5jdGlvbiBtZSgpe2Z1bmN0aW9uIGUoKXtpZighZmUmJihmZT0hMCxhLmNhbGxlZFJ1bj0hMCwhTSkpe2lmKE4oayksdChhKSxhLm9uUnVudGltZUluaXRpYWxpemVkJiZhLm9uUnVudGltZUluaXRpYWxpemVkKCksYS5wb3N0UnVuKWZvcigiZnVuY3Rpb24iPT10eXBlb2YgYS5wb3N0UnVuJiYoYS5wb3N0UnVuPVthLnBvc3RSdW5dKTthLnBvc3RSdW4ubGVuZ3RoOyl7dmFyIGU9YS5wb3N0UnVuLnNoaWZ0KCk7Qy51bnNoaWZ0KGUpfU4oQyl9fWlmKCEoMDxJKSl7aWYoYS5wcmVSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBhLnByZVJ1biYmKGEucHJlUnVuPVthLnByZVJ1bl0pO2EucHJlUnVuLmxlbmd0aDspUCgpO04oRiksMDxJfHwoYS5zZXRTdGF0dXM/KGEuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe2Euc2V0U3RhdHVzKCIiKX0pLDEpLGUoKX0pLDEpKTplKCkpfX1pZihhLnN0YWNrQWxsb2M9aGUsYS5zdGFja1NhdmU9cGUsYS5zdGFja1Jlc3RvcmU9Z2UsYS5VVEY4VG9TdHJpbmc9SixhLnN0cmluZ1RvVVRGOD0oZSx0LHIpPT5LKGUsRSx0LHIpLGEubGVuZ3RoQnl0ZXNVVEY4PVgsTD1mdW5jdGlvbiBlKCl7ZmV8fG1lKCksZmV8fChMPWUpfSxhLnByZUluaXQpZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBhLnByZUluaXQmJihhLnByZUluaXQ9W2EucHJlSW5pdF0pOzA8YS5wcmVJbml0Lmxlbmd0aDspYS5wcmVJbml0LnBvcCgpKCk7cmV0dXJuIG1lKCksZS5yZWFkeX0pO2UuZXhwb3J0cz1ufSwxNTQ6ZT0+eyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9XCcidXNlIHN0cmljdCI7dmFyIGU9e30sYT0ib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MmJiJvYmplY3QiPT10eXBlb2YgcHJvY2Vzcy52ZXJzaW9ucyYmInN0cmluZyI9PXR5cGVvZiBwcm9jZXNzLnZlcnNpb25zLm5vZGU7aWYoYSl7dmFyIHI9cmVxdWlyZSgid29ya2VyX3RocmVhZHMiKSx0PXIucGFyZW50UG9ydDt0Lm9uKCJtZXNzYWdlIiwoZT0+b25tZXNzYWdlKHtkYXRhOmV9KSkpO3ZhciBzPXJlcXVpcmUoImZzIik7T2JqZWN0LmFzc2lnbihnbG9iYWwse3NlbGY6Z2xvYmFsLHJlcXVpcmU6cmVxdWlyZSxNb2R1bGU6ZSxsb2NhdGlvbjp7aHJlZjpfX2ZpbGVuYW1lfSxXb3JrZXI6ci5Xb3JrZXIsaW1wb3J0U2NyaXB0czplPT4oMCxldmFsKShzLnJlYWRGaWxlU3luYyhlLCJ1dGY4IikrIi8vIyBzb3VyY2VVUkw9IitlKSxwb3N0TWVzc2FnZTplPT50LnBvc3RNZXNzYWdlKGUpLHBlcmZvcm1hbmNlOmdsb2JhbC5wZXJmb3JtYW5jZXx8e25vdzpEYXRlLm5vd319KX12YXIgbz0hMSxkPWZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKS5qb2luKCIgIik7YT9zLndyaXRlU3luYygyLGUrIlxcXFxuIik6Y29uc29sZS5lcnJvcihlKX07c2VsZi5hbGVydD1mdW5jdGlvbigpe3ZhciBhPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuam9pbigiICIpO3Bvc3RNZXNzYWdlKHtjbWQ6ImFsZXJ0Iix0ZXh0OmEsdGhyZWFkSWQ6ZS5fcHRocmVhZF9zZWxmKCl9KX0sZS5pbnN0YW50aWF0ZVdhc209KGEscik9Pnt2YXIgdD1lLndhc21Nb2R1bGU7cmV0dXJuIGUud2FzbU1vZHVsZT1udWxsLHIobmV3IFdlYkFzc2VtYmx5Lkluc3RhbmNlKHQsYSkpfSxzZWxmLm9udW5oYW5kbGVkcmVqZWN0aW9uPWU9Pnt0aHJvdyBlLnJlYXNvbj8/ZX0sc2VsZi5vbm1lc3NhZ2U9ZnVuY3Rpb24gYShyKXt0cnl7aWYoImxvYWQiPT09ci5kYXRhLmNtZCl7bGV0IHM9W107c2VsZi5vbm1lc3NhZ2U9ZT0+cy5wdXNoKGUpLHNlbGYuc3RhcnRXb3JrZXI9cj0+e2U9cixwb3N0TWVzc2FnZSh7Y21kOiJsb2FkZWQifSk7Zm9yKGxldCBlIG9mIHMpYShlKTtzZWxmLm9ubWVzc2FnZT1hfSxlLndhc21Nb2R1bGU9ci5kYXRhLndhc21Nb2R1bGU7Zm9yKGNvbnN0IGEgb2Ygci5kYXRhLmhhbmRsZXJzKWVbYV09KC4uLmUpPT57cG9zdE1lc3NhZ2Uoe2NtZDoiY2FsbEhhbmRsZXIiLGhhbmRsZXI6YSxhcmdzOmV9KX07aWYoZS53YXNtTWVtb3J5PXIuZGF0YS53YXNtTWVtb3J5LGUuYnVmZmVyPWUud2FzbU1lbW9yeS5idWZmZXIsZS5FTlZJUk9OTUVOVF9JU19QVEhSRUFEPSEwLCJzdHJpbmciPT10eXBlb2Ygci5kYXRhLnVybE9yQmxvYilpbXBvcnRTY3JpcHRzKHIuZGF0YS51cmxPckJsb2IpO2Vsc2V7dmFyIHQ9VVJMLmNyZWF0ZU9iamVjdFVSTChyLmRhdGEudXJsT3JCbG9iKTtpbXBvcnRTY3JpcHRzKHQpLFVSTC5yZXZva2VPYmplY3RVUkwodCl9b3J0V2FzbVRocmVhZGVkKGUpfWVsc2UgaWYoInJ1biI9PT1yLmRhdGEuY21kKXtlLl9fZW1zY3JpcHRlbl90aHJlYWRfaW5pdChyLmRhdGEucHRocmVhZF9wdHIsMCwwLDEpLGUuX19lbXNjcmlwdGVuX3RocmVhZF9tYWlsYm94X2F3YWl0KHIuZGF0YS5wdGhyZWFkX3B0ciksZS5lc3RhYmxpc2hTdGFja1NwYWNlKCksZS5QVGhyZWFkLnJlY2VpdmVPYmplY3RUcmFuc2ZlcihyLmRhdGEpLGUuUFRocmVhZC50aHJlYWRJbml0VExTKCksb3x8KG89ITApO3RyeXtlLmludm9rZUVudHJ5UG9pbnQoci5kYXRhLnN0YXJ0X3JvdXRpbmUsci5kYXRhLmFyZyl9Y2F0Y2goZSl7aWYoInVud2luZCIhPWUpdGhyb3cgZX19ZWxzZSJjYW5jZWwiPT09ci5kYXRhLmNtZD9lLl9wdGhyZWFkX3NlbGYoKSYmZS5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2V4aXQoLTEpOiJzZXRpbW1lZGlhdGUiPT09ci5kYXRhLnRhcmdldHx8KCJjaGVja01haWxib3giPT09ci5kYXRhLmNtZD9vJiZlLmNoZWNrTWFpbGJveCgpOnIuZGF0YS5jbWQmJihkKCJ3b3JrZXIuanMgcmVjZWl2ZWQgdW5rbm93biBjb21tYW5kICIrci5kYXRhLmNtZCksZChyLmRhdGEpKSl9Y2F0Y2goYSl7dGhyb3cgZS5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2NyYXNoZWQmJmUuX19lbXNjcmlwdGVuX3RocmVhZF9jcmFzaGVkKCksYX19O1xcblwnfSw3NjA6KCk9Pnt9LDM4NDooKT0+e30sOTkzOigpPT57fSw5MDg6KCk9Pnt9LDk1MzooKT0+e30sOTI1OigpPT57fSw0NDk6KCk9Pnt9fSx0PXt9O2Z1bmN0aW9uIHIobil7dmFyIGE9dFtuXTtpZih2b2lkIDAhPT1hKXJldHVybiBhLmV4cG9ydHM7dmFyIG89dFtuXT17ZXhwb3J0czp7fX07cmV0dXJuIGVbbl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsciksby5leHBvcnRzfSgoKT0+eyJ1c2Ugc3RyaWN0Ijtjb25zdCBlPXIoMjU5KSx0PXIoMjYzKTtzZWxmLm9ubWVzc2FnZT1yPT57c3dpdGNoKHIuZGF0YS50eXBlKXtjYXNlImluaXQtd2FzbSI6dHJ5eygwLHQuaW5pdGlhbGl6ZVdlYkFzc2VtYmx5KShyLmRhdGEuaW4pLnRoZW4oKCgpPT5wb3N0TWVzc2FnZSh7dHlwZToiaW5pdC13YXNtIn0pKSwoZT0+cG9zdE1lc3NhZ2Uoe3R5cGU6ImluaXQtd2FzbSIsZXJyOmV9KSkpfWNhdGNoKGUpe3Bvc3RNZXNzYWdlKHt0eXBlOiJpbml0LXdhc20iLGVycjplfSl9YnJlYWs7Y2FzZSJpbml0LW9ydCI6dHJ5eygwLGUuaW5pdFJ1bnRpbWUpKHIuZGF0YS5pbikudGhlbigoKCk9PnBvc3RNZXNzYWdlKHt0eXBlOiJpbml0LW9ydCJ9KSksKGU9PnBvc3RNZXNzYWdlKHt0eXBlOiJpbml0LW9ydCIsZXJyOmV9KSkpLHBvc3RNZXNzYWdlKHt0eXBlOiJpbml0LW9ydCJ9KX1jYXRjaChlKXtwb3N0TWVzc2FnZSh7dHlwZToiaW5pdC1vcnQiLGVycjplfSl9YnJlYWs7Y2FzZSJjcmVhdGVfYWxsb2NhdGUiOnRyeXtjb25zdHttb2RlbDp0fT1yLmRhdGEuaW4sbj0oMCxlLmNyZWF0ZVNlc3Npb25BbGxvY2F0ZSkodCk7cG9zdE1lc3NhZ2Uoe3R5cGU6ImNyZWF0ZV9hbGxvY2F0ZSIsb3V0Om59KX1jYXRjaChlKXtwb3N0TWVzc2FnZSh7dHlwZToiY3JlYXRlX2FsbG9jYXRlIixlcnI6ZX0pfWJyZWFrO2Nhc2UiY3JlYXRlX2ZpbmFsaXplIjp0cnl7Y29uc3R7bW9kZWxkYXRhOnQsb3B0aW9uczpufT1yLmRhdGEuaW4sYT0oMCxlLmNyZWF0ZVNlc3Npb25GaW5hbGl6ZSkodCxuKTtwb3N0TWVzc2FnZSh7dHlwZToiY3JlYXRlX2ZpbmFsaXplIixvdXQ6YX0pfWNhdGNoKGUpe3Bvc3RNZXNzYWdlKHt0eXBlOiJjcmVhdGVfZmluYWxpemUiLGVycjplfSl9YnJlYWs7Y2FzZSJjcmVhdGUiOnRyeXtjb25zdHttb2RlbDp0LG9wdGlvbnM6bn09ci5kYXRhLmluLGE9KDAsZS5jcmVhdGVTZXNzaW9uKSh0LG4pO3Bvc3RNZXNzYWdlKHt0eXBlOiJjcmVhdGUiLG91dDphfSl9Y2F0Y2goZSl7cG9zdE1lc3NhZ2Uoe3R5cGU6ImNyZWF0ZSIsZXJyOmV9KX1icmVhaztjYXNlInJlbGVhc2UiOnRyeXtjb25zdCB0PXIuZGF0YS5pbjsoMCxlLnJlbGVhc2VTZXNzaW9uKSh0KSxwb3N0TWVzc2FnZSh7dHlwZToicmVsZWFzZSJ9KX1jYXRjaChlKXtwb3N0TWVzc2FnZSh7dHlwZToicmVsZWFzZSIsZXJyOmV9KX1icmVhaztjYXNlInJ1biI6dHJ5e2NvbnN0e3Nlc3Npb25JZDp0LGlucHV0SW5kaWNlczpuLGlucHV0czphLG91dHB1dEluZGljZXM6byxvcHRpb25zOml9PXIuZGF0YS5pbjsoMCxlLnJ1bikodCxuLGEsbyxpKS50aGVuKCh0PT57cG9zdE1lc3NhZ2Uoe3R5cGU6InJ1biIsb3V0OnR9LCgwLGUuZXh0cmFjdFRyYW5zZmVyYWJsZUJ1ZmZlcnMpKHQpKX0pLChlPT57cG9zdE1lc3NhZ2Uoe3R5cGU6InJ1biIsZXJyOmV9KX0pKX1jYXRjaChlKXtwb3N0TWVzc2FnZSh7dHlwZToicnVuIixlcnI6ZX0pfWJyZWFrO2Nhc2UiZW5kLXByb2ZpbGluZyI6dHJ5e2NvbnN0IHQ9ci5kYXRhLmluOygwLGUuZW5kUHJvZmlsaW5nKSh0KSxwb3N0TWVzc2FnZSh7dHlwZToiZW5kLXByb2ZpbGluZyJ9KX1jYXRjaChlKXtwb3N0TWVzc2FnZSh7dHlwZToiZW5kLXByb2ZpbGluZyIsZXJyOmV9KX19fX0pKCl9KSgpO1xuJywiV29ya2VyIix2b2lkIDAsdm9pZCAwKX19LDY2MTQ6ZT0+e2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbixyKXt2YXIgbz1zZWxmfHx3aW5kb3c7dHJ5e3RyeXt2YXIgaTt0cnl7aT1uZXcgby5CbG9iKFtlXSk7fWNhdGNoKHQpeyhpPW5ldyhvLkJsb2JCdWlsZGVyfHxvLldlYktpdEJsb2JCdWlsZGVyfHxvLk1vekJsb2JCdWlsZGVyfHxvLk1TQmxvYkJ1aWxkZXIpKS5hcHBlbmQoZSksaT1pLmdldEJsb2IoKTt9dmFyIHM9by5VUkx8fG8ud2Via2l0VVJMLGE9cy5jcmVhdGVPYmplY3RVUkwoaSksdT1uZXcgb1t0XShhLG4pO3JldHVybiBzLnJldm9rZU9iamVjdFVSTChhKSx1fWNhdGNoKHIpe3JldHVybiBuZXcgb1t0XSgiZGF0YTphcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCIuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChlKSksbil9fWNhdGNoKGUpe2lmKCFyKXRocm93IEVycm9yKCJJbmxpbmUgd29ya2VyIGlzIG5vdCBzdXBwb3J0ZWQiKTtyZXR1cm4gbmV3IG9bdF0ocixuKX19O30sMjQ0NjooZSx0LG4pPT57dmFyIHIsbyxpLHM9bigyMTAwKSxhPXMuUmVhZGVyLHU9cy5Xcml0ZXIsbD1zLnV0aWwsYz1zLnJvb3RzLmRlZmF1bHR8fChzLnJvb3RzLmRlZmF1bHQ9e30pO2Mub25ueD0oKGk9e30pLlZlcnNpb249KHI9e30sKG89T2JqZWN0LmNyZWF0ZShyKSlbclswXT0iX1NUQVJUX1ZFUlNJT04iXT0wLG9bclsxXT0iSVJfVkVSU0lPTl8yMDE3XzEwXzEwIl09MSxvW3JbMl09IklSX1ZFUlNJT05fMjAxN18xMF8zMCJdPTIsb1tyWzNdPSJJUl9WRVJTSU9OXzIwMTdfMTFfMyJdPTMsb1tyWzRdPSJJUl9WRVJTSU9OXzIwMTlfMV8yMiJdPTQsb1tyWzVdPSJJUl9WRVJTSU9OXzIwMTlfM18xOCJdPTUsb1tyWzZdPSJJUl9WRVJTSU9OXzIwMTlfOV8xOSJdPTYsb1tyWzddPSJJUl9WRVJTSU9OXzIwMjBfNV84Il09NyxvW3JbOF09IklSX1ZFUlNJT05fMjAyMV83XzMwIl09OCxvW3JbOV09IklSX1ZFUlNJT04iXT05LG8pLGkuQXR0cmlidXRlUHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKHRoaXMuZmxvYXRzPVtdLHRoaXMuaW50cz1bXSx0aGlzLnN0cmluZ3M9W10sdGhpcy50ZW5zb3JzPVtdLHRoaXMuZ3JhcGhzPVtdLHRoaXMuc3BhcnNlVGVuc29ycz1bXSx0aGlzLnR5cGVQcm90b3M9W10sZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUubmFtZT0iIixlLnByb3RvdHlwZS5yZWZBdHRyTmFtZT0iIixlLnByb3RvdHlwZS5kb2NTdHJpbmc9IiIsZS5wcm90b3R5cGUudHlwZT0wLGUucHJvdG90eXBlLmY9MCxlLnByb3RvdHlwZS5pPWwuTG9uZz9sLkxvbmcuZnJvbUJpdHMoMCwwLCExKTowLGUucHJvdG90eXBlLnM9bC5uZXdCdWZmZXIoW10pLGUucHJvdG90eXBlLnQ9bnVsbCxlLnByb3RvdHlwZS5nPW51bGwsZS5wcm90b3R5cGUuc3BhcnNlVGVuc29yPW51bGwsZS5wcm90b3R5cGUudHA9bnVsbCxlLnByb3RvdHlwZS5mbG9hdHM9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLmludHM9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLnN0cmluZ3M9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLnRlbnNvcnM9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLmdyYXBocz1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuc3BhcnNlVGVuc29ycz1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUudHlwZVByb3Rvcz1sLmVtcHR5QXJyYXksZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe2lmKHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUubmFtZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwibmFtZSIpJiZ0LnVpbnQzMigxMCkuc3RyaW5nKGUubmFtZSksbnVsbCE9ZS5mJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJmIikmJnQudWludDMyKDIxKS5mbG9hdChlLmYpLG51bGwhPWUuaSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiaSIpJiZ0LnVpbnQzMigyNCkuaW50NjQoZS5pKSxudWxsIT1lLnMmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsInMiKSYmdC51aW50MzIoMzQpLmJ5dGVzKGUucyksbnVsbCE9ZS50JiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJ0IikmJmMub25ueC5UZW5zb3JQcm90by5lbmNvZGUoZS50LHQudWludDMyKDQyKS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuZyYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZyIpJiZjLm9ubnguR3JhcGhQcm90by5lbmNvZGUoZS5nLHQudWludDMyKDUwKS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuZmxvYXRzJiZlLmZsb2F0cy5sZW5ndGgpe3QudWludDMyKDU4KS5mb3JrKCk7Zm9yKHZhciBuPTA7bjxlLmZsb2F0cy5sZW5ndGg7KytuKXQuZmxvYXQoZS5mbG9hdHNbbl0pO3QubGRlbGltKCk7fWlmKG51bGwhPWUuaW50cyYmZS5pbnRzLmxlbmd0aCl7Zm9yKHQudWludDMyKDY2KS5mb3JrKCksbj0wO248ZS5pbnRzLmxlbmd0aDsrK24pdC5pbnQ2NChlLmludHNbbl0pO3QubGRlbGltKCk7fWlmKG51bGwhPWUuc3RyaW5ncyYmZS5zdHJpbmdzLmxlbmd0aClmb3Iobj0wO248ZS5zdHJpbmdzLmxlbmd0aDsrK24pdC51aW50MzIoNzQpLmJ5dGVzKGUuc3RyaW5nc1tuXSk7aWYobnVsbCE9ZS50ZW5zb3JzJiZlLnRlbnNvcnMubGVuZ3RoKWZvcihuPTA7bjxlLnRlbnNvcnMubGVuZ3RoOysrbiljLm9ubnguVGVuc29yUHJvdG8uZW5jb2RlKGUudGVuc29yc1tuXSx0LnVpbnQzMig4MikuZm9yaygpKS5sZGVsaW0oKTtpZihudWxsIT1lLmdyYXBocyYmZS5ncmFwaHMubGVuZ3RoKWZvcihuPTA7bjxlLmdyYXBocy5sZW5ndGg7KytuKWMub25ueC5HcmFwaFByb3RvLmVuY29kZShlLmdyYXBoc1tuXSx0LnVpbnQzMig5MCkuZm9yaygpKS5sZGVsaW0oKTtpZihudWxsIT1lLmRvY1N0cmluZyYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZG9jU3RyaW5nIikmJnQudWludDMyKDEwNikuc3RyaW5nKGUuZG9jU3RyaW5nKSxudWxsIT1lLnRwJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJ0cCIpJiZjLm9ubnguVHlwZVByb3RvLmVuY29kZShlLnRwLHQudWludDMyKDExNCkuZm9yaygpKS5sZGVsaW0oKSxudWxsIT1lLnR5cGVQcm90b3MmJmUudHlwZVByb3Rvcy5sZW5ndGgpZm9yKG49MDtuPGUudHlwZVByb3Rvcy5sZW5ndGg7KytuKWMub25ueC5UeXBlUHJvdG8uZW5jb2RlKGUudHlwZVByb3Rvc1tuXSx0LnVpbnQzMigxMjIpLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS50eXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJ0eXBlIikmJnQudWludDMyKDE2MCkuaW50MzIoZS50eXBlKSxudWxsIT1lLnJlZkF0dHJOYW1lJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJyZWZBdHRyTmFtZSIpJiZ0LnVpbnQzMigxNzApLnN0cmluZyhlLnJlZkF0dHJOYW1lKSxudWxsIT1lLnNwYXJzZVRlbnNvciYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwic3BhcnNlVGVuc29yIikmJmMub25ueC5TcGFyc2VUZW5zb3JQcm90by5lbmNvZGUoZS5zcGFyc2VUZW5zb3IsdC51aW50MzIoMTc4KS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuc3BhcnNlVGVuc29ycyYmZS5zcGFyc2VUZW5zb3JzLmxlbmd0aClmb3Iobj0wO248ZS5zcGFyc2VUZW5zb3JzLmxlbmd0aDsrK24pYy5vbm54LlNwYXJzZVRlbnNvclByb3RvLmVuY29kZShlLnNwYXJzZVRlbnNvcnNbbl0sdC51aW50MzIoMTg2KS5mb3JrKCkpLmxkZWxpbSgpO3JldHVybiB0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguQXR0cmlidXRlUHJvdG87ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci5uYW1lPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSAyMTpyLnJlZkF0dHJOYW1lPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSAxMzpyLmRvY1N0cmluZz1lLnN0cmluZygpO2JyZWFrO2Nhc2UgMjA6ci50eXBlPWUuaW50MzIoKTticmVhaztjYXNlIDI6ci5mPWUuZmxvYXQoKTticmVhaztjYXNlIDM6ci5pPWUuaW50NjQoKTticmVhaztjYXNlIDQ6ci5zPWUuYnl0ZXMoKTticmVhaztjYXNlIDU6ci50PWMub25ueC5UZW5zb3JQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztjYXNlIDY6ci5nPWMub25ueC5HcmFwaFByb3RvLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgMjI6ci5zcGFyc2VUZW5zb3I9Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgMTQ6ci50cD1jLm9ubnguVHlwZVByb3RvLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgNzppZihyLmZsb2F0cyYmci5mbG9hdHMubGVuZ3RofHwoci5mbG9hdHM9W10pLDI9PSg3Jm8pKWZvcih2YXIgaT1lLnVpbnQzMigpK2UucG9zO2UucG9zPGk7KXIuZmxvYXRzLnB1c2goZS5mbG9hdCgpKTtlbHNlIHIuZmxvYXRzLnB1c2goZS5mbG9hdCgpKTticmVhaztjYXNlIDg6aWYoci5pbnRzJiZyLmludHMubGVuZ3RofHwoci5pbnRzPVtdKSwyPT0oNyZvKSlmb3IoaT1lLnVpbnQzMigpK2UucG9zO2UucG9zPGk7KXIuaW50cy5wdXNoKGUuaW50NjQoKSk7ZWxzZSByLmludHMucHVzaChlLmludDY0KCkpO2JyZWFrO2Nhc2UgOTpyLnN0cmluZ3MmJnIuc3RyaW5ncy5sZW5ndGh8fChyLnN0cmluZ3M9W10pLHIuc3RyaW5ncy5wdXNoKGUuYnl0ZXMoKSk7YnJlYWs7Y2FzZSAxMDpyLnRlbnNvcnMmJnIudGVuc29ycy5sZW5ndGh8fChyLnRlbnNvcnM9W10pLHIudGVuc29ycy5wdXNoKGMub25ueC5UZW5zb3JQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAxMTpyLmdyYXBocyYmci5ncmFwaHMubGVuZ3RofHwoci5ncmFwaHM9W10pLHIuZ3JhcGhzLnB1c2goYy5vbm54LkdyYXBoUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMjM6ci5zcGFyc2VUZW5zb3JzJiZyLnNwYXJzZVRlbnNvcnMubGVuZ3RofHwoci5zcGFyc2VUZW5zb3JzPVtdKSxyLnNwYXJzZVRlbnNvcnMucHVzaChjLm9ubnguU3BhcnNlVGVuc29yUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMTU6ci50eXBlUHJvdG9zJiZyLnR5cGVQcm90b3MubGVuZ3RofHwoci50eXBlUHJvdG9zPVtdKSxyLnR5cGVQcm90b3MucHVzaChjLm9ubnguVHlwZVByb3RvLmRlY29kZShlLGUudWludDMyKCkpKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmIWwuaXNTdHJpbmcoZS5uYW1lKSlyZXR1cm4gIm5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5yZWZBdHRyTmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgicmVmQXR0ck5hbWUiKSYmIWwuaXNTdHJpbmcoZS5yZWZBdHRyTmFtZSkpcmV0dXJuICJyZWZBdHRyTmFtZTogc3RyaW5nIGV4cGVjdGVkIjtpZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJiFsLmlzU3RyaW5nKGUuZG9jU3RyaW5nKSlyZXR1cm4gImRvY1N0cmluZzogc3RyaW5nIGV4cGVjdGVkIjtpZihudWxsIT1lLnR5cGUmJmUuaGFzT3duUHJvcGVydHkoInR5cGUiKSlzd2l0Y2goZS50eXBlKXtkZWZhdWx0OnJldHVybiAidHlwZTogZW51bSB2YWx1ZSBleHBlY3RlZCI7Y2FzZSAwOmNhc2UgMTpjYXNlIDI6Y2FzZSAzOmNhc2UgNDpjYXNlIDU6Y2FzZSAxMTpjYXNlIDEzOmNhc2UgNjpjYXNlIDc6Y2FzZSA4OmNhc2UgOTpjYXNlIDEwOmNhc2UgMTI6Y2FzZSAxNDp9aWYobnVsbCE9ZS5mJiZlLmhhc093blByb3BlcnR5KCJmIikmJiJudW1iZXIiIT10eXBlb2YgZS5mKXJldHVybiAiZjogbnVtYmVyIGV4cGVjdGVkIjtpZihudWxsIT1lLmkmJmUuaGFzT3duUHJvcGVydHkoImkiKSYmIShsLmlzSW50ZWdlcihlLmkpfHxlLmkmJmwuaXNJbnRlZ2VyKGUuaS5sb3cpJiZsLmlzSW50ZWdlcihlLmkuaGlnaCkpKXJldHVybiAiaTogaW50ZWdlcnxMb25nIGV4cGVjdGVkIjtpZihudWxsIT1lLnMmJmUuaGFzT3duUHJvcGVydHkoInMiKSYmIShlLnMmJiJudW1iZXIiPT10eXBlb2YgZS5zLmxlbmd0aHx8bC5pc1N0cmluZyhlLnMpKSlyZXR1cm4gInM6IGJ1ZmZlciBleHBlY3RlZCI7aWYobnVsbCE9ZS50JiZlLmhhc093blByb3BlcnR5KCJ0IikmJihuPWMub25ueC5UZW5zb3JQcm90by52ZXJpZnkoZS50KSkpcmV0dXJuICJ0LiIrbjtpZihudWxsIT1lLmcmJmUuaGFzT3duUHJvcGVydHkoImciKSYmKG49Yy5vbm54LkdyYXBoUHJvdG8udmVyaWZ5KGUuZykpKXJldHVybiAiZy4iK247aWYobnVsbCE9ZS5zcGFyc2VUZW5zb3ImJmUuaGFzT3duUHJvcGVydHkoInNwYXJzZVRlbnNvciIpJiYobj1jLm9ubnguU3BhcnNlVGVuc29yUHJvdG8udmVyaWZ5KGUuc3BhcnNlVGVuc29yKSkpcmV0dXJuICJzcGFyc2VUZW5zb3IuIituO2lmKG51bGwhPWUudHAmJmUuaGFzT3duUHJvcGVydHkoInRwIikmJihuPWMub25ueC5UeXBlUHJvdG8udmVyaWZ5KGUudHApKSlyZXR1cm4gInRwLiIrbjtpZihudWxsIT1lLmZsb2F0cyYmZS5oYXNPd25Qcm9wZXJ0eSgiZmxvYXRzIikpe2lmKCFBcnJheS5pc0FycmF5KGUuZmxvYXRzKSlyZXR1cm4gImZsb2F0czogYXJyYXkgZXhwZWN0ZWQiO2Zvcih2YXIgdD0wO3Q8ZS5mbG9hdHMubGVuZ3RoOysrdClpZigibnVtYmVyIiE9dHlwZW9mIGUuZmxvYXRzW3RdKXJldHVybiAiZmxvYXRzOiBudW1iZXJbXSBleHBlY3RlZCJ9aWYobnVsbCE9ZS5pbnRzJiZlLmhhc093blByb3BlcnR5KCJpbnRzIikpe2lmKCFBcnJheS5pc0FycmF5KGUuaW50cykpcmV0dXJuICJpbnRzOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuaW50cy5sZW5ndGg7Kyt0KWlmKCEobC5pc0ludGVnZXIoZS5pbnRzW3RdKXx8ZS5pbnRzW3RdJiZsLmlzSW50ZWdlcihlLmludHNbdF0ubG93KSYmbC5pc0ludGVnZXIoZS5pbnRzW3RdLmhpZ2gpKSlyZXR1cm4gImludHM6IGludGVnZXJ8TG9uZ1tdIGV4cGVjdGVkIn1pZihudWxsIT1lLnN0cmluZ3MmJmUuaGFzT3duUHJvcGVydHkoInN0cmluZ3MiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5zdHJpbmdzKSlyZXR1cm4gInN0cmluZ3M6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5zdHJpbmdzLmxlbmd0aDsrK3QpaWYoIShlLnN0cmluZ3NbdF0mJiJudW1iZXIiPT10eXBlb2YgZS5zdHJpbmdzW3RdLmxlbmd0aHx8bC5pc1N0cmluZyhlLnN0cmluZ3NbdF0pKSlyZXR1cm4gInN0cmluZ3M6IGJ1ZmZlcltdIGV4cGVjdGVkIn1pZihudWxsIT1lLnRlbnNvcnMmJmUuaGFzT3duUHJvcGVydHkoInRlbnNvcnMiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS50ZW5zb3JzKSlyZXR1cm4gInRlbnNvcnM6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS50ZW5zb3JzLmxlbmd0aDsrK3QpaWYobj1jLm9ubnguVGVuc29yUHJvdG8udmVyaWZ5KGUudGVuc29yc1t0XSkpcmV0dXJuICJ0ZW5zb3JzLiIrbn1pZihudWxsIT1lLmdyYXBocyYmZS5oYXNPd25Qcm9wZXJ0eSgiZ3JhcGhzIikpe2lmKCFBcnJheS5pc0FycmF5KGUuZ3JhcGhzKSlyZXR1cm4gImdyYXBoczogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLmdyYXBocy5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54LkdyYXBoUHJvdG8udmVyaWZ5KGUuZ3JhcGhzW3RdKSlyZXR1cm4gImdyYXBocy4iK259aWYobnVsbCE9ZS5zcGFyc2VUZW5zb3JzJiZlLmhhc093blByb3BlcnR5KCJzcGFyc2VUZW5zb3JzIikpe2lmKCFBcnJheS5pc0FycmF5KGUuc3BhcnNlVGVuc29ycykpcmV0dXJuICJzcGFyc2VUZW5zb3JzOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuc3BhcnNlVGVuc29ycy5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLnZlcmlmeShlLnNwYXJzZVRlbnNvcnNbdF0pKXJldHVybiAic3BhcnNlVGVuc29ycy4iK259aWYobnVsbCE9ZS50eXBlUHJvdG9zJiZlLmhhc093blByb3BlcnR5KCJ0eXBlUHJvdG9zIikpe2lmKCFBcnJheS5pc0FycmF5KGUudHlwZVByb3RvcykpcmV0dXJuICJ0eXBlUHJvdG9zOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUudHlwZVByb3Rvcy5sZW5ndGg7Kyt0KXt2YXIgbjtpZihuPWMub25ueC5UeXBlUHJvdG8udmVyaWZ5KGUudHlwZVByb3Rvc1t0XSkpcmV0dXJuICJ0eXBlUHJvdG9zLiIrbn19cmV0dXJuIG51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LkF0dHJpYnV0ZVByb3RvKXJldHVybiBlO3ZhciB0PW5ldyBjLm9ubnguQXR0cmlidXRlUHJvdG87c3dpdGNoKG51bGwhPWUubmFtZSYmKHQubmFtZT1TdHJpbmcoZS5uYW1lKSksbnVsbCE9ZS5yZWZBdHRyTmFtZSYmKHQucmVmQXR0ck5hbWU9U3RyaW5nKGUucmVmQXR0ck5hbWUpKSxudWxsIT1lLmRvY1N0cmluZyYmKHQuZG9jU3RyaW5nPVN0cmluZyhlLmRvY1N0cmluZykpLGUudHlwZSl7ZGVmYXVsdDppZigibnVtYmVyIj09dHlwZW9mIGUudHlwZSl7dC50eXBlPWUudHlwZTticmVha31icmVhaztjYXNlIlVOREVGSU5FRCI6Y2FzZSAwOnQudHlwZT0wO2JyZWFrO2Nhc2UiRkxPQVQiOmNhc2UgMTp0LnR5cGU9MTticmVhaztjYXNlIklOVCI6Y2FzZSAyOnQudHlwZT0yO2JyZWFrO2Nhc2UiU1RSSU5HIjpjYXNlIDM6dC50eXBlPTM7YnJlYWs7Y2FzZSJURU5TT1IiOmNhc2UgNDp0LnR5cGU9NDticmVhaztjYXNlIkdSQVBIIjpjYXNlIDU6dC50eXBlPTU7YnJlYWs7Y2FzZSJTUEFSU0VfVEVOU09SIjpjYXNlIDExOnQudHlwZT0xMTticmVhaztjYXNlIlRZUEVfUFJPVE8iOmNhc2UgMTM6dC50eXBlPTEzO2JyZWFrO2Nhc2UiRkxPQVRTIjpjYXNlIDY6dC50eXBlPTY7YnJlYWs7Y2FzZSJJTlRTIjpjYXNlIDc6dC50eXBlPTc7YnJlYWs7Y2FzZSJTVFJJTkdTIjpjYXNlIDg6dC50eXBlPTg7YnJlYWs7Y2FzZSJURU5TT1JTIjpjYXNlIDk6dC50eXBlPTk7YnJlYWs7Y2FzZSJHUkFQSFMiOmNhc2UgMTA6dC50eXBlPTEwO2JyZWFrO2Nhc2UiU1BBUlNFX1RFTlNPUlMiOmNhc2UgMTI6dC50eXBlPTEyO2JyZWFrO2Nhc2UiVFlQRV9QUk9UT1MiOmNhc2UgMTQ6dC50eXBlPTE0O31pZihudWxsIT1lLmYmJih0LmY9TnVtYmVyKGUuZikpLG51bGwhPWUuaSYmKGwuTG9uZz8odC5pPWwuTG9uZy5mcm9tVmFsdWUoZS5pKSkudW5zaWduZWQ9ITE6InN0cmluZyI9PXR5cGVvZiBlLmk/dC5pPXBhcnNlSW50KGUuaSwxMCk6Im51bWJlciI9PXR5cGVvZiBlLmk/dC5pPWUuaToib2JqZWN0Ij09dHlwZW9mIGUuaSYmKHQuaT1uZXcgbC5Mb25nQml0cyhlLmkubG93Pj4+MCxlLmkuaGlnaD4+PjApLnRvTnVtYmVyKCkpKSxudWxsIT1lLnMmJigic3RyaW5nIj09dHlwZW9mIGUucz9sLmJhc2U2NC5kZWNvZGUoZS5zLHQucz1sLm5ld0J1ZmZlcihsLmJhc2U2NC5sZW5ndGgoZS5zKSksMCk6ZS5zLmxlbmd0aD49MCYmKHQucz1lLnMpKSxudWxsIT1lLnQpe2lmKCJvYmplY3QiIT10eXBlb2YgZS50KXRocm93IFR5cGVFcnJvcigiLm9ubnguQXR0cmlidXRlUHJvdG8udDogb2JqZWN0IGV4cGVjdGVkIik7dC50PWMub25ueC5UZW5zb3JQcm90by5mcm9tT2JqZWN0KGUudCk7fWlmKG51bGwhPWUuZyl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLmcpdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by5nOiBvYmplY3QgZXhwZWN0ZWQiKTt0Lmc9Yy5vbm54LkdyYXBoUHJvdG8uZnJvbU9iamVjdChlLmcpO31pZihudWxsIT1lLnNwYXJzZVRlbnNvcil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnNwYXJzZVRlbnNvcil0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkF0dHJpYnV0ZVByb3RvLnNwYXJzZVRlbnNvcjogb2JqZWN0IGV4cGVjdGVkIik7dC5zcGFyc2VUZW5zb3I9Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLmZyb21PYmplY3QoZS5zcGFyc2VUZW5zb3IpO31pZihudWxsIT1lLnRwKXtpZigib2JqZWN0IiE9dHlwZW9mIGUudHApdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by50cDogb2JqZWN0IGV4cGVjdGVkIik7dC50cD1jLm9ubnguVHlwZVByb3RvLmZyb21PYmplY3QoZS50cCk7fWlmKGUuZmxvYXRzKXtpZighQXJyYXkuaXNBcnJheShlLmZsb2F0cykpdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by5mbG9hdHM6IGFycmF5IGV4cGVjdGVkIik7dC5mbG9hdHM9W107Zm9yKHZhciBuPTA7bjxlLmZsb2F0cy5sZW5ndGg7KytuKXQuZmxvYXRzW25dPU51bWJlcihlLmZsb2F0c1tuXSk7fWlmKGUuaW50cyl7aWYoIUFycmF5LmlzQXJyYXkoZS5pbnRzKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkF0dHJpYnV0ZVByb3RvLmludHM6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuaW50cz1bXSxuPTA7bjxlLmludHMubGVuZ3RoOysrbilsLkxvbmc/KHQuaW50c1tuXT1sLkxvbmcuZnJvbVZhbHVlKGUuaW50c1tuXSkpLnVuc2lnbmVkPSExOiJzdHJpbmciPT10eXBlb2YgZS5pbnRzW25dP3QuaW50c1tuXT1wYXJzZUludChlLmludHNbbl0sMTApOiJudW1iZXIiPT10eXBlb2YgZS5pbnRzW25dP3QuaW50c1tuXT1lLmludHNbbl06Im9iamVjdCI9PXR5cGVvZiBlLmludHNbbl0mJih0LmludHNbbl09bmV3IGwuTG9uZ0JpdHMoZS5pbnRzW25dLmxvdz4+PjAsZS5pbnRzW25dLmhpZ2g+Pj4wKS50b051bWJlcigpKTt9aWYoZS5zdHJpbmdzKXtpZighQXJyYXkuaXNBcnJheShlLnN0cmluZ3MpKXRocm93IFR5cGVFcnJvcigiLm9ubnguQXR0cmlidXRlUHJvdG8uc3RyaW5nczogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5zdHJpbmdzPVtdLG49MDtuPGUuc3RyaW5ncy5sZW5ndGg7KytuKSJzdHJpbmciPT10eXBlb2YgZS5zdHJpbmdzW25dP2wuYmFzZTY0LmRlY29kZShlLnN0cmluZ3Nbbl0sdC5zdHJpbmdzW25dPWwubmV3QnVmZmVyKGwuYmFzZTY0Lmxlbmd0aChlLnN0cmluZ3Nbbl0pKSwwKTplLnN0cmluZ3Nbbl0ubGVuZ3RoPj0wJiYodC5zdHJpbmdzW25dPWUuc3RyaW5nc1tuXSk7fWlmKGUudGVuc29ycyl7aWYoIUFycmF5LmlzQXJyYXkoZS50ZW5zb3JzKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkF0dHJpYnV0ZVByb3RvLnRlbnNvcnM6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQudGVuc29ycz1bXSxuPTA7bjxlLnRlbnNvcnMubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnRlbnNvcnNbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by50ZW5zb3JzOiBvYmplY3QgZXhwZWN0ZWQiKTt0LnRlbnNvcnNbbl09Yy5vbm54LlRlbnNvclByb3RvLmZyb21PYmplY3QoZS50ZW5zb3JzW25dKTt9fWlmKGUuZ3JhcGhzKXtpZighQXJyYXkuaXNBcnJheShlLmdyYXBocykpdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by5ncmFwaHM6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuZ3JhcGhzPVtdLG49MDtuPGUuZ3JhcGhzLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5ncmFwaHNbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5BdHRyaWJ1dGVQcm90by5ncmFwaHM6IG9iamVjdCBleHBlY3RlZCIpO3QuZ3JhcGhzW25dPWMub25ueC5HcmFwaFByb3RvLmZyb21PYmplY3QoZS5ncmFwaHNbbl0pO319aWYoZS5zcGFyc2VUZW5zb3JzKXtpZighQXJyYXkuaXNBcnJheShlLnNwYXJzZVRlbnNvcnMpKXRocm93IFR5cGVFcnJvcigiLm9ubnguQXR0cmlidXRlUHJvdG8uc3BhcnNlVGVuc29yczogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5zcGFyc2VUZW5zb3JzPVtdLG49MDtuPGUuc3BhcnNlVGVuc29ycy5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuc3BhcnNlVGVuc29yc1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkF0dHJpYnV0ZVByb3RvLnNwYXJzZVRlbnNvcnM6IG9iamVjdCBleHBlY3RlZCIpO3Quc3BhcnNlVGVuc29yc1tuXT1jLm9ubnguU3BhcnNlVGVuc29yUHJvdG8uZnJvbU9iamVjdChlLnNwYXJzZVRlbnNvcnNbbl0pO319aWYoZS50eXBlUHJvdG9zKXtpZighQXJyYXkuaXNBcnJheShlLnR5cGVQcm90b3MpKXRocm93IFR5cGVFcnJvcigiLm9ubnguQXR0cmlidXRlUHJvdG8udHlwZVByb3RvczogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC50eXBlUHJvdG9zPVtdLG49MDtuPGUudHlwZVByb3Rvcy5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUudHlwZVByb3Rvc1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkF0dHJpYnV0ZVByb3RvLnR5cGVQcm90b3M6IG9iamVjdCBleHBlY3RlZCIpO3QudHlwZVByb3Rvc1tuXT1jLm9ubnguVHlwZVByb3RvLmZyb21PYmplY3QoZS50eXBlUHJvdG9zW25dKTt9fXJldHVybiB0fSxlLnRvT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dHx8KHQ9e30pO3ZhciBuPXt9O2lmKCh0LmFycmF5c3x8dC5kZWZhdWx0cykmJihuLmZsb2F0cz1bXSxuLmludHM9W10sbi5zdHJpbmdzPVtdLG4udGVuc29ycz1bXSxuLmdyYXBocz1bXSxuLnR5cGVQcm90b3M9W10sbi5zcGFyc2VUZW5zb3JzPVtdKSx0LmRlZmF1bHRzKXtpZihuLm5hbWU9IiIsbi5mPTAsbC5Mb25nKXt2YXIgcj1uZXcgbC5Mb25nKDAsMCwhMSk7bi5pPXQubG9uZ3M9PT1TdHJpbmc/ci50b1N0cmluZygpOnQubG9uZ3M9PT1OdW1iZXI/ci50b051bWJlcigpOnI7fWVsc2Ugbi5pPXQubG9uZ3M9PT1TdHJpbmc/IjAiOjA7dC5ieXRlcz09PVN0cmluZz9uLnM9IiI6KG4ucz1bXSx0LmJ5dGVzIT09QXJyYXkmJihuLnM9bC5uZXdCdWZmZXIobi5zKSkpLG4udD1udWxsLG4uZz1udWxsLG4uZG9jU3RyaW5nPSIiLG4udHA9bnVsbCxuLnR5cGU9dC5lbnVtcz09PVN0cmluZz8iVU5ERUZJTkVEIjowLG4ucmVmQXR0ck5hbWU9IiIsbi5zcGFyc2VUZW5zb3I9bnVsbDt9aWYobnVsbCE9ZS5uYW1lJiZlLmhhc093blByb3BlcnR5KCJuYW1lIikmJihuLm5hbWU9ZS5uYW1lKSxudWxsIT1lLmYmJmUuaGFzT3duUHJvcGVydHkoImYiKSYmKG4uZj10Lmpzb24mJiFpc0Zpbml0ZShlLmYpP1N0cmluZyhlLmYpOmUuZiksbnVsbCE9ZS5pJiZlLmhhc093blByb3BlcnR5KCJpIikmJigibnVtYmVyIj09dHlwZW9mIGUuaT9uLmk9dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS5pKTplLmk6bi5pPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUuaSk6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLmkubG93Pj4+MCxlLmkuaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS5pKSxudWxsIT1lLnMmJmUuaGFzT3duUHJvcGVydHkoInMiKSYmKG4ucz10LmJ5dGVzPT09U3RyaW5nP2wuYmFzZTY0LmVuY29kZShlLnMsMCxlLnMubGVuZ3RoKTp0LmJ5dGVzPT09QXJyYXk/QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZS5zKTplLnMpLG51bGwhPWUudCYmZS5oYXNPd25Qcm9wZXJ0eSgidCIpJiYobi50PWMub25ueC5UZW5zb3JQcm90by50b09iamVjdChlLnQsdCkpLG51bGwhPWUuZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZyIpJiYobi5nPWMub25ueC5HcmFwaFByb3RvLnRvT2JqZWN0KGUuZyx0KSksZS5mbG9hdHMmJmUuZmxvYXRzLmxlbmd0aCl7bi5mbG9hdHM9W107Zm9yKHZhciBvPTA7bzxlLmZsb2F0cy5sZW5ndGg7KytvKW4uZmxvYXRzW29dPXQuanNvbiYmIWlzRmluaXRlKGUuZmxvYXRzW29dKT9TdHJpbmcoZS5mbG9hdHNbb10pOmUuZmxvYXRzW29dO31pZihlLmludHMmJmUuaW50cy5sZW5ndGgpZm9yKG4uaW50cz1bXSxvPTA7bzxlLmludHMubGVuZ3RoOysrbykibnVtYmVyIj09dHlwZW9mIGUuaW50c1tvXT9uLmludHNbb109dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS5pbnRzW29dKTplLmludHNbb106bi5pbnRzW29dPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUuaW50c1tvXSk6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLmludHNbb10ubG93Pj4+MCxlLmludHNbb10uaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS5pbnRzW29dO2lmKGUuc3RyaW5ncyYmZS5zdHJpbmdzLmxlbmd0aClmb3Iobi5zdHJpbmdzPVtdLG89MDtvPGUuc3RyaW5ncy5sZW5ndGg7KytvKW4uc3RyaW5nc1tvXT10LmJ5dGVzPT09U3RyaW5nP2wuYmFzZTY0LmVuY29kZShlLnN0cmluZ3Nbb10sMCxlLnN0cmluZ3Nbb10ubGVuZ3RoKTp0LmJ5dGVzPT09QXJyYXk/QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZS5zdHJpbmdzW29dKTplLnN0cmluZ3Nbb107aWYoZS50ZW5zb3JzJiZlLnRlbnNvcnMubGVuZ3RoKWZvcihuLnRlbnNvcnM9W10sbz0wO288ZS50ZW5zb3JzLmxlbmd0aDsrK28pbi50ZW5zb3JzW29dPWMub25ueC5UZW5zb3JQcm90by50b09iamVjdChlLnRlbnNvcnNbb10sdCk7aWYoZS5ncmFwaHMmJmUuZ3JhcGhzLmxlbmd0aClmb3Iobi5ncmFwaHM9W10sbz0wO288ZS5ncmFwaHMubGVuZ3RoOysrbyluLmdyYXBoc1tvXT1jLm9ubnguR3JhcGhQcm90by50b09iamVjdChlLmdyYXBoc1tvXSx0KTtpZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJihuLmRvY1N0cmluZz1lLmRvY1N0cmluZyksbnVsbCE9ZS50cCYmZS5oYXNPd25Qcm9wZXJ0eSgidHAiKSYmKG4udHA9Yy5vbm54LlR5cGVQcm90by50b09iamVjdChlLnRwLHQpKSxlLnR5cGVQcm90b3MmJmUudHlwZVByb3Rvcy5sZW5ndGgpZm9yKG4udHlwZVByb3Rvcz1bXSxvPTA7bzxlLnR5cGVQcm90b3MubGVuZ3RoOysrbyluLnR5cGVQcm90b3Nbb109Yy5vbm54LlR5cGVQcm90by50b09iamVjdChlLnR5cGVQcm90b3Nbb10sdCk7aWYobnVsbCE9ZS50eXBlJiZlLmhhc093blByb3BlcnR5KCJ0eXBlIikmJihuLnR5cGU9dC5lbnVtcz09PVN0cmluZz92b2lkIDA9PT1jLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZVtlLnR5cGVdP2UudHlwZTpjLm9ubnguQXR0cmlidXRlUHJvdG8uQXR0cmlidXRlVHlwZVtlLnR5cGVdOmUudHlwZSksbnVsbCE9ZS5yZWZBdHRyTmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgicmVmQXR0ck5hbWUiKSYmKG4ucmVmQXR0ck5hbWU9ZS5yZWZBdHRyTmFtZSksbnVsbCE9ZS5zcGFyc2VUZW5zb3ImJmUuaGFzT3duUHJvcGVydHkoInNwYXJzZVRlbnNvciIpJiYobi5zcGFyc2VUZW5zb3I9Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLnRvT2JqZWN0KGUuc3BhcnNlVGVuc29yLHQpKSxlLnNwYXJzZVRlbnNvcnMmJmUuc3BhcnNlVGVuc29ycy5sZW5ndGgpZm9yKG4uc3BhcnNlVGVuc29ycz1bXSxvPTA7bzxlLnNwYXJzZVRlbnNvcnMubGVuZ3RoOysrbyluLnNwYXJzZVRlbnNvcnNbb109Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLnRvT2JqZWN0KGUuc3BhcnNlVGVuc29yc1tvXSx0KTtyZXR1cm4gbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5BdHRyaWJ1dGVQcm90byJ9LGUuQXR0cmlidXRlVHlwZT1mdW5jdGlvbigpe3ZhciBlPXt9LHQ9T2JqZWN0LmNyZWF0ZShlKTtyZXR1cm4gdFtlWzBdPSJVTkRFRklORUQiXT0wLHRbZVsxXT0iRkxPQVQiXT0xLHRbZVsyXT0iSU5UIl09Mix0W2VbM109IlNUUklORyJdPTMsdFtlWzRdPSJURU5TT1IiXT00LHRbZVs1XT0iR1JBUEgiXT01LHRbZVsxMV09IlNQQVJTRV9URU5TT1IiXT0xMSx0W2VbMTNdPSJUWVBFX1BST1RPIl09MTMsdFtlWzZdPSJGTE9BVFMiXT02LHRbZVs3XT0iSU5UUyJdPTcsdFtlWzhdPSJTVFJJTkdTIl09OCx0W2VbOV09IlRFTlNPUlMiXT05LHRbZVsxMF09IkdSQVBIUyJdPTEwLHRbZVsxMl09IlNQQVJTRV9URU5TT1JTIl09MTIsdFtlWzE0XT0iVFlQRV9QUk9UT1MiXT0xNCx0fSgpLGV9KCksaS5WYWx1ZUluZm9Qcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUubmFtZT0iIixlLnByb3RvdHlwZS50eXBlPW51bGwsZS5wcm90b3R5cGUuZG9jU3RyaW5nPSIiLGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS5uYW1lJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJuYW1lIikmJnQudWludDMyKDEwKS5zdHJpbmcoZS5uYW1lKSxudWxsIT1lLnR5cGUmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsInR5cGUiKSYmYy5vbm54LlR5cGVQcm90by5lbmNvZGUoZS50eXBlLHQudWludDMyKDE4KS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuZG9jU3RyaW5nJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkb2NTdHJpbmciKSYmdC51aW50MzIoMjYpLnN0cmluZyhlLmRvY1N0cmluZyksdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LlZhbHVlSW5mb1Byb3RvO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIubmFtZT1lLnN0cmluZygpO2JyZWFrO2Nhc2UgMjpyLnR5cGU9Yy5vbm54LlR5cGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztjYXNlIDM6ci5kb2NTdHJpbmc9ZS5zdHJpbmcoKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmIWwuaXNTdHJpbmcoZS5uYW1lKSlyZXR1cm4gIm5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS50eXBlJiZlLmhhc093blByb3BlcnR5KCJ0eXBlIikpe3ZhciB0PWMub25ueC5UeXBlUHJvdG8udmVyaWZ5KGUudHlwZSk7aWYodClyZXR1cm4gInR5cGUuIit0fXJldHVybiBudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJiFsLmlzU3RyaW5nKGUuZG9jU3RyaW5nKT8iZG9jU3RyaW5nOiBzdHJpbmcgZXhwZWN0ZWQiOm51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlZhbHVlSW5mb1Byb3RvKXJldHVybiBlO3ZhciB0PW5ldyBjLm9ubnguVmFsdWVJbmZvUHJvdG87aWYobnVsbCE9ZS5uYW1lJiYodC5uYW1lPVN0cmluZyhlLm5hbWUpKSxudWxsIT1lLnR5cGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZS50eXBlKXRocm93IFR5cGVFcnJvcigiLm9ubnguVmFsdWVJbmZvUHJvdG8udHlwZTogb2JqZWN0IGV4cGVjdGVkIik7dC50eXBlPWMub25ueC5UeXBlUHJvdG8uZnJvbU9iamVjdChlLnR5cGUpO31yZXR1cm4gbnVsbCE9ZS5kb2NTdHJpbmcmJih0LmRvY1N0cmluZz1TdHJpbmcoZS5kb2NTdHJpbmcpKSx0fSxlLnRvT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dHx8KHQ9e30pO3ZhciBuPXt9O3JldHVybiB0LmRlZmF1bHRzJiYobi5uYW1lPSIiLG4udHlwZT1udWxsLG4uZG9jU3RyaW5nPSIiKSxudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmKG4ubmFtZT1lLm5hbWUpLG51bGwhPWUudHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgidHlwZSIpJiYobi50eXBlPWMub25ueC5UeXBlUHJvdG8udG9PYmplY3QoZS50eXBlLHQpKSxudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJihuLmRvY1N0cmluZz1lLmRvY1N0cmluZyksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5WYWx1ZUluZm9Qcm90byJ9LGV9KCksaS5Ob2RlUHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKHRoaXMuaW5wdXQ9W10sdGhpcy5vdXRwdXQ9W10sdGhpcy5hdHRyaWJ1dGU9W10sZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUuaW5wdXQ9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLm91dHB1dD1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUubmFtZT0iIixlLnByb3RvdHlwZS5vcFR5cGU9IiIsZS5wcm90b3R5cGUuZG9tYWluPSIiLGUucHJvdG90eXBlLmF0dHJpYnV0ZT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuZG9jU3RyaW5nPSIiLGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtpZih0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmlucHV0JiZlLmlucHV0Lmxlbmd0aClmb3IodmFyIG49MDtuPGUuaW5wdXQubGVuZ3RoOysrbil0LnVpbnQzMigxMCkuc3RyaW5nKGUuaW5wdXRbbl0pO2lmKG51bGwhPWUub3V0cHV0JiZlLm91dHB1dC5sZW5ndGgpZm9yKG49MDtuPGUub3V0cHV0Lmxlbmd0aDsrK24pdC51aW50MzIoMTgpLnN0cmluZyhlLm91dHB1dFtuXSk7aWYobnVsbCE9ZS5uYW1lJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJuYW1lIikmJnQudWludDMyKDI2KS5zdHJpbmcoZS5uYW1lKSxudWxsIT1lLm9wVHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwib3BUeXBlIikmJnQudWludDMyKDM0KS5zdHJpbmcoZS5vcFR5cGUpLG51bGwhPWUuYXR0cmlidXRlJiZlLmF0dHJpYnV0ZS5sZW5ndGgpZm9yKG49MDtuPGUuYXR0cmlidXRlLmxlbmd0aDsrK24pYy5vbm54LkF0dHJpYnV0ZVByb3RvLmVuY29kZShlLmF0dHJpYnV0ZVtuXSx0LnVpbnQzMig0MikuZm9yaygpKS5sZGVsaW0oKTtyZXR1cm4gbnVsbCE9ZS5kb2NTdHJpbmcmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRvY1N0cmluZyIpJiZ0LnVpbnQzMig1MCkuc3RyaW5nKGUuZG9jU3RyaW5nKSxudWxsIT1lLmRvbWFpbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZG9tYWluIikmJnQudWludDMyKDU4KS5zdHJpbmcoZS5kb21haW4pLHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5Ob2RlUHJvdG87ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci5pbnB1dCYmci5pbnB1dC5sZW5ndGh8fChyLmlucHV0PVtdKSxyLmlucHV0LnB1c2goZS5zdHJpbmcoKSk7YnJlYWs7Y2FzZSAyOnIub3V0cHV0JiZyLm91dHB1dC5sZW5ndGh8fChyLm91dHB1dD1bXSksci5vdXRwdXQucHVzaChlLnN0cmluZygpKTticmVhaztjYXNlIDM6ci5uYW1lPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA0OnIub3BUeXBlPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA3OnIuZG9tYWluPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA1OnIuYXR0cmlidXRlJiZyLmF0dHJpYnV0ZS5sZW5ndGh8fChyLmF0dHJpYnV0ZT1bXSksci5hdHRyaWJ1dGUucHVzaChjLm9ubnguQXR0cmlidXRlUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgNjpyLmRvY1N0cmluZz1lLnN0cmluZygpO2JyZWFrO2RlZmF1bHQ6ZS5za2lwVHlwZSg3Jm8pO319cmV0dXJuIHJ9LGUuZGVjb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgYXx8KGU9bmV3IGEoZSkpLHRoaXMuZGVjb2RlKGUsZS51aW50MzIoKSl9LGUudmVyaWZ5PWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuICJvYmplY3QgZXhwZWN0ZWQiO2lmKG51bGwhPWUuaW5wdXQmJmUuaGFzT3duUHJvcGVydHkoImlucHV0Iikpe2lmKCFBcnJheS5pc0FycmF5KGUuaW5wdXQpKXJldHVybiAiaW5wdXQ6IGFycmF5IGV4cGVjdGVkIjtmb3IodmFyIHQ9MDt0PGUuaW5wdXQubGVuZ3RoOysrdClpZighbC5pc1N0cmluZyhlLmlucHV0W3RdKSlyZXR1cm4gImlucHV0OiBzdHJpbmdbXSBleHBlY3RlZCJ9aWYobnVsbCE9ZS5vdXRwdXQmJmUuaGFzT3duUHJvcGVydHkoIm91dHB1dCIpKXtpZighQXJyYXkuaXNBcnJheShlLm91dHB1dCkpcmV0dXJuICJvdXRwdXQ6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5vdXRwdXQubGVuZ3RoOysrdClpZighbC5pc1N0cmluZyhlLm91dHB1dFt0XSkpcmV0dXJuICJvdXRwdXQ6IHN0cmluZ1tdIGV4cGVjdGVkIn1pZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmIWwuaXNTdHJpbmcoZS5uYW1lKSlyZXR1cm4gIm5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5vcFR5cGUmJmUuaGFzT3duUHJvcGVydHkoIm9wVHlwZSIpJiYhbC5pc1N0cmluZyhlLm9wVHlwZSkpcmV0dXJuICJvcFR5cGU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5kb21haW4mJmUuaGFzT3duUHJvcGVydHkoImRvbWFpbiIpJiYhbC5pc1N0cmluZyhlLmRvbWFpbikpcmV0dXJuICJkb21haW46IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5hdHRyaWJ1dGUmJmUuaGFzT3duUHJvcGVydHkoImF0dHJpYnV0ZSIpKXtpZighQXJyYXkuaXNBcnJheShlLmF0dHJpYnV0ZSkpcmV0dXJuICJhdHRyaWJ1dGU6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5hdHRyaWJ1dGUubGVuZ3RoOysrdCl7dmFyIG49Yy5vbm54LkF0dHJpYnV0ZVByb3RvLnZlcmlmeShlLmF0dHJpYnV0ZVt0XSk7aWYobilyZXR1cm4gImF0dHJpYnV0ZS4iK259fXJldHVybiBudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJiFsLmlzU3RyaW5nKGUuZG9jU3RyaW5nKT8iZG9jU3RyaW5nOiBzdHJpbmcgZXhwZWN0ZWQiOm51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54Lk5vZGVQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54Lk5vZGVQcm90bztpZihlLmlucHV0KXtpZighQXJyYXkuaXNBcnJheShlLmlucHV0KSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk5vZGVQcm90by5pbnB1dDogYXJyYXkgZXhwZWN0ZWQiKTt0LmlucHV0PVtdO2Zvcih2YXIgbj0wO248ZS5pbnB1dC5sZW5ndGg7KytuKXQuaW5wdXRbbl09U3RyaW5nKGUuaW5wdXRbbl0pO31pZihlLm91dHB1dCl7aWYoIUFycmF5LmlzQXJyYXkoZS5vdXRwdXQpKXRocm93IFR5cGVFcnJvcigiLm9ubnguTm9kZVByb3RvLm91dHB1dDogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5vdXRwdXQ9W10sbj0wO248ZS5vdXRwdXQubGVuZ3RoOysrbil0Lm91dHB1dFtuXT1TdHJpbmcoZS5vdXRwdXRbbl0pO31pZihudWxsIT1lLm5hbWUmJih0Lm5hbWU9U3RyaW5nKGUubmFtZSkpLG51bGwhPWUub3BUeXBlJiYodC5vcFR5cGU9U3RyaW5nKGUub3BUeXBlKSksbnVsbCE9ZS5kb21haW4mJih0LmRvbWFpbj1TdHJpbmcoZS5kb21haW4pKSxlLmF0dHJpYnV0ZSl7aWYoIUFycmF5LmlzQXJyYXkoZS5hdHRyaWJ1dGUpKXRocm93IFR5cGVFcnJvcigiLm9ubnguTm9kZVByb3RvLmF0dHJpYnV0ZTogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5hdHRyaWJ1dGU9W10sbj0wO248ZS5hdHRyaWJ1dGUubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLmF0dHJpYnV0ZVtuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk5vZGVQcm90by5hdHRyaWJ1dGU6IG9iamVjdCBleHBlY3RlZCIpO3QuYXR0cmlidXRlW25dPWMub25ueC5BdHRyaWJ1dGVQcm90by5mcm9tT2JqZWN0KGUuYXR0cmlidXRlW25dKTt9fXJldHVybiBudWxsIT1lLmRvY1N0cmluZyYmKHQuZG9jU3RyaW5nPVN0cmluZyhlLmRvY1N0cmluZykpLHR9LGUudG9PYmplY3Q9ZnVuY3Rpb24oZSx0KXt0fHwodD17fSk7dmFyIG49e307aWYoKHQuYXJyYXlzfHx0LmRlZmF1bHRzKSYmKG4uaW5wdXQ9W10sbi5vdXRwdXQ9W10sbi5hdHRyaWJ1dGU9W10pLHQuZGVmYXVsdHMmJihuLm5hbWU9IiIsbi5vcFR5cGU9IiIsbi5kb2NTdHJpbmc9IiIsbi5kb21haW49IiIpLGUuaW5wdXQmJmUuaW5wdXQubGVuZ3RoKXtuLmlucHV0PVtdO2Zvcih2YXIgcj0wO3I8ZS5pbnB1dC5sZW5ndGg7KytyKW4uaW5wdXRbcl09ZS5pbnB1dFtyXTt9aWYoZS5vdXRwdXQmJmUub3V0cHV0Lmxlbmd0aClmb3Iobi5vdXRwdXQ9W10scj0wO3I8ZS5vdXRwdXQubGVuZ3RoOysrciluLm91dHB1dFtyXT1lLm91dHB1dFtyXTtpZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmKG4ubmFtZT1lLm5hbWUpLG51bGwhPWUub3BUeXBlJiZlLmhhc093blByb3BlcnR5KCJvcFR5cGUiKSYmKG4ub3BUeXBlPWUub3BUeXBlKSxlLmF0dHJpYnV0ZSYmZS5hdHRyaWJ1dGUubGVuZ3RoKWZvcihuLmF0dHJpYnV0ZT1bXSxyPTA7cjxlLmF0dHJpYnV0ZS5sZW5ndGg7KytyKW4uYXR0cmlidXRlW3JdPWMub25ueC5BdHRyaWJ1dGVQcm90by50b09iamVjdChlLmF0dHJpYnV0ZVtyXSx0KTtyZXR1cm4gbnVsbCE9ZS5kb2NTdHJpbmcmJmUuaGFzT3duUHJvcGVydHkoImRvY1N0cmluZyIpJiYobi5kb2NTdHJpbmc9ZS5kb2NTdHJpbmcpLG51bGwhPWUuZG9tYWluJiZlLmhhc093blByb3BlcnR5KCJkb21haW4iKSYmKG4uZG9tYWluPWUuZG9tYWluKSxufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54Lk5vZGVQcm90byJ9LGV9KCksaS5UcmFpbmluZ0luZm9Qcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodGhpcy5pbml0aWFsaXphdGlvbkJpbmRpbmc9W10sdGhpcy51cGRhdGVCaW5kaW5nPVtdLGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmluaXRpYWxpemF0aW9uPW51bGwsZS5wcm90b3R5cGUuYWxnb3JpdGhtPW51bGwsZS5wcm90b3R5cGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nPWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS51cGRhdGVCaW5kaW5nPWwuZW1wdHlBcnJheSxlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7aWYodHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS5pbml0aWFsaXphdGlvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiaW5pdGlhbGl6YXRpb24iKSYmYy5vbm54LkdyYXBoUHJvdG8uZW5jb2RlKGUuaW5pdGlhbGl6YXRpb24sdC51aW50MzIoMTApLmZvcmsoKSkubGRlbGltKCksbnVsbCE9ZS5hbGdvcml0aG0mJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImFsZ29yaXRobSIpJiZjLm9ubnguR3JhcGhQcm90by5lbmNvZGUoZS5hbGdvcml0aG0sdC51aW50MzIoMTgpLmZvcmsoKSkubGRlbGltKCksbnVsbCE9ZS5pbml0aWFsaXphdGlvbkJpbmRpbmcmJmUuaW5pdGlhbGl6YXRpb25CaW5kaW5nLmxlbmd0aClmb3IodmFyIG49MDtuPGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nLmxlbmd0aDsrK24pYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8uZW5jb2RlKGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nW25dLHQudWludDMyKDI2KS5mb3JrKCkpLmxkZWxpbSgpO2lmKG51bGwhPWUudXBkYXRlQmluZGluZyYmZS51cGRhdGVCaW5kaW5nLmxlbmd0aClmb3Iobj0wO248ZS51cGRhdGVCaW5kaW5nLmxlbmd0aDsrK24pYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8uZW5jb2RlKGUudXBkYXRlQmluZGluZ1tuXSx0LnVpbnQzMigzNCkuZm9yaygpKS5sZGVsaW0oKTtyZXR1cm4gdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LlRyYWluaW5nSW5mb1Byb3RvO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIuaW5pdGlhbGl6YXRpb249Yy5vbm54LkdyYXBoUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7Y2FzZSAyOnIuYWxnb3JpdGhtPWMub25ueC5HcmFwaFByb3RvLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgMzpyLmluaXRpYWxpemF0aW9uQmluZGluZyYmci5pbml0aWFsaXphdGlvbkJpbmRpbmcubGVuZ3RofHwoci5pbml0aWFsaXphdGlvbkJpbmRpbmc9W10pLHIuaW5pdGlhbGl6YXRpb25CaW5kaW5nLnB1c2goYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgNDpyLnVwZGF0ZUJpbmRpbmcmJnIudXBkYXRlQmluZGluZy5sZW5ndGh8fChyLnVwZGF0ZUJpbmRpbmc9W10pLHIudXBkYXRlQmluZGluZy5wdXNoKGMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLmRlY29kZShlLGUudWludDMyKCkpKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLmluaXRpYWxpemF0aW9uJiZlLmhhc093blByb3BlcnR5KCJpbml0aWFsaXphdGlvbiIpJiYobj1jLm9ubnguR3JhcGhQcm90by52ZXJpZnkoZS5pbml0aWFsaXphdGlvbikpKXJldHVybiAiaW5pdGlhbGl6YXRpb24uIituO2lmKG51bGwhPWUuYWxnb3JpdGhtJiZlLmhhc093blByb3BlcnR5KCJhbGdvcml0aG0iKSYmKG49Yy5vbm54LkdyYXBoUHJvdG8udmVyaWZ5KGUuYWxnb3JpdGhtKSkpcmV0dXJuICJhbGdvcml0aG0uIituO2lmKG51bGwhPWUuaW5pdGlhbGl6YXRpb25CaW5kaW5nJiZlLmhhc093blByb3BlcnR5KCJpbml0aWFsaXphdGlvbkJpbmRpbmciKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5pbml0aWFsaXphdGlvbkJpbmRpbmcpKXJldHVybiAiaW5pdGlhbGl6YXRpb25CaW5kaW5nOiBhcnJheSBleHBlY3RlZCI7Zm9yKHZhciB0PTA7dDxlLmluaXRpYWxpemF0aW9uQmluZGluZy5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8udmVyaWZ5KGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nW3RdKSlyZXR1cm4gImluaXRpYWxpemF0aW9uQmluZGluZy4iK259aWYobnVsbCE9ZS51cGRhdGVCaW5kaW5nJiZlLmhhc093blByb3BlcnR5KCJ1cGRhdGVCaW5kaW5nIikpe2lmKCFBcnJheS5pc0FycmF5KGUudXBkYXRlQmluZGluZykpcmV0dXJuICJ1cGRhdGVCaW5kaW5nOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUudXBkYXRlQmluZGluZy5sZW5ndGg7Kyt0KXt2YXIgbjtpZihuPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLnZlcmlmeShlLnVwZGF0ZUJpbmRpbmdbdF0pKXJldHVybiAidXBkYXRlQmluZGluZy4iK259fXJldHVybiBudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5UcmFpbmluZ0luZm9Qcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlRyYWluaW5nSW5mb1Byb3RvO2lmKG51bGwhPWUuaW5pdGlhbGl6YXRpb24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5pbml0aWFsaXphdGlvbil0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRyYWluaW5nSW5mb1Byb3RvLmluaXRpYWxpemF0aW9uOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmluaXRpYWxpemF0aW9uPWMub25ueC5HcmFwaFByb3RvLmZyb21PYmplY3QoZS5pbml0aWFsaXphdGlvbik7fWlmKG51bGwhPWUuYWxnb3JpdGhtKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuYWxnb3JpdGhtKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHJhaW5pbmdJbmZvUHJvdG8uYWxnb3JpdGhtOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmFsZ29yaXRobT1jLm9ubnguR3JhcGhQcm90by5mcm9tT2JqZWN0KGUuYWxnb3JpdGhtKTt9aWYoZS5pbml0aWFsaXphdGlvbkJpbmRpbmcpe2lmKCFBcnJheS5pc0FycmF5KGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRyYWluaW5nSW5mb1Byb3RvLmluaXRpYWxpemF0aW9uQmluZGluZzogYXJyYXkgZXhwZWN0ZWQiKTt0LmluaXRpYWxpemF0aW9uQmluZGluZz1bXTtmb3IodmFyIG49MDtuPGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5pbml0aWFsaXphdGlvbkJpbmRpbmdbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5UcmFpbmluZ0luZm9Qcm90by5pbml0aWFsaXphdGlvbkJpbmRpbmc6IG9iamVjdCBleHBlY3RlZCIpO3QuaW5pdGlhbGl6YXRpb25CaW5kaW5nW25dPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLmZyb21PYmplY3QoZS5pbml0aWFsaXphdGlvbkJpbmRpbmdbbl0pO319aWYoZS51cGRhdGVCaW5kaW5nKXtpZighQXJyYXkuaXNBcnJheShlLnVwZGF0ZUJpbmRpbmcpKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHJhaW5pbmdJbmZvUHJvdG8udXBkYXRlQmluZGluZzogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC51cGRhdGVCaW5kaW5nPVtdLG49MDtuPGUudXBkYXRlQmluZGluZy5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUudXBkYXRlQmluZGluZ1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRyYWluaW5nSW5mb1Byb3RvLnVwZGF0ZUJpbmRpbmc6IG9iamVjdCBleHBlY3RlZCIpO3QudXBkYXRlQmluZGluZ1tuXT1jLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by5mcm9tT2JqZWN0KGUudXBkYXRlQmluZGluZ1tuXSk7fX1yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5pbml0aWFsaXphdGlvbkJpbmRpbmc9W10sbi51cGRhdGVCaW5kaW5nPVtdKSx0LmRlZmF1bHRzJiYobi5pbml0aWFsaXphdGlvbj1udWxsLG4uYWxnb3JpdGhtPW51bGwpLG51bGwhPWUuaW5pdGlhbGl6YXRpb24mJmUuaGFzT3duUHJvcGVydHkoImluaXRpYWxpemF0aW9uIikmJihuLmluaXRpYWxpemF0aW9uPWMub25ueC5HcmFwaFByb3RvLnRvT2JqZWN0KGUuaW5pdGlhbGl6YXRpb24sdCkpLG51bGwhPWUuYWxnb3JpdGhtJiZlLmhhc093blByb3BlcnR5KCJhbGdvcml0aG0iKSYmKG4uYWxnb3JpdGhtPWMub25ueC5HcmFwaFByb3RvLnRvT2JqZWN0KGUuYWxnb3JpdGhtLHQpKSxlLmluaXRpYWxpemF0aW9uQmluZGluZyYmZS5pbml0aWFsaXphdGlvbkJpbmRpbmcubGVuZ3RoKXtuLmluaXRpYWxpemF0aW9uQmluZGluZz1bXTtmb3IodmFyIHI9MDtyPGUuaW5pdGlhbGl6YXRpb25CaW5kaW5nLmxlbmd0aDsrK3Ipbi5pbml0aWFsaXphdGlvbkJpbmRpbmdbcl09Yy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8udG9PYmplY3QoZS5pbml0aWFsaXphdGlvbkJpbmRpbmdbcl0sdCk7fWlmKGUudXBkYXRlQmluZGluZyYmZS51cGRhdGVCaW5kaW5nLmxlbmd0aClmb3Iobi51cGRhdGVCaW5kaW5nPVtdLHI9MDtyPGUudXBkYXRlQmluZGluZy5sZW5ndGg7KytyKW4udXBkYXRlQmluZGluZ1tyXT1jLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by50b09iamVjdChlLnVwZGF0ZUJpbmRpbmdbcl0sdCk7cmV0dXJuIG59LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnRvT2JqZWN0KHRoaXMscy51dGlsLnRvSlNPTk9wdGlvbnMpfSxlLmdldFR5cGVVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSJ0eXBlLmdvb2dsZWFwaXMuY29tIiksZSsiL29ubnguVHJhaW5pbmdJbmZvUHJvdG8ifSxlfSgpLGkuTW9kZWxQcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodGhpcy5vcHNldEltcG9ydD1bXSx0aGlzLm1ldGFkYXRhUHJvcHM9W10sdGhpcy50cmFpbmluZ0luZm89W10sdGhpcy5mdW5jdGlvbnM9W10sZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUuaXJWZXJzaW9uPWwuTG9uZz9sLkxvbmcuZnJvbUJpdHMoMCwwLCExKTowLGUucHJvdG90eXBlLm9wc2V0SW1wb3J0PWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5wcm9kdWNlck5hbWU9IiIsZS5wcm90b3R5cGUucHJvZHVjZXJWZXJzaW9uPSIiLGUucHJvdG90eXBlLmRvbWFpbj0iIixlLnByb3RvdHlwZS5tb2RlbFZlcnNpb249bC5Mb25nP2wuTG9uZy5mcm9tQml0cygwLDAsITEpOjAsZS5wcm90b3R5cGUuZG9jU3RyaW5nPSIiLGUucHJvdG90eXBlLmdyYXBoPW51bGwsZS5wcm90b3R5cGUubWV0YWRhdGFQcm9wcz1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUudHJhaW5pbmdJbmZvPWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5mdW5jdGlvbnM9bC5lbXB0eUFycmF5LGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtpZih0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmlyVmVyc2lvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiaXJWZXJzaW9uIikmJnQudWludDMyKDgpLmludDY0KGUuaXJWZXJzaW9uKSxudWxsIT1lLnByb2R1Y2VyTmFtZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwicHJvZHVjZXJOYW1lIikmJnQudWludDMyKDE4KS5zdHJpbmcoZS5wcm9kdWNlck5hbWUpLG51bGwhPWUucHJvZHVjZXJWZXJzaW9uJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJwcm9kdWNlclZlcnNpb24iKSYmdC51aW50MzIoMjYpLnN0cmluZyhlLnByb2R1Y2VyVmVyc2lvbiksbnVsbCE9ZS5kb21haW4mJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRvbWFpbiIpJiZ0LnVpbnQzMigzNCkuc3RyaW5nKGUuZG9tYWluKSxudWxsIT1lLm1vZGVsVmVyc2lvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwibW9kZWxWZXJzaW9uIikmJnQudWludDMyKDQwKS5pbnQ2NChlLm1vZGVsVmVyc2lvbiksbnVsbCE9ZS5kb2NTdHJpbmcmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRvY1N0cmluZyIpJiZ0LnVpbnQzMig1MCkuc3RyaW5nKGUuZG9jU3RyaW5nKSxudWxsIT1lLmdyYXBoJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJncmFwaCIpJiZjLm9ubnguR3JhcGhQcm90by5lbmNvZGUoZS5ncmFwaCx0LnVpbnQzMig1OCkuZm9yaygpKS5sZGVsaW0oKSxudWxsIT1lLm9wc2V0SW1wb3J0JiZlLm9wc2V0SW1wb3J0Lmxlbmd0aClmb3IodmFyIG49MDtuPGUub3BzZXRJbXBvcnQubGVuZ3RoOysrbiljLm9ubnguT3BlcmF0b3JTZXRJZFByb3RvLmVuY29kZShlLm9wc2V0SW1wb3J0W25dLHQudWludDMyKDY2KS5mb3JrKCkpLmxkZWxpbSgpO2lmKG51bGwhPWUubWV0YWRhdGFQcm9wcyYmZS5tZXRhZGF0YVByb3BzLmxlbmd0aClmb3Iobj0wO248ZS5tZXRhZGF0YVByb3BzLmxlbmd0aDsrK24pYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8uZW5jb2RlKGUubWV0YWRhdGFQcm9wc1tuXSx0LnVpbnQzMigxMTQpLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS50cmFpbmluZ0luZm8mJmUudHJhaW5pbmdJbmZvLmxlbmd0aClmb3Iobj0wO248ZS50cmFpbmluZ0luZm8ubGVuZ3RoOysrbiljLm9ubnguVHJhaW5pbmdJbmZvUHJvdG8uZW5jb2RlKGUudHJhaW5pbmdJbmZvW25dLHQudWludDMyKDE2MikuZm9yaygpKS5sZGVsaW0oKTtpZihudWxsIT1lLmZ1bmN0aW9ucyYmZS5mdW5jdGlvbnMubGVuZ3RoKWZvcihuPTA7bjxlLmZ1bmN0aW9ucy5sZW5ndGg7KytuKWMub25ueC5GdW5jdGlvblByb3RvLmVuY29kZShlLmZ1bmN0aW9uc1tuXSx0LnVpbnQzMigyMDIpLmZvcmsoKSkubGRlbGltKCk7cmV0dXJuIHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5Nb2RlbFByb3RvO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIuaXJWZXJzaW9uPWUuaW50NjQoKTticmVhaztjYXNlIDg6ci5vcHNldEltcG9ydCYmci5vcHNldEltcG9ydC5sZW5ndGh8fChyLm9wc2V0SW1wb3J0PVtdKSxyLm9wc2V0SW1wb3J0LnB1c2goYy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAyOnIucHJvZHVjZXJOYW1lPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSAzOnIucHJvZHVjZXJWZXJzaW9uPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA0OnIuZG9tYWluPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA1OnIubW9kZWxWZXJzaW9uPWUuaW50NjQoKTticmVhaztjYXNlIDY6ci5kb2NTdHJpbmc9ZS5zdHJpbmcoKTticmVhaztjYXNlIDc6ci5ncmFwaD1jLm9ubnguR3JhcGhQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztjYXNlIDE0OnIubWV0YWRhdGFQcm9wcyYmci5tZXRhZGF0YVByb3BzLmxlbmd0aHx8KHIubWV0YWRhdGFQcm9wcz1bXSksci5tZXRhZGF0YVByb3BzLnB1c2goYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMjA6ci50cmFpbmluZ0luZm8mJnIudHJhaW5pbmdJbmZvLmxlbmd0aHx8KHIudHJhaW5pbmdJbmZvPVtdKSxyLnRyYWluaW5nSW5mby5wdXNoKGMub25ueC5UcmFpbmluZ0luZm9Qcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAyNTpyLmZ1bmN0aW9ucyYmci5mdW5jdGlvbnMubGVuZ3RofHwoci5mdW5jdGlvbnM9W10pLHIuZnVuY3Rpb25zLnB1c2goYy5vbm54LkZ1bmN0aW9uUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2RlZmF1bHQ6ZS5za2lwVHlwZSg3Jm8pO319cmV0dXJuIHJ9LGUuZGVjb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgYXx8KGU9bmV3IGEoZSkpLHRoaXMuZGVjb2RlKGUsZS51aW50MzIoKSl9LGUudmVyaWZ5PWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuICJvYmplY3QgZXhwZWN0ZWQiO2lmKG51bGwhPWUuaXJWZXJzaW9uJiZlLmhhc093blByb3BlcnR5KCJpclZlcnNpb24iKSYmIShsLmlzSW50ZWdlcihlLmlyVmVyc2lvbil8fGUuaXJWZXJzaW9uJiZsLmlzSW50ZWdlcihlLmlyVmVyc2lvbi5sb3cpJiZsLmlzSW50ZWdlcihlLmlyVmVyc2lvbi5oaWdoKSkpcmV0dXJuICJpclZlcnNpb246IGludGVnZXJ8TG9uZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5vcHNldEltcG9ydCYmZS5oYXNPd25Qcm9wZXJ0eSgib3BzZXRJbXBvcnQiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5vcHNldEltcG9ydCkpcmV0dXJuICJvcHNldEltcG9ydDogYXJyYXkgZXhwZWN0ZWQiO2Zvcih2YXIgdD0wO3Q8ZS5vcHNldEltcG9ydC5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90by52ZXJpZnkoZS5vcHNldEltcG9ydFt0XSkpcmV0dXJuICJvcHNldEltcG9ydC4iK259aWYobnVsbCE9ZS5wcm9kdWNlck5hbWUmJmUuaGFzT3duUHJvcGVydHkoInByb2R1Y2VyTmFtZSIpJiYhbC5pc1N0cmluZyhlLnByb2R1Y2VyTmFtZSkpcmV0dXJuICJwcm9kdWNlck5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5wcm9kdWNlclZlcnNpb24mJmUuaGFzT3duUHJvcGVydHkoInByb2R1Y2VyVmVyc2lvbiIpJiYhbC5pc1N0cmluZyhlLnByb2R1Y2VyVmVyc2lvbikpcmV0dXJuICJwcm9kdWNlclZlcnNpb246IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5kb21haW4mJmUuaGFzT3duUHJvcGVydHkoImRvbWFpbiIpJiYhbC5pc1N0cmluZyhlLmRvbWFpbikpcmV0dXJuICJkb21haW46IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5tb2RlbFZlcnNpb24mJmUuaGFzT3duUHJvcGVydHkoIm1vZGVsVmVyc2lvbiIpJiYhKGwuaXNJbnRlZ2VyKGUubW9kZWxWZXJzaW9uKXx8ZS5tb2RlbFZlcnNpb24mJmwuaXNJbnRlZ2VyKGUubW9kZWxWZXJzaW9uLmxvdykmJmwuaXNJbnRlZ2VyKGUubW9kZWxWZXJzaW9uLmhpZ2gpKSlyZXR1cm4gIm1vZGVsVmVyc2lvbjogaW50ZWdlcnxMb25nIGV4cGVjdGVkIjtpZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJiFsLmlzU3RyaW5nKGUuZG9jU3RyaW5nKSlyZXR1cm4gImRvY1N0cmluZzogc3RyaW5nIGV4cGVjdGVkIjtpZihudWxsIT1lLmdyYXBoJiZlLmhhc093blByb3BlcnR5KCJncmFwaCIpJiYobj1jLm9ubnguR3JhcGhQcm90by52ZXJpZnkoZS5ncmFwaCkpKXJldHVybiAiZ3JhcGguIituO2lmKG51bGwhPWUubWV0YWRhdGFQcm9wcyYmZS5oYXNPd25Qcm9wZXJ0eSgibWV0YWRhdGFQcm9wcyIpKXtpZighQXJyYXkuaXNBcnJheShlLm1ldGFkYXRhUHJvcHMpKXJldHVybiAibWV0YWRhdGFQcm9wczogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLm1ldGFkYXRhUHJvcHMubGVuZ3RoOysrdClpZihuPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLnZlcmlmeShlLm1ldGFkYXRhUHJvcHNbdF0pKXJldHVybiAibWV0YWRhdGFQcm9wcy4iK259aWYobnVsbCE9ZS50cmFpbmluZ0luZm8mJmUuaGFzT3duUHJvcGVydHkoInRyYWluaW5nSW5mbyIpKXtpZighQXJyYXkuaXNBcnJheShlLnRyYWluaW5nSW5mbykpcmV0dXJuICJ0cmFpbmluZ0luZm86IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS50cmFpbmluZ0luZm8ubGVuZ3RoOysrdClpZihuPWMub25ueC5UcmFpbmluZ0luZm9Qcm90by52ZXJpZnkoZS50cmFpbmluZ0luZm9bdF0pKXJldHVybiAidHJhaW5pbmdJbmZvLiIrbn1pZihudWxsIT1lLmZ1bmN0aW9ucyYmZS5oYXNPd25Qcm9wZXJ0eSgiZnVuY3Rpb25zIikpe2lmKCFBcnJheS5pc0FycmF5KGUuZnVuY3Rpb25zKSlyZXR1cm4gImZ1bmN0aW9uczogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLmZ1bmN0aW9ucy5sZW5ndGg7Kyt0KXt2YXIgbjtpZihuPWMub25ueC5GdW5jdGlvblByb3RvLnZlcmlmeShlLmZ1bmN0aW9uc1t0XSkpcmV0dXJuICJmdW5jdGlvbnMuIitufX1yZXR1cm4gbnVsbH0sZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBjLm9ubnguTW9kZWxQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54Lk1vZGVsUHJvdG87aWYobnVsbCE9ZS5pclZlcnNpb24mJihsLkxvbmc/KHQuaXJWZXJzaW9uPWwuTG9uZy5mcm9tVmFsdWUoZS5pclZlcnNpb24pKS51bnNpZ25lZD0hMToic3RyaW5nIj09dHlwZW9mIGUuaXJWZXJzaW9uP3QuaXJWZXJzaW9uPXBhcnNlSW50KGUuaXJWZXJzaW9uLDEwKToibnVtYmVyIj09dHlwZW9mIGUuaXJWZXJzaW9uP3QuaXJWZXJzaW9uPWUuaXJWZXJzaW9uOiJvYmplY3QiPT10eXBlb2YgZS5pclZlcnNpb24mJih0LmlyVmVyc2lvbj1uZXcgbC5Mb25nQml0cyhlLmlyVmVyc2lvbi5sb3c+Pj4wLGUuaXJWZXJzaW9uLmhpZ2g+Pj4wKS50b051bWJlcigpKSksZS5vcHNldEltcG9ydCl7aWYoIUFycmF5LmlzQXJyYXkoZS5vcHNldEltcG9ydCkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5Nb2RlbFByb3RvLm9wc2V0SW1wb3J0OiBhcnJheSBleHBlY3RlZCIpO3Qub3BzZXRJbXBvcnQ9W107Zm9yKHZhciBuPTA7bjxlLm9wc2V0SW1wb3J0Lmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5vcHNldEltcG9ydFtuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk1vZGVsUHJvdG8ub3BzZXRJbXBvcnQ6IG9iamVjdCBleHBlY3RlZCIpO3Qub3BzZXRJbXBvcnRbbl09Yy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90by5mcm9tT2JqZWN0KGUub3BzZXRJbXBvcnRbbl0pO319aWYobnVsbCE9ZS5wcm9kdWNlck5hbWUmJih0LnByb2R1Y2VyTmFtZT1TdHJpbmcoZS5wcm9kdWNlck5hbWUpKSxudWxsIT1lLnByb2R1Y2VyVmVyc2lvbiYmKHQucHJvZHVjZXJWZXJzaW9uPVN0cmluZyhlLnByb2R1Y2VyVmVyc2lvbikpLG51bGwhPWUuZG9tYWluJiYodC5kb21haW49U3RyaW5nKGUuZG9tYWluKSksbnVsbCE9ZS5tb2RlbFZlcnNpb24mJihsLkxvbmc/KHQubW9kZWxWZXJzaW9uPWwuTG9uZy5mcm9tVmFsdWUoZS5tb2RlbFZlcnNpb24pKS51bnNpZ25lZD0hMToic3RyaW5nIj09dHlwZW9mIGUubW9kZWxWZXJzaW9uP3QubW9kZWxWZXJzaW9uPXBhcnNlSW50KGUubW9kZWxWZXJzaW9uLDEwKToibnVtYmVyIj09dHlwZW9mIGUubW9kZWxWZXJzaW9uP3QubW9kZWxWZXJzaW9uPWUubW9kZWxWZXJzaW9uOiJvYmplY3QiPT10eXBlb2YgZS5tb2RlbFZlcnNpb24mJih0Lm1vZGVsVmVyc2lvbj1uZXcgbC5Mb25nQml0cyhlLm1vZGVsVmVyc2lvbi5sb3c+Pj4wLGUubW9kZWxWZXJzaW9uLmhpZ2g+Pj4wKS50b051bWJlcigpKSksbnVsbCE9ZS5kb2NTdHJpbmcmJih0LmRvY1N0cmluZz1TdHJpbmcoZS5kb2NTdHJpbmcpKSxudWxsIT1lLmdyYXBoKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuZ3JhcGgpdGhyb3cgVHlwZUVycm9yKCIub25ueC5Nb2RlbFByb3RvLmdyYXBoOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmdyYXBoPWMub25ueC5HcmFwaFByb3RvLmZyb21PYmplY3QoZS5ncmFwaCk7fWlmKGUubWV0YWRhdGFQcm9wcyl7aWYoIUFycmF5LmlzQXJyYXkoZS5tZXRhZGF0YVByb3BzKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk1vZGVsUHJvdG8ubWV0YWRhdGFQcm9wczogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5tZXRhZGF0YVByb3BzPVtdLG49MDtuPGUubWV0YWRhdGFQcm9wcy5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUubWV0YWRhdGFQcm9wc1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk1vZGVsUHJvdG8ubWV0YWRhdGFQcm9wczogb2JqZWN0IGV4cGVjdGVkIik7dC5tZXRhZGF0YVByb3BzW25dPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLmZyb21PYmplY3QoZS5tZXRhZGF0YVByb3BzW25dKTt9fWlmKGUudHJhaW5pbmdJbmZvKXtpZighQXJyYXkuaXNBcnJheShlLnRyYWluaW5nSW5mbykpdGhyb3cgVHlwZUVycm9yKCIub25ueC5Nb2RlbFByb3RvLnRyYWluaW5nSW5mbzogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC50cmFpbmluZ0luZm89W10sbj0wO248ZS50cmFpbmluZ0luZm8ubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnRyYWluaW5nSW5mb1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54Lk1vZGVsUHJvdG8udHJhaW5pbmdJbmZvOiBvYmplY3QgZXhwZWN0ZWQiKTt0LnRyYWluaW5nSW5mb1tuXT1jLm9ubnguVHJhaW5pbmdJbmZvUHJvdG8uZnJvbU9iamVjdChlLnRyYWluaW5nSW5mb1tuXSk7fX1pZihlLmZ1bmN0aW9ucyl7aWYoIUFycmF5LmlzQXJyYXkoZS5mdW5jdGlvbnMpKXRocm93IFR5cGVFcnJvcigiLm9ubnguTW9kZWxQcm90by5mdW5jdGlvbnM6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuZnVuY3Rpb25zPVtdLG49MDtuPGUuZnVuY3Rpb25zLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5mdW5jdGlvbnNbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5Nb2RlbFByb3RvLmZ1bmN0aW9uczogb2JqZWN0IGV4cGVjdGVkIik7dC5mdW5jdGlvbnNbbl09Yy5vbm54LkZ1bmN0aW9uUHJvdG8uZnJvbU9iamVjdChlLmZ1bmN0aW9uc1tuXSk7fX1yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5vcHNldEltcG9ydD1bXSxuLm1ldGFkYXRhUHJvcHM9W10sbi50cmFpbmluZ0luZm89W10sbi5mdW5jdGlvbnM9W10pLHQuZGVmYXVsdHMpe2lmKGwuTG9uZyl7dmFyIHI9bmV3IGwuTG9uZygwLDAsITEpO24uaXJWZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/ci50b1N0cmluZygpOnQubG9uZ3M9PT1OdW1iZXI/ci50b051bWJlcigpOnI7fWVsc2Ugbi5pclZlcnNpb249dC5sb25ncz09PVN0cmluZz8iMCI6MDtuLnByb2R1Y2VyTmFtZT0iIixuLnByb2R1Y2VyVmVyc2lvbj0iIixuLmRvbWFpbj0iIixsLkxvbmc/KHI9bmV3IGwuTG9uZygwLDAsITEpLG4ubW9kZWxWZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/ci50b1N0cmluZygpOnQubG9uZ3M9PT1OdW1iZXI/ci50b051bWJlcigpOnIpOm4ubW9kZWxWZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/IjAiOjAsbi5kb2NTdHJpbmc9IiIsbi5ncmFwaD1udWxsO31pZihudWxsIT1lLmlyVmVyc2lvbiYmZS5oYXNPd25Qcm9wZXJ0eSgiaXJWZXJzaW9uIikmJigibnVtYmVyIj09dHlwZW9mIGUuaXJWZXJzaW9uP24uaXJWZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/U3RyaW5nKGUuaXJWZXJzaW9uKTplLmlyVmVyc2lvbjpuLmlyVmVyc2lvbj10LmxvbmdzPT09U3RyaW5nP2wuTG9uZy5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlLmlyVmVyc2lvbik6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLmlyVmVyc2lvbi5sb3c+Pj4wLGUuaXJWZXJzaW9uLmhpZ2g+Pj4wKS50b051bWJlcigpOmUuaXJWZXJzaW9uKSxudWxsIT1lLnByb2R1Y2VyTmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgicHJvZHVjZXJOYW1lIikmJihuLnByb2R1Y2VyTmFtZT1lLnByb2R1Y2VyTmFtZSksbnVsbCE9ZS5wcm9kdWNlclZlcnNpb24mJmUuaGFzT3duUHJvcGVydHkoInByb2R1Y2VyVmVyc2lvbiIpJiYobi5wcm9kdWNlclZlcnNpb249ZS5wcm9kdWNlclZlcnNpb24pLG51bGwhPWUuZG9tYWluJiZlLmhhc093blByb3BlcnR5KCJkb21haW4iKSYmKG4uZG9tYWluPWUuZG9tYWluKSxudWxsIT1lLm1vZGVsVmVyc2lvbiYmZS5oYXNPd25Qcm9wZXJ0eSgibW9kZWxWZXJzaW9uIikmJigibnVtYmVyIj09dHlwZW9mIGUubW9kZWxWZXJzaW9uP24ubW9kZWxWZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/U3RyaW5nKGUubW9kZWxWZXJzaW9uKTplLm1vZGVsVmVyc2lvbjpuLm1vZGVsVmVyc2lvbj10LmxvbmdzPT09U3RyaW5nP2wuTG9uZy5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlLm1vZGVsVmVyc2lvbik6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLm1vZGVsVmVyc2lvbi5sb3c+Pj4wLGUubW9kZWxWZXJzaW9uLmhpZ2g+Pj4wKS50b051bWJlcigpOmUubW9kZWxWZXJzaW9uKSxudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJihuLmRvY1N0cmluZz1lLmRvY1N0cmluZyksbnVsbCE9ZS5ncmFwaCYmZS5oYXNPd25Qcm9wZXJ0eSgiZ3JhcGgiKSYmKG4uZ3JhcGg9Yy5vbm54LkdyYXBoUHJvdG8udG9PYmplY3QoZS5ncmFwaCx0KSksZS5vcHNldEltcG9ydCYmZS5vcHNldEltcG9ydC5sZW5ndGgpe24ub3BzZXRJbXBvcnQ9W107Zm9yKHZhciBvPTA7bzxlLm9wc2V0SW1wb3J0Lmxlbmd0aDsrK28pbi5vcHNldEltcG9ydFtvXT1jLm9ubnguT3BlcmF0b3JTZXRJZFByb3RvLnRvT2JqZWN0KGUub3BzZXRJbXBvcnRbb10sdCk7fWlmKGUubWV0YWRhdGFQcm9wcyYmZS5tZXRhZGF0YVByb3BzLmxlbmd0aClmb3Iobi5tZXRhZGF0YVByb3BzPVtdLG89MDtvPGUubWV0YWRhdGFQcm9wcy5sZW5ndGg7KytvKW4ubWV0YWRhdGFQcm9wc1tvXT1jLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by50b09iamVjdChlLm1ldGFkYXRhUHJvcHNbb10sdCk7aWYoZS50cmFpbmluZ0luZm8mJmUudHJhaW5pbmdJbmZvLmxlbmd0aClmb3Iobi50cmFpbmluZ0luZm89W10sbz0wO288ZS50cmFpbmluZ0luZm8ubGVuZ3RoOysrbyluLnRyYWluaW5nSW5mb1tvXT1jLm9ubnguVHJhaW5pbmdJbmZvUHJvdG8udG9PYmplY3QoZS50cmFpbmluZ0luZm9bb10sdCk7aWYoZS5mdW5jdGlvbnMmJmUuZnVuY3Rpb25zLmxlbmd0aClmb3Iobi5mdW5jdGlvbnM9W10sbz0wO288ZS5mdW5jdGlvbnMubGVuZ3RoOysrbyluLmZ1bmN0aW9uc1tvXT1jLm9ubnguRnVuY3Rpb25Qcm90by50b09iamVjdChlLmZ1bmN0aW9uc1tvXSx0KTtyZXR1cm4gbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5Nb2RlbFByb3RvIn0sZX0oKSxpLlN0cmluZ1N0cmluZ0VudHJ5UHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmtleT0iIixlLnByb3RvdHlwZS52YWx1ZT0iIixlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUua2V5JiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJrZXkiKSYmdC51aW50MzIoMTApLnN0cmluZyhlLmtleSksbnVsbCE9ZS52YWx1ZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwidmFsdWUiKSYmdC51aW50MzIoMTgpLnN0cmluZyhlLnZhbHVlKSx0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90bztlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTpyLmtleT1lLnN0cmluZygpO2JyZWFrO2Nhc2UgMjpyLnZhbHVlPWUuc3RyaW5nKCk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7cmV0dXJuICJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWU/Im9iamVjdCBleHBlY3RlZCI6bnVsbCE9ZS5rZXkmJmUuaGFzT3duUHJvcGVydHkoImtleSIpJiYhbC5pc1N0cmluZyhlLmtleSk/ImtleTogc3RyaW5nIGV4cGVjdGVkIjpudWxsIT1lLnZhbHVlJiZlLmhhc093blByb3BlcnR5KCJ2YWx1ZSIpJiYhbC5pc1N0cmluZyhlLnZhbHVlKT8idmFsdWU6IHN0cmluZyBleHBlY3RlZCI6bnVsbH0sZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBjLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG87cmV0dXJuIG51bGwhPWUua2V5JiYodC5rZXk9U3RyaW5nKGUua2V5KSksbnVsbCE9ZS52YWx1ZSYmKHQudmFsdWU9U3RyaW5nKGUudmFsdWUpKSx0fSxlLnRvT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dHx8KHQ9e30pO3ZhciBuPXt9O3JldHVybiB0LmRlZmF1bHRzJiYobi5rZXk9IiIsbi52YWx1ZT0iIiksbnVsbCE9ZS5rZXkmJmUuaGFzT3duUHJvcGVydHkoImtleSIpJiYobi5rZXk9ZS5rZXkpLG51bGwhPWUudmFsdWUmJmUuaGFzT3duUHJvcGVydHkoInZhbHVlIikmJihuLnZhbHVlPWUudmFsdWUpLG59LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnRvT2JqZWN0KHRoaXMscy51dGlsLnRvSlNPTk9wdGlvbnMpfSxlLmdldFR5cGVVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSJ0eXBlLmdvb2dsZWFwaXMuY29tIiksZSsiL29ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90byJ9LGV9KCksaS5UZW5zb3JBbm5vdGF0aW9uPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZih0aGlzLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXM9W10sZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUudGVuc29yTmFtZT0iIixlLnByb3RvdHlwZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzPWwuZW1wdHlBcnJheSxlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7aWYodHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS50ZW5zb3JOYW1lJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJ0ZW5zb3JOYW1lIikmJnQudWludDMyKDEwKS5zdHJpbmcoZS50ZW5zb3JOYW1lKSxudWxsIT1lLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMmJmUucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lcy5sZW5ndGgpZm9yKHZhciBuPTA7bjxlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMubGVuZ3RoOysrbiljLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by5lbmNvZGUoZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzW25dLHQudWludDMyKDE4KS5mb3JrKCkpLmxkZWxpbSgpO3JldHVybiB0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguVGVuc29yQW5ub3RhdGlvbjtlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTpyLnRlbnNvck5hbWU9ZS5zdHJpbmcoKTticmVhaztjYXNlIDI6ci5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzJiZyLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMubGVuZ3RofHwoci5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzPVtdKSxyLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMucHVzaChjLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gIm9iamVjdCBleHBlY3RlZCI7aWYobnVsbCE9ZS50ZW5zb3JOYW1lJiZlLmhhc093blByb3BlcnR5KCJ0ZW5zb3JOYW1lIikmJiFsLmlzU3RyaW5nKGUudGVuc29yTmFtZSkpcmV0dXJuICJ0ZW5zb3JOYW1lOiBzdHJpbmcgZXhwZWN0ZWQiO2lmKG51bGwhPWUucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lcyYmZS5oYXNPd25Qcm9wZXJ0eSgicXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lcyIpKXtpZighQXJyYXkuaXNBcnJheShlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMpKXJldHVybiAicXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lczogYXJyYXkgZXhwZWN0ZWQiO2Zvcih2YXIgdD0wO3Q8ZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzLmxlbmd0aDsrK3Qpe3ZhciBuPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLnZlcmlmeShlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXNbdF0pO2lmKG4pcmV0dXJuICJxdWFudFBhcmFtZXRlclRlbnNvck5hbWVzLiIrbn19cmV0dXJuIG51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlRlbnNvckFubm90YXRpb24pcmV0dXJuIGU7dmFyIHQ9bmV3IGMub25ueC5UZW5zb3JBbm5vdGF0aW9uO2lmKG51bGwhPWUudGVuc29yTmFtZSYmKHQudGVuc29yTmFtZT1TdHJpbmcoZS50ZW5zb3JOYW1lKSksZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzKXtpZighQXJyYXkuaXNBcnJheShlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMpKXRocm93IFR5cGVFcnJvcigiLm9ubnguVGVuc29yQW5ub3RhdGlvbi5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzOiBhcnJheSBleHBlY3RlZCIpO3QucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lcz1bXTtmb3IodmFyIG49MDtuPGUucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lcy5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lc1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvckFubm90YXRpb24ucXVhbnRQYXJhbWV0ZXJUZW5zb3JOYW1lczogb2JqZWN0IGV4cGVjdGVkIik7dC5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzW25dPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLmZyb21PYmplY3QoZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzW25dKTt9fXJldHVybiB0fSxlLnRvT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dHx8KHQ9e30pO3ZhciBuPXt9O2lmKCh0LmFycmF5c3x8dC5kZWZhdWx0cykmJihuLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXM9W10pLHQuZGVmYXVsdHMmJihuLnRlbnNvck5hbWU9IiIpLG51bGwhPWUudGVuc29yTmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgidGVuc29yTmFtZSIpJiYobi50ZW5zb3JOYW1lPWUudGVuc29yTmFtZSksZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzJiZlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMubGVuZ3RoKXtuLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXM9W107Zm9yKHZhciByPTA7cjxlLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXMubGVuZ3RoOysrciluLnF1YW50UGFyYW1ldGVyVGVuc29yTmFtZXNbcl09Yy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8udG9PYmplY3QoZS5xdWFudFBhcmFtZXRlclRlbnNvck5hbWVzW3JdLHQpO31yZXR1cm4gbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UZW5zb3JBbm5vdGF0aW9uIn0sZX0oKSxpLkdyYXBoUHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKHRoaXMubm9kZT1bXSx0aGlzLmluaXRpYWxpemVyPVtdLHRoaXMuc3BhcnNlSW5pdGlhbGl6ZXI9W10sdGhpcy5pbnB1dD1bXSx0aGlzLm91dHB1dD1bXSx0aGlzLnZhbHVlSW5mbz1bXSx0aGlzLnF1YW50aXphdGlvbkFubm90YXRpb249W10sZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUubm9kZT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUubmFtZT0iIixlLnByb3RvdHlwZS5pbml0aWFsaXplcj1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuc3BhcnNlSW5pdGlhbGl6ZXI9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLmRvY1N0cmluZz0iIixlLnByb3RvdHlwZS5pbnB1dD1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUub3V0cHV0PWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS52YWx1ZUluZm89bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLnF1YW50aXphdGlvbkFubm90YXRpb249bC5lbXB0eUFycmF5LGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtpZih0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLm5vZGUmJmUubm9kZS5sZW5ndGgpZm9yKHZhciBuPTA7bjxlLm5vZGUubGVuZ3RoOysrbiljLm9ubnguTm9kZVByb3RvLmVuY29kZShlLm5vZGVbbl0sdC51aW50MzIoMTApLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS5uYW1lJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJuYW1lIikmJnQudWludDMyKDE4KS5zdHJpbmcoZS5uYW1lKSxudWxsIT1lLmluaXRpYWxpemVyJiZlLmluaXRpYWxpemVyLmxlbmd0aClmb3Iobj0wO248ZS5pbml0aWFsaXplci5sZW5ndGg7KytuKWMub25ueC5UZW5zb3JQcm90by5lbmNvZGUoZS5pbml0aWFsaXplcltuXSx0LnVpbnQzMig0MikuZm9yaygpKS5sZGVsaW0oKTtpZihudWxsIT1lLmRvY1N0cmluZyYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZG9jU3RyaW5nIikmJnQudWludDMyKDgyKS5zdHJpbmcoZS5kb2NTdHJpbmcpLG51bGwhPWUuaW5wdXQmJmUuaW5wdXQubGVuZ3RoKWZvcihuPTA7bjxlLmlucHV0Lmxlbmd0aDsrK24pYy5vbm54LlZhbHVlSW5mb1Byb3RvLmVuY29kZShlLmlucHV0W25dLHQudWludDMyKDkwKS5mb3JrKCkpLmxkZWxpbSgpO2lmKG51bGwhPWUub3V0cHV0JiZlLm91dHB1dC5sZW5ndGgpZm9yKG49MDtuPGUub3V0cHV0Lmxlbmd0aDsrK24pYy5vbm54LlZhbHVlSW5mb1Byb3RvLmVuY29kZShlLm91dHB1dFtuXSx0LnVpbnQzMig5OCkuZm9yaygpKS5sZGVsaW0oKTtpZihudWxsIT1lLnZhbHVlSW5mbyYmZS52YWx1ZUluZm8ubGVuZ3RoKWZvcihuPTA7bjxlLnZhbHVlSW5mby5sZW5ndGg7KytuKWMub25ueC5WYWx1ZUluZm9Qcm90by5lbmNvZGUoZS52YWx1ZUluZm9bbl0sdC51aW50MzIoMTA2KS5mb3JrKCkpLmxkZWxpbSgpO2lmKG51bGwhPWUucXVhbnRpemF0aW9uQW5ub3RhdGlvbiYmZS5xdWFudGl6YXRpb25Bbm5vdGF0aW9uLmxlbmd0aClmb3Iobj0wO248ZS5xdWFudGl6YXRpb25Bbm5vdGF0aW9uLmxlbmd0aDsrK24pYy5vbm54LlRlbnNvckFubm90YXRpb24uZW5jb2RlKGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbltuXSx0LnVpbnQzMigxMTQpLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS5zcGFyc2VJbml0aWFsaXplciYmZS5zcGFyc2VJbml0aWFsaXplci5sZW5ndGgpZm9yKG49MDtuPGUuc3BhcnNlSW5pdGlhbGl6ZXIubGVuZ3RoOysrbiljLm9ubnguU3BhcnNlVGVuc29yUHJvdG8uZW5jb2RlKGUuc3BhcnNlSW5pdGlhbGl6ZXJbbl0sdC51aW50MzIoMTIyKS5mb3JrKCkpLmxkZWxpbSgpO3JldHVybiB0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguR3JhcGhQcm90bztlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTpyLm5vZGUmJnIubm9kZS5sZW5ndGh8fChyLm5vZGU9W10pLHIubm9kZS5wdXNoKGMub25ueC5Ob2RlUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMjpyLm5hbWU9ZS5zdHJpbmcoKTticmVhaztjYXNlIDU6ci5pbml0aWFsaXplciYmci5pbml0aWFsaXplci5sZW5ndGh8fChyLmluaXRpYWxpemVyPVtdKSxyLmluaXRpYWxpemVyLnB1c2goYy5vbm54LlRlbnNvclByb3RvLmRlY29kZShlLGUudWludDMyKCkpKTticmVhaztjYXNlIDE1OnIuc3BhcnNlSW5pdGlhbGl6ZXImJnIuc3BhcnNlSW5pdGlhbGl6ZXIubGVuZ3RofHwoci5zcGFyc2VJbml0aWFsaXplcj1bXSksci5zcGFyc2VJbml0aWFsaXplci5wdXNoKGMub25ueC5TcGFyc2VUZW5zb3JQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAxMDpyLmRvY1N0cmluZz1lLnN0cmluZygpO2JyZWFrO2Nhc2UgMTE6ci5pbnB1dCYmci5pbnB1dC5sZW5ndGh8fChyLmlucHV0PVtdKSxyLmlucHV0LnB1c2goYy5vbm54LlZhbHVlSW5mb1Byb3RvLmRlY29kZShlLGUudWludDMyKCkpKTticmVhaztjYXNlIDEyOnIub3V0cHV0JiZyLm91dHB1dC5sZW5ndGh8fChyLm91dHB1dD1bXSksci5vdXRwdXQucHVzaChjLm9ubnguVmFsdWVJbmZvUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMTM6ci52YWx1ZUluZm8mJnIudmFsdWVJbmZvLmxlbmd0aHx8KHIudmFsdWVJbmZvPVtdKSxyLnZhbHVlSW5mby5wdXNoKGMub25ueC5WYWx1ZUluZm9Qcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAxNDpyLnF1YW50aXphdGlvbkFubm90YXRpb24mJnIucXVhbnRpemF0aW9uQW5ub3RhdGlvbi5sZW5ndGh8fChyLnF1YW50aXphdGlvbkFubm90YXRpb249W10pLHIucXVhbnRpemF0aW9uQW5ub3RhdGlvbi5wdXNoKGMub25ueC5UZW5zb3JBbm5vdGF0aW9uLmRlY29kZShlLGUudWludDMyKCkpKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLm5vZGUmJmUuaGFzT3duUHJvcGVydHkoIm5vZGUiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5ub2RlKSlyZXR1cm4gIm5vZGU6IGFycmF5IGV4cGVjdGVkIjtmb3IodmFyIHQ9MDt0PGUubm9kZS5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54Lk5vZGVQcm90by52ZXJpZnkoZS5ub2RlW3RdKSlyZXR1cm4gIm5vZGUuIitufWlmKG51bGwhPWUubmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgibmFtZSIpJiYhbC5pc1N0cmluZyhlLm5hbWUpKXJldHVybiAibmFtZTogc3RyaW5nIGV4cGVjdGVkIjtpZihudWxsIT1lLmluaXRpYWxpemVyJiZlLmhhc093blByb3BlcnR5KCJpbml0aWFsaXplciIpKXtpZighQXJyYXkuaXNBcnJheShlLmluaXRpYWxpemVyKSlyZXR1cm4gImluaXRpYWxpemVyOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuaW5pdGlhbGl6ZXIubGVuZ3RoOysrdClpZihuPWMub25ueC5UZW5zb3JQcm90by52ZXJpZnkoZS5pbml0aWFsaXplclt0XSkpcmV0dXJuICJpbml0aWFsaXplci4iK259aWYobnVsbCE9ZS5zcGFyc2VJbml0aWFsaXplciYmZS5oYXNPd25Qcm9wZXJ0eSgic3BhcnNlSW5pdGlhbGl6ZXIiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5zcGFyc2VJbml0aWFsaXplcikpcmV0dXJuICJzcGFyc2VJbml0aWFsaXplcjogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLnNwYXJzZUluaXRpYWxpemVyLmxlbmd0aDsrK3QpaWYobj1jLm9ubnguU3BhcnNlVGVuc29yUHJvdG8udmVyaWZ5KGUuc3BhcnNlSW5pdGlhbGl6ZXJbdF0pKXJldHVybiAic3BhcnNlSW5pdGlhbGl6ZXIuIitufWlmKG51bGwhPWUuZG9jU3RyaW5nJiZlLmhhc093blByb3BlcnR5KCJkb2NTdHJpbmciKSYmIWwuaXNTdHJpbmcoZS5kb2NTdHJpbmcpKXJldHVybiAiZG9jU3RyaW5nOiBzdHJpbmcgZXhwZWN0ZWQiO2lmKG51bGwhPWUuaW5wdXQmJmUuaGFzT3duUHJvcGVydHkoImlucHV0Iikpe2lmKCFBcnJheS5pc0FycmF5KGUuaW5wdXQpKXJldHVybiAiaW5wdXQ6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5pbnB1dC5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54LlZhbHVlSW5mb1Byb3RvLnZlcmlmeShlLmlucHV0W3RdKSlyZXR1cm4gImlucHV0LiIrbn1pZihudWxsIT1lLm91dHB1dCYmZS5oYXNPd25Qcm9wZXJ0eSgib3V0cHV0Iikpe2lmKCFBcnJheS5pc0FycmF5KGUub3V0cHV0KSlyZXR1cm4gIm91dHB1dDogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLm91dHB1dC5sZW5ndGg7Kyt0KWlmKG49Yy5vbm54LlZhbHVlSW5mb1Byb3RvLnZlcmlmeShlLm91dHB1dFt0XSkpcmV0dXJuICJvdXRwdXQuIitufWlmKG51bGwhPWUudmFsdWVJbmZvJiZlLmhhc093blByb3BlcnR5KCJ2YWx1ZUluZm8iKSl7aWYoIUFycmF5LmlzQXJyYXkoZS52YWx1ZUluZm8pKXJldHVybiAidmFsdWVJbmZvOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUudmFsdWVJbmZvLmxlbmd0aDsrK3QpaWYobj1jLm9ubnguVmFsdWVJbmZvUHJvdG8udmVyaWZ5KGUudmFsdWVJbmZvW3RdKSlyZXR1cm4gInZhbHVlSW5mby4iK259aWYobnVsbCE9ZS5xdWFudGl6YXRpb25Bbm5vdGF0aW9uJiZlLmhhc093blByb3BlcnR5KCJxdWFudGl6YXRpb25Bbm5vdGF0aW9uIikpe2lmKCFBcnJheS5pc0FycmF5KGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbikpcmV0dXJuICJxdWFudGl6YXRpb25Bbm5vdGF0aW9uOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbi5sZW5ndGg7Kyt0KXt2YXIgbjtpZihuPWMub25ueC5UZW5zb3JBbm5vdGF0aW9uLnZlcmlmeShlLnF1YW50aXphdGlvbkFubm90YXRpb25bdF0pKXJldHVybiAicXVhbnRpemF0aW9uQW5ub3RhdGlvbi4iK259fXJldHVybiBudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5HcmFwaFByb3RvKXJldHVybiBlO3ZhciB0PW5ldyBjLm9ubnguR3JhcGhQcm90bztpZihlLm5vZGUpe2lmKCFBcnJheS5pc0FycmF5KGUubm9kZSkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLm5vZGU6IGFycmF5IGV4cGVjdGVkIik7dC5ub2RlPVtdO2Zvcih2YXIgbj0wO248ZS5ub2RlLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5ub2RlW25dKXRocm93IFR5cGVFcnJvcigiLm9ubnguR3JhcGhQcm90by5ub2RlOiBvYmplY3QgZXhwZWN0ZWQiKTt0Lm5vZGVbbl09Yy5vbm54Lk5vZGVQcm90by5mcm9tT2JqZWN0KGUubm9kZVtuXSk7fX1pZihudWxsIT1lLm5hbWUmJih0Lm5hbWU9U3RyaW5nKGUubmFtZSkpLGUuaW5pdGlhbGl6ZXIpe2lmKCFBcnJheS5pc0FycmF5KGUuaW5pdGlhbGl6ZXIpKXRocm93IFR5cGVFcnJvcigiLm9ubnguR3JhcGhQcm90by5pbml0aWFsaXplcjogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5pbml0aWFsaXplcj1bXSxuPTA7bjxlLmluaXRpYWxpemVyLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5pbml0aWFsaXplcltuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkdyYXBoUHJvdG8uaW5pdGlhbGl6ZXI6IG9iamVjdCBleHBlY3RlZCIpO3QuaW5pdGlhbGl6ZXJbbl09Yy5vbm54LlRlbnNvclByb3RvLmZyb21PYmplY3QoZS5pbml0aWFsaXplcltuXSk7fX1pZihlLnNwYXJzZUluaXRpYWxpemVyKXtpZighQXJyYXkuaXNBcnJheShlLnNwYXJzZUluaXRpYWxpemVyKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkdyYXBoUHJvdG8uc3BhcnNlSW5pdGlhbGl6ZXI6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuc3BhcnNlSW5pdGlhbGl6ZXI9W10sbj0wO248ZS5zcGFyc2VJbml0aWFsaXplci5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuc3BhcnNlSW5pdGlhbGl6ZXJbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLnNwYXJzZUluaXRpYWxpemVyOiBvYmplY3QgZXhwZWN0ZWQiKTt0LnNwYXJzZUluaXRpYWxpemVyW25dPWMub25ueC5TcGFyc2VUZW5zb3JQcm90by5mcm9tT2JqZWN0KGUuc3BhcnNlSW5pdGlhbGl6ZXJbbl0pO319aWYobnVsbCE9ZS5kb2NTdHJpbmcmJih0LmRvY1N0cmluZz1TdHJpbmcoZS5kb2NTdHJpbmcpKSxlLmlucHV0KXtpZighQXJyYXkuaXNBcnJheShlLmlucHV0KSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkdyYXBoUHJvdG8uaW5wdXQ6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuaW5wdXQ9W10sbj0wO248ZS5pbnB1dC5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuaW5wdXRbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLmlucHV0OiBvYmplY3QgZXhwZWN0ZWQiKTt0LmlucHV0W25dPWMub25ueC5WYWx1ZUluZm9Qcm90by5mcm9tT2JqZWN0KGUuaW5wdXRbbl0pO319aWYoZS5vdXRwdXQpe2lmKCFBcnJheS5pc0FycmF5KGUub3V0cHV0KSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkdyYXBoUHJvdG8ub3V0cHV0OiBhcnJheSBleHBlY3RlZCIpO2Zvcih0Lm91dHB1dD1bXSxuPTA7bjxlLm91dHB1dC5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUub3V0cHV0W25dKXRocm93IFR5cGVFcnJvcigiLm9ubnguR3JhcGhQcm90by5vdXRwdXQ6IG9iamVjdCBleHBlY3RlZCIpO3Qub3V0cHV0W25dPWMub25ueC5WYWx1ZUluZm9Qcm90by5mcm9tT2JqZWN0KGUub3V0cHV0W25dKTt9fWlmKGUudmFsdWVJbmZvKXtpZighQXJyYXkuaXNBcnJheShlLnZhbHVlSW5mbykpdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLnZhbHVlSW5mbzogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC52YWx1ZUluZm89W10sbj0wO248ZS52YWx1ZUluZm8ubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnZhbHVlSW5mb1tuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkdyYXBoUHJvdG8udmFsdWVJbmZvOiBvYmplY3QgZXhwZWN0ZWQiKTt0LnZhbHVlSW5mb1tuXT1jLm9ubnguVmFsdWVJbmZvUHJvdG8uZnJvbU9iamVjdChlLnZhbHVlSW5mb1tuXSk7fX1pZihlLnF1YW50aXphdGlvbkFubm90YXRpb24pe2lmKCFBcnJheS5pc0FycmF5KGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbikpdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLnF1YW50aXphdGlvbkFubm90YXRpb246IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQucXVhbnRpemF0aW9uQW5ub3RhdGlvbj1bXSxuPTA7bjxlLnF1YW50aXphdGlvbkFubm90YXRpb24ubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnF1YW50aXphdGlvbkFubm90YXRpb25bbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5HcmFwaFByb3RvLnF1YW50aXphdGlvbkFubm90YXRpb246IG9iamVjdCBleHBlY3RlZCIpO3QucXVhbnRpemF0aW9uQW5ub3RhdGlvbltuXT1jLm9ubnguVGVuc29yQW5ub3RhdGlvbi5mcm9tT2JqZWN0KGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbltuXSk7fX1yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5ub2RlPVtdLG4uaW5pdGlhbGl6ZXI9W10sbi5pbnB1dD1bXSxuLm91dHB1dD1bXSxuLnZhbHVlSW5mbz1bXSxuLnF1YW50aXphdGlvbkFubm90YXRpb249W10sbi5zcGFyc2VJbml0aWFsaXplcj1bXSksdC5kZWZhdWx0cyYmKG4ubmFtZT0iIixuLmRvY1N0cmluZz0iIiksZS5ub2RlJiZlLm5vZGUubGVuZ3RoKXtuLm5vZGU9W107Zm9yKHZhciByPTA7cjxlLm5vZGUubGVuZ3RoOysrciluLm5vZGVbcl09Yy5vbm54Lk5vZGVQcm90by50b09iamVjdChlLm5vZGVbcl0sdCk7fWlmKG51bGwhPWUubmFtZSYmZS5oYXNPd25Qcm9wZXJ0eSgibmFtZSIpJiYobi5uYW1lPWUubmFtZSksZS5pbml0aWFsaXplciYmZS5pbml0aWFsaXplci5sZW5ndGgpZm9yKG4uaW5pdGlhbGl6ZXI9W10scj0wO3I8ZS5pbml0aWFsaXplci5sZW5ndGg7KytyKW4uaW5pdGlhbGl6ZXJbcl09Yy5vbm54LlRlbnNvclByb3RvLnRvT2JqZWN0KGUuaW5pdGlhbGl6ZXJbcl0sdCk7aWYobnVsbCE9ZS5kb2NTdHJpbmcmJmUuaGFzT3duUHJvcGVydHkoImRvY1N0cmluZyIpJiYobi5kb2NTdHJpbmc9ZS5kb2NTdHJpbmcpLGUuaW5wdXQmJmUuaW5wdXQubGVuZ3RoKWZvcihuLmlucHV0PVtdLHI9MDtyPGUuaW5wdXQubGVuZ3RoOysrciluLmlucHV0W3JdPWMub25ueC5WYWx1ZUluZm9Qcm90by50b09iamVjdChlLmlucHV0W3JdLHQpO2lmKGUub3V0cHV0JiZlLm91dHB1dC5sZW5ndGgpZm9yKG4ub3V0cHV0PVtdLHI9MDtyPGUub3V0cHV0Lmxlbmd0aDsrK3Ipbi5vdXRwdXRbcl09Yy5vbm54LlZhbHVlSW5mb1Byb3RvLnRvT2JqZWN0KGUub3V0cHV0W3JdLHQpO2lmKGUudmFsdWVJbmZvJiZlLnZhbHVlSW5mby5sZW5ndGgpZm9yKG4udmFsdWVJbmZvPVtdLHI9MDtyPGUudmFsdWVJbmZvLmxlbmd0aDsrK3Ipbi52YWx1ZUluZm9bcl09Yy5vbm54LlZhbHVlSW5mb1Byb3RvLnRvT2JqZWN0KGUudmFsdWVJbmZvW3JdLHQpO2lmKGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbiYmZS5xdWFudGl6YXRpb25Bbm5vdGF0aW9uLmxlbmd0aClmb3Iobi5xdWFudGl6YXRpb25Bbm5vdGF0aW9uPVtdLHI9MDtyPGUucXVhbnRpemF0aW9uQW5ub3RhdGlvbi5sZW5ndGg7KytyKW4ucXVhbnRpemF0aW9uQW5ub3RhdGlvbltyXT1jLm9ubnguVGVuc29yQW5ub3RhdGlvbi50b09iamVjdChlLnF1YW50aXphdGlvbkFubm90YXRpb25bcl0sdCk7aWYoZS5zcGFyc2VJbml0aWFsaXplciYmZS5zcGFyc2VJbml0aWFsaXplci5sZW5ndGgpZm9yKG4uc3BhcnNlSW5pdGlhbGl6ZXI9W10scj0wO3I8ZS5zcGFyc2VJbml0aWFsaXplci5sZW5ndGg7KytyKW4uc3BhcnNlSW5pdGlhbGl6ZXJbcl09Yy5vbm54LlNwYXJzZVRlbnNvclByb3RvLnRvT2JqZWN0KGUuc3BhcnNlSW5pdGlhbGl6ZXJbcl0sdCk7cmV0dXJuIG59LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnRvT2JqZWN0KHRoaXMscy51dGlsLnRvSlNPTk9wdGlvbnMpfSxlLmdldFR5cGVVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSJ0eXBlLmdvb2dsZWFwaXMuY29tIiksZSsiL29ubnguR3JhcGhQcm90byJ9LGV9KCksaS5UZW5zb3JQcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodGhpcy5kaW1zPVtdLHRoaXMuZmxvYXREYXRhPVtdLHRoaXMuaW50MzJEYXRhPVtdLHRoaXMuc3RyaW5nRGF0YT1bXSx0aGlzLmludDY0RGF0YT1bXSx0aGlzLmV4dGVybmFsRGF0YT1bXSx0aGlzLmRvdWJsZURhdGE9W10sdGhpcy51aW50NjREYXRhPVtdLGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmRpbXM9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLmRhdGFUeXBlPTAsZS5wcm90b3R5cGUuc2VnbWVudD1udWxsLGUucHJvdG90eXBlLmZsb2F0RGF0YT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuaW50MzJEYXRhPWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5zdHJpbmdEYXRhPWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5pbnQ2NERhdGE9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLm5hbWU9IiIsZS5wcm90b3R5cGUuZG9jU3RyaW5nPSIiLGUucHJvdG90eXBlLnJhd0RhdGE9bC5uZXdCdWZmZXIoW10pLGUucHJvdG90eXBlLmV4dGVybmFsRGF0YT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuZGF0YUxvY2F0aW9uPTAsZS5wcm90b3R5cGUuZG91YmxlRGF0YT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUudWludDY0RGF0YT1sLmVtcHR5QXJyYXksZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe2lmKHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUuZGltcyYmZS5kaW1zLmxlbmd0aCl7dC51aW50MzIoMTApLmZvcmsoKTtmb3IodmFyIG49MDtuPGUuZGltcy5sZW5ndGg7KytuKXQuaW50NjQoZS5kaW1zW25dKTt0LmxkZWxpbSgpO31pZihudWxsIT1lLmRhdGFUeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkYXRhVHlwZSIpJiZ0LnVpbnQzMigxNikuaW50MzIoZS5kYXRhVHlwZSksbnVsbCE9ZS5zZWdtZW50JiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJzZWdtZW50IikmJmMub25ueC5UZW5zb3JQcm90by5TZWdtZW50LmVuY29kZShlLnNlZ21lbnQsdC51aW50MzIoMjYpLmZvcmsoKSkubGRlbGltKCksbnVsbCE9ZS5mbG9hdERhdGEmJmUuZmxvYXREYXRhLmxlbmd0aCl7Zm9yKHQudWludDMyKDM0KS5mb3JrKCksbj0wO248ZS5mbG9hdERhdGEubGVuZ3RoOysrbil0LmZsb2F0KGUuZmxvYXREYXRhW25dKTt0LmxkZWxpbSgpO31pZihudWxsIT1lLmludDMyRGF0YSYmZS5pbnQzMkRhdGEubGVuZ3RoKXtmb3IodC51aW50MzIoNDIpLmZvcmsoKSxuPTA7bjxlLmludDMyRGF0YS5sZW5ndGg7KytuKXQuaW50MzIoZS5pbnQzMkRhdGFbbl0pO3QubGRlbGltKCk7fWlmKG51bGwhPWUuc3RyaW5nRGF0YSYmZS5zdHJpbmdEYXRhLmxlbmd0aClmb3Iobj0wO248ZS5zdHJpbmdEYXRhLmxlbmd0aDsrK24pdC51aW50MzIoNTApLmJ5dGVzKGUuc3RyaW5nRGF0YVtuXSk7aWYobnVsbCE9ZS5pbnQ2NERhdGEmJmUuaW50NjREYXRhLmxlbmd0aCl7Zm9yKHQudWludDMyKDU4KS5mb3JrKCksbj0wO248ZS5pbnQ2NERhdGEubGVuZ3RoOysrbil0LmludDY0KGUuaW50NjREYXRhW25dKTt0LmxkZWxpbSgpO31pZihudWxsIT1lLm5hbWUmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIm5hbWUiKSYmdC51aW50MzIoNjYpLnN0cmluZyhlLm5hbWUpLG51bGwhPWUucmF3RGF0YSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwicmF3RGF0YSIpJiZ0LnVpbnQzMig3NCkuYnl0ZXMoZS5yYXdEYXRhKSxudWxsIT1lLmRvdWJsZURhdGEmJmUuZG91YmxlRGF0YS5sZW5ndGgpe2Zvcih0LnVpbnQzMig4MikuZm9yaygpLG49MDtuPGUuZG91YmxlRGF0YS5sZW5ndGg7KytuKXQuZG91YmxlKGUuZG91YmxlRGF0YVtuXSk7dC5sZGVsaW0oKTt9aWYobnVsbCE9ZS51aW50NjREYXRhJiZlLnVpbnQ2NERhdGEubGVuZ3RoKXtmb3IodC51aW50MzIoOTApLmZvcmsoKSxuPTA7bjxlLnVpbnQ2NERhdGEubGVuZ3RoOysrbil0LnVpbnQ2NChlLnVpbnQ2NERhdGFbbl0pO3QubGRlbGltKCk7fWlmKG51bGwhPWUuZG9jU3RyaW5nJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkb2NTdHJpbmciKSYmdC51aW50MzIoOTgpLnN0cmluZyhlLmRvY1N0cmluZyksbnVsbCE9ZS5leHRlcm5hbERhdGEmJmUuZXh0ZXJuYWxEYXRhLmxlbmd0aClmb3Iobj0wO248ZS5leHRlcm5hbERhdGEubGVuZ3RoOysrbiljLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by5lbmNvZGUoZS5leHRlcm5hbERhdGFbbl0sdC51aW50MzIoMTA2KS5mb3JrKCkpLmxkZWxpbSgpO3JldHVybiBudWxsIT1lLmRhdGFMb2NhdGlvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZGF0YUxvY2F0aW9uIikmJnQudWludDMyKDExMikuaW50MzIoZS5kYXRhTG9jYXRpb24pLHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5UZW5zb3JQcm90bztlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTppZihyLmRpbXMmJnIuZGltcy5sZW5ndGh8fChyLmRpbXM9W10pLDI9PSg3Jm8pKWZvcih2YXIgaT1lLnVpbnQzMigpK2UucG9zO2UucG9zPGk7KXIuZGltcy5wdXNoKGUuaW50NjQoKSk7ZWxzZSByLmRpbXMucHVzaChlLmludDY0KCkpO2JyZWFrO2Nhc2UgMjpyLmRhdGFUeXBlPWUuaW50MzIoKTticmVhaztjYXNlIDM6ci5zZWdtZW50PWMub25ueC5UZW5zb3JQcm90by5TZWdtZW50LmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgNDppZihyLmZsb2F0RGF0YSYmci5mbG9hdERhdGEubGVuZ3RofHwoci5mbG9hdERhdGE9W10pLDI9PSg3Jm8pKWZvcihpPWUudWludDMyKCkrZS5wb3M7ZS5wb3M8aTspci5mbG9hdERhdGEucHVzaChlLmZsb2F0KCkpO2Vsc2Ugci5mbG9hdERhdGEucHVzaChlLmZsb2F0KCkpO2JyZWFrO2Nhc2UgNTppZihyLmludDMyRGF0YSYmci5pbnQzMkRhdGEubGVuZ3RofHwoci5pbnQzMkRhdGE9W10pLDI9PSg3Jm8pKWZvcihpPWUudWludDMyKCkrZS5wb3M7ZS5wb3M8aTspci5pbnQzMkRhdGEucHVzaChlLmludDMyKCkpO2Vsc2Ugci5pbnQzMkRhdGEucHVzaChlLmludDMyKCkpO2JyZWFrO2Nhc2UgNjpyLnN0cmluZ0RhdGEmJnIuc3RyaW5nRGF0YS5sZW5ndGh8fChyLnN0cmluZ0RhdGE9W10pLHIuc3RyaW5nRGF0YS5wdXNoKGUuYnl0ZXMoKSk7YnJlYWs7Y2FzZSA3OmlmKHIuaW50NjREYXRhJiZyLmludDY0RGF0YS5sZW5ndGh8fChyLmludDY0RGF0YT1bXSksMj09KDcmbykpZm9yKGk9ZS51aW50MzIoKStlLnBvcztlLnBvczxpOylyLmludDY0RGF0YS5wdXNoKGUuaW50NjQoKSk7ZWxzZSByLmludDY0RGF0YS5wdXNoKGUuaW50NjQoKSk7YnJlYWs7Y2FzZSA4OnIubmFtZT1lLnN0cmluZygpO2JyZWFrO2Nhc2UgMTI6ci5kb2NTdHJpbmc9ZS5zdHJpbmcoKTticmVhaztjYXNlIDk6ci5yYXdEYXRhPWUuYnl0ZXMoKTticmVhaztjYXNlIDEzOnIuZXh0ZXJuYWxEYXRhJiZyLmV4dGVybmFsRGF0YS5sZW5ndGh8fChyLmV4dGVybmFsRGF0YT1bXSksci5leHRlcm5hbERhdGEucHVzaChjLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSAxNDpyLmRhdGFMb2NhdGlvbj1lLmludDMyKCk7YnJlYWs7Y2FzZSAxMDppZihyLmRvdWJsZURhdGEmJnIuZG91YmxlRGF0YS5sZW5ndGh8fChyLmRvdWJsZURhdGE9W10pLDI9PSg3Jm8pKWZvcihpPWUudWludDMyKCkrZS5wb3M7ZS5wb3M8aTspci5kb3VibGVEYXRhLnB1c2goZS5kb3VibGUoKSk7ZWxzZSByLmRvdWJsZURhdGEucHVzaChlLmRvdWJsZSgpKTticmVhaztjYXNlIDExOmlmKHIudWludDY0RGF0YSYmci51aW50NjREYXRhLmxlbmd0aHx8KHIudWludDY0RGF0YT1bXSksMj09KDcmbykpZm9yKGk9ZS51aW50MzIoKStlLnBvcztlLnBvczxpOylyLnVpbnQ2NERhdGEucHVzaChlLnVpbnQ2NCgpKTtlbHNlIHIudWludDY0RGF0YS5wdXNoKGUudWludDY0KCkpO2JyZWFrO2RlZmF1bHQ6ZS5za2lwVHlwZSg3Jm8pO319cmV0dXJuIHJ9LGUuZGVjb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgYXx8KGU9bmV3IGEoZSkpLHRoaXMuZGVjb2RlKGUsZS51aW50MzIoKSl9LGUudmVyaWZ5PWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuICJvYmplY3QgZXhwZWN0ZWQiO2lmKG51bGwhPWUuZGltcyYmZS5oYXNPd25Qcm9wZXJ0eSgiZGltcyIpKXtpZighQXJyYXkuaXNBcnJheShlLmRpbXMpKXJldHVybiAiZGltczogYXJyYXkgZXhwZWN0ZWQiO2Zvcih2YXIgdD0wO3Q8ZS5kaW1zLmxlbmd0aDsrK3QpaWYoIShsLmlzSW50ZWdlcihlLmRpbXNbdF0pfHxlLmRpbXNbdF0mJmwuaXNJbnRlZ2VyKGUuZGltc1t0XS5sb3cpJiZsLmlzSW50ZWdlcihlLmRpbXNbdF0uaGlnaCkpKXJldHVybiAiZGltczogaW50ZWdlcnxMb25nW10gZXhwZWN0ZWQifWlmKG51bGwhPWUuZGF0YVR5cGUmJmUuaGFzT3duUHJvcGVydHkoImRhdGFUeXBlIikmJiFsLmlzSW50ZWdlcihlLmRhdGFUeXBlKSlyZXR1cm4gImRhdGFUeXBlOiBpbnRlZ2VyIGV4cGVjdGVkIjtpZihudWxsIT1lLnNlZ21lbnQmJmUuaGFzT3duUHJvcGVydHkoInNlZ21lbnQiKSYmKG49Yy5vbm54LlRlbnNvclByb3RvLlNlZ21lbnQudmVyaWZ5KGUuc2VnbWVudCkpKXJldHVybiAic2VnbWVudC4iK247aWYobnVsbCE9ZS5mbG9hdERhdGEmJmUuaGFzT3duUHJvcGVydHkoImZsb2F0RGF0YSIpKXtpZighQXJyYXkuaXNBcnJheShlLmZsb2F0RGF0YSkpcmV0dXJuICJmbG9hdERhdGE6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5mbG9hdERhdGEubGVuZ3RoOysrdClpZigibnVtYmVyIiE9dHlwZW9mIGUuZmxvYXREYXRhW3RdKXJldHVybiAiZmxvYXREYXRhOiBudW1iZXJbXSBleHBlY3RlZCJ9aWYobnVsbCE9ZS5pbnQzMkRhdGEmJmUuaGFzT3duUHJvcGVydHkoImludDMyRGF0YSIpKXtpZighQXJyYXkuaXNBcnJheShlLmludDMyRGF0YSkpcmV0dXJuICJpbnQzMkRhdGE6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS5pbnQzMkRhdGEubGVuZ3RoOysrdClpZighbC5pc0ludGVnZXIoZS5pbnQzMkRhdGFbdF0pKXJldHVybiAiaW50MzJEYXRhOiBpbnRlZ2VyW10gZXhwZWN0ZWQifWlmKG51bGwhPWUuc3RyaW5nRGF0YSYmZS5oYXNPd25Qcm9wZXJ0eSgic3RyaW5nRGF0YSIpKXtpZighQXJyYXkuaXNBcnJheShlLnN0cmluZ0RhdGEpKXJldHVybiAic3RyaW5nRGF0YTogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLnN0cmluZ0RhdGEubGVuZ3RoOysrdClpZighKGUuc3RyaW5nRGF0YVt0XSYmIm51bWJlciI9PXR5cGVvZiBlLnN0cmluZ0RhdGFbdF0ubGVuZ3RofHxsLmlzU3RyaW5nKGUuc3RyaW5nRGF0YVt0XSkpKXJldHVybiAic3RyaW5nRGF0YTogYnVmZmVyW10gZXhwZWN0ZWQifWlmKG51bGwhPWUuaW50NjREYXRhJiZlLmhhc093blByb3BlcnR5KCJpbnQ2NERhdGEiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5pbnQ2NERhdGEpKXJldHVybiAiaW50NjREYXRhOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuaW50NjREYXRhLmxlbmd0aDsrK3QpaWYoIShsLmlzSW50ZWdlcihlLmludDY0RGF0YVt0XSl8fGUuaW50NjREYXRhW3RdJiZsLmlzSW50ZWdlcihlLmludDY0RGF0YVt0XS5sb3cpJiZsLmlzSW50ZWdlcihlLmludDY0RGF0YVt0XS5oaWdoKSkpcmV0dXJuICJpbnQ2NERhdGE6IGludGVnZXJ8TG9uZ1tdIGV4cGVjdGVkIn1pZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmIWwuaXNTdHJpbmcoZS5uYW1lKSlyZXR1cm4gIm5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5kb2NTdHJpbmcmJmUuaGFzT3duUHJvcGVydHkoImRvY1N0cmluZyIpJiYhbC5pc1N0cmluZyhlLmRvY1N0cmluZykpcmV0dXJuICJkb2NTdHJpbmc6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5yYXdEYXRhJiZlLmhhc093blByb3BlcnR5KCJyYXdEYXRhIikmJiEoZS5yYXdEYXRhJiYibnVtYmVyIj09dHlwZW9mIGUucmF3RGF0YS5sZW5ndGh8fGwuaXNTdHJpbmcoZS5yYXdEYXRhKSkpcmV0dXJuICJyYXdEYXRhOiBidWZmZXIgZXhwZWN0ZWQiO2lmKG51bGwhPWUuZXh0ZXJuYWxEYXRhJiZlLmhhc093blByb3BlcnR5KCJleHRlcm5hbERhdGEiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5leHRlcm5hbERhdGEpKXJldHVybiAiZXh0ZXJuYWxEYXRhOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuZXh0ZXJuYWxEYXRhLmxlbmd0aDsrK3Qpe3ZhciBuO2lmKG49Yy5vbm54LlN0cmluZ1N0cmluZ0VudHJ5UHJvdG8udmVyaWZ5KGUuZXh0ZXJuYWxEYXRhW3RdKSlyZXR1cm4gImV4dGVybmFsRGF0YS4iK259fWlmKG51bGwhPWUuZGF0YUxvY2F0aW9uJiZlLmhhc093blByb3BlcnR5KCJkYXRhTG9jYXRpb24iKSlzd2l0Y2goZS5kYXRhTG9jYXRpb24pe2RlZmF1bHQ6cmV0dXJuICJkYXRhTG9jYXRpb246IGVudW0gdmFsdWUgZXhwZWN0ZWQiO2Nhc2UgMDpjYXNlIDE6fWlmKG51bGwhPWUuZG91YmxlRGF0YSYmZS5oYXNPd25Qcm9wZXJ0eSgiZG91YmxlRGF0YSIpKXtpZighQXJyYXkuaXNBcnJheShlLmRvdWJsZURhdGEpKXJldHVybiAiZG91YmxlRGF0YTogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLmRvdWJsZURhdGEubGVuZ3RoOysrdClpZigibnVtYmVyIiE9dHlwZW9mIGUuZG91YmxlRGF0YVt0XSlyZXR1cm4gImRvdWJsZURhdGE6IG51bWJlcltdIGV4cGVjdGVkIn1pZihudWxsIT1lLnVpbnQ2NERhdGEmJmUuaGFzT3duUHJvcGVydHkoInVpbnQ2NERhdGEiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS51aW50NjREYXRhKSlyZXR1cm4gInVpbnQ2NERhdGE6IGFycmF5IGV4cGVjdGVkIjtmb3IodD0wO3Q8ZS51aW50NjREYXRhLmxlbmd0aDsrK3QpaWYoIShsLmlzSW50ZWdlcihlLnVpbnQ2NERhdGFbdF0pfHxlLnVpbnQ2NERhdGFbdF0mJmwuaXNJbnRlZ2VyKGUudWludDY0RGF0YVt0XS5sb3cpJiZsLmlzSW50ZWdlcihlLnVpbnQ2NERhdGFbdF0uaGlnaCkpKXJldHVybiAidWludDY0RGF0YTogaW50ZWdlcnxMb25nW10gZXhwZWN0ZWQifXJldHVybiBudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5UZW5zb3JQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlRlbnNvclByb3RvO2lmKGUuZGltcyl7aWYoIUFycmF5LmlzQXJyYXkoZS5kaW1zKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLmRpbXM6IGFycmF5IGV4cGVjdGVkIik7dC5kaW1zPVtdO2Zvcih2YXIgbj0wO248ZS5kaW1zLmxlbmd0aDsrK24pbC5Mb25nPyh0LmRpbXNbbl09bC5Mb25nLmZyb21WYWx1ZShlLmRpbXNbbl0pKS51bnNpZ25lZD0hMToic3RyaW5nIj09dHlwZW9mIGUuZGltc1tuXT90LmRpbXNbbl09cGFyc2VJbnQoZS5kaW1zW25dLDEwKToibnVtYmVyIj09dHlwZW9mIGUuZGltc1tuXT90LmRpbXNbbl09ZS5kaW1zW25dOiJvYmplY3QiPT10eXBlb2YgZS5kaW1zW25dJiYodC5kaW1zW25dPW5ldyBsLkxvbmdCaXRzKGUuZGltc1tuXS5sb3c+Pj4wLGUuZGltc1tuXS5oaWdoPj4+MCkudG9OdW1iZXIoKSk7fWlmKG51bGwhPWUuZGF0YVR5cGUmJih0LmRhdGFUeXBlPTB8ZS5kYXRhVHlwZSksbnVsbCE9ZS5zZWdtZW50KXtpZigib2JqZWN0IiE9dHlwZW9mIGUuc2VnbWVudCl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLnNlZ21lbnQ6IG9iamVjdCBleHBlY3RlZCIpO3Quc2VnbWVudD1jLm9ubnguVGVuc29yUHJvdG8uU2VnbWVudC5mcm9tT2JqZWN0KGUuc2VnbWVudCk7fWlmKGUuZmxvYXREYXRhKXtpZighQXJyYXkuaXNBcnJheShlLmZsb2F0RGF0YSkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5UZW5zb3JQcm90by5mbG9hdERhdGE6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuZmxvYXREYXRhPVtdLG49MDtuPGUuZmxvYXREYXRhLmxlbmd0aDsrK24pdC5mbG9hdERhdGFbbl09TnVtYmVyKGUuZmxvYXREYXRhW25dKTt9aWYoZS5pbnQzMkRhdGEpe2lmKCFBcnJheS5pc0FycmF5KGUuaW50MzJEYXRhKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLmludDMyRGF0YTogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5pbnQzMkRhdGE9W10sbj0wO248ZS5pbnQzMkRhdGEubGVuZ3RoOysrbil0LmludDMyRGF0YVtuXT0wfGUuaW50MzJEYXRhW25dO31pZihlLnN0cmluZ0RhdGEpe2lmKCFBcnJheS5pc0FycmF5KGUuc3RyaW5nRGF0YSkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5UZW5zb3JQcm90by5zdHJpbmdEYXRhOiBhcnJheSBleHBlY3RlZCIpO2Zvcih0LnN0cmluZ0RhdGE9W10sbj0wO248ZS5zdHJpbmdEYXRhLmxlbmd0aDsrK24pInN0cmluZyI9PXR5cGVvZiBlLnN0cmluZ0RhdGFbbl0/bC5iYXNlNjQuZGVjb2RlKGUuc3RyaW5nRGF0YVtuXSx0LnN0cmluZ0RhdGFbbl09bC5uZXdCdWZmZXIobC5iYXNlNjQubGVuZ3RoKGUuc3RyaW5nRGF0YVtuXSkpLDApOmUuc3RyaW5nRGF0YVtuXS5sZW5ndGg+PTAmJih0LnN0cmluZ0RhdGFbbl09ZS5zdHJpbmdEYXRhW25dKTt9aWYoZS5pbnQ2NERhdGEpe2lmKCFBcnJheS5pc0FycmF5KGUuaW50NjREYXRhKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLmludDY0RGF0YTogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5pbnQ2NERhdGE9W10sbj0wO248ZS5pbnQ2NERhdGEubGVuZ3RoOysrbilsLkxvbmc/KHQuaW50NjREYXRhW25dPWwuTG9uZy5mcm9tVmFsdWUoZS5pbnQ2NERhdGFbbl0pKS51bnNpZ25lZD0hMToic3RyaW5nIj09dHlwZW9mIGUuaW50NjREYXRhW25dP3QuaW50NjREYXRhW25dPXBhcnNlSW50KGUuaW50NjREYXRhW25dLDEwKToibnVtYmVyIj09dHlwZW9mIGUuaW50NjREYXRhW25dP3QuaW50NjREYXRhW25dPWUuaW50NjREYXRhW25dOiJvYmplY3QiPT10eXBlb2YgZS5pbnQ2NERhdGFbbl0mJih0LmludDY0RGF0YVtuXT1uZXcgbC5Mb25nQml0cyhlLmludDY0RGF0YVtuXS5sb3c+Pj4wLGUuaW50NjREYXRhW25dLmhpZ2g+Pj4wKS50b051bWJlcigpKTt9aWYobnVsbCE9ZS5uYW1lJiYodC5uYW1lPVN0cmluZyhlLm5hbWUpKSxudWxsIT1lLmRvY1N0cmluZyYmKHQuZG9jU3RyaW5nPVN0cmluZyhlLmRvY1N0cmluZykpLG51bGwhPWUucmF3RGF0YSYmKCJzdHJpbmciPT10eXBlb2YgZS5yYXdEYXRhP2wuYmFzZTY0LmRlY29kZShlLnJhd0RhdGEsdC5yYXdEYXRhPWwubmV3QnVmZmVyKGwuYmFzZTY0Lmxlbmd0aChlLnJhd0RhdGEpKSwwKTplLnJhd0RhdGEubGVuZ3RoPj0wJiYodC5yYXdEYXRhPWUucmF3RGF0YSkpLGUuZXh0ZXJuYWxEYXRhKXtpZighQXJyYXkuaXNBcnJheShlLmV4dGVybmFsRGF0YSkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5UZW5zb3JQcm90by5leHRlcm5hbERhdGE6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuZXh0ZXJuYWxEYXRhPVtdLG49MDtuPGUuZXh0ZXJuYWxEYXRhLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5leHRlcm5hbERhdGFbbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5UZW5zb3JQcm90by5leHRlcm5hbERhdGE6IG9iamVjdCBleHBlY3RlZCIpO3QuZXh0ZXJuYWxEYXRhW25dPWMub25ueC5TdHJpbmdTdHJpbmdFbnRyeVByb3RvLmZyb21PYmplY3QoZS5leHRlcm5hbERhdGFbbl0pO319c3dpdGNoKGUuZGF0YUxvY2F0aW9uKXtkZWZhdWx0OmlmKCJudW1iZXIiPT10eXBlb2YgZS5kYXRhTG9jYXRpb24pe3QuZGF0YUxvY2F0aW9uPWUuZGF0YUxvY2F0aW9uO2JyZWFrfWJyZWFrO2Nhc2UiREVGQVVMVCI6Y2FzZSAwOnQuZGF0YUxvY2F0aW9uPTA7YnJlYWs7Y2FzZSJFWFRFUk5BTCI6Y2FzZSAxOnQuZGF0YUxvY2F0aW9uPTE7fWlmKGUuZG91YmxlRGF0YSl7aWYoIUFycmF5LmlzQXJyYXkoZS5kb3VibGVEYXRhKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLmRvdWJsZURhdGE6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuZG91YmxlRGF0YT1bXSxuPTA7bjxlLmRvdWJsZURhdGEubGVuZ3RoOysrbil0LmRvdWJsZURhdGFbbl09TnVtYmVyKGUuZG91YmxlRGF0YVtuXSk7fWlmKGUudWludDY0RGF0YSl7aWYoIUFycmF5LmlzQXJyYXkoZS51aW50NjREYXRhKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclByb3RvLnVpbnQ2NERhdGE6IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQudWludDY0RGF0YT1bXSxuPTA7bjxlLnVpbnQ2NERhdGEubGVuZ3RoOysrbilsLkxvbmc/KHQudWludDY0RGF0YVtuXT1sLkxvbmcuZnJvbVZhbHVlKGUudWludDY0RGF0YVtuXSkpLnVuc2lnbmVkPSEwOiJzdHJpbmciPT10eXBlb2YgZS51aW50NjREYXRhW25dP3QudWludDY0RGF0YVtuXT1wYXJzZUludChlLnVpbnQ2NERhdGFbbl0sMTApOiJudW1iZXIiPT10eXBlb2YgZS51aW50NjREYXRhW25dP3QudWludDY0RGF0YVtuXT1lLnVpbnQ2NERhdGFbbl06Im9iamVjdCI9PXR5cGVvZiBlLnVpbnQ2NERhdGFbbl0mJih0LnVpbnQ2NERhdGFbbl09bmV3IGwuTG9uZ0JpdHMoZS51aW50NjREYXRhW25dLmxvdz4+PjAsZS51aW50NjREYXRhW25dLmhpZ2g+Pj4wKS50b051bWJlcighMCkpO31yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5kaW1zPVtdLG4uZmxvYXREYXRhPVtdLG4uaW50MzJEYXRhPVtdLG4uc3RyaW5nRGF0YT1bXSxuLmludDY0RGF0YT1bXSxuLmRvdWJsZURhdGE9W10sbi51aW50NjREYXRhPVtdLG4uZXh0ZXJuYWxEYXRhPVtdKSx0LmRlZmF1bHRzJiYobi5kYXRhVHlwZT0wLG4uc2VnbWVudD1udWxsLG4ubmFtZT0iIix0LmJ5dGVzPT09U3RyaW5nP24ucmF3RGF0YT0iIjoobi5yYXdEYXRhPVtdLHQuYnl0ZXMhPT1BcnJheSYmKG4ucmF3RGF0YT1sLm5ld0J1ZmZlcihuLnJhd0RhdGEpKSksbi5kb2NTdHJpbmc9IiIsbi5kYXRhTG9jYXRpb249dC5lbnVtcz09PVN0cmluZz8iREVGQVVMVCI6MCksZS5kaW1zJiZlLmRpbXMubGVuZ3RoKXtuLmRpbXM9W107Zm9yKHZhciByPTA7cjxlLmRpbXMubGVuZ3RoOysrcikibnVtYmVyIj09dHlwZW9mIGUuZGltc1tyXT9uLmRpbXNbcl09dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS5kaW1zW3JdKTplLmRpbXNbcl06bi5kaW1zW3JdPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUuZGltc1tyXSk6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLmRpbXNbcl0ubG93Pj4+MCxlLmRpbXNbcl0uaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS5kaW1zW3JdO31pZihudWxsIT1lLmRhdGFUeXBlJiZlLmhhc093blByb3BlcnR5KCJkYXRhVHlwZSIpJiYobi5kYXRhVHlwZT1lLmRhdGFUeXBlKSxudWxsIT1lLnNlZ21lbnQmJmUuaGFzT3duUHJvcGVydHkoInNlZ21lbnQiKSYmKG4uc2VnbWVudD1jLm9ubnguVGVuc29yUHJvdG8uU2VnbWVudC50b09iamVjdChlLnNlZ21lbnQsdCkpLGUuZmxvYXREYXRhJiZlLmZsb2F0RGF0YS5sZW5ndGgpZm9yKG4uZmxvYXREYXRhPVtdLHI9MDtyPGUuZmxvYXREYXRhLmxlbmd0aDsrK3Ipbi5mbG9hdERhdGFbcl09dC5qc29uJiYhaXNGaW5pdGUoZS5mbG9hdERhdGFbcl0pP1N0cmluZyhlLmZsb2F0RGF0YVtyXSk6ZS5mbG9hdERhdGFbcl07aWYoZS5pbnQzMkRhdGEmJmUuaW50MzJEYXRhLmxlbmd0aClmb3Iobi5pbnQzMkRhdGE9W10scj0wO3I8ZS5pbnQzMkRhdGEubGVuZ3RoOysrciluLmludDMyRGF0YVtyXT1lLmludDMyRGF0YVtyXTtpZihlLnN0cmluZ0RhdGEmJmUuc3RyaW5nRGF0YS5sZW5ndGgpZm9yKG4uc3RyaW5nRGF0YT1bXSxyPTA7cjxlLnN0cmluZ0RhdGEubGVuZ3RoOysrciluLnN0cmluZ0RhdGFbcl09dC5ieXRlcz09PVN0cmluZz9sLmJhc2U2NC5lbmNvZGUoZS5zdHJpbmdEYXRhW3JdLDAsZS5zdHJpbmdEYXRhW3JdLmxlbmd0aCk6dC5ieXRlcz09PUFycmF5P0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGUuc3RyaW5nRGF0YVtyXSk6ZS5zdHJpbmdEYXRhW3JdO2lmKGUuaW50NjREYXRhJiZlLmludDY0RGF0YS5sZW5ndGgpZm9yKG4uaW50NjREYXRhPVtdLHI9MDtyPGUuaW50NjREYXRhLmxlbmd0aDsrK3IpIm51bWJlciI9PXR5cGVvZiBlLmludDY0RGF0YVtyXT9uLmludDY0RGF0YVtyXT10LmxvbmdzPT09U3RyaW5nP1N0cmluZyhlLmludDY0RGF0YVtyXSk6ZS5pbnQ2NERhdGFbcl06bi5pbnQ2NERhdGFbcl09dC5sb25ncz09PVN0cmluZz9sLkxvbmcucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZS5pbnQ2NERhdGFbcl0pOnQubG9uZ3M9PT1OdW1iZXI/bmV3IGwuTG9uZ0JpdHMoZS5pbnQ2NERhdGFbcl0ubG93Pj4+MCxlLmludDY0RGF0YVtyXS5oaWdoPj4+MCkudG9OdW1iZXIoKTplLmludDY0RGF0YVtyXTtpZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmKG4ubmFtZT1lLm5hbWUpLG51bGwhPWUucmF3RGF0YSYmZS5oYXNPd25Qcm9wZXJ0eSgicmF3RGF0YSIpJiYobi5yYXdEYXRhPXQuYnl0ZXM9PT1TdHJpbmc/bC5iYXNlNjQuZW5jb2RlKGUucmF3RGF0YSwwLGUucmF3RGF0YS5sZW5ndGgpOnQuYnl0ZXM9PT1BcnJheT9BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlLnJhd0RhdGEpOmUucmF3RGF0YSksZS5kb3VibGVEYXRhJiZlLmRvdWJsZURhdGEubGVuZ3RoKWZvcihuLmRvdWJsZURhdGE9W10scj0wO3I8ZS5kb3VibGVEYXRhLmxlbmd0aDsrK3Ipbi5kb3VibGVEYXRhW3JdPXQuanNvbiYmIWlzRmluaXRlKGUuZG91YmxlRGF0YVtyXSk/U3RyaW5nKGUuZG91YmxlRGF0YVtyXSk6ZS5kb3VibGVEYXRhW3JdO2lmKGUudWludDY0RGF0YSYmZS51aW50NjREYXRhLmxlbmd0aClmb3Iobi51aW50NjREYXRhPVtdLHI9MDtyPGUudWludDY0RGF0YS5sZW5ndGg7KytyKSJudW1iZXIiPT10eXBlb2YgZS51aW50NjREYXRhW3JdP24udWludDY0RGF0YVtyXT10LmxvbmdzPT09U3RyaW5nP1N0cmluZyhlLnVpbnQ2NERhdGFbcl0pOmUudWludDY0RGF0YVtyXTpuLnVpbnQ2NERhdGFbcl09dC5sb25ncz09PVN0cmluZz9sLkxvbmcucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZS51aW50NjREYXRhW3JdKTp0LmxvbmdzPT09TnVtYmVyP25ldyBsLkxvbmdCaXRzKGUudWludDY0RGF0YVtyXS5sb3c+Pj4wLGUudWludDY0RGF0YVtyXS5oaWdoPj4+MCkudG9OdW1iZXIoITApOmUudWludDY0RGF0YVtyXTtpZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJihuLmRvY1N0cmluZz1lLmRvY1N0cmluZyksZS5leHRlcm5hbERhdGEmJmUuZXh0ZXJuYWxEYXRhLmxlbmd0aClmb3Iobi5leHRlcm5hbERhdGE9W10scj0wO3I8ZS5leHRlcm5hbERhdGEubGVuZ3RoOysrciluLmV4dGVybmFsRGF0YVtyXT1jLm9ubnguU3RyaW5nU3RyaW5nRW50cnlQcm90by50b09iamVjdChlLmV4dGVybmFsRGF0YVtyXSx0KTtyZXR1cm4gbnVsbCE9ZS5kYXRhTG9jYXRpb24mJmUuaGFzT3duUHJvcGVydHkoImRhdGFMb2NhdGlvbiIpJiYobi5kYXRhTG9jYXRpb249dC5lbnVtcz09PVN0cmluZz92b2lkIDA9PT1jLm9ubnguVGVuc29yUHJvdG8uRGF0YUxvY2F0aW9uW2UuZGF0YUxvY2F0aW9uXT9lLmRhdGFMb2NhdGlvbjpjLm9ubnguVGVuc29yUHJvdG8uRGF0YUxvY2F0aW9uW2UuZGF0YUxvY2F0aW9uXTplLmRhdGFMb2NhdGlvbiksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UZW5zb3JQcm90byJ9LGUuRGF0YVR5cGU9ZnVuY3Rpb24oKXt2YXIgZT17fSx0PU9iamVjdC5jcmVhdGUoZSk7cmV0dXJuIHRbZVswXT0iVU5ERUZJTkVEIl09MCx0W2VbMV09IkZMT0FUIl09MSx0W2VbMl09IlVJTlQ4Il09Mix0W2VbM109IklOVDgiXT0zLHRbZVs0XT0iVUlOVDE2Il09NCx0W2VbNV09IklOVDE2Il09NSx0W2VbNl09IklOVDMyIl09Nix0W2VbN109IklOVDY0Il09Nyx0W2VbOF09IlNUUklORyJdPTgsdFtlWzldPSJCT09MIl09OSx0W2VbMTBdPSJGTE9BVDE2Il09MTAsdFtlWzExXT0iRE9VQkxFIl09MTEsdFtlWzEyXT0iVUlOVDMyIl09MTIsdFtlWzEzXT0iVUlOVDY0Il09MTMsdFtlWzE0XT0iQ09NUExFWDY0Il09MTQsdFtlWzE1XT0iQ09NUExFWDEyOCJdPTE1LHRbZVsxNl09IkJGTE9BVDE2Il09MTYsdFtlWzE3XT0iRkxPQVQ4RTRNM0ZOIl09MTcsdFtlWzE4XT0iRkxPQVQ4RTRNM0ZOVVoiXT0xOCx0W2VbMTldPSJGTE9BVDhFNU0yIl09MTksdFtlWzIwXT0iRkxPQVQ4RTVNMkZOVVoiXT0yMCx0fSgpLGUuU2VnbWVudD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUuYmVnaW49bC5Mb25nP2wuTG9uZy5mcm9tQml0cygwLDAsITEpOjAsZS5wcm90b3R5cGUuZW5kPWwuTG9uZz9sLkxvbmcuZnJvbUJpdHMoMCwwLCExKTowLGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS5iZWdpbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiYmVnaW4iKSYmdC51aW50MzIoOCkuaW50NjQoZS5iZWdpbiksbnVsbCE9ZS5lbmQmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImVuZCIpJiZ0LnVpbnQzMigxNikuaW50NjQoZS5lbmQpLHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5UZW5zb3JQcm90by5TZWdtZW50O2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIuYmVnaW49ZS5pbnQ2NCgpO2JyZWFrO2Nhc2UgMjpyLmVuZD1lLmludDY0KCk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7cmV0dXJuICJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWU/Im9iamVjdCBleHBlY3RlZCI6bnVsbCE9ZS5iZWdpbiYmZS5oYXNPd25Qcm9wZXJ0eSgiYmVnaW4iKSYmIShsLmlzSW50ZWdlcihlLmJlZ2luKXx8ZS5iZWdpbiYmbC5pc0ludGVnZXIoZS5iZWdpbi5sb3cpJiZsLmlzSW50ZWdlcihlLmJlZ2luLmhpZ2gpKT8iYmVnaW46IGludGVnZXJ8TG9uZyBleHBlY3RlZCI6bnVsbCE9ZS5lbmQmJmUuaGFzT3duUHJvcGVydHkoImVuZCIpJiYhKGwuaXNJbnRlZ2VyKGUuZW5kKXx8ZS5lbmQmJmwuaXNJbnRlZ2VyKGUuZW5kLmxvdykmJmwuaXNJbnRlZ2VyKGUuZW5kLmhpZ2gpKT8iZW5kOiBpbnRlZ2VyfExvbmcgZXhwZWN0ZWQiOm51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlRlbnNvclByb3RvLlNlZ21lbnQpcmV0dXJuIGU7dmFyIHQ9bmV3IGMub25ueC5UZW5zb3JQcm90by5TZWdtZW50O3JldHVybiBudWxsIT1lLmJlZ2luJiYobC5Mb25nPyh0LmJlZ2luPWwuTG9uZy5mcm9tVmFsdWUoZS5iZWdpbikpLnVuc2lnbmVkPSExOiJzdHJpbmciPT10eXBlb2YgZS5iZWdpbj90LmJlZ2luPXBhcnNlSW50KGUuYmVnaW4sMTApOiJudW1iZXIiPT10eXBlb2YgZS5iZWdpbj90LmJlZ2luPWUuYmVnaW46Im9iamVjdCI9PXR5cGVvZiBlLmJlZ2luJiYodC5iZWdpbj1uZXcgbC5Mb25nQml0cyhlLmJlZ2luLmxvdz4+PjAsZS5iZWdpbi5oaWdoPj4+MCkudG9OdW1iZXIoKSkpLG51bGwhPWUuZW5kJiYobC5Mb25nPyh0LmVuZD1sLkxvbmcuZnJvbVZhbHVlKGUuZW5kKSkudW5zaWduZWQ9ITE6InN0cmluZyI9PXR5cGVvZiBlLmVuZD90LmVuZD1wYXJzZUludChlLmVuZCwxMCk6Im51bWJlciI9PXR5cGVvZiBlLmVuZD90LmVuZD1lLmVuZDoib2JqZWN0Ij09dHlwZW9mIGUuZW5kJiYodC5lbmQ9bmV3IGwuTG9uZ0JpdHMoZS5lbmQubG93Pj4+MCxlLmVuZC5oaWdoPj4+MCkudG9OdW1iZXIoKSkpLHR9LGUudG9PYmplY3Q9ZnVuY3Rpb24oZSx0KXt0fHwodD17fSk7dmFyIG49e307aWYodC5kZWZhdWx0cyl7aWYobC5Mb25nKXt2YXIgcj1uZXcgbC5Mb25nKDAsMCwhMSk7bi5iZWdpbj10LmxvbmdzPT09U3RyaW5nP3IudG9TdHJpbmcoKTp0LmxvbmdzPT09TnVtYmVyP3IudG9OdW1iZXIoKTpyO31lbHNlIG4uYmVnaW49dC5sb25ncz09PVN0cmluZz8iMCI6MDtsLkxvbmc/KHI9bmV3IGwuTG9uZygwLDAsITEpLG4uZW5kPXQubG9uZ3M9PT1TdHJpbmc/ci50b1N0cmluZygpOnQubG9uZ3M9PT1OdW1iZXI/ci50b051bWJlcigpOnIpOm4uZW5kPXQubG9uZ3M9PT1TdHJpbmc/IjAiOjA7fXJldHVybiBudWxsIT1lLmJlZ2luJiZlLmhhc093blByb3BlcnR5KCJiZWdpbiIpJiYoIm51bWJlciI9PXR5cGVvZiBlLmJlZ2luP24uYmVnaW49dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS5iZWdpbik6ZS5iZWdpbjpuLmJlZ2luPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUuYmVnaW4pOnQubG9uZ3M9PT1OdW1iZXI/bmV3IGwuTG9uZ0JpdHMoZS5iZWdpbi5sb3c+Pj4wLGUuYmVnaW4uaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS5iZWdpbiksbnVsbCE9ZS5lbmQmJmUuaGFzT3duUHJvcGVydHkoImVuZCIpJiYoIm51bWJlciI9PXR5cGVvZiBlLmVuZD9uLmVuZD10LmxvbmdzPT09U3RyaW5nP1N0cmluZyhlLmVuZCk6ZS5lbmQ6bi5lbmQ9dC5sb25ncz09PVN0cmluZz9sLkxvbmcucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZS5lbmQpOnQubG9uZ3M9PT1OdW1iZXI/bmV3IGwuTG9uZ0JpdHMoZS5lbmQubG93Pj4+MCxlLmVuZC5oaWdoPj4+MCkudG9OdW1iZXIoKTplLmVuZCksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UZW5zb3JQcm90by5TZWdtZW50In0sZX0oKSxlLkRhdGFMb2NhdGlvbj1mdW5jdGlvbigpe3ZhciBlPXt9LHQ9T2JqZWN0LmNyZWF0ZShlKTtyZXR1cm4gdFtlWzBdPSJERUZBVUxUIl09MCx0W2VbMV09IkVYVEVSTkFMIl09MSx0fSgpLGV9KCksaS5TcGFyc2VUZW5zb3JQcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodGhpcy5kaW1zPVtdLGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLnZhbHVlcz1udWxsLGUucHJvdG90eXBlLmluZGljZXM9bnVsbCxlLnByb3RvdHlwZS5kaW1zPWwuZW1wdHlBcnJheSxlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7aWYodHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS52YWx1ZXMmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsInZhbHVlcyIpJiZjLm9ubnguVGVuc29yUHJvdG8uZW5jb2RlKGUudmFsdWVzLHQudWludDMyKDEwKS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuaW5kaWNlcyYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiaW5kaWNlcyIpJiZjLm9ubnguVGVuc29yUHJvdG8uZW5jb2RlKGUuaW5kaWNlcyx0LnVpbnQzMigxOCkuZm9yaygpKS5sZGVsaW0oKSxudWxsIT1lLmRpbXMmJmUuZGltcy5sZW5ndGgpe3QudWludDMyKDI2KS5mb3JrKCk7Zm9yKHZhciBuPTA7bjxlLmRpbXMubGVuZ3RoOysrbil0LmludDY0KGUuZGltc1tuXSk7dC5sZGVsaW0oKTt9cmV0dXJuIHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5TcGFyc2VUZW5zb3JQcm90bztlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTpyLnZhbHVlcz1jLm9ubnguVGVuc29yUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7Y2FzZSAyOnIuaW5kaWNlcz1jLm9ubnguVGVuc29yUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7Y2FzZSAzOmlmKHIuZGltcyYmci5kaW1zLmxlbmd0aHx8KHIuZGltcz1bXSksMj09KDcmbykpZm9yKHZhciBpPWUudWludDMyKCkrZS5wb3M7ZS5wb3M8aTspci5kaW1zLnB1c2goZS5pbnQ2NCgpKTtlbHNlIHIuZGltcy5wdXNoKGUuaW50NjQoKSk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gIm9iamVjdCBleHBlY3RlZCI7dmFyIHQ7aWYobnVsbCE9ZS52YWx1ZXMmJmUuaGFzT3duUHJvcGVydHkoInZhbHVlcyIpJiYodD1jLm9ubnguVGVuc29yUHJvdG8udmVyaWZ5KGUudmFsdWVzKSkpcmV0dXJuICJ2YWx1ZXMuIit0O2lmKG51bGwhPWUuaW5kaWNlcyYmZS5oYXNPd25Qcm9wZXJ0eSgiaW5kaWNlcyIpJiYodD1jLm9ubnguVGVuc29yUHJvdG8udmVyaWZ5KGUuaW5kaWNlcykpKXJldHVybiAiaW5kaWNlcy4iK3Q7aWYobnVsbCE9ZS5kaW1zJiZlLmhhc093blByb3BlcnR5KCJkaW1zIikpe2lmKCFBcnJheS5pc0FycmF5KGUuZGltcykpcmV0dXJuICJkaW1zOiBhcnJheSBleHBlY3RlZCI7Zm9yKHZhciBuPTA7bjxlLmRpbXMubGVuZ3RoOysrbilpZighKGwuaXNJbnRlZ2VyKGUuZGltc1tuXSl8fGUuZGltc1tuXSYmbC5pc0ludGVnZXIoZS5kaW1zW25dLmxvdykmJmwuaXNJbnRlZ2VyKGUuZGltc1tuXS5oaWdoKSkpcmV0dXJuICJkaW1zOiBpbnRlZ2VyfExvbmdbXSBleHBlY3RlZCJ9cmV0dXJuIG51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlNwYXJzZVRlbnNvclByb3RvKXJldHVybiBlO3ZhciB0PW5ldyBjLm9ubnguU3BhcnNlVGVuc29yUHJvdG87aWYobnVsbCE9ZS52YWx1ZXMpe2lmKCJvYmplY3QiIT10eXBlb2YgZS52YWx1ZXMpdGhyb3cgVHlwZUVycm9yKCIub25ueC5TcGFyc2VUZW5zb3JQcm90by52YWx1ZXM6IG9iamVjdCBleHBlY3RlZCIpO3QudmFsdWVzPWMub25ueC5UZW5zb3JQcm90by5mcm9tT2JqZWN0KGUudmFsdWVzKTt9aWYobnVsbCE9ZS5pbmRpY2VzKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuaW5kaWNlcyl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlNwYXJzZVRlbnNvclByb3RvLmluZGljZXM6IG9iamVjdCBleHBlY3RlZCIpO3QuaW5kaWNlcz1jLm9ubnguVGVuc29yUHJvdG8uZnJvbU9iamVjdChlLmluZGljZXMpO31pZihlLmRpbXMpe2lmKCFBcnJheS5pc0FycmF5KGUuZGltcykpdGhyb3cgVHlwZUVycm9yKCIub25ueC5TcGFyc2VUZW5zb3JQcm90by5kaW1zOiBhcnJheSBleHBlY3RlZCIpO3QuZGltcz1bXTtmb3IodmFyIG49MDtuPGUuZGltcy5sZW5ndGg7KytuKWwuTG9uZz8odC5kaW1zW25dPWwuTG9uZy5mcm9tVmFsdWUoZS5kaW1zW25dKSkudW5zaWduZWQ9ITE6InN0cmluZyI9PXR5cGVvZiBlLmRpbXNbbl0/dC5kaW1zW25dPXBhcnNlSW50KGUuZGltc1tuXSwxMCk6Im51bWJlciI9PXR5cGVvZiBlLmRpbXNbbl0/dC5kaW1zW25dPWUuZGltc1tuXToib2JqZWN0Ij09dHlwZW9mIGUuZGltc1tuXSYmKHQuZGltc1tuXT1uZXcgbC5Mb25nQml0cyhlLmRpbXNbbl0ubG93Pj4+MCxlLmRpbXNbbl0uaGlnaD4+PjApLnRvTnVtYmVyKCkpO31yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5kaW1zPVtdKSx0LmRlZmF1bHRzJiYobi52YWx1ZXM9bnVsbCxuLmluZGljZXM9bnVsbCksbnVsbCE9ZS52YWx1ZXMmJmUuaGFzT3duUHJvcGVydHkoInZhbHVlcyIpJiYobi52YWx1ZXM9Yy5vbm54LlRlbnNvclByb3RvLnRvT2JqZWN0KGUudmFsdWVzLHQpKSxudWxsIT1lLmluZGljZXMmJmUuaGFzT3duUHJvcGVydHkoImluZGljZXMiKSYmKG4uaW5kaWNlcz1jLm9ubnguVGVuc29yUHJvdG8udG9PYmplY3QoZS5pbmRpY2VzLHQpKSxlLmRpbXMmJmUuZGltcy5sZW5ndGgpe24uZGltcz1bXTtmb3IodmFyIHI9MDtyPGUuZGltcy5sZW5ndGg7KytyKSJudW1iZXIiPT10eXBlb2YgZS5kaW1zW3JdP24uZGltc1tyXT10LmxvbmdzPT09U3RyaW5nP1N0cmluZyhlLmRpbXNbcl0pOmUuZGltc1tyXTpuLmRpbXNbcl09dC5sb25ncz09PVN0cmluZz9sLkxvbmcucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZS5kaW1zW3JdKTp0LmxvbmdzPT09TnVtYmVyP25ldyBsLkxvbmdCaXRzKGUuZGltc1tyXS5sb3c+Pj4wLGUuZGltc1tyXS5oaWdoPj4+MCkudG9OdW1iZXIoKTplLmRpbXNbcl07fXJldHVybiBufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54LlNwYXJzZVRlbnNvclByb3RvIn0sZX0oKSxpLlRlbnNvclNoYXBlUHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKHRoaXMuZGltPVtdLGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmRpbT1sLmVtcHR5QXJyYXksZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe2lmKHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUuZGltJiZlLmRpbS5sZW5ndGgpZm9yKHZhciBuPTA7bjxlLmRpbS5sZW5ndGg7KytuKWMub25ueC5UZW5zb3JTaGFwZVByb3RvLkRpbWVuc2lvbi5lbmNvZGUoZS5kaW1bbl0sdC51aW50MzIoMTApLmZvcmsoKSkubGRlbGltKCk7cmV0dXJuIHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5UZW5zb3JTaGFwZVByb3RvO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO28+Pj4zPT0xPyhyLmRpbSYmci5kaW0ubGVuZ3RofHwoci5kaW09W10pLHIuZGltLnB1c2goYy5vbm54LlRlbnNvclNoYXBlUHJvdG8uRGltZW5zaW9uLmRlY29kZShlLGUudWludDMyKCkpKSk6ZS5za2lwVHlwZSg3Jm8pO31yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gIm9iamVjdCBleHBlY3RlZCI7aWYobnVsbCE9ZS5kaW0mJmUuaGFzT3duUHJvcGVydHkoImRpbSIpKXtpZighQXJyYXkuaXNBcnJheShlLmRpbSkpcmV0dXJuICJkaW06IGFycmF5IGV4cGVjdGVkIjtmb3IodmFyIHQ9MDt0PGUuZGltLmxlbmd0aDsrK3Qpe3ZhciBuPWMub25ueC5UZW5zb3JTaGFwZVByb3RvLkRpbWVuc2lvbi52ZXJpZnkoZS5kaW1bdF0pO2lmKG4pcmV0dXJuICJkaW0uIitufX1yZXR1cm4gbnVsbH0sZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBjLm9ubnguVGVuc29yU2hhcGVQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlRlbnNvclNoYXBlUHJvdG87aWYoZS5kaW0pe2lmKCFBcnJheS5pc0FycmF5KGUuZGltKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclNoYXBlUHJvdG8uZGltOiBhcnJheSBleHBlY3RlZCIpO3QuZGltPVtdO2Zvcih2YXIgbj0wO248ZS5kaW0ubGVuZ3RoOysrbil7aWYoIm9iamVjdCIhPXR5cGVvZiBlLmRpbVtuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlRlbnNvclNoYXBlUHJvdG8uZGltOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmRpbVtuXT1jLm9ubnguVGVuc29yU2hhcGVQcm90by5EaW1lbnNpb24uZnJvbU9iamVjdChlLmRpbVtuXSk7fX1yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5kaW09W10pLGUuZGltJiZlLmRpbS5sZW5ndGgpe24uZGltPVtdO2Zvcih2YXIgcj0wO3I8ZS5kaW0ubGVuZ3RoOysrciluLmRpbVtyXT1jLm9ubnguVGVuc29yU2hhcGVQcm90by5EaW1lbnNpb24udG9PYmplY3QoZS5kaW1bcl0sdCk7fXJldHVybiBufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54LlRlbnNvclNoYXBlUHJvdG8ifSxlLkRpbWVuc2lvbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO312YXIgdDtyZXR1cm4gZS5wcm90b3R5cGUuZGltVmFsdWU9bnVsbCxlLnByb3RvdHlwZS5kaW1QYXJhbT1udWxsLGUucHJvdG90eXBlLmRlbm90YXRpb249IiIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLCJ2YWx1ZSIse2dldDpsLm9uZU9mR2V0dGVyKHQ9WyJkaW1WYWx1ZSIsImRpbVBhcmFtIl0pLHNldDpsLm9uZU9mU2V0dGVyKHQpfSksZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmRpbVZhbHVlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkaW1WYWx1ZSIpJiZ0LnVpbnQzMig4KS5pbnQ2NChlLmRpbVZhbHVlKSxudWxsIT1lLmRpbVBhcmFtJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkaW1QYXJhbSIpJiZ0LnVpbnQzMigxOCkuc3RyaW5nKGUuZGltUGFyYW0pLG51bGwhPWUuZGVub3RhdGlvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZGVub3RhdGlvbiIpJiZ0LnVpbnQzMigyNikuc3RyaW5nKGUuZGVub3RhdGlvbiksdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LlRlbnNvclNoYXBlUHJvdG8uRGltZW5zaW9uO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIuZGltVmFsdWU9ZS5pbnQ2NCgpO2JyZWFrO2Nhc2UgMjpyLmRpbVBhcmFtPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSAzOnIuZGVub3RhdGlvbj1lLnN0cmluZygpO2JyZWFrO2RlZmF1bHQ6ZS5za2lwVHlwZSg3Jm8pO319cmV0dXJuIHJ9LGUuZGVjb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgYXx8KGU9bmV3IGEoZSkpLHRoaXMuZGVjb2RlKGUsZS51aW50MzIoKSl9LGUudmVyaWZ5PWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuICJvYmplY3QgZXhwZWN0ZWQiO3ZhciB0PXt9O2lmKG51bGwhPWUuZGltVmFsdWUmJmUuaGFzT3duUHJvcGVydHkoImRpbVZhbHVlIikmJih0LnZhbHVlPTEsIShsLmlzSW50ZWdlcihlLmRpbVZhbHVlKXx8ZS5kaW1WYWx1ZSYmbC5pc0ludGVnZXIoZS5kaW1WYWx1ZS5sb3cpJiZsLmlzSW50ZWdlcihlLmRpbVZhbHVlLmhpZ2gpKSkpcmV0dXJuICJkaW1WYWx1ZTogaW50ZWdlcnxMb25nIGV4cGVjdGVkIjtpZihudWxsIT1lLmRpbVBhcmFtJiZlLmhhc093blByb3BlcnR5KCJkaW1QYXJhbSIpKXtpZigxPT09dC52YWx1ZSlyZXR1cm4gInZhbHVlOiBtdWx0aXBsZSB2YWx1ZXMiO2lmKHQudmFsdWU9MSwhbC5pc1N0cmluZyhlLmRpbVBhcmFtKSlyZXR1cm4gImRpbVBhcmFtOiBzdHJpbmcgZXhwZWN0ZWQifXJldHVybiBudWxsIT1lLmRlbm90YXRpb24mJmUuaGFzT3duUHJvcGVydHkoImRlbm90YXRpb24iKSYmIWwuaXNTdHJpbmcoZS5kZW5vdGF0aW9uKT8iZGVub3RhdGlvbjogc3RyaW5nIGV4cGVjdGVkIjpudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5UZW5zb3JTaGFwZVByb3RvLkRpbWVuc2lvbilyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlRlbnNvclNoYXBlUHJvdG8uRGltZW5zaW9uO3JldHVybiBudWxsIT1lLmRpbVZhbHVlJiYobC5Mb25nPyh0LmRpbVZhbHVlPWwuTG9uZy5mcm9tVmFsdWUoZS5kaW1WYWx1ZSkpLnVuc2lnbmVkPSExOiJzdHJpbmciPT10eXBlb2YgZS5kaW1WYWx1ZT90LmRpbVZhbHVlPXBhcnNlSW50KGUuZGltVmFsdWUsMTApOiJudW1iZXIiPT10eXBlb2YgZS5kaW1WYWx1ZT90LmRpbVZhbHVlPWUuZGltVmFsdWU6Im9iamVjdCI9PXR5cGVvZiBlLmRpbVZhbHVlJiYodC5kaW1WYWx1ZT1uZXcgbC5Mb25nQml0cyhlLmRpbVZhbHVlLmxvdz4+PjAsZS5kaW1WYWx1ZS5oaWdoPj4+MCkudG9OdW1iZXIoKSkpLG51bGwhPWUuZGltUGFyYW0mJih0LmRpbVBhcmFtPVN0cmluZyhlLmRpbVBhcmFtKSksbnVsbCE9ZS5kZW5vdGF0aW9uJiYodC5kZW5vdGF0aW9uPVN0cmluZyhlLmRlbm90YXRpb24pKSx0fSxlLnRvT2JqZWN0PWZ1bmN0aW9uKGUsdCl7dHx8KHQ9e30pO3ZhciBuPXt9O3JldHVybiB0LmRlZmF1bHRzJiYobi5kZW5vdGF0aW9uPSIiKSxudWxsIT1lLmRpbVZhbHVlJiZlLmhhc093blByb3BlcnR5KCJkaW1WYWx1ZSIpJiYoIm51bWJlciI9PXR5cGVvZiBlLmRpbVZhbHVlP24uZGltVmFsdWU9dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS5kaW1WYWx1ZSk6ZS5kaW1WYWx1ZTpuLmRpbVZhbHVlPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUuZGltVmFsdWUpOnQubG9uZ3M9PT1OdW1iZXI/bmV3IGwuTG9uZ0JpdHMoZS5kaW1WYWx1ZS5sb3c+Pj4wLGUuZGltVmFsdWUuaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS5kaW1WYWx1ZSx0Lm9uZW9mcyYmKG4udmFsdWU9ImRpbVZhbHVlIikpLG51bGwhPWUuZGltUGFyYW0mJmUuaGFzT3duUHJvcGVydHkoImRpbVBhcmFtIikmJihuLmRpbVBhcmFtPWUuZGltUGFyYW0sdC5vbmVvZnMmJihuLnZhbHVlPSJkaW1QYXJhbSIpKSxudWxsIT1lLmRlbm90YXRpb24mJmUuaGFzT3duUHJvcGVydHkoImRlbm90YXRpb24iKSYmKG4uZGVub3RhdGlvbj1lLmRlbm90YXRpb24pLG59LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnRvT2JqZWN0KHRoaXMscy51dGlsLnRvSlNPTk9wdGlvbnMpfSxlLmdldFR5cGVVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSJ0eXBlLmdvb2dsZWFwaXMuY29tIiksZSsiL29ubnguVGVuc29yU2hhcGVQcm90by5EaW1lbnNpb24ifSxlfSgpLGV9KCksaS5UeXBlUHJvdG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9dmFyIHQ7cmV0dXJuIGUucHJvdG90eXBlLnRlbnNvclR5cGU9bnVsbCxlLnByb3RvdHlwZS5zZXF1ZW5jZVR5cGU9bnVsbCxlLnByb3RvdHlwZS5tYXBUeXBlPW51bGwsZS5wcm90b3R5cGUub3B0aW9uYWxUeXBlPW51bGwsZS5wcm90b3R5cGUuc3BhcnNlVGVuc29yVHlwZT1udWxsLGUucHJvdG90eXBlLmRlbm90YXRpb249IiIsT2JqZWN0LmRlZmluZVByb3BlcnR5KGUucHJvdG90eXBlLCJ2YWx1ZSIse2dldDpsLm9uZU9mR2V0dGVyKHQ9WyJ0ZW5zb3JUeXBlIiwic2VxdWVuY2VUeXBlIiwibWFwVHlwZSIsIm9wdGlvbmFsVHlwZSIsInNwYXJzZVRlbnNvclR5cGUiXSksc2V0Omwub25lT2ZTZXR0ZXIodCl9KSxlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUudGVuc29yVHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwidGVuc29yVHlwZSIpJiZjLm9ubnguVHlwZVByb3RvLlRlbnNvci5lbmNvZGUoZS50ZW5zb3JUeXBlLHQudWludDMyKDEwKS5mb3JrKCkpLmxkZWxpbSgpLG51bGwhPWUuc2VxdWVuY2VUeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJzZXF1ZW5jZVR5cGUiKSYmYy5vbm54LlR5cGVQcm90by5TZXF1ZW5jZS5lbmNvZGUoZS5zZXF1ZW5jZVR5cGUsdC51aW50MzIoMzQpLmZvcmsoKSkubGRlbGltKCksbnVsbCE9ZS5tYXBUeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJtYXBUeXBlIikmJmMub25ueC5UeXBlUHJvdG8uTWFwLmVuY29kZShlLm1hcFR5cGUsdC51aW50MzIoNDIpLmZvcmsoKSkubGRlbGltKCksbnVsbCE9ZS5kZW5vdGF0aW9uJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJkZW5vdGF0aW9uIikmJnQudWludDMyKDUwKS5zdHJpbmcoZS5kZW5vdGF0aW9uKSxudWxsIT1lLnNwYXJzZVRlbnNvclR5cGUmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsInNwYXJzZVRlbnNvclR5cGUiKSYmYy5vbm54LlR5cGVQcm90by5TcGFyc2VUZW5zb3IuZW5jb2RlKGUuc3BhcnNlVGVuc29yVHlwZSx0LnVpbnQzMig2NikuZm9yaygpKS5sZGVsaW0oKSxudWxsIT1lLm9wdGlvbmFsVHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwib3B0aW9uYWxUeXBlIikmJmMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWwuZW5jb2RlKGUub3B0aW9uYWxUeXBlLHQudWludDMyKDc0KS5mb3JrKCkpLmxkZWxpbSgpLHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5UeXBlUHJvdG87ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci50ZW5zb3JUeXBlPWMub25ueC5UeXBlUHJvdG8uVGVuc29yLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgNDpyLnNlcXVlbmNlVHlwZT1jLm9ubnguVHlwZVByb3RvLlNlcXVlbmNlLmRlY29kZShlLGUudWludDMyKCkpO2JyZWFrO2Nhc2UgNTpyLm1hcFR5cGU9Yy5vbm54LlR5cGVQcm90by5NYXAuZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7Y2FzZSA5OnIub3B0aW9uYWxUeXBlPWMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWwuZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7Y2FzZSA4OnIuc3BhcnNlVGVuc29yVHlwZT1jLm9ubnguVHlwZVByb3RvLlNwYXJzZVRlbnNvci5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztjYXNlIDY6ci5kZW5vdGF0aW9uPWUuc3RyaW5nKCk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gIm9iamVjdCBleHBlY3RlZCI7dmFyIHQ9e307aWYobnVsbCE9ZS50ZW5zb3JUeXBlJiZlLmhhc093blByb3BlcnR5KCJ0ZW5zb3JUeXBlIikmJih0LnZhbHVlPTEsbj1jLm9ubnguVHlwZVByb3RvLlRlbnNvci52ZXJpZnkoZS50ZW5zb3JUeXBlKSkpcmV0dXJuICJ0ZW5zb3JUeXBlLiIrbjtpZihudWxsIT1lLnNlcXVlbmNlVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgic2VxdWVuY2VUeXBlIikpe2lmKDE9PT10LnZhbHVlKXJldHVybiAidmFsdWU6IG11bHRpcGxlIHZhbHVlcyI7aWYodC52YWx1ZT0xLG49Yy5vbm54LlR5cGVQcm90by5TZXF1ZW5jZS52ZXJpZnkoZS5zZXF1ZW5jZVR5cGUpKXJldHVybiAic2VxdWVuY2VUeXBlLiIrbn1pZihudWxsIT1lLm1hcFR5cGUmJmUuaGFzT3duUHJvcGVydHkoIm1hcFR5cGUiKSl7aWYoMT09PXQudmFsdWUpcmV0dXJuICJ2YWx1ZTogbXVsdGlwbGUgdmFsdWVzIjtpZih0LnZhbHVlPTEsbj1jLm9ubnguVHlwZVByb3RvLk1hcC52ZXJpZnkoZS5tYXBUeXBlKSlyZXR1cm4gIm1hcFR5cGUuIitufWlmKG51bGwhPWUub3B0aW9uYWxUeXBlJiZlLmhhc093blByb3BlcnR5KCJvcHRpb25hbFR5cGUiKSl7aWYoMT09PXQudmFsdWUpcmV0dXJuICJ2YWx1ZTogbXVsdGlwbGUgdmFsdWVzIjtpZih0LnZhbHVlPTEsbj1jLm9ubnguVHlwZVByb3RvLk9wdGlvbmFsLnZlcmlmeShlLm9wdGlvbmFsVHlwZSkpcmV0dXJuICJvcHRpb25hbFR5cGUuIitufWlmKG51bGwhPWUuc3BhcnNlVGVuc29yVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgic3BhcnNlVGVuc29yVHlwZSIpKXtpZigxPT09dC52YWx1ZSlyZXR1cm4gInZhbHVlOiBtdWx0aXBsZSB2YWx1ZXMiO3ZhciBuO2lmKHQudmFsdWU9MSxuPWMub25ueC5UeXBlUHJvdG8uU3BhcnNlVGVuc29yLnZlcmlmeShlLnNwYXJzZVRlbnNvclR5cGUpKXJldHVybiAic3BhcnNlVGVuc29yVHlwZS4iK259cmV0dXJuIG51bGwhPWUuZGVub3RhdGlvbiYmZS5oYXNPd25Qcm9wZXJ0eSgiZGVub3RhdGlvbiIpJiYhbC5pc1N0cmluZyhlLmRlbm90YXRpb24pPyJkZW5vdGF0aW9uOiBzdHJpbmcgZXhwZWN0ZWQiOm51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlR5cGVQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlR5cGVQcm90bztpZihudWxsIT1lLnRlbnNvclR5cGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZS50ZW5zb3JUeXBlKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHlwZVByb3RvLnRlbnNvclR5cGU6IG9iamVjdCBleHBlY3RlZCIpO3QudGVuc29yVHlwZT1jLm9ubnguVHlwZVByb3RvLlRlbnNvci5mcm9tT2JqZWN0KGUudGVuc29yVHlwZSk7fWlmKG51bGwhPWUuc2VxdWVuY2VUeXBlKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuc2VxdWVuY2VUeXBlKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHlwZVByb3RvLnNlcXVlbmNlVHlwZTogb2JqZWN0IGV4cGVjdGVkIik7dC5zZXF1ZW5jZVR5cGU9Yy5vbm54LlR5cGVQcm90by5TZXF1ZW5jZS5mcm9tT2JqZWN0KGUuc2VxdWVuY2VUeXBlKTt9aWYobnVsbCE9ZS5tYXBUeXBlKXtpZigib2JqZWN0IiE9dHlwZW9mIGUubWFwVHlwZSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlR5cGVQcm90by5tYXBUeXBlOiBvYmplY3QgZXhwZWN0ZWQiKTt0Lm1hcFR5cGU9Yy5vbm54LlR5cGVQcm90by5NYXAuZnJvbU9iamVjdChlLm1hcFR5cGUpO31pZihudWxsIT1lLm9wdGlvbmFsVHlwZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLm9wdGlvbmFsVHlwZSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlR5cGVQcm90by5vcHRpb25hbFR5cGU6IG9iamVjdCBleHBlY3RlZCIpO3Qub3B0aW9uYWxUeXBlPWMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWwuZnJvbU9iamVjdChlLm9wdGlvbmFsVHlwZSk7fWlmKG51bGwhPWUuc3BhcnNlVGVuc29yVHlwZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnNwYXJzZVRlbnNvclR5cGUpdGhyb3cgVHlwZUVycm9yKCIub25ueC5UeXBlUHJvdG8uc3BhcnNlVGVuc29yVHlwZTogb2JqZWN0IGV4cGVjdGVkIik7dC5zcGFyc2VUZW5zb3JUeXBlPWMub25ueC5UeXBlUHJvdG8uU3BhcnNlVGVuc29yLmZyb21PYmplY3QoZS5zcGFyc2VUZW5zb3JUeXBlKTt9cmV0dXJuIG51bGwhPWUuZGVub3RhdGlvbiYmKHQuZGVub3RhdGlvbj1TdHJpbmcoZS5kZW5vdGF0aW9uKSksdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtyZXR1cm4gdC5kZWZhdWx0cyYmKG4uZGVub3RhdGlvbj0iIiksbnVsbCE9ZS50ZW5zb3JUeXBlJiZlLmhhc093blByb3BlcnR5KCJ0ZW5zb3JUeXBlIikmJihuLnRlbnNvclR5cGU9Yy5vbm54LlR5cGVQcm90by5UZW5zb3IudG9PYmplY3QoZS50ZW5zb3JUeXBlLHQpLHQub25lb2ZzJiYobi52YWx1ZT0idGVuc29yVHlwZSIpKSxudWxsIT1lLnNlcXVlbmNlVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgic2VxdWVuY2VUeXBlIikmJihuLnNlcXVlbmNlVHlwZT1jLm9ubnguVHlwZVByb3RvLlNlcXVlbmNlLnRvT2JqZWN0KGUuc2VxdWVuY2VUeXBlLHQpLHQub25lb2ZzJiYobi52YWx1ZT0ic2VxdWVuY2VUeXBlIikpLG51bGwhPWUubWFwVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgibWFwVHlwZSIpJiYobi5tYXBUeXBlPWMub25ueC5UeXBlUHJvdG8uTWFwLnRvT2JqZWN0KGUubWFwVHlwZSx0KSx0Lm9uZW9mcyYmKG4udmFsdWU9Im1hcFR5cGUiKSksbnVsbCE9ZS5kZW5vdGF0aW9uJiZlLmhhc093blByb3BlcnR5KCJkZW5vdGF0aW9uIikmJihuLmRlbm90YXRpb249ZS5kZW5vdGF0aW9uKSxudWxsIT1lLnNwYXJzZVRlbnNvclR5cGUmJmUuaGFzT3duUHJvcGVydHkoInNwYXJzZVRlbnNvclR5cGUiKSYmKG4uc3BhcnNlVGVuc29yVHlwZT1jLm9ubnguVHlwZVByb3RvLlNwYXJzZVRlbnNvci50b09iamVjdChlLnNwYXJzZVRlbnNvclR5cGUsdCksdC5vbmVvZnMmJihuLnZhbHVlPSJzcGFyc2VUZW5zb3JUeXBlIikpLG51bGwhPWUub3B0aW9uYWxUeXBlJiZlLmhhc093blByb3BlcnR5KCJvcHRpb25hbFR5cGUiKSYmKG4ub3B0aW9uYWxUeXBlPWMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWwudG9PYmplY3QoZS5vcHRpb25hbFR5cGUsdCksdC5vbmVvZnMmJihuLnZhbHVlPSJvcHRpb25hbFR5cGUiKSksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UeXBlUHJvdG8ifSxlLlRlbnNvcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUuZWxlbVR5cGU9MCxlLnByb3RvdHlwZS5zaGFwZT1udWxsLGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS5lbGVtVHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZWxlbVR5cGUiKSYmdC51aW50MzIoOCkuaW50MzIoZS5lbGVtVHlwZSksbnVsbCE9ZS5zaGFwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwic2hhcGUiKSYmYy5vbm54LlRlbnNvclNoYXBlUHJvdG8uZW5jb2RlKGUuc2hhcGUsdC51aW50MzIoMTgpLmZvcmsoKSkubGRlbGltKCksdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LlR5cGVQcm90by5UZW5zb3I7ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci5lbGVtVHlwZT1lLmludDMyKCk7YnJlYWs7Y2FzZSAyOnIuc2hhcGU9Yy5vbm54LlRlbnNvclNoYXBlUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gIm9iamVjdCBleHBlY3RlZCI7aWYobnVsbCE9ZS5lbGVtVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgiZWxlbVR5cGUiKSYmIWwuaXNJbnRlZ2VyKGUuZWxlbVR5cGUpKXJldHVybiAiZWxlbVR5cGU6IGludGVnZXIgZXhwZWN0ZWQiO2lmKG51bGwhPWUuc2hhcGUmJmUuaGFzT3duUHJvcGVydHkoInNoYXBlIikpe3ZhciB0PWMub25ueC5UZW5zb3JTaGFwZVByb3RvLnZlcmlmeShlLnNoYXBlKTtpZih0KXJldHVybiAic2hhcGUuIit0fXJldHVybiBudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5UeXBlUHJvdG8uVGVuc29yKXJldHVybiBlO3ZhciB0PW5ldyBjLm9ubnguVHlwZVByb3RvLlRlbnNvcjtpZihudWxsIT1lLmVsZW1UeXBlJiYodC5lbGVtVHlwZT0wfGUuZWxlbVR5cGUpLG51bGwhPWUuc2hhcGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZS5zaGFwZSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlR5cGVQcm90by5UZW5zb3Iuc2hhcGU6IG9iamVjdCBleHBlY3RlZCIpO3Quc2hhcGU9Yy5vbm54LlRlbnNvclNoYXBlUHJvdG8uZnJvbU9iamVjdChlLnNoYXBlKTt9cmV0dXJuIHR9LGUudG9PYmplY3Q9ZnVuY3Rpb24oZSx0KXt0fHwodD17fSk7dmFyIG49e307cmV0dXJuIHQuZGVmYXVsdHMmJihuLmVsZW1UeXBlPTAsbi5zaGFwZT1udWxsKSxudWxsIT1lLmVsZW1UeXBlJiZlLmhhc093blByb3BlcnR5KCJlbGVtVHlwZSIpJiYobi5lbGVtVHlwZT1lLmVsZW1UeXBlKSxudWxsIT1lLnNoYXBlJiZlLmhhc093blByb3BlcnR5KCJzaGFwZSIpJiYobi5zaGFwZT1jLm9ubnguVGVuc29yU2hhcGVQcm90by50b09iamVjdChlLnNoYXBlLHQpKSxufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54LlR5cGVQcm90by5UZW5zb3IifSxlfSgpLGUuU2VxdWVuY2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmVsZW1UeXBlPW51bGwsZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmVsZW1UeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJlbGVtVHlwZSIpJiZjLm9ubnguVHlwZVByb3RvLmVuY29kZShlLmVsZW1UeXBlLHQudWludDMyKDEwKS5mb3JrKCkpLmxkZWxpbSgpLHR9LGUuZW5jb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZW5jb2RlKGUsdCkubGRlbGltKCl9LGUuZGVjb2RlPWZ1bmN0aW9uKGUsdCl7ZSBpbnN0YW5jZW9mIGF8fChlPWEuY3JlYXRlKGUpKTtmb3IodmFyIG49dm9pZCAwPT09dD9lLmxlbjplLnBvcyt0LHI9bmV3IGMub25ueC5UeXBlUHJvdG8uU2VxdWVuY2U7ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7bz4+PjM9PTE/ci5lbGVtVHlwZT1jLm9ubnguVHlwZVByb3RvLmRlY29kZShlLGUudWludDMyKCkpOmUuc2tpcFR5cGUoNyZvKTt9cmV0dXJuIHJ9LGUuZGVjb2RlRGVsaW1pdGVkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgYXx8KGU9bmV3IGEoZSkpLHRoaXMuZGVjb2RlKGUsZS51aW50MzIoKSl9LGUudmVyaWZ5PWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuICJvYmplY3QgZXhwZWN0ZWQiO2lmKG51bGwhPWUuZWxlbVR5cGUmJmUuaGFzT3duUHJvcGVydHkoImVsZW1UeXBlIikpe3ZhciB0PWMub25ueC5UeXBlUHJvdG8udmVyaWZ5KGUuZWxlbVR5cGUpO2lmKHQpcmV0dXJuICJlbGVtVHlwZS4iK3R9cmV0dXJuIG51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlR5cGVQcm90by5TZXF1ZW5jZSlyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlR5cGVQcm90by5TZXF1ZW5jZTtpZihudWxsIT1lLmVsZW1UeXBlKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuZWxlbVR5cGUpdGhyb3cgVHlwZUVycm9yKCIub25ueC5UeXBlUHJvdG8uU2VxdWVuY2UuZWxlbVR5cGU6IG9iamVjdCBleHBlY3RlZCIpO3QuZWxlbVR5cGU9Yy5vbm54LlR5cGVQcm90by5mcm9tT2JqZWN0KGUuZWxlbVR5cGUpO31yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtyZXR1cm4gdC5kZWZhdWx0cyYmKG4uZWxlbVR5cGU9bnVsbCksbnVsbCE9ZS5lbGVtVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgiZWxlbVR5cGUiKSYmKG4uZWxlbVR5cGU9Yy5vbm54LlR5cGVQcm90by50b09iamVjdChlLmVsZW1UeXBlLHQpKSxufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54LlR5cGVQcm90by5TZXF1ZW5jZSJ9LGV9KCksZS5NYXA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2lmKGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLmtleVR5cGU9MCxlLnByb3RvdHlwZS52YWx1ZVR5cGU9bnVsbCxlLmNyZWF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUuZW5jb2RlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUua2V5VHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwia2V5VHlwZSIpJiZ0LnVpbnQzMig4KS5pbnQzMihlLmtleVR5cGUpLG51bGwhPWUudmFsdWVUeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJ2YWx1ZVR5cGUiKSYmYy5vbm54LlR5cGVQcm90by5lbmNvZGUoZS52YWx1ZVR5cGUsdC51aW50MzIoMTgpLmZvcmsoKSkubGRlbGltKCksdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LlR5cGVQcm90by5NYXA7ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci5rZXlUeXBlPWUuaW50MzIoKTticmVhaztjYXNlIDI6ci52YWx1ZVR5cGU9Yy5vbm54LlR5cGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLmtleVR5cGUmJmUuaGFzT3duUHJvcGVydHkoImtleVR5cGUiKSYmIWwuaXNJbnRlZ2VyKGUua2V5VHlwZSkpcmV0dXJuICJrZXlUeXBlOiBpbnRlZ2VyIGV4cGVjdGVkIjtpZihudWxsIT1lLnZhbHVlVHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgidmFsdWVUeXBlIikpe3ZhciB0PWMub25ueC5UeXBlUHJvdG8udmVyaWZ5KGUudmFsdWVUeXBlKTtpZih0KXJldHVybiAidmFsdWVUeXBlLiIrdH1yZXR1cm4gbnVsbH0sZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBjLm9ubnguVHlwZVByb3RvLk1hcClyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LlR5cGVQcm90by5NYXA7aWYobnVsbCE9ZS5rZXlUeXBlJiYodC5rZXlUeXBlPTB8ZS5rZXlUeXBlKSxudWxsIT1lLnZhbHVlVHlwZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnZhbHVlVHlwZSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LlR5cGVQcm90by5NYXAudmFsdWVUeXBlOiBvYmplY3QgZXhwZWN0ZWQiKTt0LnZhbHVlVHlwZT1jLm9ubnguVHlwZVByb3RvLmZyb21PYmplY3QoZS52YWx1ZVR5cGUpO31yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtyZXR1cm4gdC5kZWZhdWx0cyYmKG4ua2V5VHlwZT0wLG4udmFsdWVUeXBlPW51bGwpLG51bGwhPWUua2V5VHlwZSYmZS5oYXNPd25Qcm9wZXJ0eSgia2V5VHlwZSIpJiYobi5rZXlUeXBlPWUua2V5VHlwZSksbnVsbCE9ZS52YWx1ZVR5cGUmJmUuaGFzT3duUHJvcGVydHkoInZhbHVlVHlwZSIpJiYobi52YWx1ZVR5cGU9Yy5vbm54LlR5cGVQcm90by50b09iamVjdChlLnZhbHVlVHlwZSx0KSksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UeXBlUHJvdG8uTWFwIn0sZX0oKSxlLk9wdGlvbmFsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZihlKWZvcih2YXIgdD1PYmplY3Qua2V5cyhlKSxuPTA7bjx0Lmxlbmd0aDsrK24pbnVsbCE9ZVt0W25dXSYmKHRoaXNbdFtuXV09ZVt0W25dXSk7fXJldHVybiBlLnByb3RvdHlwZS5lbGVtVHlwZT1udWxsLGUuY3JlYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0sZS5lbmNvZGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8KHQ9dS5jcmVhdGUoKSksbnVsbCE9ZS5lbGVtVHlwZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZWxlbVR5cGUiKSYmYy5vbm54LlR5cGVQcm90by5lbmNvZGUoZS5lbGVtVHlwZSx0LnVpbnQzMigxMCkuZm9yaygpKS5sZGVsaW0oKSx0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguVHlwZVByb3RvLk9wdGlvbmFsO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO28+Pj4zPT0xP3IuZWxlbVR5cGU9Yy5vbm54LlR5cGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTplLnNraXBUeXBlKDcmbyk7fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLmVsZW1UeXBlJiZlLmhhc093blByb3BlcnR5KCJlbGVtVHlwZSIpKXt2YXIgdD1jLm9ubnguVHlwZVByb3RvLnZlcmlmeShlLmVsZW1UeXBlKTtpZih0KXJldHVybiAiZWxlbVR5cGUuIit0fXJldHVybiBudWxsfSxlLmZyb21PYmplY3Q9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIGMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWwpcmV0dXJuIGU7dmFyIHQ9bmV3IGMub25ueC5UeXBlUHJvdG8uT3B0aW9uYWw7aWYobnVsbCE9ZS5lbGVtVHlwZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLmVsZW1UeXBlKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHlwZVByb3RvLk9wdGlvbmFsLmVsZW1UeXBlOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmVsZW1UeXBlPWMub25ueC5UeXBlUHJvdG8uZnJvbU9iamVjdChlLmVsZW1UeXBlKTt9cmV0dXJuIHR9LGUudG9PYmplY3Q9ZnVuY3Rpb24oZSx0KXt0fHwodD17fSk7dmFyIG49e307cmV0dXJuIHQuZGVmYXVsdHMmJihuLmVsZW1UeXBlPW51bGwpLG51bGwhPWUuZWxlbVR5cGUmJmUuaGFzT3duUHJvcGVydHkoImVsZW1UeXBlIikmJihuLmVsZW1UeXBlPWMub25ueC5UeXBlUHJvdG8udG9PYmplY3QoZS5lbGVtVHlwZSx0KSksbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5UeXBlUHJvdG8uT3B0aW9uYWwifSxlfSgpLGUuU3BhcnNlVGVuc29yPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZihlKWZvcih2YXIgdD1PYmplY3Qua2V5cyhlKSxuPTA7bjx0Lmxlbmd0aDsrK24pbnVsbCE9ZVt0W25dXSYmKHRoaXNbdFtuXV09ZVt0W25dXSk7fXJldHVybiBlLnByb3RvdHlwZS5lbGVtVHlwZT0wLGUucHJvdG90eXBlLnNoYXBlPW51bGwsZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmVsZW1UeXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJlbGVtVHlwZSIpJiZ0LnVpbnQzMig4KS5pbnQzMihlLmVsZW1UeXBlKSxudWxsIT1lLnNoYXBlJiZPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLCJzaGFwZSIpJiZjLm9ubnguVGVuc29yU2hhcGVQcm90by5lbmNvZGUoZS5zaGFwZSx0LnVpbnQzMigxOCkuZm9yaygpKS5sZGVsaW0oKSx0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguVHlwZVByb3RvLlNwYXJzZVRlbnNvcjtlLnBvczxuOyl7dmFyIG89ZS51aW50MzIoKTtzd2l0Y2gobz4+PjMpe2Nhc2UgMTpyLmVsZW1UeXBlPWUuaW50MzIoKTticmVhaztjYXNlIDI6ci5zaGFwZT1jLm9ubnguVGVuc29yU2hhcGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLmVsZW1UeXBlJiZlLmhhc093blByb3BlcnR5KCJlbGVtVHlwZSIpJiYhbC5pc0ludGVnZXIoZS5lbGVtVHlwZSkpcmV0dXJuICJlbGVtVHlwZTogaW50ZWdlciBleHBlY3RlZCI7aWYobnVsbCE9ZS5zaGFwZSYmZS5oYXNPd25Qcm9wZXJ0eSgic2hhcGUiKSl7dmFyIHQ9Yy5vbm54LlRlbnNvclNoYXBlUHJvdG8udmVyaWZ5KGUuc2hhcGUpO2lmKHQpcmV0dXJuICJzaGFwZS4iK3R9cmV0dXJuIG51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54LlR5cGVQcm90by5TcGFyc2VUZW5zb3IpcmV0dXJuIGU7dmFyIHQ9bmV3IGMub25ueC5UeXBlUHJvdG8uU3BhcnNlVGVuc29yO2lmKG51bGwhPWUuZWxlbVR5cGUmJih0LmVsZW1UeXBlPTB8ZS5lbGVtVHlwZSksbnVsbCE9ZS5zaGFwZSl7aWYoIm9iamVjdCIhPXR5cGVvZiBlLnNoYXBlKXRocm93IFR5cGVFcnJvcigiLm9ubnguVHlwZVByb3RvLlNwYXJzZVRlbnNvci5zaGFwZTogb2JqZWN0IGV4cGVjdGVkIik7dC5zaGFwZT1jLm9ubnguVGVuc29yU2hhcGVQcm90by5mcm9tT2JqZWN0KGUuc2hhcGUpO31yZXR1cm4gdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtyZXR1cm4gdC5kZWZhdWx0cyYmKG4uZWxlbVR5cGU9MCxuLnNoYXBlPW51bGwpLG51bGwhPWUuZWxlbVR5cGUmJmUuaGFzT3duUHJvcGVydHkoImVsZW1UeXBlIikmJihuLmVsZW1UeXBlPWUuZWxlbVR5cGUpLG51bGwhPWUuc2hhcGUmJmUuaGFzT3duUHJvcGVydHkoInNoYXBlIikmJihuLnNoYXBlPWMub25ueC5UZW5zb3JTaGFwZVByb3RvLnRvT2JqZWN0KGUuc2hhcGUsdCkpLG59LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnRvT2JqZWN0KHRoaXMscy51dGlsLnRvSlNPTk9wdGlvbnMpfSxlLmdldFR5cGVVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPSJ0eXBlLmdvb2dsZWFwaXMuY29tIiksZSsiL29ubnguVHlwZVByb3RvLlNwYXJzZVRlbnNvciJ9LGV9KCksZX0oKSxpLk9wZXJhdG9yU2V0SWRQcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZSlmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7KytuKW51bGwhPWVbdFtuXV0mJih0aGlzW3Rbbl1dPWVbdFtuXV0pO31yZXR1cm4gZS5wcm90b3R5cGUuZG9tYWluPSIiLGUucHJvdG90eXBlLnZlcnNpb249bC5Mb25nP2wuTG9uZy5mcm9tQml0cygwLDAsITEpOjAsZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHwodD11LmNyZWF0ZSgpKSxudWxsIT1lLmRvbWFpbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwiZG9tYWluIikmJnQudWludDMyKDEwKS5zdHJpbmcoZS5kb21haW4pLG51bGwhPWUudmVyc2lvbiYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwidmVyc2lvbiIpJiZ0LnVpbnQzMigxNikuaW50NjQoZS52ZXJzaW9uKSx0fSxlLmVuY29kZURlbGltaXRlZD1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVuY29kZShlLHQpLmxkZWxpbSgpfSxlLmRlY29kZT1mdW5jdGlvbihlLHQpe2UgaW5zdGFuY2VvZiBhfHwoZT1hLmNyZWF0ZShlKSk7Zm9yKHZhciBuPXZvaWQgMD09PXQ/ZS5sZW46ZS5wb3MrdCxyPW5ldyBjLm9ubnguT3BlcmF0b3JTZXRJZFByb3RvO2UucG9zPG47KXt2YXIgbz1lLnVpbnQzMigpO3N3aXRjaChvPj4+Myl7Y2FzZSAxOnIuZG9tYWluPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSAyOnIudmVyc2lvbj1lLmludDY0KCk7YnJlYWs7ZGVmYXVsdDplLnNraXBUeXBlKDcmbyk7fX1yZXR1cm4gcn0sZS5kZWNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBhfHwoZT1uZXcgYShlKSksdGhpcy5kZWNvZGUoZSxlLnVpbnQzMigpKX0sZS52ZXJpZnk9ZnVuY3Rpb24oZSl7cmV0dXJuICJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWU/Im9iamVjdCBleHBlY3RlZCI6bnVsbCE9ZS5kb21haW4mJmUuaGFzT3duUHJvcGVydHkoImRvbWFpbiIpJiYhbC5pc1N0cmluZyhlLmRvbWFpbik/ImRvbWFpbjogc3RyaW5nIGV4cGVjdGVkIjpudWxsIT1lLnZlcnNpb24mJmUuaGFzT3duUHJvcGVydHkoInZlcnNpb24iKSYmIShsLmlzSW50ZWdlcihlLnZlcnNpb24pfHxlLnZlcnNpb24mJmwuaXNJbnRlZ2VyKGUudmVyc2lvbi5sb3cpJiZsLmlzSW50ZWdlcihlLnZlcnNpb24uaGlnaCkpPyJ2ZXJzaW9uOiBpbnRlZ2VyfExvbmcgZXhwZWN0ZWQiOm51bGx9LGUuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgYy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90bztyZXR1cm4gbnVsbCE9ZS5kb21haW4mJih0LmRvbWFpbj1TdHJpbmcoZS5kb21haW4pKSxudWxsIT1lLnZlcnNpb24mJihsLkxvbmc/KHQudmVyc2lvbj1sLkxvbmcuZnJvbVZhbHVlKGUudmVyc2lvbikpLnVuc2lnbmVkPSExOiJzdHJpbmciPT10eXBlb2YgZS52ZXJzaW9uP3QudmVyc2lvbj1wYXJzZUludChlLnZlcnNpb24sMTApOiJudW1iZXIiPT10eXBlb2YgZS52ZXJzaW9uP3QudmVyc2lvbj1lLnZlcnNpb246Im9iamVjdCI9PXR5cGVvZiBlLnZlcnNpb24mJih0LnZlcnNpb249bmV3IGwuTG9uZ0JpdHMoZS52ZXJzaW9uLmxvdz4+PjAsZS52ZXJzaW9uLmhpZ2g+Pj4wKS50b051bWJlcigpKSksdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZih0LmRlZmF1bHRzKWlmKG4uZG9tYWluPSIiLGwuTG9uZyl7dmFyIHI9bmV3IGwuTG9uZygwLDAsITEpO24udmVyc2lvbj10LmxvbmdzPT09U3RyaW5nP3IudG9TdHJpbmcoKTp0LmxvbmdzPT09TnVtYmVyP3IudG9OdW1iZXIoKTpyO31lbHNlIG4udmVyc2lvbj10LmxvbmdzPT09U3RyaW5nPyIwIjowO3JldHVybiBudWxsIT1lLmRvbWFpbiYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9tYWluIikmJihuLmRvbWFpbj1lLmRvbWFpbiksbnVsbCE9ZS52ZXJzaW9uJiZlLmhhc093blByb3BlcnR5KCJ2ZXJzaW9uIikmJigibnVtYmVyIj09dHlwZW9mIGUudmVyc2lvbj9uLnZlcnNpb249dC5sb25ncz09PVN0cmluZz9TdHJpbmcoZS52ZXJzaW9uKTplLnZlcnNpb246bi52ZXJzaW9uPXQubG9uZ3M9PT1TdHJpbmc/bC5Mb25nLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUudmVyc2lvbik6dC5sb25ncz09PU51bWJlcj9uZXcgbC5Mb25nQml0cyhlLnZlcnNpb24ubG93Pj4+MCxlLnZlcnNpb24uaGlnaD4+PjApLnRvTnVtYmVyKCk6ZS52ZXJzaW9uKSxufSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci50b09iamVjdCh0aGlzLHMudXRpbC50b0pTT05PcHRpb25zKX0sZS5nZXRUeXBlVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0idHlwZS5nb29nbGVhcGlzLmNvbSIpLGUrIi9vbm54Lk9wZXJhdG9yU2V0SWRQcm90byJ9LGV9KCksaS5PcGVyYXRvclN0YXR1cz1mdW5jdGlvbigpe3ZhciBlPXt9LHQ9T2JqZWN0LmNyZWF0ZShlKTtyZXR1cm4gdFtlWzBdPSJFWFBFUklNRU5UQUwiXT0wLHRbZVsxXT0iU1RBQkxFIl09MSx0fSgpLGkuRnVuY3Rpb25Qcm90bz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYodGhpcy5pbnB1dD1bXSx0aGlzLm91dHB1dD1bXSx0aGlzLmF0dHJpYnV0ZT1bXSx0aGlzLmF0dHJpYnV0ZVByb3RvPVtdLHRoaXMubm9kZT1bXSx0aGlzLm9wc2V0SW1wb3J0PVtdLGUpZm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLG49MDtuPHQubGVuZ3RoOysrbiludWxsIT1lW3Rbbl1dJiYodGhpc1t0W25dXT1lW3Rbbl1dKTt9cmV0dXJuIGUucHJvdG90eXBlLm5hbWU9IiIsZS5wcm90b3R5cGUuaW5wdXQ9bC5lbXB0eUFycmF5LGUucHJvdG90eXBlLm91dHB1dD1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuYXR0cmlidXRlPWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5hdHRyaWJ1dGVQcm90bz1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUubm9kZT1sLmVtcHR5QXJyYXksZS5wcm90b3R5cGUuZG9jU3RyaW5nPSIiLGUucHJvdG90eXBlLm9wc2V0SW1wb3J0PWwuZW1wdHlBcnJheSxlLnByb3RvdHlwZS5kb21haW49IiIsZS5jcmVhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpfSxlLmVuY29kZT1mdW5jdGlvbihlLHQpe2lmKHR8fCh0PXUuY3JlYXRlKCkpLG51bGwhPWUubmFtZSYmT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoZSwibmFtZSIpJiZ0LnVpbnQzMigxMCkuc3RyaW5nKGUubmFtZSksbnVsbCE9ZS5pbnB1dCYmZS5pbnB1dC5sZW5ndGgpZm9yKHZhciBuPTA7bjxlLmlucHV0Lmxlbmd0aDsrK24pdC51aW50MzIoMzQpLnN0cmluZyhlLmlucHV0W25dKTtpZihudWxsIT1lLm91dHB1dCYmZS5vdXRwdXQubGVuZ3RoKWZvcihuPTA7bjxlLm91dHB1dC5sZW5ndGg7KytuKXQudWludDMyKDQyKS5zdHJpbmcoZS5vdXRwdXRbbl0pO2lmKG51bGwhPWUuYXR0cmlidXRlJiZlLmF0dHJpYnV0ZS5sZW5ndGgpZm9yKG49MDtuPGUuYXR0cmlidXRlLmxlbmd0aDsrK24pdC51aW50MzIoNTApLnN0cmluZyhlLmF0dHJpYnV0ZVtuXSk7aWYobnVsbCE9ZS5ub2RlJiZlLm5vZGUubGVuZ3RoKWZvcihuPTA7bjxlLm5vZGUubGVuZ3RoOysrbiljLm9ubnguTm9kZVByb3RvLmVuY29kZShlLm5vZGVbbl0sdC51aW50MzIoNTgpLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS5kb2NTdHJpbmcmJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRvY1N0cmluZyIpJiZ0LnVpbnQzMig2Nikuc3RyaW5nKGUuZG9jU3RyaW5nKSxudWxsIT1lLm9wc2V0SW1wb3J0JiZlLm9wc2V0SW1wb3J0Lmxlbmd0aClmb3Iobj0wO248ZS5vcHNldEltcG9ydC5sZW5ndGg7KytuKWMub25ueC5PcGVyYXRvclNldElkUHJvdG8uZW5jb2RlKGUub3BzZXRJbXBvcnRbbl0sdC51aW50MzIoNzQpLmZvcmsoKSkubGRlbGltKCk7aWYobnVsbCE9ZS5kb21haW4mJk9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsImRvbWFpbiIpJiZ0LnVpbnQzMig4Mikuc3RyaW5nKGUuZG9tYWluKSxudWxsIT1lLmF0dHJpYnV0ZVByb3RvJiZlLmF0dHJpYnV0ZVByb3RvLmxlbmd0aClmb3Iobj0wO248ZS5hdHRyaWJ1dGVQcm90by5sZW5ndGg7KytuKWMub25ueC5BdHRyaWJ1dGVQcm90by5lbmNvZGUoZS5hdHRyaWJ1dGVQcm90b1tuXSx0LnVpbnQzMig5MCkuZm9yaygpKS5sZGVsaW0oKTtyZXR1cm4gdH0sZS5lbmNvZGVEZWxpbWl0ZWQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5lbmNvZGUoZSx0KS5sZGVsaW0oKX0sZS5kZWNvZGU9ZnVuY3Rpb24oZSx0KXtlIGluc3RhbmNlb2YgYXx8KGU9YS5jcmVhdGUoZSkpO2Zvcih2YXIgbj12b2lkIDA9PT10P2UubGVuOmUucG9zK3Qscj1uZXcgYy5vbm54LkZ1bmN0aW9uUHJvdG87ZS5wb3M8bjspe3ZhciBvPWUudWludDMyKCk7c3dpdGNoKG8+Pj4zKXtjYXNlIDE6ci5uYW1lPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA0OnIuaW5wdXQmJnIuaW5wdXQubGVuZ3RofHwoci5pbnB1dD1bXSksci5pbnB1dC5wdXNoKGUuc3RyaW5nKCkpO2JyZWFrO2Nhc2UgNTpyLm91dHB1dCYmci5vdXRwdXQubGVuZ3RofHwoci5vdXRwdXQ9W10pLHIub3V0cHV0LnB1c2goZS5zdHJpbmcoKSk7YnJlYWs7Y2FzZSA2OnIuYXR0cmlidXRlJiZyLmF0dHJpYnV0ZS5sZW5ndGh8fChyLmF0dHJpYnV0ZT1bXSksci5hdHRyaWJ1dGUucHVzaChlLnN0cmluZygpKTticmVhaztjYXNlIDExOnIuYXR0cmlidXRlUHJvdG8mJnIuYXR0cmlidXRlUHJvdG8ubGVuZ3RofHwoci5hdHRyaWJ1dGVQcm90bz1bXSksci5hdHRyaWJ1dGVQcm90by5wdXNoKGMub25ueC5BdHRyaWJ1dGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSA3OnIubm9kZSYmci5ub2RlLmxlbmd0aHx8KHIubm9kZT1bXSksci5ub2RlLnB1c2goYy5vbm54Lk5vZGVQcm90by5kZWNvZGUoZSxlLnVpbnQzMigpKSk7YnJlYWs7Y2FzZSA4OnIuZG9jU3RyaW5nPWUuc3RyaW5nKCk7YnJlYWs7Y2FzZSA5OnIub3BzZXRJbXBvcnQmJnIub3BzZXRJbXBvcnQubGVuZ3RofHwoci5vcHNldEltcG9ydD1bXSksci5vcHNldEltcG9ydC5wdXNoKGMub25ueC5PcGVyYXRvclNldElkUHJvdG8uZGVjb2RlKGUsZS51aW50MzIoKSkpO2JyZWFrO2Nhc2UgMTA6ci5kb21haW49ZS5zdHJpbmcoKTticmVhaztkZWZhdWx0OmUuc2tpcFR5cGUoNyZvKTt9fXJldHVybiByfSxlLmRlY29kZURlbGltaXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGF8fChlPW5ldyBhKGUpKSx0aGlzLmRlY29kZShlLGUudWludDMyKCkpfSxlLnZlcmlmeT1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiAib2JqZWN0IGV4cGVjdGVkIjtpZihudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmIWwuaXNTdHJpbmcoZS5uYW1lKSlyZXR1cm4gIm5hbWU6IHN0cmluZyBleHBlY3RlZCI7aWYobnVsbCE9ZS5pbnB1dCYmZS5oYXNPd25Qcm9wZXJ0eSgiaW5wdXQiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5pbnB1dCkpcmV0dXJuICJpbnB1dDogYXJyYXkgZXhwZWN0ZWQiO2Zvcih2YXIgdD0wO3Q8ZS5pbnB1dC5sZW5ndGg7Kyt0KWlmKCFsLmlzU3RyaW5nKGUuaW5wdXRbdF0pKXJldHVybiAiaW5wdXQ6IHN0cmluZ1tdIGV4cGVjdGVkIn1pZihudWxsIT1lLm91dHB1dCYmZS5oYXNPd25Qcm9wZXJ0eSgib3V0cHV0Iikpe2lmKCFBcnJheS5pc0FycmF5KGUub3V0cHV0KSlyZXR1cm4gIm91dHB1dDogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLm91dHB1dC5sZW5ndGg7Kyt0KWlmKCFsLmlzU3RyaW5nKGUub3V0cHV0W3RdKSlyZXR1cm4gIm91dHB1dDogc3RyaW5nW10gZXhwZWN0ZWQifWlmKG51bGwhPWUuYXR0cmlidXRlJiZlLmhhc093blByb3BlcnR5KCJhdHRyaWJ1dGUiKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5hdHRyaWJ1dGUpKXJldHVybiAiYXR0cmlidXRlOiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUuYXR0cmlidXRlLmxlbmd0aDsrK3QpaWYoIWwuaXNTdHJpbmcoZS5hdHRyaWJ1dGVbdF0pKXJldHVybiAiYXR0cmlidXRlOiBzdHJpbmdbXSBleHBlY3RlZCJ9aWYobnVsbCE9ZS5hdHRyaWJ1dGVQcm90byYmZS5oYXNPd25Qcm9wZXJ0eSgiYXR0cmlidXRlUHJvdG8iKSl7aWYoIUFycmF5LmlzQXJyYXkoZS5hdHRyaWJ1dGVQcm90bykpcmV0dXJuICJhdHRyaWJ1dGVQcm90bzogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLmF0dHJpYnV0ZVByb3RvLmxlbmd0aDsrK3QpaWYobj1jLm9ubnguQXR0cmlidXRlUHJvdG8udmVyaWZ5KGUuYXR0cmlidXRlUHJvdG9bdF0pKXJldHVybiAiYXR0cmlidXRlUHJvdG8uIitufWlmKG51bGwhPWUubm9kZSYmZS5oYXNPd25Qcm9wZXJ0eSgibm9kZSIpKXtpZighQXJyYXkuaXNBcnJheShlLm5vZGUpKXJldHVybiAibm9kZTogYXJyYXkgZXhwZWN0ZWQiO2Zvcih0PTA7dDxlLm5vZGUubGVuZ3RoOysrdClpZihuPWMub25ueC5Ob2RlUHJvdG8udmVyaWZ5KGUubm9kZVt0XSkpcmV0dXJuICJub2RlLiIrbn1pZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJiFsLmlzU3RyaW5nKGUuZG9jU3RyaW5nKSlyZXR1cm4gImRvY1N0cmluZzogc3RyaW5nIGV4cGVjdGVkIjtpZihudWxsIT1lLm9wc2V0SW1wb3J0JiZlLmhhc093blByb3BlcnR5KCJvcHNldEltcG9ydCIpKXtpZighQXJyYXkuaXNBcnJheShlLm9wc2V0SW1wb3J0KSlyZXR1cm4gIm9wc2V0SW1wb3J0OiBhcnJheSBleHBlY3RlZCI7Zm9yKHQ9MDt0PGUub3BzZXRJbXBvcnQubGVuZ3RoOysrdCl7dmFyIG47aWYobj1jLm9ubnguT3BlcmF0b3JTZXRJZFByb3RvLnZlcmlmeShlLm9wc2V0SW1wb3J0W3RdKSlyZXR1cm4gIm9wc2V0SW1wb3J0LiIrbn19cmV0dXJuIG51bGwhPWUuZG9tYWluJiZlLmhhc093blByb3BlcnR5KCJkb21haW4iKSYmIWwuaXNTdHJpbmcoZS5kb21haW4pPyJkb21haW46IHN0cmluZyBleHBlY3RlZCI6bnVsbH0sZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBjLm9ubnguRnVuY3Rpb25Qcm90bylyZXR1cm4gZTt2YXIgdD1uZXcgYy5vbm54LkZ1bmN0aW9uUHJvdG87aWYobnVsbCE9ZS5uYW1lJiYodC5uYW1lPVN0cmluZyhlLm5hbWUpKSxlLmlucHV0KXtpZighQXJyYXkuaXNBcnJheShlLmlucHV0KSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkZ1bmN0aW9uUHJvdG8uaW5wdXQ6IGFycmF5IGV4cGVjdGVkIik7dC5pbnB1dD1bXTtmb3IodmFyIG49MDtuPGUuaW5wdXQubGVuZ3RoOysrbil0LmlucHV0W25dPVN0cmluZyhlLmlucHV0W25dKTt9aWYoZS5vdXRwdXQpe2lmKCFBcnJheS5pc0FycmF5KGUub3V0cHV0KSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkZ1bmN0aW9uUHJvdG8ub3V0cHV0OiBhcnJheSBleHBlY3RlZCIpO2Zvcih0Lm91dHB1dD1bXSxuPTA7bjxlLm91dHB1dC5sZW5ndGg7KytuKXQub3V0cHV0W25dPVN0cmluZyhlLm91dHB1dFtuXSk7fWlmKGUuYXR0cmlidXRlKXtpZighQXJyYXkuaXNBcnJheShlLmF0dHJpYnV0ZSkpdGhyb3cgVHlwZUVycm9yKCIub25ueC5GdW5jdGlvblByb3RvLmF0dHJpYnV0ZTogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5hdHRyaWJ1dGU9W10sbj0wO248ZS5hdHRyaWJ1dGUubGVuZ3RoOysrbil0LmF0dHJpYnV0ZVtuXT1TdHJpbmcoZS5hdHRyaWJ1dGVbbl0pO31pZihlLmF0dHJpYnV0ZVByb3RvKXtpZighQXJyYXkuaXNBcnJheShlLmF0dHJpYnV0ZVByb3RvKSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkZ1bmN0aW9uUHJvdG8uYXR0cmlidXRlUHJvdG86IGFycmF5IGV4cGVjdGVkIik7Zm9yKHQuYXR0cmlidXRlUHJvdG89W10sbj0wO248ZS5hdHRyaWJ1dGVQcm90by5sZW5ndGg7KytuKXtpZigib2JqZWN0IiE9dHlwZW9mIGUuYXR0cmlidXRlUHJvdG9bbl0pdGhyb3cgVHlwZUVycm9yKCIub25ueC5GdW5jdGlvblByb3RvLmF0dHJpYnV0ZVByb3RvOiBvYmplY3QgZXhwZWN0ZWQiKTt0LmF0dHJpYnV0ZVByb3RvW25dPWMub25ueC5BdHRyaWJ1dGVQcm90by5mcm9tT2JqZWN0KGUuYXR0cmlidXRlUHJvdG9bbl0pO319aWYoZS5ub2RlKXtpZighQXJyYXkuaXNBcnJheShlLm5vZGUpKXRocm93IFR5cGVFcnJvcigiLm9ubnguRnVuY3Rpb25Qcm90by5ub2RlOiBhcnJheSBleHBlY3RlZCIpO2Zvcih0Lm5vZGU9W10sbj0wO248ZS5ub2RlLmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5ub2RlW25dKXRocm93IFR5cGVFcnJvcigiLm9ubnguRnVuY3Rpb25Qcm90by5ub2RlOiBvYmplY3QgZXhwZWN0ZWQiKTt0Lm5vZGVbbl09Yy5vbm54Lk5vZGVQcm90by5mcm9tT2JqZWN0KGUubm9kZVtuXSk7fX1pZihudWxsIT1lLmRvY1N0cmluZyYmKHQuZG9jU3RyaW5nPVN0cmluZyhlLmRvY1N0cmluZykpLGUub3BzZXRJbXBvcnQpe2lmKCFBcnJheS5pc0FycmF5KGUub3BzZXRJbXBvcnQpKXRocm93IFR5cGVFcnJvcigiLm9ubnguRnVuY3Rpb25Qcm90by5vcHNldEltcG9ydDogYXJyYXkgZXhwZWN0ZWQiKTtmb3IodC5vcHNldEltcG9ydD1bXSxuPTA7bjxlLm9wc2V0SW1wb3J0Lmxlbmd0aDsrK24pe2lmKCJvYmplY3QiIT10eXBlb2YgZS5vcHNldEltcG9ydFtuXSl0aHJvdyBUeXBlRXJyb3IoIi5vbm54LkZ1bmN0aW9uUHJvdG8ub3BzZXRJbXBvcnQ6IG9iamVjdCBleHBlY3RlZCIpO3Qub3BzZXRJbXBvcnRbbl09Yy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90by5mcm9tT2JqZWN0KGUub3BzZXRJbXBvcnRbbl0pO319cmV0dXJuIG51bGwhPWUuZG9tYWluJiYodC5kb21haW49U3RyaW5nKGUuZG9tYWluKSksdH0sZS50b09iamVjdD1mdW5jdGlvbihlLHQpe3R8fCh0PXt9KTt2YXIgbj17fTtpZigodC5hcnJheXN8fHQuZGVmYXVsdHMpJiYobi5pbnB1dD1bXSxuLm91dHB1dD1bXSxuLmF0dHJpYnV0ZT1bXSxuLm5vZGU9W10sbi5vcHNldEltcG9ydD1bXSxuLmF0dHJpYnV0ZVByb3RvPVtdKSx0LmRlZmF1bHRzJiYobi5uYW1lPSIiLG4uZG9jU3RyaW5nPSIiLG4uZG9tYWluPSIiKSxudWxsIT1lLm5hbWUmJmUuaGFzT3duUHJvcGVydHkoIm5hbWUiKSYmKG4ubmFtZT1lLm5hbWUpLGUuaW5wdXQmJmUuaW5wdXQubGVuZ3RoKXtuLmlucHV0PVtdO2Zvcih2YXIgcj0wO3I8ZS5pbnB1dC5sZW5ndGg7KytyKW4uaW5wdXRbcl09ZS5pbnB1dFtyXTt9aWYoZS5vdXRwdXQmJmUub3V0cHV0Lmxlbmd0aClmb3Iobi5vdXRwdXQ9W10scj0wO3I8ZS5vdXRwdXQubGVuZ3RoOysrciluLm91dHB1dFtyXT1lLm91dHB1dFtyXTtpZihlLmF0dHJpYnV0ZSYmZS5hdHRyaWJ1dGUubGVuZ3RoKWZvcihuLmF0dHJpYnV0ZT1bXSxyPTA7cjxlLmF0dHJpYnV0ZS5sZW5ndGg7KytyKW4uYXR0cmlidXRlW3JdPWUuYXR0cmlidXRlW3JdO2lmKGUubm9kZSYmZS5ub2RlLmxlbmd0aClmb3Iobi5ub2RlPVtdLHI9MDtyPGUubm9kZS5sZW5ndGg7KytyKW4ubm9kZVtyXT1jLm9ubnguTm9kZVByb3RvLnRvT2JqZWN0KGUubm9kZVtyXSx0KTtpZihudWxsIT1lLmRvY1N0cmluZyYmZS5oYXNPd25Qcm9wZXJ0eSgiZG9jU3RyaW5nIikmJihuLmRvY1N0cmluZz1lLmRvY1N0cmluZyksZS5vcHNldEltcG9ydCYmZS5vcHNldEltcG9ydC5sZW5ndGgpZm9yKG4ub3BzZXRJbXBvcnQ9W10scj0wO3I8ZS5vcHNldEltcG9ydC5sZW5ndGg7KytyKW4ub3BzZXRJbXBvcnRbcl09Yy5vbm54Lk9wZXJhdG9yU2V0SWRQcm90by50b09iamVjdChlLm9wc2V0SW1wb3J0W3JdLHQpO2lmKG51bGwhPWUuZG9tYWluJiZlLmhhc093blByb3BlcnR5KCJkb21haW4iKSYmKG4uZG9tYWluPWUuZG9tYWluKSxlLmF0dHJpYnV0ZVByb3RvJiZlLmF0dHJpYnV0ZVByb3RvLmxlbmd0aClmb3Iobi5hdHRyaWJ1dGVQcm90bz1bXSxyPTA7cjxlLmF0dHJpYnV0ZVByb3RvLmxlbmd0aDsrK3Ipbi5hdHRyaWJ1dGVQcm90b1tyXT1jLm9ubnguQXR0cmlidXRlUHJvdG8udG9PYmplY3QoZS5hdHRyaWJ1dGVQcm90b1tyXSx0KTtyZXR1cm4gbn0sZS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9PYmplY3QodGhpcyxzLnV0aWwudG9KU09OT3B0aW9ucyl9LGUuZ2V0VHlwZVVybD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9InR5cGUuZ29vZ2xlYXBpcy5jb20iKSxlKyIvb25ueC5GdW5jdGlvblByb3RvIn0sZX0oKSxpKSxlLmV4cG9ydHM9Yzt9LDM0NzQ6KGUsdCxuKT0+e3ZhciByLG89KHI9InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmZG9jdW1lbnQuY3VycmVudFNjcmlwdD9kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYzp2b2lkIDAsInVuZGVmaW5lZCIhPXR5cGVvZiBfX2ZpbGVuYW1lJiYocj1yfHxfX2ZpbGVuYW1lKSxmdW5jdGlvbihlPXt9KXtmdW5jdGlvbiB0KCl7cmV0dXJuICQuYnVmZmVyIT1qLmJ1ZmZlciYmQigpLGp9ZnVuY3Rpb24gbygpe3JldHVybiAkLmJ1ZmZlciE9ai5idWZmZXImJkIoKSxSfWZ1bmN0aW9uIGkoKXtyZXR1cm4gJC5idWZmZXIhPWouYnVmZmVyJiZCKCksTH1mdW5jdGlvbiBzKCl7cmV0dXJuICQuYnVmZmVyIT1qLmJ1ZmZlciYmQigpLEN9ZnVuY3Rpb24gYSgpe3JldHVybiAkLmJ1ZmZlciE9ai5idWZmZXImJkIoKSxNfXZhciB1LGwsYz1lO2MucmVhZHk9bmV3IFByb21pc2UoKChlLHQpPT57dT1lLGw9dDt9KSk7dmFyIHAsZCxmLGg9T2JqZWN0LmFzc2lnbih7fSxjKSxnPSIuL3RoaXMucHJvZ3JhbSIsYj0oZSx0KT0+e3Rocm93IHR9LG09Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cseT0iZnVuY3Rpb24iPT10eXBlb2YgaW1wb3J0U2NyaXB0cyx2PSJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzLnZlcnNpb25zJiYic3RyaW5nIj09dHlwZW9mIHByb2Nlc3MudmVyc2lvbnMubm9kZSxfPWMuRU5WSVJPTk1FTlRfSVNfUFRIUkVBRHx8ITEsdz0iIjtmdW5jdGlvbiBUKGUpe3JldHVybiBjLmxvY2F0ZUZpbGU/Yy5sb2NhdGVGaWxlKGUsdyk6dytlfWlmKHYpe3ZhciB4PW4oMTM4NCksTz1uKDkwOCk7bGV0IHQ7dz15P08uZGlybmFtZSh3KSsiLyI6X19kaXJuYW1lKyIvIixwPShlLHQpPT4oZT1lLnN0YXJ0c1dpdGgoImZpbGU6Ly8iKT9uZXcgVVJMKGUpOk8ubm9ybWFsaXplKGUpLHgucmVhZEZpbGVTeW5jKGUsdD92b2lkIDA6InV0ZjgiKSksZj1lPT4oKGU9cChlLCEwKSkuYnVmZmVyfHwoZT1uZXcgVWludDhBcnJheShlKSksZSksZD0oZSx0LG4scj0hMCk9PntlPWUuc3RhcnRzV2l0aCgiZmlsZTovLyIpP25ldyBVUkwoZSk6Ty5ub3JtYWxpemUoZSkseC5yZWFkRmlsZShlLHI/dm9pZCAwOiJ1dGY4IiwoKGUsbyk9PntlP24oZSk6dChyP28uYnVmZmVyOm8pO30pKTt9LCFjLnRoaXNQcm9ncmFtJiYxPHByb2Nlc3MuYXJndi5sZW5ndGgmJihnPXByb2Nlc3MuYXJndlsxXS5yZXBsYWNlKC9cXC9nLCIvIikpLHByb2Nlc3MuYXJndi5zbGljZSgyKSxiPShlLHQpPT57dGhyb3cgcHJvY2Vzcy5leGl0Q29kZT1lLHR9LGMuaW5zcGVjdD0oKT0+IltFbXNjcmlwdGVuIE1vZHVsZSBvYmplY3RdIjt0cnl7dD1uKDk5MjUpO31jYXRjaChlKXt0aHJvdyBjb25zb2xlLmVycm9yKCdUaGUgIndvcmtlcl90aHJlYWRzIiBtb2R1bGUgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIG5vZGUuanMgYnVpbGQgLSBwZXJoYXBzIGEgbmV3ZXIgdmVyc2lvbiBpcyBuZWVkZWQ/JyksZX1jb21tb25qc0dsb2JhbC5Xb3JrZXI9dC5Xb3JrZXI7fWVsc2UgKG18fHkpJiYoeT93PXNlbGYubG9jYXRpb24uaHJlZjoidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5jdXJyZW50U2NyaXB0JiYodz1kb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYyksciYmKHc9ciksdz0wIT09dy5pbmRleE9mKCJibG9iOiIpP3cuc3Vic3RyKDAsdy5yZXBsYWNlKC9bPyNdLiovLCIiKS5sYXN0SW5kZXhPZigiLyIpKzEpOiIiLHZ8fChwPWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQobnVsbCksdC5yZXNwb25zZVRleHR9LHkmJihmPWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLHQuc2VuZChudWxsKSxuZXcgVWludDhBcnJheSh0LnJlc3BvbnNlKX0pLGQ9KGUsdCxuKT0+e3ZhciByPW5ldyBYTUxIdHRwUmVxdWVzdDtyLm9wZW4oIkdFVCIsZSwhMCksci5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixyLm9ubG9hZD0oKT0+ezIwMD09ci5zdGF0dXN8fDA9PXIuc3RhdHVzJiZyLnJlc3BvbnNlP3Qoci5yZXNwb25zZSk6bigpO30sci5vbmVycm9yPW4sci5zZW5kKG51bGwpO30pKTt2JiYidW5kZWZpbmVkIj09dHlwZW9mIHBlcmZvcm1hbmNlJiYoY29tbW9uanNHbG9iYWwucGVyZm9ybWFuY2U9big2OTUzKS5wZXJmb3JtYW5jZSk7dmFyIFM9Y29uc29sZS5sb2cuYmluZChjb25zb2xlKSxBPWNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKTt2JiYoUz0oLi4uZSk9Pngud3JpdGVTeW5jKDEsZS5qb2luKCIgIikrIlxuIiksQT0oLi4uZSk9Pngud3JpdGVTeW5jKDIsZS5qb2luKCIgIikrIlxuIikpO3ZhciBQLEk9Yy5wcmludHx8UyxFPWMucHJpbnRFcnJ8fEE7T2JqZWN0LmFzc2lnbihjLGgpLGg9bnVsbCxjLnRoaXNQcm9ncmFtJiYoZz1jLnRoaXNQcm9ncmFtKSxjLnF1aXQmJihiPWMucXVpdCksYy53YXNtQmluYXJ5JiYoUD1jLndhc21CaW5hcnkpO3ZhciBEPWMubm9FeGl0UnVudGltZXx8ITA7Im9iamVjdCIhPXR5cGVvZiBXZWJBc3NlbWJseSYmbmUoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKTt2YXIgJCxrLEYsTixqLFIsTCxDLE0sVT0hMTtmdW5jdGlvbiBCKCl7dmFyIGU9JC5idWZmZXI7Yy5IRUFQOD1qPW5ldyBJbnQ4QXJyYXkoZSksYy5IRUFQMTY9bmV3IEludDE2QXJyYXkoZSksYy5IRUFQMzI9TD1uZXcgSW50MzJBcnJheShlKSxjLkhFQVBVOD1SPW5ldyBVaW50OEFycmF5KGUpLGMuSEVBUFUxNj1uZXcgVWludDE2QXJyYXkoZSksYy5IRUFQVTMyPUM9bmV3IFVpbnQzMkFycmF5KGUpLGMuSEVBUEYzMj1uZXcgRmxvYXQzMkFycmF5KGUpLGMuSEVBUEY2ND1NPW5ldyBGbG9hdDY0QXJyYXkoZSk7fXZhciBWPWMuSU5JVElBTF9NRU1PUll8fDE2Nzc3MjE2O2lmKDUyNDI4ODA8PVZ8fG5lKCJJTklUSUFMX01FTU9SWSBzaG91bGQgYmUgbGFyZ2VyIHRoYW4gU1RBQ0tfU0laRSwgd2FzICIrVisiISAoU1RBQ0tfU0laRT01MjQyODgwKSIpLF8pJD1jLndhc21NZW1vcnk7ZWxzZSBpZihjLndhc21NZW1vcnkpJD1jLndhc21NZW1vcnk7ZWxzZSBpZighKCgkPW5ldyBXZWJBc3NlbWJseS5NZW1vcnkoe2luaXRpYWw6Vi82NTUzNixtYXhpbXVtOjY1NTM2LHNoYXJlZDohMH0pKS5idWZmZXIgaW5zdGFuY2VvZiBTaGFyZWRBcnJheUJ1ZmZlcikpdGhyb3cgRSgicmVxdWVzdGVkIGEgc2hhcmVkIFdlYkFzc2VtYmx5Lk1lbW9yeSBidXQgdGhlIHJldHVybmVkIGJ1ZmZlciBpcyBub3QgYSBTaGFyZWRBcnJheUJ1ZmZlciwgaW5kaWNhdGluZyB0aGF0IHdoaWxlIHRoZSBicm93c2VyIGhhcyBTaGFyZWRBcnJheUJ1ZmZlciBpdCBkb2VzIG5vdCBoYXZlIFdlYkFzc2VtYmx5IHRocmVhZHMgc3VwcG9ydCAtIHlvdSBtYXkgbmVlZCB0byBzZXQgYSBmbGFnIiksdiYmRSgiKG9uIG5vZGUgeW91IG1heSBuZWVkOiAtLWV4cGVyaW1lbnRhbC13YXNtLXRocmVhZHMgLS1leHBlcmltZW50YWwtd2FzbS1idWxrLW1lbW9yeSBhbmQvb3IgcmVjZW50IHZlcnNpb24pIiksRXJyb3IoImJhZCBtZW1vcnkiKTtCKCksVj0kLmJ1ZmZlci5ieXRlTGVuZ3RoO3ZhciB6LEc9W10sSD1bXSxXPVtdLHE9MDtmdW5jdGlvbiBYKCl7cmV0dXJuIER8fDA8cX12YXIgWSxLLEo9MCxRPW51bGw7ZnVuY3Rpb24gZWUoKXtKKyssYy5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZjLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoSik7fWZ1bmN0aW9uIHRlKCl7aWYoSi0tLGMubW9uaXRvclJ1bkRlcGVuZGVuY2llcyYmYy5tb25pdG9yUnVuRGVwZW5kZW5jaWVzKEopLDA9PUomJihRKSl7dmFyIGU9UTtRPW51bGwsZSgpO319ZnVuY3Rpb24gbmUoZSl7dGhyb3cgYy5vbkFib3J0JiZjLm9uQWJvcnQoZSksRShlPSJBYm9ydGVkKCIrZSsiKSIpLFU9ITAsTj0xLGU9bmV3IFdlYkFzc2VtYmx5LlJ1bnRpbWVFcnJvcihlKyIuIEJ1aWxkIHdpdGggLXNBU1NFUlRJT05TIGZvciBtb3JlIGluZm8uIiksbChlKSxlfWZ1bmN0aW9uIHJlKGUpe3JldHVybiBlLnN0YXJ0c1dpdGgoImRhdGE6YXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtO2Jhc2U2NCwiKX1mdW5jdGlvbiBvZShlKXtpZihlPT1ZJiZQKXJldHVybiBuZXcgVWludDhBcnJheShQKTtpZihmKXJldHVybiBmKGUpO3Rocm93ICJib3RoIGFzeW5jIGFuZCBzeW5jIGZldGNoaW5nIG9mIHRoZSB3YXNtIGZhaWxlZCJ9ZnVuY3Rpb24gaWUoZSx0LG4pe3JldHVybiBmdW5jdGlvbihlKXtpZighUCYmKG18fHkpKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgZmV0Y2gmJiFlLnN0YXJ0c1dpdGgoImZpbGU6Ly8iKSlyZXR1cm4gZmV0Y2goZSx7Y3JlZGVudGlhbHM6InNhbWUtb3JpZ2luIn0pLnRoZW4oKHQ9PntpZighdC5vayl0aHJvdyAiZmFpbGVkIHRvIGxvYWQgd2FzbSBiaW5hcnkgZmlsZSBhdCAnIitlKyInIjtyZXR1cm4gdC5hcnJheUJ1ZmZlcigpfSkpLmNhdGNoKCgoKT0+b2UoZSkpKTtpZihkKXJldHVybiBuZXcgUHJvbWlzZSgoKHQsbik9PntkKGUsKGU9PnQobmV3IFVpbnQ4QXJyYXkoZSkpKSxuKTt9KSl9cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCgpPT5vZShlKSkpfShlKS50aGVuKChlPT5XZWJBc3NlbWJseS5pbnN0YW50aWF0ZShlLHQpKSkudGhlbigoZT0+ZSkpLnRoZW4obiwoZT0+e0UoImZhaWxlZCB0byBhc3luY2hyb25vdXNseSBwcmVwYXJlIHdhc206ICIrZSksbmUoZSk7fSkpfWZ1bmN0aW9uIHNlKGUpe3RoaXMubmFtZT0iRXhpdFN0YXR1cyIsdGhpcy5tZXNzYWdlPWBQcm9ncmFtIHRlcm1pbmF0ZWQgd2l0aCBleGl0KCR7ZX0pYCx0aGlzLnN0YXR1cz1lO31mdW5jdGlvbiBhZShlKXtlLnRlcm1pbmF0ZSgpLGUub25tZXNzYWdlPSgpPT57fTt9ZnVuY3Rpb24gdWUoZSl7KGU9Z2UuRmFbZV0pfHxuZSgpLGdlLmZiKGUpO31mdW5jdGlvbiBsZShlKXt2YXIgdD1nZS5aYSgpO2lmKCF0KXJldHVybiA2O2dlLklhLnB1c2godCksZ2UuRmFbZS5IYV09dCx0LkhhPWUuSGE7dmFyIG49e2NtZDoicnVuIixzdGFydF9yb3V0aW5lOmUuZ2IsYXJnOmUuWWEscHRocmVhZF9wdHI6ZS5IYX07cmV0dXJuIHYmJnQudW5yZWYoKSx0LnBvc3RNZXNzYWdlKG4sZS5tYiksMH1yZShZPSJvcnQtd2FzbS10aHJlYWRlZC53YXNtIil8fChZPVQoWSkpO3ZhciBjZT0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMCxwZT0oZSx0LG4pPT57dmFyIHI9KHQ+Pj49MCkrbjtmb3Iobj10O2Vbbl0mJiEobj49cik7KSsrbjtpZigxNjxuLXQmJmUuYnVmZmVyJiZjZSlyZXR1cm4gY2UuZGVjb2RlKGUuYnVmZmVyIGluc3RhbmNlb2YgU2hhcmVkQXJyYXlCdWZmZXI/ZS5zbGljZSh0LG4pOmUuc3ViYXJyYXkodCxuKSk7Zm9yKHI9IiI7dDxuOyl7dmFyIG89ZVt0KytdO2lmKDEyOCZvKXt2YXIgaT02MyZlW3QrK107aWYoMTkyPT0oMjI0Jm8pKXIrPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJm8pPDw2fGkpO2Vsc2Uge3ZhciBzPTYzJmVbdCsrXTs2NTUzNj4obz0yMjQ9PSgyNDAmbyk/KDE1Jm8pPDwxMnxpPDw2fHM6KDcmbyk8PDE4fGk8PDEyfHM8PDZ8NjMmZVt0KytdKT9yKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8pOihvLT02NTUzNixyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2fG8+PjEwLDU2MzIwfDEwMjMmbykpO319ZWxzZSByKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8pO31yZXR1cm4gcn0sZGU9KGUsdCk9PihlPj4+PTApP3BlKG8oKSxlLHQpOiIiO2Z1bmN0aW9uIGZlKGUpe2lmKF8pcmV0dXJuIFhlKDEsMSxlKTtOPWUsWCgpfHwoZ2UuaGIoKSxjLm9uRXhpdCYmYy5vbkV4aXQoZSksVT0hMCksYihlLG5ldyBzZShlKSk7fXZhciBoZT1lPT57aWYoTj1lLF8pdGhyb3cgbWUoZSksInVud2luZCI7ZmUoZSk7fSxnZT17TGE6W10sSWE6W10sVGE6W10sRmE6e30sUGE6ZnVuY3Rpb24oKXtfP2dlLmFiKCk6Z2UuJGEoKTt9LCRhOmZ1bmN0aW9uKCl7Ry51bnNoaWZ0KCgoKT0+e2VlKCksZ2UuYmIoKCgpPT50ZSgpKSk7fSkpO30sYWI6ZnVuY3Rpb24oKXtnZS5yZWNlaXZlT2JqZWN0VHJhbnNmZXI9Z2UuZWIsZ2UudGhyZWFkSW5pdFRMUz1nZS5TYSxnZS5zZXRFeGl0U3RhdHVzPWdlLlJhLEQ9ITE7fSxSYTpmdW5jdGlvbihlKXtOPWU7fSxyYjpbIiR0ZXJtaW5hdGVXb3JrZXIiXSxoYjpmdW5jdGlvbigpe2Zvcih2YXIgZSBvZiBnZS5JYSlhZShlKTtmb3IoZSBvZiBnZS5MYSlhZShlKTtnZS5MYT1bXSxnZS5JYT1bXSxnZS5GYT1bXTt9LGZiOmZ1bmN0aW9uKGUpe3ZhciB0PWUuSGE7ZGVsZXRlIGdlLkZhW3RdLGdlLkxhLnB1c2goZSksZ2UuSWEuc3BsaWNlKGdlLklhLmluZGV4T2YoZSksMSksZS5IYT0wLHl0KHQpO30sZWI6ZnVuY3Rpb24oKXt9LFNhOmZ1bmN0aW9uKCl7Z2UuVGEuZm9yRWFjaCgoZT0+ZSgpKSk7fSxjYjplPT5uZXcgUHJvbWlzZSgodD0+e2Uub25tZXNzYWdlPW49Pnt2YXIgcj0obj1uLmRhdGEpLmNtZDtpZihuLnRhcmdldFRocmVhZCYmbi50YXJnZXRUaHJlYWQhPWZ0KCkpe3ZhciBvPWdlLkZhW24ucWJdO28/by5wb3N0TWVzc2FnZShuLG4udHJhbnNmZXJMaXN0KTpFKCdJbnRlcm5hbCBlcnJvciEgV29ya2VyIHNlbnQgYSBtZXNzYWdlICInK3IrJyIgdG8gdGFyZ2V0IHB0aHJlYWQgJytuLnRhcmdldFRocmVhZCsiLCBidXQgdGhhdCB0aHJlYWQgbm8gbG9uZ2VyIGV4aXN0cyEiKTt9ZWxzZSAiY2hlY2tNYWlsYm94Ij09PXI/VWUoKToic3Bhd25UaHJlYWQiPT09cj9sZShuKToiY2xlYW51cFRocmVhZCI9PT1yP3VlKG4udGhyZWFkKToia2lsbFRocmVhZCI9PT1yPyhuPW4udGhyZWFkLHI9Z2UuRmFbbl0sZGVsZXRlIGdlLkZhW25dLGFlKHIpLHl0KG4pLGdlLklhLnNwbGljZShnZS5JYS5pbmRleE9mKHIpLDEpLHIuSGE9MCk6ImNhbmNlbFRocmVhZCI9PT1yP2dlLkZhW24udGhyZWFkXS5wb3N0TWVzc2FnZSh7Y21kOiJjYW5jZWwifSk6ImxvYWRlZCI9PT1yPyhlLmxvYWRlZD0hMCx0KGUpKToiYWxlcnQiPT09cj9hbGVydCgiVGhyZWFkICIrbi50aHJlYWRJZCsiOiAiK24udGV4dCk6InNldGltbWVkaWF0ZSI9PT1uLnRhcmdldD9lLnBvc3RNZXNzYWdlKG4pOiJjYWxsSGFuZGxlciI9PT1yP2Nbbi5oYW5kbGVyXSguLi5uLmFyZ3MpOnImJkUoIndvcmtlciBzZW50IGFuIHVua25vd24gY29tbWFuZCAiK3IpO30sZS5vbmVycm9yPWU9Pnt0aHJvdyBFKCJ3b3JrZXIgc2VudCBhbiBlcnJvciEgIitlLmZpbGVuYW1lKyI6IitlLmxpbmVubysiOiAiK2UubWVzc2FnZSksZX0sdiYmKGUub24oIm1lc3NhZ2UiLChmdW5jdGlvbih0KXtlLm9ubWVzc2FnZSh7ZGF0YTp0fSk7fSkpLGUub24oImVycm9yIiwoZnVuY3Rpb24odCl7ZS5vbmVycm9yKHQpO30pKSk7dmFyIG4sbz1bXTtmb3IobiBvZiBbIm9uRXhpdCIsIm9uQWJvcnQiLCJwcmludCIsInByaW50RXJyIl0pYy5oYXNPd25Qcm9wZXJ0eShuKSYmby5wdXNoKG4pO2UucG9zdE1lc3NhZ2Uoe2NtZDoibG9hZCIsaGFuZGxlcnM6byx1cmxPckJsb2I6Yy5tYWluU2NyaXB0VXJsT3JCbG9ifHxyLHdhc21NZW1vcnk6JCx3YXNtTW9kdWxlOkZ9KTt9KSksYmI6ZnVuY3Rpb24oZSl7ZSgpO30sWGE6ZnVuY3Rpb24oKXt2YXIgZT1UKCJvcnQtd2FzbS10aHJlYWRlZC53b3JrZXIuanMiKTtlPW5ldyBXb3JrZXIoZSksZ2UuTGEucHVzaChlKTt9LFphOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PWdlLkxhLmxlbmd0aCYmKGdlLlhhKCksZ2UuY2IoZ2UuTGFbMF0pKSxnZS5MYS5wb3AoKX19O2MuUFRocmVhZD1nZTt2YXIgYmU9ZT0+e2Zvcig7MDxlLmxlbmd0aDspZS5zaGlmdCgpKGMpO307ZnVuY3Rpb24gbWUoZSl7aWYoXylyZXR1cm4gWGUoMiwwLGUpO2hlKGUpO31jLmVzdGFibGlzaFN0YWNrU3BhY2U9ZnVuY3Rpb24oKXt2YXIgZT1mdCgpLHQ9aSgpW2UrNTI+PjI+Pj4wXTtlPWkoKVtlKzU2Pj4yPj4+MF0sVHQodCx0LWUpLE90KHQpO307dmFyIHllPVtdO2Z1bmN0aW9uIHZlKGUpe3RoaXMuT2E9ZS0yNCx0aGlzLldhPWZ1bmN0aW9uKGUpe3MoKVt0aGlzLk9hKzQ+PjI+Pj4wXT1lO30sdGhpcy5WYT1mdW5jdGlvbihlKXtzKClbdGhpcy5PYSs4Pj4yPj4+MF09ZTt9LHRoaXMuUGE9ZnVuY3Rpb24oZSx0KXt0aGlzLlVhKCksdGhpcy5XYShlKSx0aGlzLlZhKHQpO30sdGhpcy5VYT1mdW5jdGlvbigpe3MoKVt0aGlzLk9hKzE2Pj4yPj4+MF09MDt9O31mdW5jdGlvbiBfZShlLHQsbixyKXtyZXR1cm4gXz9YZSgzLDEsZSx0LG4scik6d2UoZSx0LG4scil9ZnVuY3Rpb24gd2UoZSx0LG4scil7aWYoZT4+Pj0wLHQ+Pj49MCxuPj4+PTAscj4+Pj0wLCJ1bmRlZmluZWQiPT10eXBlb2YgU2hhcmVkQXJyYXlCdWZmZXIpcmV0dXJuIEUoIkN1cnJlbnQgZW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCBTaGFyZWRBcnJheUJ1ZmZlciwgcHRocmVhZHMgYXJlIG5vdCBhdmFpbGFibGUhIiksNjt2YXIgbz1bXTtyZXR1cm4gXyYmMD09PW8ubGVuZ3RoP19lKGUsdCxuLHIpOihlPXtnYjpuLEhhOmUsWWE6cixtYjpvfSxfPyhlLm9iPSJzcGF3blRocmVhZCIscG9zdE1lc3NhZ2UoZSxvKSwwKTpsZShlKSl9ZnVuY3Rpb24gVGUoZSx0LG4pe3JldHVybiBfP1hlKDQsMSxlLHQsbik6MH1mdW5jdGlvbiB4ZShlLHQpe2lmKF8pcmV0dXJuIFhlKDUsMSxlLHQpfWMuaW52b2tlRW50cnlQb2ludD1mdW5jdGlvbihlLHQpe3ZhciBuPXllW2VdO258fChlPj15ZS5sZW5ndGgmJih5ZS5sZW5ndGg9ZSsxKSx5ZVtlXT1uPXouZ2V0KGUpKSxlPW4odCksWCgpP2dlLlJhKGUpOnZ0KGUpO307dmFyIE9lPWU9Pntmb3IodmFyIHQ9MCxuPTA7bjxlLmxlbmd0aDsrK24pe3ZhciByPWUuY2hhckNvZGVBdChuKTsxMjc+PXI/dCsrOjIwNDc+PXI/dCs9Mjo1NTI5Njw9ciYmNTczNDM+PXI/KHQrPTQsKytuKTp0Kz0zO31yZXR1cm4gdH0sU2U9KGUsdCxuLHIpPT57aWYoISgwPHIpKXJldHVybiAwO3ZhciBvPW4+Pj49MDtyPW4rci0xO2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7KytpKXt2YXIgcz1lLmNoYXJDb2RlQXQoaSk7aWYoNTUyOTY8PXMmJjU3MzQzPj1zJiYocz02NTUzNisoKDEwMjMmcyk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK2kpKSwxMjc+PXMpe2lmKG4+PXIpYnJlYWs7dFtuKys+Pj4wXT1zO31lbHNlIHtpZigyMDQ3Pj1zKXtpZihuKzE+PXIpYnJlYWs7dFtuKys+Pj4wXT0xOTJ8cz4+Njt9ZWxzZSB7aWYoNjU1MzU+PXMpe2lmKG4rMj49cilicmVhazt0W24rKz4+PjBdPTIyNHxzPj4xMjt9ZWxzZSB7aWYobiszPj1yKWJyZWFrO3RbbisrPj4+MF09MjQwfHM+PjE4LHRbbisrPj4+MF09MTI4fHM+PjEyJjYzO310W24rKz4+PjBdPTEyOHxzPj42JjYzO310W24rKz4+PjBdPTEyOHw2MyZzO319cmV0dXJuIHRbbj4+PjBdPTAsbi1vfSxBZT0oZSx0LG4pPT5TZShlLG8oKSx0LG4pO2Z1bmN0aW9uIFBlKGUsdCl7aWYoXylyZXR1cm4gWGUoNiwxLGUsdCl9ZnVuY3Rpb24gSWUoZSx0LG4pe2lmKF8pcmV0dXJuIFhlKDcsMSxlLHQsbil9ZnVuY3Rpb24gRWUoZSx0LG4pe3JldHVybiBfP1hlKDgsMSxlLHQsbik6MH1mdW5jdGlvbiBEZShlLHQpe2lmKF8pcmV0dXJuIFhlKDksMSxlLHQpfWZ1bmN0aW9uICRlKGUsdCxuKXtpZihfKXJldHVybiBYZSgxMCwxLGUsdCxuKX1mdW5jdGlvbiBrZShlLHQsbixyKXtpZihfKXJldHVybiBYZSgxMSwxLGUsdCxuLHIpfWZ1bmN0aW9uIEZlKGUsdCxuLHIpe2lmKF8pcmV0dXJuIFhlKDEyLDEsZSx0LG4scil9ZnVuY3Rpb24gTmUoZSx0LG4scil7aWYoXylyZXR1cm4gWGUoMTMsMSxlLHQsbixyKX1mdW5jdGlvbiBqZShlKXtpZihfKXJldHVybiBYZSgxNCwxLGUpfWZ1bmN0aW9uIFJlKGUsdCl7aWYoXylyZXR1cm4gWGUoMTUsMSxlLHQpfWZ1bmN0aW9uIExlKGUsdCxuKXtpZihfKXJldHVybiBYZSgxNiwxLGUsdCxuKX12YXIgQ2U9ZT0+e2lmKCFVKXRyeXtpZihlKCksIVgoKSl0cnl7Xz92dChOKTpoZShOKTt9Y2F0Y2goZSl7ZSBpbnN0YW5jZW9mIHNlfHwidW53aW5kIj09ZXx8YigxLGUpO319Y2F0Y2goZSl7ZSBpbnN0YW5jZW9mIHNlfHwidW53aW5kIj09ZXx8YigxLGUpO319O2Z1bmN0aW9uIE1lKGUpe2U+Pj49MCwiZnVuY3Rpb24iPT10eXBlb2YgQXRvbWljcy5uYiYmKEF0b21pY3MubmIoaSgpLGU+PjIsZSkudmFsdWUudGhlbihVZSksZSs9MTI4LEF0b21pY3Muc3RvcmUoaSgpLGU+PjIsMSkpO31mdW5jdGlvbiBVZSgpe3ZhciBlPWZ0KCk7ZSYmKE1lKGUpLENlKCgoKT0+X3QoKSkpKTt9Yy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX21haWxib3hfYXdhaXQ9TWUsYy5jaGVja01haWxib3g9VWU7dmFyIEJlPWU9PjA9PWUlNCYmKDAhPWUlMTAwfHwwPT1lJTQwMCksVmU9WzAsMzEsNjAsOTEsMTIxLDE1MiwxODIsMjEzLDI0NCwyNzQsMzA1LDMzNV0semU9WzAsMzEsNTksOTAsMTIwLDE1MSwxODEsMjEyLDI0MywyNzMsMzA0LDMzNF07ZnVuY3Rpb24gR2UoZSx0LG4scixvLGkscyxhKXtyZXR1cm4gXz9YZSgxNywxLGUsdCxuLHIsbyxpLHMsYSk6LTUyfWZ1bmN0aW9uIEhlKGUsdCxuLHIsbyxpLHMpe2lmKF8pcmV0dXJuIFhlKDE4LDEsZSx0LG4scixvLGkscyl9dmFyIFdlPWU9Pnt2YXIgdD1PZShlKSsxLG49aHQodCk7cmV0dXJuIG4mJkFlKGUsbix0KSxufSxxZT1lPT57dmFyIHQ9eHQoKTtyZXR1cm4gZT1lKCksT3QodCksZX07ZnVuY3Rpb24gWGUoZSx0KXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoLTIscj1hcmd1bWVudHM7cmV0dXJuIHFlKCgoKT0+e2Zvcih2YXIgbz1TdCg4Km4pLGk9bz4+MyxzPTA7czxuO3MrKyl7dmFyIHU9clsyK3NdO2EoKVtpK3M+Pj4wXT11O31yZXR1cm4gbXQoZSxuLG8sdCl9KSl9dmFyIFllLEtlPVtdLEplPXt9LFplPSgpPT57aWYoIVllKXt2YXIgZSx0PXtVU0VSOiJ3ZWJfdXNlciIsTE9HTkFNRToid2ViX3VzZXIiLFBBVEg6Ii8iLFBXRDoiLyIsSE9NRToiL2hvbWUvd2ViX3VzZXIiLExBTkc6KCJvYmplY3QiPT10eXBlb2YgbmF2aWdhdG9yJiZuYXZpZ2F0b3IubGFuZ3VhZ2VzJiZuYXZpZ2F0b3IubGFuZ3VhZ2VzWzBdfHwiQyIpLnJlcGxhY2UoIi0iLCJfIikrIi5VVEYtOCIsXzpnfHwiLi90aGlzLnByb2dyYW0ifTtmb3IoZSBpbiBKZSl2b2lkIDA9PT1KZVtlXT9kZWxldGUgdFtlXTp0W2VdPUplW2VdO3ZhciBuPVtdO2ZvcihlIGluIHQpbi5wdXNoKGAke2V9PSR7dFtlXX1gKTtZZT1uO31yZXR1cm4gWWV9O2Z1bmN0aW9uIFFlKGUsbil7aWYoXylyZXR1cm4gWGUoMTksMSxlLG4pO2U+Pj49MCxuPj4+PTA7dmFyIHI9MDtyZXR1cm4gWmUoKS5mb3JFYWNoKChmdW5jdGlvbihvLGkpe3ZhciBhPW4rcjtmb3IoaT1zKClbZSs0Kmk+PjI+Pj4wXT1hLGE9MDthPG8ubGVuZ3RoOysrYSl0KClbaSsrPj4wPj4+MF09by5jaGFyQ29kZUF0KGEpO3QoKVtpPj4wPj4+MF09MCxyKz1vLmxlbmd0aCsxO30pKSwwfWZ1bmN0aW9uIGV0KGUsdCl7aWYoXylyZXR1cm4gWGUoMjAsMSxlLHQpO2U+Pj49MCx0Pj4+PTA7dmFyIG49WmUoKTtzKClbZT4+Mj4+PjBdPW4ubGVuZ3RoO3ZhciByPTA7cmV0dXJuIG4uZm9yRWFjaCgoZnVuY3Rpb24oZSl7cis9ZS5sZW5ndGgrMTt9KSkscygpW3Q+PjI+Pj4wXT1yLDB9ZnVuY3Rpb24gdHQoZSl7cmV0dXJuIF8/WGUoMjEsMSxlKTo1Mn1mdW5jdGlvbiBudChlLHQsbixyKXtyZXR1cm4gXz9YZSgyMiwxLGUsdCxuLHIpOjUyfWZ1bmN0aW9uIHJ0KGUsdCxuLHIsbyl7cmV0dXJuIF8/WGUoMjMsMSxlLHQsbixyLG8pOjcwfXZhciBvdD1bbnVsbCxbXSxbXV07ZnVuY3Rpb24gaXQoZSx0LG4scil7aWYoXylyZXR1cm4gWGUoMjQsMSxlLHQsbixyKTt0Pj4+PTAsbj4+Pj0wLHI+Pj49MDtmb3IodmFyIGk9MCxhPTA7YTxuO2ErKyl7dmFyIHU9cygpW3Q+PjI+Pj4wXSxsPXMoKVt0KzQ+PjI+Pj4wXTt0Kz04O2Zvcih2YXIgYz0wO2M8bDtjKyspe3ZhciBwPW8oKVt1K2M+Pj4wXSxkPW90W2VdOzA9PT1wfHwxMD09PXA/KCgxPT09ZT9JOkUpKHBlKGQsMCkpLGQubGVuZ3RoPTApOmQucHVzaChwKTt9aSs9bDt9cmV0dXJuIHMoKVtyPj4yPj4+MF09aSwwfXZhciBzdD1lPT4oc3Q9KCgpPT57aWYoIm9iamVjdCI9PXR5cGVvZiBjcnlwdG8mJiJmdW5jdGlvbiI9PXR5cGVvZiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKXJldHVybiBlPT4oZS5zZXQoY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShlLmJ5dGVMZW5ndGgpKSksZSk7aWYodil0cnl7dmFyIGU9big3NjApO2lmKGUucmFuZG9tRmlsbFN5bmMpcmV0dXJuIHQ9PmUucmFuZG9tRmlsbFN5bmModCk7dmFyIHQ9ZS5yYW5kb21CeXRlcztyZXR1cm4gZT0+KGUuc2V0KHQoZS5ieXRlTGVuZ3RoKSksZSl9Y2F0Y2goZSl7fW5lKCJpbml0UmFuZG9tRGV2aWNlIik7fSkoKSkoZSksYXQ9WzMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSx1dD1bMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLGx0PShlLG4pPT57dCgpLnNldChlLG4+Pj4wKTt9O2Z1bmN0aW9uIGN0KGUsdCxuLHIpe2Z1bmN0aW9uIG8oZSx0LG4pe2ZvcihlPSJudW1iZXIiPT10eXBlb2YgZT9lLnRvU3RyaW5nKCk6ZXx8IiI7ZS5sZW5ndGg8dDspZT1uWzBdK2U7cmV0dXJuIGV9ZnVuY3Rpb24gcyhlLHQpe3JldHVybiBvKGUsdCwiMCIpfWZ1bmN0aW9uIGEoZSx0KXtmdW5jdGlvbiBuKGUpe3JldHVybiAwPmU/LTE6MDxlPzE6MH12YXIgcjtyZXR1cm4gMD09PShyPW4oZS5nZXRGdWxsWWVhcigpLXQuZ2V0RnVsbFllYXIoKSkpJiYwPT09KHI9bihlLmdldE1vbnRoKCktdC5nZXRNb250aCgpKSkmJihyPW4oZS5nZXREYXRlKCktdC5nZXREYXRlKCkpKSxyfWZ1bmN0aW9uIHUoZSl7c3dpdGNoKGUuZ2V0RGF5KCkpe2Nhc2UgMDpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMjkpO2Nhc2UgMTpyZXR1cm4gZTtjYXNlIDI6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDMpO2Nhc2UgMzpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMik7Y2FzZSA0OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwxKTtjYXNlIDU6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDMxKTtjYXNlIDY6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDMwKX19ZnVuY3Rpb24gbChlKXt2YXIgdD1lLkphO2ZvcihlPW5ldyBEYXRlKG5ldyBEYXRlKGUuS2ErMTkwMCwwLDEpLmdldFRpbWUoKSk7MDx0Oyl7dmFyIG49ZS5nZXRNb250aCgpLHI9KEJlKGUuZ2V0RnVsbFllYXIoKSk/YXQ6dXQpW25dO2lmKCEodD5yLWUuZ2V0RGF0ZSgpKSl7ZS5zZXREYXRlKGUuZ2V0RGF0ZSgpK3QpO2JyZWFrfXQtPXItZS5nZXREYXRlKCkrMSxlLnNldERhdGUoMSksMTE+bj9lLnNldE1vbnRoKG4rMSk6KGUuc2V0TW9udGgoMCksZS5zZXRGdWxsWWVhcihlLmdldEZ1bGxZZWFyKCkrMSkpO31yZXR1cm4gbj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCkrMSwwLDQpLHQ9dShuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCw0KSksbj11KG4pLDA+PWEodCxlKT8wPj1hKG4sZSk/ZS5nZXRGdWxsWWVhcigpKzE6ZS5nZXRGdWxsWWVhcigpOmUuZ2V0RnVsbFllYXIoKS0xfWU+Pj49MCx0Pj4+PTAsbj4+Pj0wLHI+Pj49MDt2YXIgYz1pKClbcis0MD4+Mj4+PjBdO2Zvcih2YXIgcCBpbiByPXtrYjppKClbcj4+Mj4+PjBdLGpiOmkoKVtyKzQ+PjI+Pj4wXSxNYTppKClbcis4Pj4yPj4+MF0sUWE6aSgpW3IrMTI+PjI+Pj4wXSxOYTppKClbcisxNj4+Mj4+PjBdLEthOmkoKVtyKzIwPj4yPj4+MF0sR2E6aSgpW3IrMjQ+PjI+Pj4wXSxKYTppKClbcisyOD4+Mj4+PjBdLHNiOmkoKVtyKzMyPj4yPj4+MF0saWI6aSgpW3IrMzY+PjI+Pj4wXSxsYjpjP2RlKGMpOiIifSxuPWRlKG4pLGM9eyIlYyI6IiVhICViICVkICVIOiVNOiVTICVZIiwiJUQiOiIlbS8lZC8leSIsIiVGIjoiJVktJW0tJWQiLCIlaCI6IiViIiwiJXIiOiIlSTolTTolUyAlcCIsIiVSIjoiJUg6JU0iLCIlVCI6IiVIOiVNOiVTIiwiJXgiOiIlbS8lZC8leSIsIiVYIjoiJUg6JU06JVMiLCIlRWMiOiIlYyIsIiVFQyI6IiVDIiwiJUV4IjoiJW0vJWQvJXkiLCIlRVgiOiIlSDolTTolUyIsIiVFeSI6IiV5IiwiJUVZIjoiJVkiLCIlT2QiOiIlZCIsIiVPZSI6IiVlIiwiJU9IIjoiJUgiLCIlT0kiOiIlSSIsIiVPbSI6IiVtIiwiJU9NIjoiJU0iLCIlT1MiOiIlUyIsIiVPdSI6IiV1IiwiJU9VIjoiJVUiLCIlT1YiOiIlViIsIiVPdyI6IiV3IiwiJU9XIjoiJVciLCIlT3kiOiIleSJ9KW49bi5yZXBsYWNlKG5ldyBSZWdFeHAocCwiZyIpLGNbcF0pO3ZhciBkPSJTdW5kYXkgTW9uZGF5IFR1ZXNkYXkgV2VkbmVzZGF5IFRodXJzZGF5IEZyaWRheSBTYXR1cmRheSIuc3BsaXQoIiAiKSxmPSJKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyIi5zcGxpdCgiICIpO2ZvcihwIGluIGM9eyIlYSI6ZT0+ZFtlLkdhXS5zdWJzdHJpbmcoMCwzKSwiJUEiOmU9PmRbZS5HYV0sIiViIjplPT5mW2UuTmFdLnN1YnN0cmluZygwLDMpLCIlQiI6ZT0+ZltlLk5hXSwiJUMiOmU9PnMoKGUuS2ErMTkwMCkvMTAwfDAsMiksIiVkIjplPT5zKGUuUWEsMiksIiVlIjplPT5vKGUuUWEsMiwiICIpLCIlZyI6ZT0+bChlKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJUciOmU9PmwoZSksIiVIIjplPT5zKGUuTWEsMiksIiVJIjplPT4oMD09KGU9ZS5NYSk/ZT0xMjoxMjxlJiYoZS09MTIpLHMoZSwyKSksIiVqIjplPT57Zm9yKHZhciB0PTAsbj0wO248PWUuTmEtMTt0Kz0oQmUoZS5LYSsxOTAwKT9hdDp1dClbbisrXSk7cmV0dXJuIHMoZS5RYSt0LDMpfSwiJW0iOmU9PnMoZS5OYSsxLDIpLCIlTSI6ZT0+cyhlLmpiLDIpLCIlbiI6KCk9PiJcbiIsIiVwIjplPT4wPD1lLk1hJiYxMj5lLk1hPyJBTSI6IlBNIiwiJVMiOmU9PnMoZS5rYiwyKSwiJXQiOigpPT4iXHQiLCIldSI6ZT0+ZS5HYXx8NywiJVUiOmU9PnMoTWF0aC5mbG9vcigoZS5KYSs3LWUuR2EpLzcpLDIpLCIlViI6ZT0+e3ZhciB0PU1hdGguZmxvb3IoKGUuSmErNy0oZS5HYSs2KSU3KS83KTtpZigyPj0oZS5HYSszNzEtZS5KYS0yKSU3JiZ0KyssdCk1Mz09dCYmKDQ9PShuPShlLkdhKzM3MS1lLkphKSU3KXx8Mz09biYmQmUoZS5LYSl8fCh0PTEpKTtlbHNlIHt0PTUyO3ZhciBuPShlLkdhKzctZS5KYS0xKSU3Oyg0PT1ufHw1PT1uJiZCZShlLkthJTQwMC0xKSkmJnQrKzt9cmV0dXJuIHModCwyKX0sIiV3IjplPT5lLkdhLCIlVyI6ZT0+cyhNYXRoLmZsb29yKChlLkphKzctKGUuR2ErNiklNykvNyksMiksIiV5IjplPT4oZS5LYSsxOTAwKS50b1N0cmluZygpLnN1YnN0cmluZygyKSwiJVkiOmU9PmUuS2ErMTkwMCwiJXoiOmU9Pnt2YXIgdD0wPD0oZT1lLmliKTtyZXR1cm4gZT1NYXRoLmFicyhlKS82MCwodD8iKyI6Ii0iKStTdHJpbmcoIjAwMDAiKyhlLzYwKjEwMCtlJTYwKSkuc2xpY2UoLTQpfSwiJVoiOmU9PmUubGIsIiUlIjooKT0+IiUifSxuPW4ucmVwbGFjZSgvJSUvZywiXDBcMCIpLGMpbi5pbmNsdWRlcyhwKSYmKG49bi5yZXBsYWNlKG5ldyBSZWdFeHAocCwiZyIpLGNbcF0ocikpKTtyZXR1cm4gcD1mdW5jdGlvbihlKXt2YXIgdD1BcnJheShPZShlKSsxKTtyZXR1cm4gU2UoZSx0LDAsdC5sZW5ndGgpLHR9KG49bi5yZXBsYWNlKC9cMFwwL2csIiUiKSkscC5sZW5ndGg+dD8wOihsdChwLGUpLHAubGVuZ3RoLTEpfWdlLlBhKCk7dmFyIHB0PVtudWxsLGZlLG1lLF9lLFRlLHhlLFBlLEllLEVlLERlLCRlLGtlLEZlLE5lLGplLFJlLExlLEdlLEhlLFFlLGV0LHR0LG50LHJ0LGl0XSxkdD17YjpmdW5jdGlvbihlLHQsbil7dGhyb3cgbmV3IHZlKGU+Pj49MCkuUGEodD4+PjAsbj4+PjApLGV9LE46ZnVuY3Rpb24oZSl7Z3QoZT4+PjAsIXksMSwhbSwxMzEwNzIsITEpLGdlLlNhKCk7fSxrOmZ1bmN0aW9uKGUpe2U+Pj49MCxfP3Bvc3RNZXNzYWdlKHtjbWQ6ImNsZWFudXBUaHJlYWQiLHRocmVhZDplfSk6dWUoZSk7fSxJOndlLGg6VGUsVDp4ZSxFOlBlLEc6SWUsVTpFZSxSOkRlLEo6JGUsUTprZSxvOkZlLEY6TmUsQzpqZSxTOlJlLEQ6TGUscTooKT0+ITAsQTpmdW5jdGlvbihlLHQpeyhlPj4+PTApPT10Pj4+MD9zZXRUaW1lb3V0KCgoKT0+VWUoKSkpOl8/cG9zdE1lc3NhZ2Uoe3RhcmdldFRocmVhZDplLGNtZDoiY2hlY2tNYWlsYm94In0pOihlPWdlLkZhW2VdKSYmZS5wb3N0TWVzc2FnZSh7Y21kOiJjaGVja01haWxib3gifSk7fSxMOmZ1bmN0aW9uKCl7cmV0dXJuIC0xfSxNOk1lLHA6ZnVuY3Rpb24oZSl7diYmZ2UuRmFbZT4+PjBdLnJlZigpO30sdDpmdW5jdGlvbihlLHQsbil7ZT10KzIwOTcxNTI+Pj4wPDQxOTQzMDUtISFlPyhlPj4+MCkrNDI5NDk2NzI5Nip0Ok5hTixuPj4+PTAsZT1uZXcgRGF0ZSgxZTMqZSksaSgpW24+PjI+Pj4wXT1lLmdldFVUQ1NlY29uZHMoKSxpKClbbis0Pj4yPj4+MF09ZS5nZXRVVENNaW51dGVzKCksaSgpW24rOD4+Mj4+PjBdPWUuZ2V0VVRDSG91cnMoKSxpKClbbisxMj4+Mj4+PjBdPWUuZ2V0VVRDRGF0ZSgpLGkoKVtuKzE2Pj4yPj4+MF09ZS5nZXRVVENNb250aCgpLGkoKVtuKzIwPj4yPj4+MF09ZS5nZXRVVENGdWxsWWVhcigpLTE5MDAsaSgpW24rMjQ+PjI+Pj4wXT1lLmdldFVUQ0RheSgpLGU9KGUuZ2V0VGltZSgpLURhdGUuVVRDKGUuZ2V0VVRDRnVsbFllYXIoKSwwLDEsMCwwLDAsMCkpLzg2NGU1fDAsaSgpW24rMjg+PjI+Pj4wXT1lO30sdTpmdW5jdGlvbihlLHQsbil7ZT10KzIwOTcxNTI+Pj4wPDQxOTQzMDUtISFlPyhlPj4+MCkrNDI5NDk2NzI5Nip0Ok5hTixuPj4+PTAsZT1uZXcgRGF0ZSgxZTMqZSksaSgpW24+PjI+Pj4wXT1lLmdldFNlY29uZHMoKSxpKClbbis0Pj4yPj4+MF09ZS5nZXRNaW51dGVzKCksaSgpW24rOD4+Mj4+PjBdPWUuZ2V0SG91cnMoKSxpKClbbisxMj4+Mj4+PjBdPWUuZ2V0RGF0ZSgpLGkoKVtuKzE2Pj4yPj4+MF09ZS5nZXRNb250aCgpLGkoKVtuKzIwPj4yPj4+MF09ZS5nZXRGdWxsWWVhcigpLTE5MDAsaSgpW24rMjQ+PjI+Pj4wXT1lLmdldERheSgpLHQ9KEJlKGUuZ2V0RnVsbFllYXIoKSk/VmU6emUpW2UuZ2V0TW9udGgoKV0rZS5nZXREYXRlKCktMXwwLGkoKVtuKzI4Pj4yPj4+MF09dCxpKClbbiszNj4+Mj4+PjBdPS02MCplLmdldFRpbWV6b25lT2Zmc2V0KCksdD1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpO3ZhciByPW5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDEpLmdldFRpbWV6b25lT2Zmc2V0KCk7ZT0wfCh0IT1yJiZlLmdldFRpbWV6b25lT2Zmc2V0KCk9PU1hdGgubWluKHIsdCkpLGkoKVtuKzMyPj4yPj4+MF09ZTt9LHY6ZnVuY3Rpb24oZSl7ZT4+Pj0wO3ZhciB0PW5ldyBEYXRlKGkoKVtlKzIwPj4yPj4+MF0rMTkwMCxpKClbZSsxNj4+Mj4+PjBdLGkoKVtlKzEyPj4yPj4+MF0saSgpW2UrOD4+Mj4+PjBdLGkoKVtlKzQ+PjI+Pj4wXSxpKClbZT4+Mj4+PjBdLDApLG49aSgpW2UrMzI+PjI+Pj4wXSxyPXQuZ2V0VGltZXpvbmVPZmZzZXQoKSxvPW5ldyBEYXRlKHQuZ2V0RnVsbFllYXIoKSw2LDEpLmdldFRpbWV6b25lT2Zmc2V0KCkscz1uZXcgRGF0ZSh0LmdldEZ1bGxZZWFyKCksMCwxKS5nZXRUaW1lem9uZU9mZnNldCgpLGE9TWF0aC5taW4ocyxvKTtyZXR1cm4gMD5uP2koKVtlKzMyPj4yPj4+MF09TnVtYmVyKG8hPXMmJmE9PXIpOjA8biE9KGE9PXIpJiYobz1NYXRoLm1heChzLG8pLHQuc2V0VGltZSh0LmdldFRpbWUoKSs2ZTQqKCgwPG4/YTpvKS1yKSkpLGkoKVtlKzI0Pj4yPj4+MF09dC5nZXREYXkoKSxuPShCZSh0LmdldEZ1bGxZZWFyKCkpP1ZlOnplKVt0LmdldE1vbnRoKCldK3QuZ2V0RGF0ZSgpLTF8MCxpKClbZSsyOD4+Mj4+PjBdPW4saSgpW2U+PjI+Pj4wXT10LmdldFNlY29uZHMoKSxpKClbZSs0Pj4yPj4+MF09dC5nZXRNaW51dGVzKCksaSgpW2UrOD4+Mj4+PjBdPXQuZ2V0SG91cnMoKSxpKClbZSsxMj4+Mj4+PjBdPXQuZ2V0RGF0ZSgpLGkoKVtlKzE2Pj4yPj4+MF09dC5nZXRNb250aCgpLGkoKVtlKzIwPj4yPj4+MF09dC5nZXRZZWFyKCksZT10LmdldFRpbWUoKS8xZTMsd3QoKEs9ZSwxPD0rTWF0aC5hYnMoSyk/MDxLPytNYXRoLmZsb29yKEsvNDI5NDk2NzI5Nik+Pj4wOn5+K01hdGguY2VpbCgoSy0rKH5+Sz4+PjApKS80Mjk0OTY3Mjk2KT4+PjA6MCkpLGU+Pj4wfSxyOkdlLHM6SGUsejpmdW5jdGlvbihlLHQsbil7ZnVuY3Rpb24gcihlKXtyZXR1cm4gKGU9ZS50b1RpbWVTdHJpbmcoKS5tYXRjaCgvXCgoW0EtWmEteiBdKylcKSQvKSk/ZVsxXToiR01UIn1lPj4+PTAsdD4+Pj0wLG4+Pj49MDt2YXIgbz0obmV3IERhdGUpLmdldEZ1bGxZZWFyKCksYT1uZXcgRGF0ZShvLDAsMSksdT1uZXcgRGF0ZShvLDYsMSk7bz1hLmdldFRpbWV6b25lT2Zmc2V0KCk7dmFyIGw9dS5nZXRUaW1lem9uZU9mZnNldCgpLGM9TWF0aC5tYXgobyxsKTtzKClbZT4+Mj4+PjBdPTYwKmMsaSgpW3Q+PjI+Pj4wXT1OdW1iZXIobyE9bCksZT1yKGEpLHQ9cih1KSxlPVdlKGUpLHQ9V2UodCksbDxvPyhzKClbbj4+Mj4+PjBdPWUscygpW24rND4+Mj4+PjBdPXQpOihzKClbbj4+Mj4+PjBdPXQscygpW24rND4+Mj4+PjBdPWUpO30sYzooKT0+e25lKCIiKTt9LGw6ZnVuY3Rpb24oKXt9LGk6ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3coKX0sVjooKT0+e3Rocm93IHErPTEsInVud2luZCJ9LEI6ZnVuY3Rpb24oKXtyZXR1cm4gNDI5NDkwMTc2MH0sZTooKT0+cGVyZm9ybWFuY2UudGltZU9yaWdpbitwZXJmb3JtYW5jZS5ub3coKSxmOmZ1bmN0aW9uKCl7cmV0dXJuIHY/bigzOTkzKS5jcHVzKCkubGVuZ3RoOm5hdmlnYXRvci5oYXJkd2FyZUNvbmN1cnJlbmN5fSxLOmZ1bmN0aW9uKGUsdCxuLHIpe2ZvcihnZS5wYj10Pj4+MCxLZS5sZW5ndGg9bix0PXI+Pj4wPj4zLHI9MDtyPG47cisrKUtlW3JdPWEoKVt0K3I+Pj4wXTtyZXR1cm4gcHRbZV0uYXBwbHkobnVsbCxLZSl9LHk6ZnVuY3Rpb24oZSl7ZT4+Pj0wO3ZhciB0PW8oKS5sZW5ndGg7aWYoZTw9dHx8NDI5NDkwMTc2MDxlKXJldHVybiAhMTtmb3IodmFyIG49MTs0Pj1uO24qPTIpe3ZhciByPXQqKDErLjIvbik7cj1NYXRoLm1pbihyLGUrMTAwNjYzMjk2KTt2YXIgaT1NYXRoO3I9TWF0aC5tYXgoZSxyKTtlOntpPWkubWluLmNhbGwoaSw0Mjk0OTAxNzYwLHIrKDY1NTM2LXIlNjU1MzYpJTY1NTM2KS0kLmJ1ZmZlci5ieXRlTGVuZ3RoKzY1NTM1Pj4+MTY7dHJ5eyQuZ3JvdyhpKSxCKCk7dmFyIHM9MTticmVhayBlfWNhdGNoKGUpe31zPXZvaWQgMDt9aWYocylyZXR1cm4gITB9cmV0dXJuICExfSxPOlFlLFA6ZXQsajpoZSxnOnR0LG46bnQsdzpydCxtOml0LHg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT4+Pj0wLHQ+Pj49MCxzdChvKCkuc3ViYXJyYXkoZT4+PjAsZSt0Pj4+MCkpLDB9LGE6JHx8Yy53YXNtTWVtb3J5LEg6Y3QsZDpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gY3QoZT4+PjAsdD4+PjAsbj4+PjAscj4+PjApfX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3JldHVybiBlPWUuZXhwb3J0cyxrPWU9ZnVuY3Rpb24oZSl7dmFyIHQ9ZT0+KCk9PmUoKT4+PjAsbj1lPT50PT5lKHQpPj4+MDtyZXR1cm4gKGU9T2JqZWN0LmFzc2lnbih7fSxlKSkuX19lcnJub19sb2NhdGlvbj10KGUuX19lcnJub19sb2NhdGlvbiksZS5wdGhyZWFkX3NlbGY9dChlLnB0aHJlYWRfc2VsZiksZS5tYWxsb2M9bihlLm1hbGxvYyksZS5zdGFja1NhdmU9dChlLnN0YWNrU2F2ZSksZS5zdGFja0FsbG9jPW4oZS5zdGFja0FsbG9jKSxlfShlKSxnZS5UYS5wdXNoKGsuc2EpLHo9ay50YSxILnVuc2hpZnQoay5XKSxGPXQsdGUoKSxlfXZhciB0PXthOmR0fTtpZihlZSgpLGMuaW5zdGFudGlhdGVXYXNtKXRyeXtyZXR1cm4gYy5pbnN0YW50aWF0ZVdhc20odCxlKX1jYXRjaChlKXtFKCJNb2R1bGUuaW5zdGFudGlhdGVXYXNtIGNhbGxiYWNrIGZhaWxlZCB3aXRoIGVycm9yOiAiK2UpLGwoZSk7fShmdW5jdGlvbihlLHQpe3ZhciBuPVk7cmV0dXJuIFB8fCJmdW5jdGlvbiIhPXR5cGVvZiBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZ3x8cmUobil8fG4uc3RhcnRzV2l0aCgiZmlsZTovLyIpfHx2fHwiZnVuY3Rpb24iIT10eXBlb2YgZmV0Y2g/aWUobixlLHQpOmZldGNoKG4se2NyZWRlbnRpYWxzOiJzYW1lLW9yaWdpbiJ9KS50aGVuKChyPT5XZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZyhyLGUpLnRoZW4odCwoZnVuY3Rpb24ocil7cmV0dXJuIEUoIndhc20gc3RyZWFtaW5nIGNvbXBpbGUgZmFpbGVkOiAiK3IpLEUoImZhbGxpbmcgYmFjayB0byBBcnJheUJ1ZmZlciBpbnN0YW50aWF0aW9uIiksaWUobixlLHQpfSkpKSl9KSh0LChmdW5jdGlvbih0KXtlKHQuaW5zdGFuY2UsdC5tb2R1bGUpO30pKS5jYXRjaChsKTt9KCksYy5fT3J0SW5pdD0oZSx0KT0+KGMuX09ydEluaXQ9ay5YKShlLHQpLGMuX09ydEdldExhc3RFcnJvcj0oZSx0KT0+KGMuX09ydEdldExhc3RFcnJvcj1rLlkpKGUsdCksYy5fT3J0Q3JlYXRlU2Vzc2lvbk9wdGlvbnM9KGUsdCxuLHIsbyxpLHMsYSx1LGwpPT4oYy5fT3J0Q3JlYXRlU2Vzc2lvbk9wdGlvbnM9ay5aKShlLHQsbixyLG8saSxzLGEsdSxsKSxjLl9PcnRBcHBlbmRFeGVjdXRpb25Qcm92aWRlcj0oZSx0KT0+KGMuX09ydEFwcGVuZEV4ZWN1dGlvblByb3ZpZGVyPWsuXykoZSx0KSxjLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnk9KGUsdCxuKT0+KGMuX09ydEFkZFNlc3Npb25Db25maWdFbnRyeT1rLiQpKGUsdCxuKSxjLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnM9ZT0+KGMuX09ydFJlbGVhc2VTZXNzaW9uT3B0aW9ucz1rLmFhKShlKSxjLl9PcnRDcmVhdGVTZXNzaW9uPShlLHQsbik9PihjLl9PcnRDcmVhdGVTZXNzaW9uPWsuYmEpKGUsdCxuKSxjLl9PcnRSZWxlYXNlU2Vzc2lvbj1lPT4oYy5fT3J0UmVsZWFzZVNlc3Npb249ay5jYSkoZSksYy5fT3J0R2V0SW5wdXRPdXRwdXRDb3VudD0oZSx0LG4pPT4oYy5fT3J0R2V0SW5wdXRPdXRwdXRDb3VudD1rLmRhKShlLHQsbiksYy5fT3J0R2V0SW5wdXROYW1lPShlLHQpPT4oYy5fT3J0R2V0SW5wdXROYW1lPWsuZWEpKGUsdCksYy5fT3J0R2V0T3V0cHV0TmFtZT0oZSx0KT0+KGMuX09ydEdldE91dHB1dE5hbWU9ay5mYSkoZSx0KSxjLl9PcnRGcmVlPWU9PihjLl9PcnRGcmVlPWsuZ2EpKGUpLGMuX09ydENyZWF0ZVRlbnNvcj0oZSx0LG4scixvKT0+KGMuX09ydENyZWF0ZVRlbnNvcj1rLmhhKShlLHQsbixyLG8pLGMuX09ydEdldFRlbnNvckRhdGE9KGUsdCxuLHIsbyk9PihjLl9PcnRHZXRUZW5zb3JEYXRhPWsuaWEpKGUsdCxuLHIsbyksYy5fT3J0UmVsZWFzZVRlbnNvcj1lPT4oYy5fT3J0UmVsZWFzZVRlbnNvcj1rLmphKShlKSxjLl9PcnRDcmVhdGVSdW5PcHRpb25zPShlLHQsbixyKT0+KGMuX09ydENyZWF0ZVJ1bk9wdGlvbnM9ay5rYSkoZSx0LG4sciksYy5fT3J0QWRkUnVuQ29uZmlnRW50cnk9KGUsdCxuKT0+KGMuX09ydEFkZFJ1bkNvbmZpZ0VudHJ5PWsubGEpKGUsdCxuKSxjLl9PcnRSZWxlYXNlUnVuT3B0aW9ucz1lPT4oYy5fT3J0UmVsZWFzZVJ1bk9wdGlvbnM9ay5tYSkoZSksYy5fT3J0UnVuPShlLHQsbixyLG8saSxzLGEpPT4oYy5fT3J0UnVuPWsubmEpKGUsdCxuLHIsbyxpLHMsYSksYy5fT3J0RW5kUHJvZmlsaW5nPWU9PihjLl9PcnRFbmRQcm9maWxpbmc9ay5vYSkoZSk7dmFyIGZ0PWMuX3B0aHJlYWRfc2VsZj0oKT0+KGZ0PWMuX3B0aHJlYWRfc2VsZj1rLnBhKSgpLGh0PWMuX21hbGxvYz1lPT4oaHQ9Yy5fbWFsbG9jPWsucWEpKGUpO2MuX2ZyZWU9ZT0+KGMuX2ZyZWU9ay5yYSkoZSksYy5fX2Vtc2NyaXB0ZW5fdGxzX2luaXQ9KCk9PihjLl9fZW1zY3JpcHRlbl90bHNfaW5pdD1rLnNhKSgpO3ZhciBndD1jLl9fZW1zY3JpcHRlbl90aHJlYWRfaW5pdD0oZSx0LG4scixvLGkpPT4oZ3Q9Yy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2luaXQ9ay51YSkoZSx0LG4scixvLGkpO2MuX19lbXNjcmlwdGVuX3RocmVhZF9jcmFzaGVkPSgpPT4oYy5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2NyYXNoZWQ9ay52YSkoKTt2YXIgYnQsbXQ9KGUsdCxuLHIpPT4obXQ9ay53YSkoZSx0LG4scikseXQ9ZT0+KHl0PWsueGEpKGUpLHZ0PWMuX19lbXNjcmlwdGVuX3RocmVhZF9leGl0PWU9Pih2dD1jLl9fZW1zY3JpcHRlbl90aHJlYWRfZXhpdD1rLnlhKShlKSxfdD1jLl9fZW1zY3JpcHRlbl9jaGVja19tYWlsYm94PSgpPT4oX3Q9Yy5fX2Vtc2NyaXB0ZW5fY2hlY2tfbWFpbGJveD1rLnphKSgpLHd0PWU9Pih3dD1rLkFhKShlKSxUdD0oZSx0KT0+KFR0PWsuQmEpKGUsdCkseHQ9KCk9Pih4dD1rLkNhKSgpLE90PWU9PihPdD1rLkRhKShlKSxTdD1lPT4oU3Q9ay5FYSkoZSk7ZnVuY3Rpb24gQXQoKXtmdW5jdGlvbiBlKCl7aWYoIWJ0JiYoYnQ9ITAsYy5jYWxsZWRSdW49ITAsIVUpJiYoX3x8YmUoSCksdShjKSxjLm9uUnVudGltZUluaXRpYWxpemVkJiZjLm9uUnVudGltZUluaXRpYWxpemVkKCksIV8pKXtpZihjLnBvc3RSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBjLnBvc3RSdW4mJihjLnBvc3RSdW49W2MucG9zdFJ1bl0pO2MucG9zdFJ1bi5sZW5ndGg7KXt2YXIgZT1jLnBvc3RSdW4uc2hpZnQoKTtXLnVuc2hpZnQoZSk7fWJlKFcpO319aWYoISgwPEopKWlmKF8pdShjKSxffHxiZShIKSxzdGFydFdvcmtlcihjKTtlbHNlIHtpZihjLnByZVJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIGMucHJlUnVuJiYoYy5wcmVSdW49W2MucHJlUnVuXSk7Yy5wcmVSdW4ubGVuZ3RoOylHLnVuc2hpZnQoYy5wcmVSdW4uc2hpZnQoKSk7YmUoRyksMDxKfHwoYy5zZXRTdGF0dXM/KGMuc2V0U3RhdHVzKCJSdW5uaW5nLi4uIiksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe2Muc2V0U3RhdHVzKCIiKTt9KSwxKSxlKCk7fSksMSkpOmUoKSk7fX1pZihjLmtlZXBSdW50aW1lQWxpdmU9WCxjLndhc21NZW1vcnk9JCxjLnN0YWNrQWxsb2M9U3QsYy5zdGFja1NhdmU9eHQsYy5zdGFja1Jlc3RvcmU9T3QsYy5VVEY4VG9TdHJpbmc9ZGUsYy5zdHJpbmdUb1VURjg9QWUsYy5sZW5ndGhCeXRlc1VURjg9T2UsYy5FeGl0U3RhdHVzPXNlLGMuUFRocmVhZD1nZSxRPWZ1bmN0aW9uIGUoKXtidHx8QXQoKSxidHx8KFE9ZSk7fSxjLnByZUluaXQpZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBjLnByZUluaXQmJihjLnByZUluaXQ9W2MucHJlSW5pdF0pOzA8Yy5wcmVJbml0Lmxlbmd0aDspYy5wcmVJbml0LnBvcCgpKCk7cmV0dXJuIEF0KCksZS5yZWFkeX0pO2UuZXhwb3J0cz1vO30sOTMyOihlLHQsbik9Pnt2YXIgcixvPShyPSJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQmJmRvY3VtZW50LmN1cnJlbnRTY3JpcHQ/ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM6dm9pZCAwLCJ1bmRlZmluZWQiIT10eXBlb2YgX19maWxlbmFtZSYmKHI9cnx8X19maWxlbmFtZSksZnVuY3Rpb24oZT17fSl7dmFyIHQsbyxpPWU7aS5yZWFkeT1uZXcgUHJvbWlzZSgoKGUsbik9Pnt0PWUsbz1uO30pKTt2YXIgcyxhLHUsbD1PYmplY3QuYXNzaWduKHt9LGkpLGM9Ii4vdGhpcy5wcm9ncmFtIixwPShlLHQpPT57dGhyb3cgdH0sZD0ib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyxmPSJmdW5jdGlvbiI9PXR5cGVvZiBpbXBvcnRTY3JpcHRzLGg9Im9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiYib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MudmVyc2lvbnMmJiJzdHJpbmciPT10eXBlb2YgcHJvY2Vzcy52ZXJzaW9ucy5ub2RlLGc9IiI7aWYoaCl7dmFyIGI9bigxMzg0KSxtPW4oOTA4KTtnPWY/bS5kaXJuYW1lKGcpKyIvIjpfX2Rpcm5hbWUrIi8iLHM9KGUsdCk9PihlPWUuc3RhcnRzV2l0aCgiZmlsZTovLyIpP25ldyBVUkwoZSk6bS5ub3JtYWxpemUoZSksYi5yZWFkRmlsZVN5bmMoZSx0P3ZvaWQgMDoidXRmOCIpKSx1PWU9PigoZT1zKGUsITApKS5idWZmZXJ8fChlPW5ldyBVaW50OEFycmF5KGUpKSxlKSxhPShlLHQsbixyPSEwKT0+e2U9ZS5zdGFydHNXaXRoKCJmaWxlOi8vIik/bmV3IFVSTChlKTptLm5vcm1hbGl6ZShlKSxiLnJlYWRGaWxlKGUscj92b2lkIDA6InV0ZjgiLCgoZSxvKT0+e2U/bihlKTp0KHI/by5idWZmZXI6byk7fSkpO30sIWkudGhpc1Byb2dyYW0mJjE8cHJvY2Vzcy5hcmd2Lmxlbmd0aCYmKGM9cHJvY2Vzcy5hcmd2WzFdLnJlcGxhY2UoL1xcL2csIi8iKSkscHJvY2Vzcy5hcmd2LnNsaWNlKDIpLHA9KGUsdCk9Pnt0aHJvdyBwcm9jZXNzLmV4aXRDb2RlPWUsdH0saS5pbnNwZWN0PSgpPT4iW0Vtc2NyaXB0ZW4gTW9kdWxlIG9iamVjdF0iO31lbHNlIChkfHxmKSYmKGY/Zz1zZWxmLmxvY2F0aW9uLmhyZWY6InVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmZG9jdW1lbnQuY3VycmVudFNjcmlwdCYmKGc9ZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpLHImJihnPXIpLGc9MCE9PWcuaW5kZXhPZigiYmxvYjoiKT9nLnN1YnN0cigwLGcucmVwbGFjZSgvWz8jXS4qLywiIikubGFzdEluZGV4T2YoIi8iKSsxKToiIixzPWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQobnVsbCksdC5yZXNwb25zZVRleHR9LGYmJih1PWU9Pnt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLHQuc2VuZChudWxsKSxuZXcgVWludDhBcnJheSh0LnJlc3BvbnNlKX0pLGE9KGUsdCxuKT0+e3ZhciByPW5ldyBYTUxIdHRwUmVxdWVzdDtyLm9wZW4oIkdFVCIsZSwhMCksci5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIixyLm9ubG9hZD0oKT0+ezIwMD09ci5zdGF0dXN8fDA9PXIuc3RhdHVzJiZyLnJlc3BvbnNlP3Qoci5yZXNwb25zZSk6bigpO30sci5vbmVycm9yPW4sci5zZW5kKG51bGwpO30pO3ZhciB5LHY9aS5wcmludHx8Y29uc29sZS5sb2cuYmluZChjb25zb2xlKSxfPWkucHJpbnRFcnJ8fGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKTtPYmplY3QuYXNzaWduKGksbCksbD1udWxsLGkudGhpc1Byb2dyYW0mJihjPWkudGhpc1Byb2dyYW0pLGkucXVpdCYmKHA9aS5xdWl0KSxpLndhc21CaW5hcnkmJih5PWkud2FzbUJpbmFyeSk7dmFyIHc9aS5ub0V4aXRSdW50aW1lfHwhMDsib2JqZWN0IiE9dHlwZW9mIFdlYkFzc2VtYmx5JiZNKCJubyBuYXRpdmUgd2FzbSBzdXBwb3J0IGRldGVjdGVkIik7dmFyIFQseCxPLFMsQSxQLEk9ITE7ZnVuY3Rpb24gRSgpe3ZhciBlPVQuYnVmZmVyO2kuSEVBUDg9Tz1uZXcgSW50OEFycmF5KGUpLGkuSEVBUDE2PW5ldyBJbnQxNkFycmF5KGUpLGkuSEVBUDMyPUE9bmV3IEludDMyQXJyYXkoZSksaS5IRUFQVTg9Uz1uZXcgVWludDhBcnJheShlKSxpLkhFQVBVMTY9bmV3IFVpbnQxNkFycmF5KGUpLGkuSEVBUFUzMj1QPW5ldyBVaW50MzJBcnJheShlKSxpLkhFQVBGMzI9bmV3IEZsb2F0MzJBcnJheShlKSxpLkhFQVBGNjQ9bmV3IEZsb2F0NjRBcnJheShlKTt9dmFyIEQ9W10sJD1bXSxrPVtdO2Z1bmN0aW9uIEYoKXt2YXIgZT1pLnByZVJ1bi5zaGlmdCgpO0QudW5zaGlmdChlKTt9dmFyIE4saixSPTAsQz1udWxsO2Z1bmN0aW9uIE0oZSl7dGhyb3cgaS5vbkFib3J0JiZpLm9uQWJvcnQoZSksXyhlPSJBYm9ydGVkKCIrZSsiKSIpLEk9ITAsZT1uZXcgV2ViQXNzZW1ibHkuUnVudGltZUVycm9yKGUrIi4gQnVpbGQgd2l0aCAtc0FTU0VSVElPTlMgZm9yIG1vcmUgaW5mby4iKSxvKGUpLGV9ZnVuY3Rpb24gVShlKXtyZXR1cm4gZS5zdGFydHNXaXRoKCJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIil9aWYoIVUoTj0ib3J0LXdhc20ud2FzbSIpKXt2YXIgQj1OO049aS5sb2NhdGVGaWxlP2kubG9jYXRlRmlsZShCLGcpOmcrQjt9ZnVuY3Rpb24gVihlKXtpZihlPT1OJiZ5KXJldHVybiBuZXcgVWludDhBcnJheSh5KTtpZih1KXJldHVybiB1KGUpO3Rocm93ICJib3RoIGFzeW5jIGFuZCBzeW5jIGZldGNoaW5nIG9mIHRoZSB3YXNtIGZhaWxlZCJ9ZnVuY3Rpb24geihlLHQsbil7cmV0dXJuIGZ1bmN0aW9uKGUpe2lmKCF5JiYoZHx8Zikpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBmZXRjaCYmIWUuc3RhcnRzV2l0aCgiZmlsZTovLyIpKXJldHVybiBmZXRjaChlLHtjcmVkZW50aWFsczoic2FtZS1vcmlnaW4ifSkudGhlbigodD0+e2lmKCF0Lm9rKXRocm93ICJmYWlsZWQgdG8gbG9hZCB3YXNtIGJpbmFyeSBmaWxlIGF0ICciK2UrIiciO3JldHVybiB0LmFycmF5QnVmZmVyKCl9KSkuY2F0Y2goKCgpPT5WKGUpKSk7aWYoYSlyZXR1cm4gbmV3IFByb21pc2UoKCh0LG4pPT57YShlLChlPT50KG5ldyBVaW50OEFycmF5KGUpKSksbik7fSkpfXJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgoKT0+VihlKSkpfShlKS50aGVuKChlPT5XZWJBc3NlbWJseS5pbnN0YW50aWF0ZShlLHQpKSkudGhlbigoZT0+ZSkpLnRoZW4obiwoZT0+e18oImZhaWxlZCB0byBhc3luY2hyb25vdXNseSBwcmVwYXJlIHdhc206ICIrZSksTShlKTt9KSl9ZnVuY3Rpb24gRyhlKXt0aGlzLm5hbWU9IkV4aXRTdGF0dXMiLHRoaXMubWVzc2FnZT1gUHJvZ3JhbSB0ZXJtaW5hdGVkIHdpdGggZXhpdCgke2V9KWAsdGhpcy5zdGF0dXM9ZTt9dmFyIEg9ZT0+e2Zvcig7MDxlLmxlbmd0aDspZS5zaGlmdCgpKGkpO307ZnVuY3Rpb24gVyhlKXt0aGlzLnFhPWUtMjQsdGhpcy52YT1mdW5jdGlvbihlKXtQW3RoaXMucWErND4+Mj4+PjBdPWU7fSx0aGlzLnVhPWZ1bmN0aW9uKGUpe1BbdGhpcy5xYSs4Pj4yPj4+MF09ZTt9LHRoaXMuc2E9ZnVuY3Rpb24oZSx0KXt0aGlzLnRhKCksdGhpcy52YShlKSx0aGlzLnVhKHQpO30sdGhpcy50YT1mdW5jdGlvbigpe1BbdGhpcy5xYSsxNj4+Mj4+PjBdPTA7fTt9dmFyIHEsWD0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMCxZPShlLHQsbik9Pnt2YXIgcj0odD4+Pj0wKStuO2ZvcihuPXQ7ZVtuXSYmIShuPj1yKTspKytuO2lmKDE2PG4tdCYmZS5idWZmZXImJlgpcmV0dXJuIFguZGVjb2RlKGUuc3ViYXJyYXkodCxuKSk7Zm9yKHI9IiI7dDxuOyl7dmFyIG89ZVt0KytdO2lmKDEyOCZvKXt2YXIgaT02MyZlW3QrK107aWYoMTkyPT0oMjI0Jm8pKXIrPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJm8pPDw2fGkpO2Vsc2Uge3ZhciBzPTYzJmVbdCsrXTs2NTUzNj4obz0yMjQ9PSgyNDAmbyk/KDE1Jm8pPDwxMnxpPDw2fHM6KDcmbyk8PDE4fGk8PDEyfHM8PDZ8NjMmZVt0KytdKT9yKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8pOihvLT02NTUzNixyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2fG8+PjEwLDU2MzIwfDEwMjMmbykpO319ZWxzZSByKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8pO31yZXR1cm4gcn0sSz0oZSx0KT0+KGU+Pj49MCk/WShTLGUsdCk6IiIsSj1lPT57Zm9yKHZhciB0PTAsbj0wO248ZS5sZW5ndGg7KytuKXt2YXIgcj1lLmNoYXJDb2RlQXQobik7MTI3Pj1yP3QrKzoyMDQ3Pj1yP3QrPTI6NTUyOTY8PXImJjU3MzQzPj1yPyh0Kz00LCsrbik6dCs9Mzt9cmV0dXJuIHR9LFo9KGUsdCxuLHIpPT57aWYoISgwPHIpKXJldHVybiAwO3ZhciBvPW4+Pj49MDtyPW4rci0xO2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7KytpKXt2YXIgcz1lLmNoYXJDb2RlQXQoaSk7aWYoNTUyOTY8PXMmJjU3MzQzPj1zJiYocz02NTUzNisoKDEwMjMmcyk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK2kpKSwxMjc+PXMpe2lmKG4+PXIpYnJlYWs7dFtuKys+Pj4wXT1zO31lbHNlIHtpZigyMDQ3Pj1zKXtpZihuKzE+PXIpYnJlYWs7dFtuKys+Pj4wXT0xOTJ8cz4+Njt9ZWxzZSB7aWYoNjU1MzU+PXMpe2lmKG4rMj49cilicmVhazt0W24rKz4+PjBdPTIyNHxzPj4xMjt9ZWxzZSB7aWYobiszPj1yKWJyZWFrO3RbbisrPj4+MF09MjQwfHM+PjE4LHRbbisrPj4+MF09MTI4fHM+PjEyJjYzO310W24rKz4+PjBdPTEyOHxzPj42JjYzO310W24rKz4+PjBdPTEyOHw2MyZzO319cmV0dXJuIHRbbj4+PjBdPTAsbi1vfSxRPWU9PjA9PWUlNCYmKDAhPWUlMTAwfHwwPT1lJTQwMCksZWU9WzAsMzEsNjAsOTEsMTIxLDE1MiwxODIsMjEzLDI0NCwyNzQsMzA1LDMzNV0sdGU9WzAsMzEsNTksOTAsMTIwLDE1MSwxODEsMjEyLDI0MywyNzMsMzA0LDMzNF0sbmU9ZT0+e3ZhciB0PUooZSkrMSxuPXBlKHQpO3JldHVybiBuJiZaKGUsUyxuLHQpLG59LHJlPXt9LG9lPSgpPT57aWYoIXEpe3ZhciBlLHQ9e1VTRVI6IndlYl91c2VyIixMT0dOQU1FOiJ3ZWJfdXNlciIsUEFUSDoiLyIsUFdEOiIvIixIT01FOiIvaG9tZS93ZWJfdXNlciIsTEFORzooIm9iamVjdCI9PXR5cGVvZiBuYXZpZ2F0b3ImJm5hdmlnYXRvci5sYW5ndWFnZXMmJm5hdmlnYXRvci5sYW5ndWFnZXNbMF18fCJDIikucmVwbGFjZSgiLSIsIl8iKSsiLlVURi04IixfOmN8fCIuL3RoaXMucHJvZ3JhbSJ9O2ZvcihlIGluIHJlKXZvaWQgMD09PXJlW2VdP2RlbGV0ZSB0W2VdOnRbZV09cmVbZV07dmFyIG49W107Zm9yKGUgaW4gdCluLnB1c2goYCR7ZX09JHt0W2VdfWApO3E9bjt9cmV0dXJuIHF9LGllPVtudWxsLFtdLFtdXSxzZT1lPT4oc2U9KCgpPT57aWYoIm9iamVjdCI9PXR5cGVvZiBjcnlwdG8mJiJmdW5jdGlvbiI9PXR5cGVvZiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKXJldHVybiBlPT5jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGUpO2lmKGgpdHJ5e3ZhciBlPW4oNzYwKTtpZihlLnJhbmRvbUZpbGxTeW5jKXJldHVybiB0PT5lLnJhbmRvbUZpbGxTeW5jKHQpO3ZhciB0PWUucmFuZG9tQnl0ZXM7cmV0dXJuIGU9PihlLnNldCh0KGUuYnl0ZUxlbmd0aCkpLGUpfWNhdGNoKGUpe31NKCJpbml0UmFuZG9tRGV2aWNlIik7fSkoKSkoZSksYWU9WzMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSx1ZT1bMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdO2Z1bmN0aW9uIGxlKGUsdCxuLHIpe2Z1bmN0aW9uIG8oZSx0LG4pe2ZvcihlPSJudW1iZXIiPT10eXBlb2YgZT9lLnRvU3RyaW5nKCk6ZXx8IiI7ZS5sZW5ndGg8dDspZT1uWzBdK2U7cmV0dXJuIGV9ZnVuY3Rpb24gaShlLHQpe3JldHVybiBvKGUsdCwiMCIpfWZ1bmN0aW9uIHMoZSx0KXtmdW5jdGlvbiBuKGUpe3JldHVybiAwPmU/LTE6MDxlPzE6MH12YXIgcjtyZXR1cm4gMD09PShyPW4oZS5nZXRGdWxsWWVhcigpLXQuZ2V0RnVsbFllYXIoKSkpJiYwPT09KHI9bihlLmdldE1vbnRoKCktdC5nZXRNb250aCgpKSkmJihyPW4oZS5nZXREYXRlKCktdC5nZXREYXRlKCkpKSxyfWZ1bmN0aW9uIGEoZSl7c3dpdGNoKGUuZ2V0RGF5KCkpe2Nhc2UgMDpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLTEsMTEsMjkpO2Nhc2UgMTpyZXR1cm4gZTtjYXNlIDI6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDMpO2Nhc2UgMzpyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMik7Y2FzZSA0OnJldHVybiBuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwxKTtjYXNlIDU6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDMxKTtjYXNlIDY6cmV0dXJuIG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKS0xLDExLDMwKX19ZnVuY3Rpb24gdShlKXt2YXIgdD1lLm1hO2ZvcihlPW5ldyBEYXRlKG5ldyBEYXRlKGUubmErMTkwMCwwLDEpLmdldFRpbWUoKSk7MDx0Oyl7dmFyIG49ZS5nZXRNb250aCgpLHI9KFEoZS5nZXRGdWxsWWVhcigpKT9hZTp1ZSlbbl07aWYoISh0PnItZS5nZXREYXRlKCkpKXtlLnNldERhdGUoZS5nZXREYXRlKCkrdCk7YnJlYWt9dC09ci1lLmdldERhdGUoKSsxLGUuc2V0RGF0ZSgxKSwxMT5uP2Uuc2V0TW9udGgobisxKTooZS5zZXRNb250aCgwKSxlLnNldEZ1bGxZZWFyKGUuZ2V0RnVsbFllYXIoKSsxKSk7fXJldHVybiBuPW5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSsxLDAsNCksdD1hKG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDQpKSxuPWEobiksMD49cyh0LGUpPzA+PXMobixlKT9lLmdldEZ1bGxZZWFyKCkrMTplLmdldEZ1bGxZZWFyKCk6ZS5nZXRGdWxsWWVhcigpLTF9ZT4+Pj0wLHQ+Pj49MCxuPj4+PTA7dmFyIGw9QVs0MCsocj4+Pj0wKT4+Mj4+PjBdO2Zvcih2YXIgYyBpbiByPXt5YTpBW3I+PjI+Pj4wXSx4YTpBW3IrND4+Mj4+PjBdLG9hOkFbcis4Pj4yPj4+MF0scmE6QVtyKzEyPj4yPj4+MF0scGE6QVtyKzE2Pj4yPj4+MF0sbmE6QVtyKzIwPj4yPj4+MF0saGE6QVtyKzI0Pj4yPj4+MF0sbWE6QVtyKzI4Pj4yPj4+MF0sQWE6QVtyKzMyPj4yPj4+MF0sd2E6QVtyKzM2Pj4yPj4+MF0semE6bD9LKGwpOiIifSxuPUsobiksbD17IiVjIjoiJWEgJWIgJWQgJUg6JU06JVMgJVkiLCIlRCI6IiVtLyVkLyV5IiwiJUYiOiIlWS0lbS0lZCIsIiVoIjoiJWIiLCIlciI6IiVJOiVNOiVTICVwIiwiJVIiOiIlSDolTSIsIiVUIjoiJUg6JU06JVMiLCIleCI6IiVtLyVkLyV5IiwiJVgiOiIlSDolTTolUyIsIiVFYyI6IiVjIiwiJUVDIjoiJUMiLCIlRXgiOiIlbS8lZC8leSIsIiVFWCI6IiVIOiVNOiVTIiwiJUV5IjoiJXkiLCIlRVkiOiIlWSIsIiVPZCI6IiVkIiwiJU9lIjoiJWUiLCIlT0giOiIlSCIsIiVPSSI6IiVJIiwiJU9tIjoiJW0iLCIlT00iOiIlTSIsIiVPUyI6IiVTIiwiJU91IjoiJXUiLCIlT1UiOiIlVSIsIiVPViI6IiVWIiwiJU93IjoiJXciLCIlT1ciOiIlVyIsIiVPeSI6IiV5In0pbj1uLnJlcGxhY2UobmV3IFJlZ0V4cChjLCJnIiksbFtjXSk7dmFyIHA9IlN1bmRheSBNb25kYXkgVHVlc2RheSBXZWRuZXNkYXkgVGh1cnNkYXkgRnJpZGF5IFNhdHVyZGF5Ii5zcGxpdCgiICIpLGQ9IkphbnVhcnkgRmVicnVhcnkgTWFyY2ggQXByaWwgTWF5IEp1bmUgSnVseSBBdWd1c3QgU2VwdGVtYmVyIE9jdG9iZXIgTm92ZW1iZXIgRGVjZW1iZXIiLnNwbGl0KCIgIik7Zm9yKGMgaW4gbD17IiVhIjplPT5wW2UuaGFdLnN1YnN0cmluZygwLDMpLCIlQSI6ZT0+cFtlLmhhXSwiJWIiOmU9PmRbZS5wYV0uc3Vic3RyaW5nKDAsMyksIiVCIjplPT5kW2UucGFdLCIlQyI6ZT0+aSgoZS5uYSsxOTAwKS8xMDB8MCwyKSwiJWQiOmU9PmkoZS5yYSwyKSwiJWUiOmU9Pm8oZS5yYSwyLCIgIiksIiVnIjplPT51KGUpLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDIpLCIlRyI6ZT0+dShlKSwiJUgiOmU9PmkoZS5vYSwyKSwiJUkiOmU9PigwPT0oZT1lLm9hKT9lPTEyOjEyPGUmJihlLT0xMiksaShlLDIpKSwiJWoiOmU9Pntmb3IodmFyIHQ9MCxuPTA7bjw9ZS5wYS0xO3QrPShRKGUubmErMTkwMCk/YWU6dWUpW24rK10pO3JldHVybiBpKGUucmErdCwzKX0sIiVtIjplPT5pKGUucGErMSwyKSwiJU0iOmU9PmkoZS54YSwyKSwiJW4iOigpPT4iXG4iLCIlcCI6ZT0+MDw9ZS5vYSYmMTI+ZS5vYT8iQU0iOiJQTSIsIiVTIjplPT5pKGUueWEsMiksIiV0IjooKT0+Ilx0IiwiJXUiOmU9PmUuaGF8fDcsIiVVIjplPT5pKE1hdGguZmxvb3IoKGUubWErNy1lLmhhKS83KSwyKSwiJVYiOmU9Pnt2YXIgdD1NYXRoLmZsb29yKChlLm1hKzctKGUuaGErNiklNykvNyk7aWYoMj49KGUuaGErMzcxLWUubWEtMiklNyYmdCsrLHQpNTM9PXQmJig0PT0obj0oZS5oYSszNzEtZS5tYSklNyl8fDM9PW4mJlEoZS5uYSl8fCh0PTEpKTtlbHNlIHt0PTUyO3ZhciBuPShlLmhhKzctZS5tYS0xKSU3Oyg0PT1ufHw1PT1uJiZRKGUubmElNDAwLTEpKSYmdCsrO31yZXR1cm4gaSh0LDIpfSwiJXciOmU9PmUuaGEsIiVXIjplPT5pKE1hdGguZmxvb3IoKGUubWErNy0oZS5oYSs2KSU3KS83KSwyKSwiJXkiOmU9PihlLm5hKzE5MDApLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDIpLCIlWSI6ZT0+ZS5uYSsxOTAwLCIleiI6ZT0+e3ZhciB0PTA8PShlPWUud2EpO3JldHVybiBlPU1hdGguYWJzKGUpLzYwLCh0PyIrIjoiLSIpK1N0cmluZygiMDAwMCIrKGUvNjAqMTAwK2UlNjApKS5zbGljZSgtNCl9LCIlWiI6ZT0+ZS56YSwiJSUiOigpPT4iJSJ9LG49bi5yZXBsYWNlKC8lJS9nLCJcMFwwIiksbCluLmluY2x1ZGVzKGMpJiYobj1uLnJlcGxhY2UobmV3IFJlZ0V4cChjLCJnIiksbFtjXShyKSkpO3JldHVybiBjPWZ1bmN0aW9uKGUpe3ZhciB0PUFycmF5KEooZSkrMSk7cmV0dXJuIFooZSx0LDAsdC5sZW5ndGgpLHR9KG49bi5yZXBsYWNlKC9cMFwwL2csIiUiKSksYy5sZW5ndGg+dD8wOihPLnNldChjLGU+Pj4wKSxjLmxlbmd0aC0xKX12YXIgY2U9e2E6ZnVuY3Rpb24oZSx0LG4pe3Rocm93IG5ldyBXKGU+Pj49MCkuc2EodD4+PjAsbj4+PjApLGV9LGU6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sSTpmdW5jdGlvbigpe30seTpmdW5jdGlvbigpe30sQTpmdW5jdGlvbigpe30sSzpmdW5jdGlvbigpe3JldHVybiAwfSxHOmZ1bmN0aW9uKCl7fSxCOmZ1bmN0aW9uKCl7fSxGOmZ1bmN0aW9uKCl7fSxnOmZ1bmN0aW9uKCl7fSx6OmZ1bmN0aW9uKCl7fSx3OmZ1bmN0aW9uKCl7fSxIOmZ1bmN0aW9uKCl7fSx4OmZ1bmN0aW9uKCl7fSxrOigpPT4hMCxuOmZ1bmN0aW9uKGUsdCxuKXtlPXQrMjA5NzE1Mj4+PjA8NDE5NDMwNS0hIWU/KGU+Pj4wKSs0Mjk0OTY3Mjk2KnQ6TmFOLG4+Pj49MCxlPW5ldyBEYXRlKDFlMyplKSxBW24+PjI+Pj4wXT1lLmdldFVUQ1NlY29uZHMoKSxBW24rND4+Mj4+PjBdPWUuZ2V0VVRDTWludXRlcygpLEFbbis4Pj4yPj4+MF09ZS5nZXRVVENIb3VycygpLEFbbisxMj4+Mj4+PjBdPWUuZ2V0VVRDRGF0ZSgpLEFbbisxNj4+Mj4+PjBdPWUuZ2V0VVRDTW9udGgoKSxBW24rMjA+PjI+Pj4wXT1lLmdldFVUQ0Z1bGxZZWFyKCktMTkwMCxBW24rMjQ+PjI+Pj4wXT1lLmdldFVUQ0RheSgpLEFbbisyOD4+Mj4+PjBdPShlLmdldFRpbWUoKS1EYXRlLlVUQyhlLmdldFVUQ0Z1bGxZZWFyKCksMCwxLDAsMCwwLDApKS84NjRlNXwwO30sbzpmdW5jdGlvbihlLHQsbil7ZT10KzIwOTcxNTI+Pj4wPDQxOTQzMDUtISFlPyhlPj4+MCkrNDI5NDk2NzI5Nip0Ok5hTixuPj4+PTAsZT1uZXcgRGF0ZSgxZTMqZSksQVtuPj4yPj4+MF09ZS5nZXRTZWNvbmRzKCksQVtuKzQ+PjI+Pj4wXT1lLmdldE1pbnV0ZXMoKSxBW24rOD4+Mj4+PjBdPWUuZ2V0SG91cnMoKSxBW24rMTI+PjI+Pj4wXT1lLmdldERhdGUoKSxBW24rMTY+PjI+Pj4wXT1lLmdldE1vbnRoKCksQVtuKzIwPj4yPj4+MF09ZS5nZXRGdWxsWWVhcigpLTE5MDAsQVtuKzI0Pj4yPj4+MF09ZS5nZXREYXkoKSxBW24rMjg+PjI+Pj4wXT0oUShlLmdldEZ1bGxZZWFyKCkpP2VlOnRlKVtlLmdldE1vbnRoKCldK2UuZ2V0RGF0ZSgpLTF8MCxBW24rMzY+PjI+Pj4wXT0tNjAqZS5nZXRUaW1lem9uZU9mZnNldCgpLHQ9bmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgcj1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwxKS5nZXRUaW1lem9uZU9mZnNldCgpO0FbbiszMj4+Mj4+PjBdPTB8KHQhPXImJmUuZ2V0VGltZXpvbmVPZmZzZXQoKT09TWF0aC5taW4ocix0KSk7fSxwOmZ1bmN0aW9uKGUpe2U+Pj49MDt2YXIgdD1uZXcgRGF0ZShBW2UrMjA+PjI+Pj4wXSsxOTAwLEFbZSsxNj4+Mj4+PjBdLEFbZSsxMj4+Mj4+PjBdLEFbZSs4Pj4yPj4+MF0sQVtlKzQ+PjI+Pj4wXSxBW2U+PjI+Pj4wXSwwKSxuPUFbZSszMj4+Mj4+PjBdLHI9dC5nZXRUaW1lem9uZU9mZnNldCgpLG89bmV3IERhdGUodC5nZXRGdWxsWWVhcigpLDYsMSkuZ2V0VGltZXpvbmVPZmZzZXQoKSxpPW5ldyBEYXRlKHQuZ2V0RnVsbFllYXIoKSwwLDEpLmdldFRpbWV6b25lT2Zmc2V0KCkscz1NYXRoLm1pbihpLG8pO3JldHVybiAwPm4/QVtlKzMyPj4yPj4+MF09TnVtYmVyKG8hPWkmJnM9PXIpOjA8biE9KHM9PXIpJiYobz1NYXRoLm1heChpLG8pLHQuc2V0VGltZSh0LmdldFRpbWUoKSs2ZTQqKCgwPG4/czpvKS1yKSkpLEFbZSsyND4+Mj4+PjBdPXQuZ2V0RGF5KCksQVtlKzI4Pj4yPj4+MF09KFEodC5nZXRGdWxsWWVhcigpKT9lZTp0ZSlbdC5nZXRNb250aCgpXSt0LmdldERhdGUoKS0xfDAsQVtlPj4yPj4+MF09dC5nZXRTZWNvbmRzKCksQVtlKzQ+PjI+Pj4wXT10LmdldE1pbnV0ZXMoKSxBW2UrOD4+Mj4+PjBdPXQuZ2V0SG91cnMoKSxBW2UrMTI+PjI+Pj4wXT10LmdldERhdGUoKSxBW2UrMTY+PjI+Pj4wXT10LmdldE1vbnRoKCksQVtlKzIwPj4yPj4+MF09dC5nZXRZZWFyKCksZT10LmdldFRpbWUoKS8xZTMsZmUoKGo9ZSwxPD0rTWF0aC5hYnMoaik/MDxqPytNYXRoLmZsb29yKGovNDI5NDk2NzI5Nik+Pj4wOn5+K01hdGguY2VpbCgoai0rKH5+aj4+PjApKS80Mjk0OTY3Mjk2KT4+PjA6MCkpLGU+Pj4wfSxsOmZ1bmN0aW9uKCl7cmV0dXJuIC01Mn0sbTpmdW5jdGlvbigpe30sdTpmdW5jdGlvbihlLHQsbil7ZnVuY3Rpb24gcihlKXtyZXR1cm4gKGU9ZS50b1RpbWVTdHJpbmcoKS5tYXRjaCgvXCgoW0EtWmEteiBdKylcKSQvKSk/ZVsxXToiR01UIn1uPj4+PTA7dmFyIG89KG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpLGk9bmV3IERhdGUobywwLDEpLHM9bmV3IERhdGUobyw2LDEpO289aS5nZXRUaW1lem9uZU9mZnNldCgpO3ZhciBhPXMuZ2V0VGltZXpvbmVPZmZzZXQoKTtQW2U+Pj4wPj4yPj4+MF09NjAqTWF0aC5tYXgobyxhKSxBW3Q+Pj4wPj4yPj4+MF09TnVtYmVyKG8hPWEpLGU9cihpKSx0PXIocyksZT1uZShlKSx0PW5lKHQpLGE8bz8oUFtuPj4yPj4+MF09ZSxQW24rND4+Mj4+PjBdPXQpOihQW24+PjI+Pj4wXT10LFBbbis0Pj4yPj4+MF09ZSk7fSxkOigpPT57TSgiIik7fSxoOmZ1bmN0aW9uKCl7cmV0dXJuIERhdGUubm93KCl9LHY6ZnVuY3Rpb24oKXtyZXR1cm4gNDI5NDkwMTc2MH0sYjooKT0+cGVyZm9ybWFuY2Uubm93KCksSjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHQ+Pj49MCxTLmNvcHlXaXRoaW4oZT4+PjA+Pj4wLHQ+Pj4wLHQrKG4+Pj4wKT4+PjApfSx0OmZ1bmN0aW9uKGUpe2U+Pj49MDt2YXIgdD1TLmxlbmd0aDtpZig0Mjk0OTAxNzYwPGUpcmV0dXJuICExO2Zvcih2YXIgbj0xOzQ+PW47bio9Mil7dmFyIHI9dCooMSsuMi9uKTtyPU1hdGgubWluKHIsZSsxMDA2NjMyOTYpO3ZhciBvPU1hdGg7cj1NYXRoLm1heChlLHIpO2U6e289by5taW4uY2FsbChvLDQyOTQ5MDE3NjAscisoNjU1MzYtciU2NTUzNiklNjU1MzYpLVQuYnVmZmVyLmJ5dGVMZW5ndGgrNjU1MzU+Pj4xNjt0cnl7VC5ncm93KG8pLEUoKTt2YXIgaT0xO2JyZWFrIGV9Y2F0Y2goZSl7fWk9dm9pZCAwO31pZihpKXJldHVybiAhMH1yZXR1cm4gITF9LEQ6ZnVuY3Rpb24oZSx0KXtlPj4+PTAsdD4+Pj0wO3ZhciBuPTA7cmV0dXJuIG9lKCkuZm9yRWFjaCgoZnVuY3Rpb24ocixvKXt2YXIgaT10K247Zm9yKG89UFtlKzQqbz4+Mj4+PjBdPWksaT0wO2k8ci5sZW5ndGg7KytpKU9bbysrPj4wPj4+MF09ci5jaGFyQ29kZUF0KGkpO09bbz4+MD4+PjBdPTAsbis9ci5sZW5ndGgrMTt9KSksMH0sRTpmdW5jdGlvbihlLHQpe2U+Pj49MCx0Pj4+PTA7dmFyIG49b2UoKTtQW2U+PjI+Pj4wXT1uLmxlbmd0aDt2YXIgcj0wO3JldHVybiBuLmZvckVhY2goKGZ1bmN0aW9uKGUpe3IrPWUubGVuZ3RoKzE7fSkpLFBbdD4+Mj4+PjBdPXIsMH0sczplPT57d3x8KGkub25FeGl0JiZpLm9uRXhpdChlKSxJPSEwKSxwKGUsbmV3IEcoZSkpO30sZjooKT0+NTIsajpmdW5jdGlvbigpe3JldHVybiA1Mn0scTpmdW5jdGlvbigpe3JldHVybiA3MH0saTpmdW5jdGlvbihlLHQsbixyKXt0Pj4+PTAsbj4+Pj0wLHI+Pj49MDtmb3IodmFyIG89MCxpPTA7aTxuO2krKyl7dmFyIHM9UFt0Pj4yPj4+MF0sYT1QW3QrND4+Mj4+PjBdO3QrPTg7Zm9yKHZhciB1PTA7dTxhO3UrKyl7dmFyIGw9U1tzK3U+Pj4wXSxjPWllW2VdOzA9PT1sfHwxMD09PWw/KCgxPT09ZT92Ol8pKFkoYywwKSksYy5sZW5ndGg9MCk6Yy5wdXNoKGwpO31vKz1hO31yZXR1cm4gUFtyPj4yPj4+MF09bywwfSxyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU+Pj49MCxzZShTLnN1YmFycmF5KGU+Pj4wLGUrKHQ+Pj4wKT4+PjApKSwwfSxDOmxlLGM6ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIGxlKGU+Pj4wLHQ+Pj4wLG4+Pj4wLHI+Pj4wKX19OyFmdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSl7aWYoZT1lLmV4cG9ydHMseD1lPWZ1bmN0aW9uKGUpe3ZhciB0PWU9PigpPT5lKCk+Pj4wLG49ZT0+dD0+ZSh0KT4+PjA7cmV0dXJuIChlPU9iamVjdC5hc3NpZ24oe30sZSkpLl9fZXJybm9fbG9jYXRpb249dChlLl9fZXJybm9fbG9jYXRpb24pLGUubWFsbG9jPW4oZS5tYWxsb2MpLGUuc3RhY2tTYXZlPXQoZS5zdGFja1NhdmUpLGUuc3RhY2tBbGxvYz1uKGUuc3RhY2tBbGxvYyksZX0oZSksVD14LkwsRSgpLCQudW5zaGlmdCh4Lk0pLFItLSxpLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmkubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhSKSwwPT1SJiYoQykpe3ZhciB0PUM7Qz1udWxsLHQoKTt9cmV0dXJuIGV9dmFyIHQ9e2E6Y2V9O2lmKFIrKyxpLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMmJmkubW9uaXRvclJ1bkRlcGVuZGVuY2llcyhSKSxpLmluc3RhbnRpYXRlV2FzbSl0cnl7cmV0dXJuIGkuaW5zdGFudGlhdGVXYXNtKHQsZSl9Y2F0Y2goZSl7XygiTW9kdWxlLmluc3RhbnRpYXRlV2FzbSBjYWxsYmFjayBmYWlsZWQgd2l0aCBlcnJvcjogIitlKSxvKGUpO30oZnVuY3Rpb24oZSx0KXt2YXIgbj1OO3JldHVybiB5fHwiZnVuY3Rpb24iIT10eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmd8fFUobil8fG4uc3RhcnRzV2l0aCgiZmlsZTovLyIpfHxofHwiZnVuY3Rpb24iIT10eXBlb2YgZmV0Y2g/eihuLGUsdCk6ZmV0Y2gobix7Y3JlZGVudGlhbHM6InNhbWUtb3JpZ2luIn0pLnRoZW4oKHI9PldlYkFzc2VtYmx5Lmluc3RhbnRpYXRlU3RyZWFtaW5nKHIsZSkudGhlbih0LChmdW5jdGlvbihyKXtyZXR1cm4gXygid2FzbSBzdHJlYW1pbmcgY29tcGlsZSBmYWlsZWQ6ICIrciksXygiZmFsbGluZyBiYWNrIHRvIEFycmF5QnVmZmVyIGluc3RhbnRpYXRpb24iKSx6KG4sZSx0KX0pKSkpfSkodCwoZnVuY3Rpb24odCl7ZSh0Lmluc3RhbmNlKTt9KSkuY2F0Y2gobyk7fSgpLGkuX09ydEluaXQ9KGUsdCk9PihpLl9PcnRJbml0PXguTikoZSx0KSxpLl9PcnRHZXRMYXN0RXJyb3I9KGUsdCk9PihpLl9PcnRHZXRMYXN0RXJyb3I9eC5PKShlLHQpLGkuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPShlLHQsbixyLG8scyxhLHUsbCxjKT0+KGkuX09ydENyZWF0ZVNlc3Npb25PcHRpb25zPXguUCkoZSx0LG4scixvLHMsYSx1LGwsYyksaS5fT3J0QXBwZW5kRXhlY3V0aW9uUHJvdmlkZXI9KGUsdCk9PihpLl9PcnRBcHBlbmRFeGVjdXRpb25Qcm92aWRlcj14LlEpKGUsdCksaS5fT3J0QWRkU2Vzc2lvbkNvbmZpZ0VudHJ5PShlLHQsbik9PihpLl9PcnRBZGRTZXNzaW9uQ29uZmlnRW50cnk9eC5SKShlLHQsbiksaS5fT3J0UmVsZWFzZVNlc3Npb25PcHRpb25zPWU9PihpLl9PcnRSZWxlYXNlU2Vzc2lvbk9wdGlvbnM9eC5TKShlKSxpLl9PcnRDcmVhdGVTZXNzaW9uPShlLHQsbik9PihpLl9PcnRDcmVhdGVTZXNzaW9uPXguVCkoZSx0LG4pLGkuX09ydFJlbGVhc2VTZXNzaW9uPWU9PihpLl9PcnRSZWxlYXNlU2Vzc2lvbj14LlUpKGUpLGkuX09ydEdldElucHV0T3V0cHV0Q291bnQ9KGUsdCxuKT0+KGkuX09ydEdldElucHV0T3V0cHV0Q291bnQ9eC5WKShlLHQsbiksaS5fT3J0R2V0SW5wdXROYW1lPShlLHQpPT4oaS5fT3J0R2V0SW5wdXROYW1lPXguVykoZSx0KSxpLl9PcnRHZXRPdXRwdXROYW1lPShlLHQpPT4oaS5fT3J0R2V0T3V0cHV0TmFtZT14LlgpKGUsdCksaS5fT3J0RnJlZT1lPT4oaS5fT3J0RnJlZT14LlkpKGUpLGkuX09ydENyZWF0ZVRlbnNvcj0oZSx0LG4scixvKT0+KGkuX09ydENyZWF0ZVRlbnNvcj14LlopKGUsdCxuLHIsbyksaS5fT3J0R2V0VGVuc29yRGF0YT0oZSx0LG4scixvKT0+KGkuX09ydEdldFRlbnNvckRhdGE9eC5fKShlLHQsbixyLG8pLGkuX09ydFJlbGVhc2VUZW5zb3I9ZT0+KGkuX09ydFJlbGVhc2VUZW5zb3I9eC4kKShlKSxpLl9PcnRDcmVhdGVSdW5PcHRpb25zPShlLHQsbixyKT0+KGkuX09ydENyZWF0ZVJ1bk9wdGlvbnM9eC5hYSkoZSx0LG4sciksaS5fT3J0QWRkUnVuQ29uZmlnRW50cnk9KGUsdCxuKT0+KGkuX09ydEFkZFJ1bkNvbmZpZ0VudHJ5PXguYmEpKGUsdCxuKSxpLl9PcnRSZWxlYXNlUnVuT3B0aW9ucz1lPT4oaS5fT3J0UmVsZWFzZVJ1bk9wdGlvbnM9eC5jYSkoZSksaS5fT3J0UnVuPShlLHQsbixyLG8scyxhLHUpPT4oaS5fT3J0UnVuPXguZGEpKGUsdCxuLHIsbyxzLGEsdSksaS5fT3J0RW5kUHJvZmlsaW5nPWU9PihpLl9PcnRFbmRQcm9maWxpbmc9eC5lYSkoZSk7dmFyIHBlPWkuX21hbGxvYz1lPT4ocGU9aS5fbWFsbG9jPXguZmEpKGUpO2kuX2ZyZWU9ZT0+KGkuX2ZyZWU9eC5nYSkoZSk7dmFyIGRlLGZlPWU9PihmZT14LmlhKShlKSxoZT0oKT0+KGhlPXguamEpKCksZ2U9ZT0+KGdlPXgua2EpKGUpLGJlPWU9PihiZT14LmxhKShlKTtmdW5jdGlvbiBtZSgpe2Z1bmN0aW9uIGUoKXtpZighZGUmJihkZT0hMCxpLmNhbGxlZFJ1bj0hMCwhSSkpe2lmKEgoJCksdChpKSxpLm9uUnVudGltZUluaXRpYWxpemVkJiZpLm9uUnVudGltZUluaXRpYWxpemVkKCksaS5wb3N0UnVuKWZvcigiZnVuY3Rpb24iPT10eXBlb2YgaS5wb3N0UnVuJiYoaS5wb3N0UnVuPVtpLnBvc3RSdW5dKTtpLnBvc3RSdW4ubGVuZ3RoOyl7dmFyIGU9aS5wb3N0UnVuLnNoaWZ0KCk7ay51bnNoaWZ0KGUpO31IKGspO319aWYoISgwPFIpKXtpZihpLnByZVJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIGkucHJlUnVuJiYoaS5wcmVSdW49W2kucHJlUnVuXSk7aS5wcmVSdW4ubGVuZ3RoOylGKCk7SChEKSwwPFJ8fChpLnNldFN0YXR1cz8oaS5zZXRTdGF0dXMoIlJ1bm5pbmcuLi4iKSxzZXRUaW1lb3V0KChmdW5jdGlvbigpe3NldFRpbWVvdXQoKGZ1bmN0aW9uKCl7aS5zZXRTdGF0dXMoIiIpO30pLDEpLGUoKTt9KSwxKSk6ZSgpKTt9fWlmKGkuc3RhY2tBbGxvYz1iZSxpLnN0YWNrU2F2ZT1oZSxpLnN0YWNrUmVzdG9yZT1nZSxpLlVURjhUb1N0cmluZz1LLGkuc3RyaW5nVG9VVEY4PShlLHQsbik9PlooZSxTLHQsbiksaS5sZW5ndGhCeXRlc1VURjg9SixDPWZ1bmN0aW9uIGUoKXtkZXx8bWUoKSxkZXx8KEM9ZSk7fSxpLnByZUluaXQpZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBpLnByZUluaXQmJihpLnByZUluaXQ9W2kucHJlSW5pdF0pOzA8aS5wcmVJbml0Lmxlbmd0aDspaS5wcmVJbml0LnBvcCgpKCk7cmV0dXJuIG1lKCksZS5yZWFkeX0pO2UuZXhwb3J0cz1vO30sNDUzNzplPT57ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoLTEpLHI9MCxvPTIsaT0hMDtvPGFyZ3VtZW50cy5sZW5ndGg7KW5bcisrXT1hcmd1bWVudHNbbysrXTtyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKG8scyl7bltyXT1mdW5jdGlvbihlKXtpZihpKWlmKGk9ITEsZSlzKGUpO2Vsc2Uge2Zvcih2YXIgdD1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aC0xKSxuPTA7bjx0Lmxlbmd0aDspdFtuKytdPWFyZ3VtZW50c1tuXTtvLmFwcGx5KG51bGwsdCk7fX07dHJ5e2UuYXBwbHkodHx8bnVsbCxuKTt9Y2F0Y2goZSl7aSYmKGk9ITEscyhlKSk7fX0pKX07fSw3NDE5OihlLHQpPT57dmFyIG49dDtuLmxlbmd0aD1mdW5jdGlvbihlKXt2YXIgdD1lLmxlbmd0aDtpZighdClyZXR1cm4gMDtmb3IodmFyIG49MDstLXQlND4xJiYiPSI9PT1lLmNoYXJBdCh0KTspKytuO3JldHVybiBNYXRoLmNlaWwoMyplLmxlbmd0aCkvNC1ufTtmb3IodmFyIHI9bmV3IEFycmF5KDY0KSxvPW5ldyBBcnJheSgxMjMpLGk9MDtpPDY0OylvW3JbaV09aTwyNj9pKzY1Omk8NTI/aSs3MTppPDYyP2ktNDppLTU5fDQzXT1pKys7bi5lbmNvZGU9ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgbyxpPW51bGwscz1bXSxhPTAsdT0wO3Q8bjspe3ZhciBsPWVbdCsrXTtzd2l0Y2godSl7Y2FzZSAwOnNbYSsrXT1yW2w+PjJdLG89KDMmbCk8PDQsdT0xO2JyZWFrO2Nhc2UgMTpzW2ErK109cltvfGw+PjRdLG89KDE1JmwpPDwyLHU9MjticmVhaztjYXNlIDI6c1thKytdPXJbb3xsPj42XSxzW2ErK109cls2MyZsXSx1PTA7fWE+ODE5MSYmKChpfHwoaT1bXSkpLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcscykpLGE9MCk7fXJldHVybiB1JiYoc1thKytdPXJbb10sc1thKytdPTYxLDE9PT11JiYoc1thKytdPTYxKSksaT8oYSYmaS5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLHMuc2xpY2UoMCxhKSkpLGkuam9pbigiIikpOlN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLHMuc2xpY2UoMCxhKSl9O3ZhciBzPSJpbnZhbGlkIGVuY29kaW5nIjtuLmRlY29kZT1mdW5jdGlvbihlLHQsbil7Zm9yKHZhciByLGk9bixhPTAsdT0wO3U8ZS5sZW5ndGg7KXt2YXIgbD1lLmNoYXJDb2RlQXQodSsrKTtpZig2MT09PWwmJmE+MSlicmVhaztpZih2b2lkIDA9PT0obD1vW2xdKSl0aHJvdyBFcnJvcihzKTtzd2l0Y2goYSl7Y2FzZSAwOnI9bCxhPTE7YnJlYWs7Y2FzZSAxOnRbbisrXT1yPDwyfCg0OCZsKT4+NCxyPWwsYT0yO2JyZWFrO2Nhc2UgMjp0W24rK109KDE1JnIpPDw0fCg2MCZsKT4+MixyPWwsYT0zO2JyZWFrO2Nhc2UgMzp0W24rK109KDMmcik8PDZ8bCxhPTA7fX1pZigxPT09YSl0aHJvdyBFcnJvcihzKTtyZXR1cm4gbi1pfSxuLnRlc3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIC9eKD86W0EtWmEtejAtOSsvXXs0fSkqKD86W0EtWmEtejAtOSsvXXsyfT09fFtBLVphLXowLTkrL117M309KT8kLy50ZXN0KGUpfTt9LDkyMTE6ZT0+e2Z1bmN0aW9uIHQoKXt0aGlzLl9saXN0ZW5lcnM9e307fWUuZXhwb3J0cz10LHQucHJvdG90eXBlLm9uPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gKHRoaXMuX2xpc3RlbmVyc1tlXXx8KHRoaXMuX2xpc3RlbmVyc1tlXT1bXSkpLnB1c2goe2ZuOnQsY3R4Om58fHRoaXN9KSx0aGlzfSx0LnByb3RvdHlwZS5vZmY9ZnVuY3Rpb24oZSx0KXtpZih2b2lkIDA9PT1lKXRoaXMuX2xpc3RlbmVycz17fTtlbHNlIGlmKHZvaWQgMD09PXQpdGhpcy5fbGlzdGVuZXJzW2VdPVtdO2Vsc2UgZm9yKHZhciBuPXRoaXMuX2xpc3RlbmVyc1tlXSxyPTA7cjxuLmxlbmd0aDspbltyXS5mbj09PXQ/bi5zcGxpY2UociwxKTorK3I7cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fbGlzdGVuZXJzW2VdO2lmKHQpe2Zvcih2YXIgbj1bXSxyPTE7cjxhcmd1bWVudHMubGVuZ3RoOyluLnB1c2goYXJndW1lbnRzW3IrK10pO2ZvcihyPTA7cjx0Lmxlbmd0aDspdFtyXS5mbi5hcHBseSh0W3IrK10uY3R4LG4pO31yZXR1cm4gdGhpc307fSw5NDU6ZT0+e2Z1bmN0aW9uIHQoZSl7cmV0dXJuICJ1bmRlZmluZWQiIT10eXBlb2YgRmxvYXQzMkFycmF5P2Z1bmN0aW9uKCl7dmFyIHQ9bmV3IEZsb2F0MzJBcnJheShbLTBdKSxuPW5ldyBVaW50OEFycmF5KHQuYnVmZmVyKSxyPTEyOD09PW5bM107ZnVuY3Rpb24gbyhlLHIsbyl7dFswXT1lLHJbb109blswXSxyW28rMV09blsxXSxyW28rMl09blsyXSxyW28rM109blszXTt9ZnVuY3Rpb24gaShlLHIsbyl7dFswXT1lLHJbb109blszXSxyW28rMV09blsyXSxyW28rMl09blsxXSxyW28rM109blswXTt9ZnVuY3Rpb24gcyhlLHIpe3JldHVybiBuWzBdPWVbcl0sblsxXT1lW3IrMV0sblsyXT1lW3IrMl0sblszXT1lW3IrM10sdFswXX1mdW5jdGlvbiBhKGUscil7cmV0dXJuIG5bM109ZVtyXSxuWzJdPWVbcisxXSxuWzFdPWVbcisyXSxuWzBdPWVbciszXSx0WzBdfWUud3JpdGVGbG9hdExFPXI/bzppLGUud3JpdGVGbG9hdEJFPXI/aTpvLGUucmVhZEZsb2F0TEU9cj9zOmEsZS5yZWFkRmxvYXRCRT1yP2E6czt9KCk6ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsdCxuLHIpe3ZhciBvPXQ8MD8xOjA7aWYobyYmKHQ9LXQpLDA9PT10KWUoMS90PjA/MDoyMTQ3NDgzNjQ4LG4scik7ZWxzZSBpZihpc05hTih0KSllKDIxNDMyODkzNDQsbixyKTtlbHNlIGlmKHQ+MzQwMjgyMzQ2NjM4NTI4ODZlMjIpZSgobzw8MzF8MjEzOTA5NTA0MCk+Pj4wLG4scik7ZWxzZSBpZih0PDExNzU0OTQzNTA4MjIyODc1ZS01NCllKChvPDwzMXxNYXRoLnJvdW5kKHQvMTQwMTI5ODQ2NDMyNDgxN2UtNjApKT4+PjAsbixyKTtlbHNlIHt2YXIgaT1NYXRoLmZsb29yKE1hdGgubG9nKHQpL01hdGguTE4yKTtlKChvPDwzMXxpKzEyNzw8MjN8ODM4ODYwNyZNYXRoLnJvdW5kKHQqTWF0aC5wb3coMiwtaSkqODM4ODYwOCkpPj4+MCxuLHIpO319ZnVuY3Rpb24gcyhlLHQsbil7dmFyIHI9ZSh0LG4pLG89Mioocj4+MzEpKzEsaT1yPj4+MjMmMjU1LHM9ODM4ODYwNyZyO3JldHVybiAyNTU9PT1pP3M/TmFOOm8qKDEvMCk6MD09PWk/MTQwMTI5ODQ2NDMyNDgxN2UtNjAqbypzOm8qTWF0aC5wb3coMixpLTE1MCkqKHMrODM4ODYwOCl9ZS53cml0ZUZsb2F0TEU9dC5iaW5kKG51bGwsbiksZS53cml0ZUZsb2F0QkU9dC5iaW5kKG51bGwsciksZS5yZWFkRmxvYXRMRT1zLmJpbmQobnVsbCxvKSxlLnJlYWRGbG9hdEJFPXMuYmluZChudWxsLGkpO30oKSwidW5kZWZpbmVkIiE9dHlwZW9mIEZsb2F0NjRBcnJheT9mdW5jdGlvbigpe3ZhciB0PW5ldyBGbG9hdDY0QXJyYXkoWy0wXSksbj1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcikscj0xMjg9PT1uWzddO2Z1bmN0aW9uIG8oZSxyLG8pe3RbMF09ZSxyW29dPW5bMF0scltvKzFdPW5bMV0scltvKzJdPW5bMl0scltvKzNdPW5bM10scltvKzRdPW5bNF0scltvKzVdPW5bNV0scltvKzZdPW5bNl0scltvKzddPW5bN107fWZ1bmN0aW9uIGkoZSxyLG8pe3RbMF09ZSxyW29dPW5bN10scltvKzFdPW5bNl0scltvKzJdPW5bNV0scltvKzNdPW5bNF0scltvKzRdPW5bM10scltvKzVdPW5bMl0scltvKzZdPW5bMV0scltvKzddPW5bMF07fWZ1bmN0aW9uIHMoZSxyKXtyZXR1cm4gblswXT1lW3JdLG5bMV09ZVtyKzFdLG5bMl09ZVtyKzJdLG5bM109ZVtyKzNdLG5bNF09ZVtyKzRdLG5bNV09ZVtyKzVdLG5bNl09ZVtyKzZdLG5bN109ZVtyKzddLHRbMF19ZnVuY3Rpb24gYShlLHIpe3JldHVybiBuWzddPWVbcl0sbls2XT1lW3IrMV0sbls1XT1lW3IrMl0sbls0XT1lW3IrM10sblszXT1lW3IrNF0sblsyXT1lW3IrNV0sblsxXT1lW3IrNl0sblswXT1lW3IrN10sdFswXX1lLndyaXRlRG91YmxlTEU9cj9vOmksZS53cml0ZURvdWJsZUJFPXI/aTpvLGUucmVhZERvdWJsZUxFPXI/czphLGUucmVhZERvdWJsZUJFPXI/YTpzO30oKTpmdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0LG4scixvLGkpe3ZhciBzPXI8MD8xOjA7aWYocyYmKHI9LXIpLDA9PT1yKWUoMCxvLGkrdCksZSgxL3I+MD8wOjIxNDc0ODM2NDgsbyxpK24pO2Vsc2UgaWYoaXNOYU4ocikpZSgwLG8saSt0KSxlKDIxNDY5NTkzNjAsbyxpK24pO2Vsc2UgaWYocj4xNzk3NjkzMTM0ODYyMzE1N2UyOTIpZSgwLG8saSt0KSxlKChzPDwzMXwyMTQ2NDM1MDcyKT4+PjAsbyxpK24pO2Vsc2Uge3ZhciBhO2lmKHI8MjIyNTA3Mzg1ODUwNzIwMTRlLTMyNCllKChhPXIvNWUtMzI0KT4+PjAsbyxpK3QpLGUoKHM8PDMxfGEvNDI5NDk2NzI5Nik+Pj4wLG8saStuKTtlbHNlIHt2YXIgdT1NYXRoLmZsb29yKE1hdGgubG9nKHIpL01hdGguTE4yKTsxMDI0PT09dSYmKHU9MTAyMyksZSg0NTAzNTk5NjI3MzcwNDk2KihhPXIqTWF0aC5wb3coMiwtdSkpPj4+MCxvLGkrdCksZSgoczw8MzF8dSsxMDIzPDwyMHwxMDQ4NTc2KmEmMTA0ODU3NSk+Pj4wLG8saStuKTt9fX1mdW5jdGlvbiBzKGUsdCxuLHIsbyl7dmFyIGk9ZShyLG8rdCkscz1lKHIsbytuKSxhPTIqKHM+PjMxKSsxLHU9cz4+PjIwJjIwNDcsbD00Mjk0OTY3Mjk2KigxMDQ4NTc1JnMpK2k7cmV0dXJuIDIwNDc9PT11P2w/TmFOOmEqKDEvMCk6MD09PXU/NWUtMzI0KmEqbDphKk1hdGgucG93KDIsdS0xMDc1KSoobCs0NTAzNTk5NjI3MzcwNDk2KX1lLndyaXRlRG91YmxlTEU9dC5iaW5kKG51bGwsbiwwLDQpLGUud3JpdGVEb3VibGVCRT10LmJpbmQobnVsbCxyLDQsMCksZS5yZWFkRG91YmxlTEU9cy5iaW5kKG51bGwsbywwLDQpLGUucmVhZERvdWJsZUJFPXMuYmluZChudWxsLGksNCwwKTt9KCksZX1mdW5jdGlvbiBuKGUsdCxuKXt0W25dPTI1NSZlLHRbbisxXT1lPj4+OCYyNTUsdFtuKzJdPWU+Pj4xNiYyNTUsdFtuKzNdPWU+Pj4yNDt9ZnVuY3Rpb24gcihlLHQsbil7dFtuXT1lPj4+MjQsdFtuKzFdPWU+Pj4xNiYyNTUsdFtuKzJdPWU+Pj44JjI1NSx0W24rM109MjU1JmU7fWZ1bmN0aW9uIG8oZSx0KXtyZXR1cm4gKGVbdF18ZVt0KzFdPDw4fGVbdCsyXTw8MTZ8ZVt0KzNdPDwyNCk+Pj4wfWZ1bmN0aW9uIGkoZSx0KXtyZXR1cm4gKGVbdF08PDI0fGVbdCsxXTw8MTZ8ZVt0KzJdPDw4fGVbdCszXSk+Pj4wfWUuZXhwb3J0cz10KHQpO30sNzE5OTptb2R1bGU9PntmdW5jdGlvbiBpbnF1aXJlKG1vZHVsZU5hbWUpe3RyeXt2YXIgbW9kPWV2YWwoInF1aXJlIi5yZXBsYWNlKC9eLywicmUiKSkobW9kdWxlTmFtZSk7aWYobW9kJiYobW9kLmxlbmd0aHx8T2JqZWN0LmtleXMobW9kKS5sZW5ndGgpKXJldHVybiBtb2R9Y2F0Y2goZSl7fXJldHVybiBudWxsfW1vZHVsZS5leHBvcnRzPWlucXVpcmU7fSw2NjYyOmU9PntlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW58fDgxOTIsbz1yPj4+MSxpPW51bGwscz1yO3JldHVybiBmdW5jdGlvbihuKXtpZihuPDF8fG4+bylyZXR1cm4gZShuKTtzK24+ciYmKGk9ZShyKSxzPTApO3ZhciBhPXQuY2FsbChpLHMscys9bik7cmV0dXJuIDcmcyYmKHM9MSsoN3xzKSksYX19O30sNDk5NzooZSx0KT0+e3ZhciBuPXQ7bi5sZW5ndGg9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsbj0wLHI9MDtyPGUubGVuZ3RoOysrcikobj1lLmNoYXJDb2RlQXQocikpPDEyOD90Kz0xOm48MjA0OD90Kz0yOjU1Mjk2PT0oNjQ1MTImbikmJjU2MzIwPT0oNjQ1MTImZS5jaGFyQ29kZUF0KHIrMSkpPygrK3IsdCs9NCk6dCs9MztyZXR1cm4gdH0sbi5yZWFkPWZ1bmN0aW9uKGUsdCxuKXtpZihuLXQ8MSlyZXR1cm4gIiI7Zm9yKHZhciByLG89bnVsbCxpPVtdLHM9MDt0PG47KShyPWVbdCsrXSk8MTI4P2lbcysrXT1yOnI+MTkxJiZyPDIyND9pW3MrK109KDMxJnIpPDw2fDYzJmVbdCsrXTpyPjIzOSYmcjwzNjU/KHI9KCg3JnIpPDwxOHwoNjMmZVt0KytdKTw8MTJ8KDYzJmVbdCsrXSk8PDZ8NjMmZVt0KytdKS02NTUzNixpW3MrK109NTUyOTYrKHI+PjEwKSxpW3MrK109NTYzMjArKDEwMjMmcikpOmlbcysrXT0oMTUmcik8PDEyfCg2MyZlW3QrK10pPDw2fDYzJmVbdCsrXSxzPjgxOTEmJigob3x8KG89W10pKS5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLGkpKSxzPTApO3JldHVybiBvPyhzJiZvLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsaS5zbGljZSgwLHMpKSksby5qb2luKCIiKSk6U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsaS5zbGljZSgwLHMpKX0sbi53cml0ZT1mdW5jdGlvbihlLHQsbil7Zm9yKHZhciByLG8saT1uLHM9MDtzPGUubGVuZ3RoOysrcykocj1lLmNoYXJDb2RlQXQocykpPDEyOD90W24rK109cjpyPDIwNDg/KHRbbisrXT1yPj42fDE5Mix0W24rK109NjMmcnwxMjgpOjU1Mjk2PT0oNjQ1MTImcikmJjU2MzIwPT0oNjQ1MTImKG89ZS5jaGFyQ29kZUF0KHMrMSkpKT8ocj02NTUzNisoKDEwMjMmcik8PDEwKSsoMTAyMyZvKSwrK3MsdFtuKytdPXI+PjE4fDI0MCx0W24rK109cj4+MTImNjN8MTI4LHRbbisrXT1yPj42JjYzfDEyOCx0W24rK109NjMmcnwxMjgpOih0W24rK109cj4+MTJ8MjI0LHRbbisrXT1yPj42JjYzfDEyOCx0W24rK109NjMmcnwxMjgpO3JldHVybiBuLWl9O30sMzQ0MjooZSx0KT0+e3QuX19lc01vZHVsZT0hMDt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7aWYoIXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhcmd1bWVudDsgYHZhbHVlYCBoYXMgbm8gdmFsdWUuIik7dGhpcy52YWx1ZT1lLkVNUFRZLHQmJmUuaXNHdWlkKHQpJiYodGhpcy52YWx1ZT10KTt9cmV0dXJuIGUuaXNHdWlkPWZ1bmN0aW9uKHQpe3ZhciBuPXQudG9TdHJpbmcoKTtyZXR1cm4gdCYmKHQgaW5zdGFuY2VvZiBlfHxlLnZhbGlkYXRvci50ZXN0KG4pKX0sZS5jcmVhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGUoW2UuZ2VuKDIpLGUuZ2VuKDEpLGUuZ2VuKDEpLGUuZ2VuKDEpLGUuZ2VuKDMpXS5qb2luKCItIikpfSxlLmNyZWF0ZUVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKCJlbXB0eWd1aWQiKX0sZS5wYXJzZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCl9LGUucmF3PWZ1bmN0aW9uKCl7cmV0dXJuIFtlLmdlbigyKSxlLmdlbigxKSxlLmdlbigxKSxlLmdlbigxKSxlLmdlbigzKV0uam9pbigiLSIpfSxlLmdlbj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9IiIsbj0wO248ZTtuKyspdCs9KDY1NTM2KigxK01hdGgucmFuZG9tKCkpfDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7cmV0dXJuIHR9LGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbih0KXtyZXR1cm4gZS5pc0d1aWQodCkmJnRoaXMudmFsdWU9PT10LnRvU3RyaW5nKCl9LGUucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZT09PWUuRU1QVFl9LGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWV9LGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB7dmFsdWU6dGhpcy52YWx1ZX19LGUudmFsaWRhdG9yPW5ldyBSZWdFeHAoIl5bYS16MC05XXs4fS1bYS16MC05XXs0fS1bYS16MC05XXs0fS1bYS16MC05XXs0fS1bYS16MC05XXsxMn0kIiwiaSIpLGUuRU1QVFk9IjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCIsZX0oKTt0Lkd1aWQ9bjt9LDIxMDA6KGUsdCxuKT0+e2UuZXhwb3J0cz1uKDk0ODIpO30sOTQ4MjooZSx0LG4pPT57dmFyIHI9dDtmdW5jdGlvbiBvKCl7ci51dGlsLl9jb25maWd1cmUoKSxyLldyaXRlci5fY29uZmlndXJlKHIuQnVmZmVyV3JpdGVyKSxyLlJlYWRlci5fY29uZmlndXJlKHIuQnVmZmVyUmVhZGVyKTt9ci5idWlsZD0ibWluaW1hbCIsci5Xcml0ZXI9bigxMTczKSxyLkJ1ZmZlcldyaXRlcj1uKDMxNTUpLHIuUmVhZGVyPW4oMTQwOCksci5CdWZmZXJSZWFkZXI9big1OTMpLHIudXRpbD1uKDk2OTMpLHIucnBjPW4oNTk5NCksci5yb290cz1uKDUwNTQpLHIuY29uZmlndXJlPW8sbygpO30sMTQwODooZSx0LG4pPT57ZS5leHBvcnRzPXU7dmFyIHIsbz1uKDk2OTMpLGk9by5Mb25nQml0cyxzPW8udXRmODtmdW5jdGlvbiBhKGUsdCl7cmV0dXJuIFJhbmdlRXJyb3IoImluZGV4IG91dCBvZiByYW5nZTogIitlLnBvcysiICsgIisodHx8MSkrIiA+ICIrZS5sZW4pfWZ1bmN0aW9uIHUoZSl7dGhpcy5idWY9ZSx0aGlzLnBvcz0wLHRoaXMubGVuPWUubGVuZ3RoO312YXIgbCxjPSJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheT9mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgVWludDhBcnJheXx8QXJyYXkuaXNBcnJheShlKSlyZXR1cm4gbmV3IHUoZSk7dGhyb3cgRXJyb3IoImlsbGVnYWwgYnVmZmVyIil9OmZ1bmN0aW9uKGUpe2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIG5ldyB1KGUpO3Rocm93IEVycm9yKCJpbGxlZ2FsIGJ1ZmZlciIpfSxwPWZ1bmN0aW9uKCl7cmV0dXJuIG8uQnVmZmVyP2Z1bmN0aW9uKGUpe3JldHVybiAodS5jcmVhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIG8uQnVmZmVyLmlzQnVmZmVyKGUpP25ldyByKGUpOmMoZSl9KShlKX06Y307ZnVuY3Rpb24gZCgpe3ZhciBlPW5ldyBpKDAsMCksdD0wO2lmKCEodGhpcy5sZW4tdGhpcy5wb3M+NCkpe2Zvcig7dDwzOysrdCl7aWYodGhpcy5wb3M+PXRoaXMubGVuKXRocm93IGEodGhpcyk7aWYoZS5sbz0oZS5sb3woMTI3JnRoaXMuYnVmW3RoaXMucG9zXSk8PDcqdCk+Pj4wLHRoaXMuYnVmW3RoaXMucG9zKytdPDEyOClyZXR1cm4gZX1yZXR1cm4gZS5sbz0oZS5sb3woMTI3JnRoaXMuYnVmW3RoaXMucG9zKytdKTw8Nyp0KT4+PjAsZX1mb3IoO3Q8NDsrK3QpaWYoZS5sbz0oZS5sb3woMTI3JnRoaXMuYnVmW3RoaXMucG9zXSk8PDcqdCk+Pj4wLHRoaXMuYnVmW3RoaXMucG9zKytdPDEyOClyZXR1cm4gZTtpZihlLmxvPShlLmxvfCgxMjcmdGhpcy5idWZbdGhpcy5wb3NdKTw8MjgpPj4+MCxlLmhpPShlLmhpfCgxMjcmdGhpcy5idWZbdGhpcy5wb3NdKT4+NCk+Pj4wLHRoaXMuYnVmW3RoaXMucG9zKytdPDEyOClyZXR1cm4gZTtpZih0PTAsdGhpcy5sZW4tdGhpcy5wb3M+NCl7Zm9yKDt0PDU7Kyt0KWlmKGUuaGk9KGUuaGl8KDEyNyZ0aGlzLmJ1Zlt0aGlzLnBvc10pPDw3KnQrMyk+Pj4wLHRoaXMuYnVmW3RoaXMucG9zKytdPDEyOClyZXR1cm4gZX1lbHNlIGZvcig7dDw1OysrdCl7aWYodGhpcy5wb3M+PXRoaXMubGVuKXRocm93IGEodGhpcyk7aWYoZS5oaT0oZS5oaXwoMTI3JnRoaXMuYnVmW3RoaXMucG9zXSk8PDcqdCszKT4+PjAsdGhpcy5idWZbdGhpcy5wb3MrK108MTI4KXJldHVybiBlfXRocm93IEVycm9yKCJpbnZhbGlkIHZhcmludCBlbmNvZGluZyIpfWZ1bmN0aW9uIGYoZSx0KXtyZXR1cm4gKGVbdC00XXxlW3QtM108PDh8ZVt0LTJdPDwxNnxlW3QtMV08PDI0KT4+PjB9ZnVuY3Rpb24gaCgpe2lmKHRoaXMucG9zKzg+dGhpcy5sZW4pdGhyb3cgYSh0aGlzLDgpO3JldHVybiBuZXcgaShmKHRoaXMuYnVmLHRoaXMucG9zKz00KSxmKHRoaXMuYnVmLHRoaXMucG9zKz00KSl9dS5jcmVhdGU9cCgpLHUucHJvdG90eXBlLl9zbGljZT1vLkFycmF5LnByb3RvdHlwZS5zdWJhcnJheXx8by5BcnJheS5wcm90b3R5cGUuc2xpY2UsdS5wcm90b3R5cGUudWludDMyPShsPTQyOTQ5NjcyOTUsZnVuY3Rpb24oKXtpZihsPSgxMjcmdGhpcy5idWZbdGhpcy5wb3NdKT4+PjAsdGhpcy5idWZbdGhpcy5wb3MrK108MTI4KXJldHVybiBsO2lmKGw9KGx8KDEyNyZ0aGlzLmJ1Zlt0aGlzLnBvc10pPDw3KT4+PjAsdGhpcy5idWZbdGhpcy5wb3MrK108MTI4KXJldHVybiBsO2lmKGw9KGx8KDEyNyZ0aGlzLmJ1Zlt0aGlzLnBvc10pPDwxNCk+Pj4wLHRoaXMuYnVmW3RoaXMucG9zKytdPDEyOClyZXR1cm4gbDtpZihsPShsfCgxMjcmdGhpcy5idWZbdGhpcy5wb3NdKTw8MjEpPj4+MCx0aGlzLmJ1Zlt0aGlzLnBvcysrXTwxMjgpcmV0dXJuIGw7aWYobD0obHwoMTUmdGhpcy5idWZbdGhpcy5wb3NdKTw8MjgpPj4+MCx0aGlzLmJ1Zlt0aGlzLnBvcysrXTwxMjgpcmV0dXJuIGw7aWYoKHRoaXMucG9zKz01KT50aGlzLmxlbil0aHJvdyB0aGlzLnBvcz10aGlzLmxlbixhKHRoaXMsMTApO3JldHVybiBsfSksdS5wcm90b3R5cGUuaW50MzI9ZnVuY3Rpb24oKXtyZXR1cm4gMHx0aGlzLnVpbnQzMigpfSx1LnByb3RvdHlwZS5zaW50MzI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnVpbnQzMigpO3JldHVybiBlPj4+MV4tKDEmZSl8MH0sdS5wcm90b3R5cGUuYm9vbD1mdW5jdGlvbigpe3JldHVybiAwIT09dGhpcy51aW50MzIoKX0sdS5wcm90b3R5cGUuZml4ZWQzMj1mdW5jdGlvbigpe2lmKHRoaXMucG9zKzQ+dGhpcy5sZW4pdGhyb3cgYSh0aGlzLDQpO3JldHVybiBmKHRoaXMuYnVmLHRoaXMucG9zKz00KX0sdS5wcm90b3R5cGUuc2ZpeGVkMzI9ZnVuY3Rpb24oKXtpZih0aGlzLnBvcys0PnRoaXMubGVuKXRocm93IGEodGhpcyw0KTtyZXR1cm4gMHxmKHRoaXMuYnVmLHRoaXMucG9zKz00KX0sdS5wcm90b3R5cGUuZmxvYXQ9ZnVuY3Rpb24oKXtpZih0aGlzLnBvcys0PnRoaXMubGVuKXRocm93IGEodGhpcyw0KTt2YXIgZT1vLmZsb2F0LnJlYWRGbG9hdExFKHRoaXMuYnVmLHRoaXMucG9zKTtyZXR1cm4gdGhpcy5wb3MrPTQsZX0sdS5wcm90b3R5cGUuZG91YmxlPWZ1bmN0aW9uKCl7aWYodGhpcy5wb3MrOD50aGlzLmxlbil0aHJvdyBhKHRoaXMsNCk7dmFyIGU9by5mbG9hdC5yZWFkRG91YmxlTEUodGhpcy5idWYsdGhpcy5wb3MpO3JldHVybiB0aGlzLnBvcys9OCxlfSx1LnByb3RvdHlwZS5ieXRlcz1mdW5jdGlvbigpe3ZhciBlPXRoaXMudWludDMyKCksdD10aGlzLnBvcyxuPXRoaXMucG9zK2U7aWYobj50aGlzLmxlbil0aHJvdyBhKHRoaXMsZSk7cmV0dXJuIHRoaXMucG9zKz1lLEFycmF5LmlzQXJyYXkodGhpcy5idWYpP3RoaXMuYnVmLnNsaWNlKHQsbik6dD09PW4/bmV3IHRoaXMuYnVmLmNvbnN0cnVjdG9yKDApOnRoaXMuX3NsaWNlLmNhbGwodGhpcy5idWYsdCxuKX0sdS5wcm90b3R5cGUuc3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5ieXRlcygpO3JldHVybiBzLnJlYWQoZSwwLGUubGVuZ3RoKX0sdS5wcm90b3R5cGUuc2tpcD1mdW5jdGlvbihlKXtpZigibnVtYmVyIj09dHlwZW9mIGUpe2lmKHRoaXMucG9zK2U+dGhpcy5sZW4pdGhyb3cgYSh0aGlzLGUpO3RoaXMucG9zKz1lO31lbHNlIGRve2lmKHRoaXMucG9zPj10aGlzLmxlbil0aHJvdyBhKHRoaXMpfXdoaWxlKDEyOCZ0aGlzLmJ1Zlt0aGlzLnBvcysrXSk7cmV0dXJuIHRoaXN9LHUucHJvdG90eXBlLnNraXBUeXBlPWZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIDA6dGhpcy5za2lwKCk7YnJlYWs7Y2FzZSAxOnRoaXMuc2tpcCg4KTticmVhaztjYXNlIDI6dGhpcy5za2lwKHRoaXMudWludDMyKCkpO2JyZWFrO2Nhc2UgMzpmb3IoOzQhPShlPTcmdGhpcy51aW50MzIoKSk7KXRoaXMuc2tpcFR5cGUoZSk7YnJlYWs7Y2FzZSA1OnRoaXMuc2tpcCg0KTticmVhaztkZWZhdWx0OnRocm93IEVycm9yKCJpbnZhbGlkIHdpcmUgdHlwZSAiK2UrIiBhdCBvZmZzZXQgIit0aGlzLnBvcyl9cmV0dXJuIHRoaXN9LHUuX2NvbmZpZ3VyZT1mdW5jdGlvbihlKXtyPWUsdS5jcmVhdGU9cCgpLHIuX2NvbmZpZ3VyZSgpO3ZhciB0PW8uTG9uZz8idG9Mb25nIjoidG9OdW1iZXIiO28ubWVyZ2UodS5wcm90b3R5cGUse2ludDY0OmZ1bmN0aW9uKCl7cmV0dXJuIGQuY2FsbCh0aGlzKVt0XSghMSl9LHVpbnQ2NDpmdW5jdGlvbigpe3JldHVybiBkLmNhbGwodGhpcylbdF0oITApfSxzaW50NjQ6ZnVuY3Rpb24oKXtyZXR1cm4gZC5jYWxsKHRoaXMpLnp6RGVjb2RlKClbdF0oITEpfSxmaXhlZDY0OmZ1bmN0aW9uKCl7cmV0dXJuIGguY2FsbCh0aGlzKVt0XSghMCl9LHNmaXhlZDY0OmZ1bmN0aW9uKCl7cmV0dXJuIGguY2FsbCh0aGlzKVt0XSghMSl9fSk7fTt9LDU5MzooZSx0LG4pPT57ZS5leHBvcnRzPWk7dmFyIHI9bigxNDA4KTsoaS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShyLnByb3RvdHlwZSkpLmNvbnN0cnVjdG9yPWk7dmFyIG89big5NjkzKTtmdW5jdGlvbiBpKGUpe3IuY2FsbCh0aGlzLGUpO31pLl9jb25maWd1cmU9ZnVuY3Rpb24oKXtvLkJ1ZmZlciYmKGkucHJvdG90eXBlLl9zbGljZT1vLkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UpO30saS5wcm90b3R5cGUuc3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy51aW50MzIoKTtyZXR1cm4gdGhpcy5idWYudXRmOFNsaWNlP3RoaXMuYnVmLnV0ZjhTbGljZSh0aGlzLnBvcyx0aGlzLnBvcz1NYXRoLm1pbih0aGlzLnBvcytlLHRoaXMubGVuKSk6dGhpcy5idWYudG9TdHJpbmcoInV0Zi04Iix0aGlzLnBvcyx0aGlzLnBvcz1NYXRoLm1pbih0aGlzLnBvcytlLHRoaXMubGVuKSl9LGkuX2NvbmZpZ3VyZSgpO30sNTA1NDplPT57ZS5leHBvcnRzPXt9O30sNTk5NDooZSx0LG4pPT57dC5TZXJ2aWNlPW4oNzk0OCk7fSw3OTQ4OihlLHQsbik9PntlLmV4cG9ydHM9bzt2YXIgcj1uKDk2OTMpO2Z1bmN0aW9uIG8oZSx0LG4pe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlKXRocm93IFR5cGVFcnJvcigicnBjSW1wbCBtdXN0IGJlIGEgZnVuY3Rpb24iKTtyLkV2ZW50RW1pdHRlci5jYWxsKHRoaXMpLHRoaXMucnBjSW1wbD1lLHRoaXMucmVxdWVzdERlbGltaXRlZD1Cb29sZWFuKHQpLHRoaXMucmVzcG9uc2VEZWxpbWl0ZWQ9Qm9vbGVhbihuKTt9KG8ucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoci5FdmVudEVtaXR0ZXIucHJvdG90eXBlKSkuY29uc3RydWN0b3I9byxvLnByb3RvdHlwZS5ycGNDYWxsPWZ1bmN0aW9uIGUodCxuLG8saSxzKXtpZighaSl0aHJvdyBUeXBlRXJyb3IoInJlcXVlc3QgbXVzdCBiZSBzcGVjaWZpZWQiKTt2YXIgYT10aGlzO2lmKCFzKXJldHVybiByLmFzUHJvbWlzZShlLGEsdCxuLG8saSk7aWYoYS5ycGNJbXBsKXRyeXtyZXR1cm4gYS5ycGNJbXBsKHQsblthLnJlcXVlc3REZWxpbWl0ZWQ/ImVuY29kZURlbGltaXRlZCI6ImVuY29kZSJdKGkpLmZpbmlzaCgpLChmdW5jdGlvbihlLG4pe2lmKGUpcmV0dXJuIGEuZW1pdCgiZXJyb3IiLGUsdCkscyhlKTtpZihudWxsIT09bil7aWYoIShuIGluc3RhbmNlb2YgbykpdHJ5e249b1thLnJlc3BvbnNlRGVsaW1pdGVkPyJkZWNvZGVEZWxpbWl0ZWQiOiJkZWNvZGUiXShuKTt9Y2F0Y2goZSl7cmV0dXJuIGEuZW1pdCgiZXJyb3IiLGUsdCkscyhlKX1yZXR1cm4gYS5lbWl0KCJkYXRhIixuLHQpLHMobnVsbCxuKX1hLmVuZCghMCk7fSkpfWNhdGNoKGUpe3JldHVybiBhLmVtaXQoImVycm9yIixlLHQpLHZvaWQgc2V0VGltZW91dCgoZnVuY3Rpb24oKXtzKGUpO30pLDApfWVsc2Ugc2V0VGltZW91dCgoZnVuY3Rpb24oKXtzKEVycm9yKCJhbHJlYWR5IGVuZGVkIikpO30pLDApO30sby5wcm90b3R5cGUuZW5kPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnJwY0ltcGwmJihlfHx0aGlzLnJwY0ltcGwobnVsbCxudWxsLG51bGwpLHRoaXMucnBjSW1wbD1udWxsLHRoaXMuZW1pdCgiZW5kIikub2ZmKCkpLHRoaXN9O30sMTk0NTooZSx0LG4pPT57ZS5leHBvcnRzPW87dmFyIHI9big5NjkzKTtmdW5jdGlvbiBvKGUsdCl7dGhpcy5sbz1lPj4+MCx0aGlzLmhpPXQ+Pj4wO312YXIgaT1vLnplcm89bmV3IG8oMCwwKTtpLnRvTnVtYmVyPWZ1bmN0aW9uKCl7cmV0dXJuIDB9LGkuenpFbmNvZGU9aS56ekRlY29kZT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxpLmxlbmd0aD1mdW5jdGlvbigpe3JldHVybiAxfTt2YXIgcz1vLnplcm9IYXNoPSJcMFwwXDBcMFwwXDBcMFwwIjtvLmZyb21OdW1iZXI9ZnVuY3Rpb24oZSl7aWYoMD09PWUpcmV0dXJuIGk7dmFyIHQ9ZTwwO3QmJihlPS1lKTt2YXIgbj1lPj4+MCxyPShlLW4pLzQyOTQ5NjcyOTY+Pj4wO3JldHVybiB0JiYocj1+cj4+PjAsbj1+bj4+PjAsKytuPjQyOTQ5NjcyOTUmJihuPTAsKytyPjQyOTQ5NjcyOTUmJihyPTApKSksbmV3IG8obixyKX0sby5mcm9tPWZ1bmN0aW9uKGUpe2lmKCJudW1iZXIiPT10eXBlb2YgZSlyZXR1cm4gby5mcm9tTnVtYmVyKGUpO2lmKHIuaXNTdHJpbmcoZSkpe2lmKCFyLkxvbmcpcmV0dXJuIG8uZnJvbU51bWJlcihwYXJzZUludChlLDEwKSk7ZT1yLkxvbmcuZnJvbVN0cmluZyhlKTt9cmV0dXJuIGUubG93fHxlLmhpZ2g/bmV3IG8oZS5sb3c+Pj4wLGUuaGlnaD4+PjApOml9LG8ucHJvdG90eXBlLnRvTnVtYmVyPWZ1bmN0aW9uKGUpe2lmKCFlJiZ0aGlzLmhpPj4+MzEpe3ZhciB0PTErfnRoaXMubG8+Pj4wLG49fnRoaXMuaGk+Pj4wO3JldHVybiB0fHwobj1uKzE+Pj4wKSwtKHQrNDI5NDk2NzI5NipuKX1yZXR1cm4gdGhpcy5sbys0Mjk0OTY3Mjk2KnRoaXMuaGl9LG8ucHJvdG90eXBlLnRvTG9uZz1mdW5jdGlvbihlKXtyZXR1cm4gci5Mb25nP25ldyByLkxvbmcoMHx0aGlzLmxvLDB8dGhpcy5oaSxCb29sZWFuKGUpKTp7bG93OjB8dGhpcy5sbyxoaWdoOjB8dGhpcy5oaSx1bnNpZ25lZDpCb29sZWFuKGUpfX07dmFyIGE9U3RyaW5nLnByb3RvdHlwZS5jaGFyQ29kZUF0O28uZnJvbUhhc2g9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1zP2k6bmV3IG8oKGEuY2FsbChlLDApfGEuY2FsbChlLDEpPDw4fGEuY2FsbChlLDIpPDwxNnxhLmNhbGwoZSwzKTw8MjQpPj4+MCwoYS5jYWxsKGUsNCl8YS5jYWxsKGUsNSk8PDh8YS5jYWxsKGUsNik8PDE2fGEuY2FsbChlLDcpPDwyNCk+Pj4wKX0sby5wcm90b3R5cGUudG9IYXNoPWZ1bmN0aW9uKCl7cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoMjU1JnRoaXMubG8sdGhpcy5sbz4+PjgmMjU1LHRoaXMubG8+Pj4xNiYyNTUsdGhpcy5sbz4+PjI0LDI1NSZ0aGlzLmhpLHRoaXMuaGk+Pj44JjI1NSx0aGlzLmhpPj4+MTYmMjU1LHRoaXMuaGk+Pj4yNCl9LG8ucHJvdG90eXBlLnp6RW5jb2RlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5oaT4+MzE7cmV0dXJuIHRoaXMuaGk9KCh0aGlzLmhpPDwxfHRoaXMubG8+Pj4zMSleZSk+Pj4wLHRoaXMubG89KHRoaXMubG88PDFeZSk+Pj4wLHRoaXN9LG8ucHJvdG90eXBlLnp6RGVjb2RlPWZ1bmN0aW9uKCl7dmFyIGU9LSgxJnRoaXMubG8pO3JldHVybiB0aGlzLmxvPSgodGhpcy5sbz4+PjF8dGhpcy5oaTw8MzEpXmUpPj4+MCx0aGlzLmhpPSh0aGlzLmhpPj4+MV5lKT4+PjAsdGhpc30sby5wcm90b3R5cGUubGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5sbyx0PSh0aGlzLmxvPj4+Mjh8dGhpcy5oaTw8NCk+Pj4wLG49dGhpcy5oaT4+PjI0O3JldHVybiAwPT09bj8wPT09dD9lPDE2Mzg0P2U8MTI4PzE6MjplPDIwOTcxNTI/Mzo0OnQ8MTYzODQ/dDwxMjg/NTo2OnQ8MjA5NzE1Mj83Ojg6bjwxMjg/OToxMH07fSw5NjkzOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10O2Z1bmN0aW9uIG8oZSx0LG4pe2Zvcih2YXIgcj1PYmplY3Qua2V5cyh0KSxvPTA7bzxyLmxlbmd0aDsrK28pdm9pZCAwIT09ZVtyW29dXSYmbnx8KGVbcltvXV09dFtyW29dXSk7cmV0dXJuIGV9ZnVuY3Rpb24gaShlKXtmdW5jdGlvbiB0KGUsbil7aWYoISh0aGlzIGluc3RhbmNlb2YgdCkpcmV0dXJuIG5ldyB0KGUsbik7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIm1lc3NhZ2UiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZX19KSxFcnJvci5jYXB0dXJlU3RhY2tUcmFjZT9FcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLHQpOk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCJzdGFjayIse3ZhbHVlOihuZXcgRXJyb3IpLnN0YWNrfHwiIn0pLG4mJm8odGhpcyxuKTt9cmV0dXJuIHQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6dCx3cml0YWJsZTohMCxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0sbmFtZTp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGV9LHNldDp2b2lkIDAsZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9LHRvU3RyaW5nOnt2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWUrIjogIit0aGlzLm1lc3NhZ2V9LHdyaXRhYmxlOiEwLGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfX0pLHR9ci5hc1Byb21pc2U9big0NTM3KSxyLmJhc2U2ND1uKDc0MTkpLHIuRXZlbnRFbWl0dGVyPW4oOTIxMSksci5mbG9hdD1uKDk0NSksci5pbnF1aXJlPW4oNzE5OSksci51dGY4PW4oNDk5Nyksci5wb29sPW4oNjY2Miksci5Mb25nQml0cz1uKDE5NDUpLHIuaXNOb2RlPUJvb2xlYW4odm9pZCAwIT09Y29tbW9uanNHbG9iYWwmJmNvbW1vbmpzR2xvYmFsJiZjb21tb25qc0dsb2JhbC5wcm9jZXNzJiZjb21tb25qc0dsb2JhbC5wcm9jZXNzLnZlcnNpb25zJiZjb21tb25qc0dsb2JhbC5wcm9jZXNzLnZlcnNpb25zLm5vZGUpLHIuZ2xvYmFsPXIuaXNOb2RlJiZjb21tb25qc0dsb2JhbHx8InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvd3x8InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiZzZWxmfHx0aGlzLHIuZW1wdHlBcnJheT1PYmplY3QuZnJlZXplP09iamVjdC5mcmVlemUoW10pOltdLHIuZW1wdHlPYmplY3Q9T2JqZWN0LmZyZWV6ZT9PYmplY3QuZnJlZXplKHt9KTp7fSxyLmlzSW50ZWdlcj1OdW1iZXIuaXNJbnRlZ2VyfHxmdW5jdGlvbihlKXtyZXR1cm4gIm51bWJlciI9PXR5cGVvZiBlJiZpc0Zpbml0ZShlKSYmTWF0aC5mbG9vcihlKT09PWV9LHIuaXNTdHJpbmc9ZnVuY3Rpb24oZSl7cmV0dXJuICJzdHJpbmciPT10eXBlb2YgZXx8ZSBpbnN0YW5jZW9mIFN0cmluZ30sci5pc09iamVjdD1mdW5jdGlvbihlKXtyZXR1cm4gZSYmIm9iamVjdCI9PXR5cGVvZiBlfSxyLmlzc2V0PXIuaXNTZXQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1lW3RdO3JldHVybiAhKG51bGw9PW58fCFlLmhhc093blByb3BlcnR5KHQpKSYmKCJvYmplY3QiIT10eXBlb2Ygbnx8KEFycmF5LmlzQXJyYXkobik/bi5sZW5ndGg6T2JqZWN0LmtleXMobikubGVuZ3RoKT4wKX0sci5CdWZmZXI9ZnVuY3Rpb24oKXt0cnl7dmFyIGU9ci5pbnF1aXJlKCJidWZmZXIiKS5CdWZmZXI7cmV0dXJuIGUucHJvdG90eXBlLnV0ZjhXcml0ZT9lOm51bGx9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fSgpLHIuX0J1ZmZlcl9mcm9tPW51bGwsci5fQnVmZmVyX2FsbG9jVW5zYWZlPW51bGwsci5uZXdCdWZmZXI9ZnVuY3Rpb24oZSl7cmV0dXJuICJudW1iZXIiPT10eXBlb2YgZT9yLkJ1ZmZlcj9yLl9CdWZmZXJfYWxsb2NVbnNhZmUoZSk6bmV3IHIuQXJyYXkoZSk6ci5CdWZmZXI/ci5fQnVmZmVyX2Zyb20oZSk6InVuZGVmaW5lZCI9PXR5cGVvZiBVaW50OEFycmF5P2U6bmV3IFVpbnQ4QXJyYXkoZSl9LHIuQXJyYXk9InVuZGVmaW5lZCIhPXR5cGVvZiBVaW50OEFycmF5P1VpbnQ4QXJyYXk6QXJyYXksci5Mb25nPXIuZ2xvYmFsLmRjb2RlSU8mJnIuZ2xvYmFsLmRjb2RlSU8uTG9uZ3x8ci5nbG9iYWwuTG9uZ3x8ci5pbnF1aXJlKCJsb25nIiksci5rZXkyUmU9L150cnVlfGZhbHNlfDB8MSQvLHIua2V5MzJSZT0vXi0/KD86MHxbMS05XVswLTldKikkLyxyLmtleTY0UmU9L14oPzpbXFx4MDAtXFx4ZmZdezh9fC0/KD86MHxbMS05XVswLTldKikpJC8sci5sb25nVG9IYXNoPWZ1bmN0aW9uKGUpe3JldHVybiBlP3IuTG9uZ0JpdHMuZnJvbShlKS50b0hhc2goKTpyLkxvbmdCaXRzLnplcm9IYXNofSxyLmxvbmdGcm9tSGFzaD1mdW5jdGlvbihlLHQpe3ZhciBuPXIuTG9uZ0JpdHMuZnJvbUhhc2goZSk7cmV0dXJuIHIuTG9uZz9yLkxvbmcuZnJvbUJpdHMobi5sbyxuLmhpLHQpOm4udG9OdW1iZXIoQm9vbGVhbih0KSl9LHIubWVyZ2U9byxyLmxjRmlyc3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkrZS5zdWJzdHJpbmcoMSl9LHIubmV3RXJyb3I9aSxyLlByb3RvY29sRXJyb3I9aSgiUHJvdG9jb2xFcnJvciIpLHIub25lT2ZHZXR0ZXI9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXt9LG49MDtuPGUubGVuZ3RoOysrbil0W2Vbbl1dPTE7cmV0dXJuIGZ1bmN0aW9uKCl7Zm9yKHZhciBlPU9iamVjdC5rZXlzKHRoaXMpLG49ZS5sZW5ndGgtMTtuPi0xOy0tbilpZigxPT09dFtlW25dXSYmdm9pZCAwIT09dGhpc1tlW25dXSYmbnVsbCE9PXRoaXNbZVtuXV0pcmV0dXJuIGVbbl19fSxyLm9uZU9mU2V0dGVyPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtmb3IodmFyIG49MDtuPGUubGVuZ3RoOysrbillW25dIT09dCYmZGVsZXRlIHRoaXNbZVtuXV07fX0sci50b0pTT05PcHRpb25zPXtsb25nczpTdHJpbmcsZW51bXM6U3RyaW5nLGJ5dGVzOlN0cmluZyxqc29uOiEwfSxyLl9jb25maWd1cmU9ZnVuY3Rpb24oKXt2YXIgZT1yLkJ1ZmZlcjtlPyhyLl9CdWZmZXJfZnJvbT1lLmZyb20hPT1VaW50OEFycmF5LmZyb20mJmUuZnJvbXx8ZnVuY3Rpb24odCxuKXtyZXR1cm4gbmV3IGUodCxuKX0sci5fQnVmZmVyX2FsbG9jVW5zYWZlPWUuYWxsb2NVbnNhZmV8fGZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KX0pOnIuX0J1ZmZlcl9mcm9tPXIuX0J1ZmZlcl9hbGxvY1Vuc2FmZT1udWxsO307fSwxMTczOihlLHQsbik9PntlLmV4cG9ydHM9cDt2YXIgcixvPW4oOTY5MyksaT1vLkxvbmdCaXRzLHM9by5iYXNlNjQsYT1vLnV0Zjg7ZnVuY3Rpb24gdShlLHQsbil7dGhpcy5mbj1lLHRoaXMubGVuPXQsdGhpcy5uZXh0PXZvaWQgMCx0aGlzLnZhbD1uO31mdW5jdGlvbiBsKCl7fWZ1bmN0aW9uIGMoZSl7dGhpcy5oZWFkPWUuaGVhZCx0aGlzLnRhaWw9ZS50YWlsLHRoaXMubGVuPWUubGVuLHRoaXMubmV4dD1lLnN0YXRlczt9ZnVuY3Rpb24gcCgpe3RoaXMubGVuPTAsdGhpcy5oZWFkPW5ldyB1KGwsMCwwKSx0aGlzLnRhaWw9dGhpcy5oZWFkLHRoaXMuc3RhdGVzPW51bGw7fXZhciBkPWZ1bmN0aW9uKCl7cmV0dXJuIG8uQnVmZmVyP2Z1bmN0aW9uKCl7cmV0dXJuIChwLmNyZWF0ZT1mdW5jdGlvbigpe3JldHVybiBuZXcgcn0pKCl9OmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBwfX07ZnVuY3Rpb24gZihlLHQsbil7dFtuXT0yNTUmZTt9ZnVuY3Rpb24gaChlLHQpe3RoaXMubGVuPWUsdGhpcy5uZXh0PXZvaWQgMCx0aGlzLnZhbD10O31mdW5jdGlvbiBnKGUsdCxuKXtmb3IoO2UuaGk7KXRbbisrXT0xMjcmZS5sb3wxMjgsZS5sbz0oZS5sbz4+Pjd8ZS5oaTw8MjUpPj4+MCxlLmhpPj4+PTc7Zm9yKDtlLmxvPjEyNzspdFtuKytdPTEyNyZlLmxvfDEyOCxlLmxvPWUubG8+Pj43O3RbbisrXT1lLmxvO31mdW5jdGlvbiBiKGUsdCxuKXt0W25dPTI1NSZlLHRbbisxXT1lPj4+OCYyNTUsdFtuKzJdPWU+Pj4xNiYyNTUsdFtuKzNdPWU+Pj4yNDt9cC5jcmVhdGU9ZCgpLHAuYWxsb2M9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBvLkFycmF5KGUpfSxvLkFycmF5IT09QXJyYXkmJihwLmFsbG9jPW8ucG9vbChwLmFsbG9jLG8uQXJyYXkucHJvdG90eXBlLnN1YmFycmF5KSkscC5wcm90b3R5cGUuX3B1c2g9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB0aGlzLnRhaWw9dGhpcy50YWlsLm5leHQ9bmV3IHUoZSx0LG4pLHRoaXMubGVuKz10LHRoaXN9LGgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodS5wcm90b3R5cGUpLGgucHJvdG90eXBlLmZuPWZ1bmN0aW9uKGUsdCxuKXtmb3IoO2U+MTI3Oyl0W24rK109MTI3JmV8MTI4LGU+Pj49Nzt0W25dPWU7fSxwLnByb3RvdHlwZS51aW50MzI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubGVuKz0odGhpcy50YWlsPXRoaXMudGFpbC5uZXh0PW5ldyBoKChlPj4+PTApPDEyOD8xOmU8MTYzODQ/MjplPDIwOTcxNTI/MzplPDI2ODQzNTQ1Nj80OjUsZSkpLmxlbix0aGlzfSxwLnByb3RvdHlwZS5pbnQzMj1mdW5jdGlvbihlKXtyZXR1cm4gZTwwP3RoaXMuX3B1c2goZywxMCxpLmZyb21OdW1iZXIoZSkpOnRoaXMudWludDMyKGUpfSxwLnByb3RvdHlwZS5zaW50MzI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMudWludDMyKChlPDwxXmU+PjMxKT4+PjApfSxwLnByb3RvdHlwZS51aW50NjQ9ZnVuY3Rpb24oZSl7dmFyIHQ9aS5mcm9tKGUpO3JldHVybiB0aGlzLl9wdXNoKGcsdC5sZW5ndGgoKSx0KX0scC5wcm90b3R5cGUuaW50NjQ9cC5wcm90b3R5cGUudWludDY0LHAucHJvdG90eXBlLnNpbnQ2ND1mdW5jdGlvbihlKXt2YXIgdD1pLmZyb20oZSkuenpFbmNvZGUoKTtyZXR1cm4gdGhpcy5fcHVzaChnLHQubGVuZ3RoKCksdCl9LHAucHJvdG90eXBlLmJvb2w9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3B1c2goZiwxLGU/MTowKX0scC5wcm90b3R5cGUuZml4ZWQzMj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcHVzaChiLDQsZT4+PjApfSxwLnByb3RvdHlwZS5zZml4ZWQzMj1wLnByb3RvdHlwZS5maXhlZDMyLHAucHJvdG90eXBlLmZpeGVkNjQ9ZnVuY3Rpb24oZSl7dmFyIHQ9aS5mcm9tKGUpO3JldHVybiB0aGlzLl9wdXNoKGIsNCx0LmxvKS5fcHVzaChiLDQsdC5oaSl9LHAucHJvdG90eXBlLnNmaXhlZDY0PXAucHJvdG90eXBlLmZpeGVkNjQscC5wcm90b3R5cGUuZmxvYXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3B1c2goby5mbG9hdC53cml0ZUZsb2F0TEUsNCxlKX0scC5wcm90b3R5cGUuZG91YmxlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wdXNoKG8uZmxvYXQud3JpdGVEb3VibGVMRSw4LGUpfTt2YXIgbT1vLkFycmF5LnByb3RvdHlwZS5zZXQ/ZnVuY3Rpb24oZSx0LG4pe3Quc2V0KGUsbik7fTpmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTA7cjxlLmxlbmd0aDsrK3IpdFtuK3JdPWVbcl07fTtwLnByb3RvdHlwZS5ieXRlcz1mdW5jdGlvbihlKXt2YXIgdD1lLmxlbmd0aD4+PjA7aWYoIXQpcmV0dXJuIHRoaXMuX3B1c2goZiwxLDApO2lmKG8uaXNTdHJpbmcoZSkpe3ZhciBuPXAuYWxsb2ModD1zLmxlbmd0aChlKSk7cy5kZWNvZGUoZSxuLDApLGU9bjt9cmV0dXJuIHRoaXMudWludDMyKHQpLl9wdXNoKG0sdCxlKX0scC5wcm90b3R5cGUuc3RyaW5nPWZ1bmN0aW9uKGUpe3ZhciB0PWEubGVuZ3RoKGUpO3JldHVybiB0P3RoaXMudWludDMyKHQpLl9wdXNoKGEud3JpdGUsdCxlKTp0aGlzLl9wdXNoKGYsMSwwKX0scC5wcm90b3R5cGUuZm9yaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlcz1uZXcgYyh0aGlzKSx0aGlzLmhlYWQ9dGhpcy50YWlsPW5ldyB1KGwsMCwwKSx0aGlzLmxlbj0wLHRoaXN9LHAucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGVzPyh0aGlzLmhlYWQ9dGhpcy5zdGF0ZXMuaGVhZCx0aGlzLnRhaWw9dGhpcy5zdGF0ZXMudGFpbCx0aGlzLmxlbj10aGlzLnN0YXRlcy5sZW4sdGhpcy5zdGF0ZXM9dGhpcy5zdGF0ZXMubmV4dCk6KHRoaXMuaGVhZD10aGlzLnRhaWw9bmV3IHUobCwwLDApLHRoaXMubGVuPTApLHRoaXN9LHAucHJvdG90eXBlLmxkZWxpbT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuaGVhZCx0PXRoaXMudGFpbCxuPXRoaXMubGVuO3JldHVybiB0aGlzLnJlc2V0KCkudWludDMyKG4pLG4mJih0aGlzLnRhaWwubmV4dD1lLm5leHQsdGhpcy50YWlsPXQsdGhpcy5sZW4rPW4pLHRoaXN9LHAucHJvdG90eXBlLmZpbmlzaD1mdW5jdGlvbigpe2Zvcih2YXIgZT10aGlzLmhlYWQubmV4dCx0PXRoaXMuY29uc3RydWN0b3IuYWxsb2ModGhpcy5sZW4pLG49MDtlOyllLmZuKGUudmFsLHQsbiksbis9ZS5sZW4sZT1lLm5leHQ7cmV0dXJuIHR9LHAuX2NvbmZpZ3VyZT1mdW5jdGlvbihlKXtyPWUscC5jcmVhdGU9ZCgpLHIuX2NvbmZpZ3VyZSgpO307fSwzMTU1OihlLHQsbik9PntlLmV4cG9ydHM9aTt2YXIgcj1uKDExNzMpOyhpLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSkuY29uc3RydWN0b3I9aTt2YXIgbz1uKDk2OTMpO2Z1bmN0aW9uIGkoKXtyLmNhbGwodGhpcyk7fWZ1bmN0aW9uIHMoZSx0LG4pe2UubGVuZ3RoPDQwP28udXRmOC53cml0ZShlLHQsbik6dC51dGY4V3JpdGU/dC51dGY4V3JpdGUoZSxuKTp0LndyaXRlKGUsbik7fWkuX2NvbmZpZ3VyZT1mdW5jdGlvbigpe2kuYWxsb2M9by5fQnVmZmVyX2FsbG9jVW5zYWZlLGkud3JpdGVCeXRlc0J1ZmZlcj1vLkJ1ZmZlciYmby5CdWZmZXIucHJvdG90eXBlIGluc3RhbmNlb2YgVWludDhBcnJheSYmInNldCI9PT1vLkJ1ZmZlci5wcm90b3R5cGUuc2V0Lm5hbWU/ZnVuY3Rpb24oZSx0LG4pe3Quc2V0KGUsbik7fTpmdW5jdGlvbihlLHQsbil7aWYoZS5jb3B5KWUuY29weSh0LG4sMCxlLmxlbmd0aCk7ZWxzZSBmb3IodmFyIHI9MDtyPGUubGVuZ3RoOyl0W24rK109ZVtyKytdO307fSxpLnByb3RvdHlwZS5ieXRlcz1mdW5jdGlvbihlKXtvLmlzU3RyaW5nKGUpJiYoZT1vLl9CdWZmZXJfZnJvbShlLCJiYXNlNjQiKSk7dmFyIHQ9ZS5sZW5ndGg+Pj4wO3JldHVybiB0aGlzLnVpbnQzMih0KSx0JiZ0aGlzLl9wdXNoKGkud3JpdGVCeXRlc0J1ZmZlcix0LGUpLHRoaXN9LGkucHJvdG90eXBlLnN0cmluZz1mdW5jdGlvbihlKXt2YXIgdD1vLkJ1ZmZlci5ieXRlTGVuZ3RoKGUpO3JldHVybiB0aGlzLnVpbnQzMih0KSx0JiZ0aGlzLl9wdXNoKHMsdCxlKSx0aGlzfSxpLl9jb25maWd1cmUoKTt9LDQxNTQ6ZT0+e2UuZXhwb3J0cz0nInVzZSBzdHJpY3QiO3ZhciBlPXt9LGE9Im9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiYib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MudmVyc2lvbnMmJiJzdHJpbmciPT10eXBlb2YgcHJvY2Vzcy52ZXJzaW9ucy5ub2RlO2lmKGEpe3ZhciByPXJlcXVpcmUoIndvcmtlcl90aHJlYWRzIiksdD1yLnBhcmVudFBvcnQ7dC5vbigibWVzc2FnZSIsKGU9Pm9ubWVzc2FnZSh7ZGF0YTplfSkpKTt2YXIgcz1yZXF1aXJlKCJmcyIpO09iamVjdC5hc3NpZ24oZ2xvYmFsLHtzZWxmOmdsb2JhbCxyZXF1aXJlOnJlcXVpcmUsTW9kdWxlOmUsbG9jYXRpb246e2hyZWY6X19maWxlbmFtZX0sV29ya2VyOnIuV29ya2VyLGltcG9ydFNjcmlwdHM6ZT0+KDAsZXZhbCkocy5yZWFkRmlsZVN5bmMoZSwidXRmOCIpKyIvLyMgc291cmNlVVJMPSIrZSkscG9zdE1lc3NhZ2U6ZT0+dC5wb3N0TWVzc2FnZShlKSxwZXJmb3JtYW5jZTpnbG9iYWwucGVyZm9ybWFuY2V8fHtub3c6RGF0ZS5ub3d9fSl9dmFyIG89ITEsZD1mdW5jdGlvbigpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuam9pbigiICIpO2E/cy53cml0ZVN5bmMoMixlKyJcXG4iKTpjb25zb2xlLmVycm9yKGUpfTtzZWxmLmFsZXJ0PWZ1bmN0aW9uKCl7dmFyIGE9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKS5qb2luKCIgIik7cG9zdE1lc3NhZ2Uoe2NtZDoiYWxlcnQiLHRleHQ6YSx0aHJlYWRJZDplLl9wdGhyZWFkX3NlbGYoKX0pfSxlLmluc3RhbnRpYXRlV2FzbT0oYSxyKT0+e3ZhciB0PWUud2FzbU1vZHVsZTtyZXR1cm4gZS53YXNtTW9kdWxlPW51bGwscihuZXcgV2ViQXNzZW1ibHkuSW5zdGFuY2UodCxhKSl9LHNlbGYub251bmhhbmRsZWRyZWplY3Rpb249ZT0+e3Rocm93IGUucmVhc29uPz9lfSxzZWxmLm9ubWVzc2FnZT1mdW5jdGlvbiBhKHIpe3RyeXtpZigibG9hZCI9PT1yLmRhdGEuY21kKXtsZXQgcz1bXTtzZWxmLm9ubWVzc2FnZT1lPT5zLnB1c2goZSksc2VsZi5zdGFydFdvcmtlcj1yPT57ZT1yLHBvc3RNZXNzYWdlKHtjbWQ6ImxvYWRlZCJ9KTtmb3IobGV0IGUgb2YgcylhKGUpO3NlbGYub25tZXNzYWdlPWF9LGUud2FzbU1vZHVsZT1yLmRhdGEud2FzbU1vZHVsZTtmb3IoY29uc3QgYSBvZiByLmRhdGEuaGFuZGxlcnMpZVthXT0oLi4uZSk9Pntwb3N0TWVzc2FnZSh7Y21kOiJjYWxsSGFuZGxlciIsaGFuZGxlcjphLGFyZ3M6ZX0pfTtpZihlLndhc21NZW1vcnk9ci5kYXRhLndhc21NZW1vcnksZS5idWZmZXI9ZS53YXNtTWVtb3J5LmJ1ZmZlcixlLkVOVklST05NRU5UX0lTX1BUSFJFQUQ9ITAsInN0cmluZyI9PXR5cGVvZiByLmRhdGEudXJsT3JCbG9iKWltcG9ydFNjcmlwdHMoci5kYXRhLnVybE9yQmxvYik7ZWxzZXt2YXIgdD1VUkwuY3JlYXRlT2JqZWN0VVJMKHIuZGF0YS51cmxPckJsb2IpO2ltcG9ydFNjcmlwdHModCksVVJMLnJldm9rZU9iamVjdFVSTCh0KX1vcnRXYXNtVGhyZWFkZWQoZSl9ZWxzZSBpZigicnVuIj09PXIuZGF0YS5jbWQpe2UuX19lbXNjcmlwdGVuX3RocmVhZF9pbml0KHIuZGF0YS5wdGhyZWFkX3B0ciwwLDAsMSksZS5fX2Vtc2NyaXB0ZW5fdGhyZWFkX21haWxib3hfYXdhaXQoci5kYXRhLnB0aHJlYWRfcHRyKSxlLmVzdGFibGlzaFN0YWNrU3BhY2UoKSxlLlBUaHJlYWQucmVjZWl2ZU9iamVjdFRyYW5zZmVyKHIuZGF0YSksZS5QVGhyZWFkLnRocmVhZEluaXRUTFMoKSxvfHwobz0hMCk7dHJ5e2UuaW52b2tlRW50cnlQb2ludChyLmRhdGEuc3RhcnRfcm91dGluZSxyLmRhdGEuYXJnKX1jYXRjaChlKXtpZigidW53aW5kIiE9ZSl0aHJvdyBlfX1lbHNlImNhbmNlbCI9PT1yLmRhdGEuY21kP2UuX3B0aHJlYWRfc2VsZigpJiZlLl9fZW1zY3JpcHRlbl90aHJlYWRfZXhpdCgtMSk6InNldGltbWVkaWF0ZSI9PT1yLmRhdGEudGFyZ2V0fHwoImNoZWNrTWFpbGJveCI9PT1yLmRhdGEuY21kP28mJmUuY2hlY2tNYWlsYm94KCk6ci5kYXRhLmNtZCYmKGQoIndvcmtlci5qcyByZWNlaXZlZCB1bmtub3duIGNvbW1hbmQgIityLmRhdGEuY21kKSxkKHIuZGF0YSkpKX1jYXRjaChhKXt0aHJvdyBlLl9fZW1zY3JpcHRlbl90aHJlYWRfY3Jhc2hlZCYmZS5fX2Vtc2NyaXB0ZW5fdGhyZWFkX2NyYXNoZWQoKSxhfX07XG4nO30sNzA2NzooKT0+e30sMTI5NjooKT0+e30sNzYwOigpPT57fSwxMzg0OigpPT57fSwzOTkzOigpPT57fSw5MDg6KCk9Pnt9LDY5NTM6KCk9Pnt9LDk5MjU6KCk9Pnt9LDI4MDY6KCk9Pnt9LDY0NDk6KCk9Pnt9LDI4NTA6KCk9Pnt9LDUzODE6KCk9Pnt9LDY4NTooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnJlc29sdmVCYWNrZW5kPXQucmVnaXN0ZXJCYWNrZW5kPXZvaWQgMDtjb25zdCBuPXt9LHI9W107dC5yZWdpc3RlckJhY2tlbmQ9KGUsdCxvKT0+e2lmKCF0fHwiZnVuY3Rpb24iIT10eXBlb2YgdC5pbml0fHwiZnVuY3Rpb24iIT10eXBlb2YgdC5jcmVhdGVTZXNzaW9uSGFuZGxlcil0aHJvdyBuZXcgVHlwZUVycm9yKCJub3QgYSB2YWxpZCBiYWNrZW5kIik7e2NvbnN0IGk9bltlXTtpZih2b2lkIDA9PT1pKW5bZV09e2JhY2tlbmQ6dCxwcmlvcml0eTpvfTtlbHNlIHtpZihpLnByaW9yaXR5Pm8pcmV0dXJuO2lmKGkucHJpb3JpdHk9PT1vJiZpLmJhY2tlbmQhPT10KXRocm93IG5ldyBFcnJvcihgY2Fubm90IHJlZ2lzdGVyIGJhY2tlbmQgIiR7ZX0iIHVzaW5nIHByaW9yaXR5ICR7b31gKX1pZihvPj0wKXtjb25zdCB0PXIuaW5kZXhPZihlKTstMSE9PXQmJnIuc3BsaWNlKHQsMSk7Zm9yKGxldCB0PTA7dDxyLmxlbmd0aDt0KyspaWYobltyW3RdXS5wcmlvcml0eTw9bylyZXR1cm4gdm9pZCByLnNwbGljZSh0LDAsZSk7ci5wdXNoKGUpO319fSx0LnJlc29sdmVCYWNrZW5kPWFzeW5jIGU9Pntjb25zdCB0PTA9PT1lLmxlbmd0aD9yOmUsbz1bXTtmb3IoY29uc3QgZSBvZiB0KXtjb25zdCB0PW5bZV07aWYodCl7aWYodC5pbml0aWFsaXplZClyZXR1cm4gdC5iYWNrZW5kO2lmKHQuYWJvcnRlZCljb250aW51ZTtjb25zdCBuPSEhdC5pbml0UHJvbWlzZTt0cnl7cmV0dXJuIG58fCh0LmluaXRQcm9taXNlPXQuYmFja2VuZC5pbml0KCkpLGF3YWl0IHQuaW5pdFByb21pc2UsdC5pbml0aWFsaXplZD0hMCx0LmJhY2tlbmR9Y2F0Y2gocil7bnx8by5wdXNoKHtuYW1lOmUsZXJyOnJ9KSx0LmFib3J0ZWQ9ITA7fWZpbmFsbHl7ZGVsZXRlIHQuaW5pdFByb21pc2U7fX19dGhyb3cgbmV3IEVycm9yKGBubyBhdmFpbGFibGUgYmFja2VuZCBmb3VuZC4gRVJSOiAke28ubWFwKChlPT5gWyR7ZS5uYW1lfV0gJHtlLmVycn1gKSkuam9pbigiLCAiKX1gKX07fSw0Nzk4OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5yZWdpc3RlckJhY2tlbmQ9dm9pZCAwO3ZhciByPW4oNjg1KTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwicmVnaXN0ZXJCYWNrZW5kIix7ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gci5yZWdpc3RlckJhY2tlbmR9fSk7fSwzMTIxOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5lbnY9dm9pZCAwO2NvbnN0IHI9big5MTA0KTtsZXQgbz0id2FybmluZyI7dC5lbnY9e3dhc206e30sd2ViZ2w6e30sd2ViZ3B1Ont9LHZlcnNpb25zOntjb21tb246ci52ZXJzaW9ufSxzZXQgbG9nTGV2ZWwoZSl7aWYodm9pZCAwIT09ZSl7aWYoInN0cmluZyIhPXR5cGVvZiBlfHwtMT09PVsidmVyYm9zZSIsImluZm8iLCJ3YXJuaW5nIiwiZXJyb3IiLCJmYXRhbCJdLmluZGV4T2YoZSkpdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBsb2dnaW5nIGxldmVsOiAke2V9YCk7bz1lO319LGdldCBsb2dMZXZlbCgpe3JldHVybiBvfX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQuZW52LCJsb2dMZXZlbCIse2VudW1lcmFibGU6ITB9KTt9LDI0NTc6KGUsdCxuKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LmVudj12b2lkIDA7Y29uc3Qgcj1uKDMxMjEpO3QuZW52PXIuZW52O30sMjIzNTpmdW5jdGlvbihlLHQsbil7dmFyIHI9dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pO3ZhciBvPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTtvJiYhKCJnZXQiaW4gbz8hdC5fX2VzTW9kdWxlOm8ud3JpdGFibGV8fG8uY29uZmlndXJhYmxlKXx8KG89e2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRbbl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUscixvKTt9OmZ1bmN0aW9uKGUsdCxuLHIpe3ZvaWQgMD09PXImJihyPW4pLGVbcl09dFtuXTt9KSxvPXRoaXMmJnRoaXMuX19leHBvcnRTdGFyfHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiBlKSJkZWZhdWx0Ij09PW58fE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pfHxyKHQsZSxuKTt9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxvKG4oNDc5OCksdCksbyhuKDI0NTcpLHQpLG8obigzOTc0KSx0KSxvKG4oOTYzKSx0KSxvKG4oNzg1MiksdCk7fSw4MDM2OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5JbmZlcmVuY2VTZXNzaW9uPXZvaWQgMDtjb25zdCByPW4oNjg1KSxvPW4oOTYzKTtjbGFzcyBpe2NvbnN0cnVjdG9yKGUpe3RoaXMuaGFuZGxlcj1lO31hc3luYyBydW4oZSx0LG4pe2NvbnN0IHI9e307bGV0IGk9e307aWYoIm9iamVjdCIhPXR5cGVvZiBlfHxudWxsPT09ZXx8ZSBpbnN0YW5jZW9mIG8uVGVuc29yfHxBcnJheS5pc0FycmF5KGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIidmZWVkcycgbXVzdCBiZSBhbiBvYmplY3QgdGhhdCB1c2UgaW5wdXQgbmFtZXMgYXMga2V5cyBhbmQgT25ueFZhbHVlIGFzIGNvcnJlc3BvbmRpbmcgdmFsdWVzLiIpO2xldCBzPSEwO2lmKCJvYmplY3QiPT10eXBlb2YgdCl7aWYobnVsbD09PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiVW5leHBlY3RlZCBhcmd1bWVudFsxXTogY2Fubm90IGJlIG51bGwuIik7aWYodCBpbnN0YW5jZW9mIG8uVGVuc29yKXRocm93IG5ldyBUeXBlRXJyb3IoIidmZXRjaGVzJyBjYW5ub3QgYmUgYSBUZW5zb3IiKTtpZihBcnJheS5pc0FycmF5KHQpKXtpZigwPT09dC5sZW5ndGgpdGhyb3cgbmV3IFR5cGVFcnJvcigiJ2ZldGNoZXMnIGNhbm5vdCBiZSBhbiBlbXB0eSBhcnJheS4iKTtzPSExO2Zvcihjb25zdCBlIG9mIHQpe2lmKCJzdHJpbmciIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yKCInZmV0Y2hlcycgbXVzdCBiZSBhIHN0cmluZyBhcnJheSBvciBhbiBvYmplY3QuIik7aWYoLTE9PT10aGlzLm91dHB1dE5hbWVzLmluZGV4T2YoZSkpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYCdmZXRjaGVzJyBjb250YWlucyBpbnZhbGlkIG91dHB1dCBuYW1lOiAke2V9LmApO3JbZV09bnVsbDt9aWYoIm9iamVjdCI9PXR5cGVvZiBuJiZudWxsIT09bilpPW47ZWxzZSBpZih2b2lkIDAhPT1uKXRocm93IG5ldyBUeXBlRXJyb3IoIidvcHRpb25zJyBtdXN0IGJlIGFuIG9iamVjdC4iKX1lbHNlIHtsZXQgZT0hMTtjb25zdCBhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHQpO2Zvcihjb25zdCBuIG9mIHRoaXMub3V0cHV0TmFtZXMpaWYoLTEhPT1hLmluZGV4T2Yobikpe2NvbnN0IGk9dFtuXTsobnVsbD09PWl8fGkgaW5zdGFuY2VvZiBvLlRlbnNvcikmJihlPSEwLHM9ITEscltuXT1pKTt9aWYoZSl7aWYoIm9iamVjdCI9PXR5cGVvZiBuJiZudWxsIT09bilpPW47ZWxzZSBpZih2b2lkIDAhPT1uKXRocm93IG5ldyBUeXBlRXJyb3IoIidvcHRpb25zJyBtdXN0IGJlIGFuIG9iamVjdC4iKX1lbHNlIGk9dDt9fWVsc2UgaWYodm9pZCAwIT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmV4cGVjdGVkIGFyZ3VtZW50WzFdOiBtdXN0IGJlICdmZXRjaGVzJyBvciAnb3B0aW9ucycuIik7Zm9yKGNvbnN0IHQgb2YgdGhpcy5pbnB1dE5hbWVzKWlmKHZvaWQgMD09PWVbdF0pdGhyb3cgbmV3IEVycm9yKGBpbnB1dCAnJHt0fScgaXMgbWlzc2luZyBpbiAnZmVlZHMnLmApO2lmKHMpZm9yKGNvbnN0IGUgb2YgdGhpcy5vdXRwdXROYW1lcylyW2VdPW51bGw7Y29uc3QgYT1hd2FpdCB0aGlzLmhhbmRsZXIucnVuKGUscixpKSx1PXt9O2Zvcihjb25zdCBlIGluIGEpT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwoYSxlKSYmKHVbZV09bmV3IG8uVGVuc29yKGFbZV0udHlwZSxhW2VdLmRhdGEsYVtlXS5kaW1zKSk7cmV0dXJuIHV9YXN5bmMgcmVsZWFzZSgpe3JldHVybiB0aGlzLmhhbmRsZXIuZGlzcG9zZSgpfXN0YXRpYyBhc3luYyBjcmVhdGUoZSx0LG4sbyl7bGV0IHMsYT17fTtpZigic3RyaW5nIj09dHlwZW9mIGUpe2lmKHM9ZSwib2JqZWN0Ij09dHlwZW9mIHQmJm51bGwhPT10KWE9dDtlbHNlIGlmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiJ29wdGlvbnMnIG11c3QgYmUgYW4gb2JqZWN0LiIpfWVsc2UgaWYoZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe2lmKHM9ZSwib2JqZWN0Ij09dHlwZW9mIHQmJm51bGwhPT10KWE9dDtlbHNlIGlmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiJ29wdGlvbnMnIG11c3QgYmUgYW4gb2JqZWN0LiIpfWVsc2Uge2lmKCEoZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHwidW5kZWZpbmVkIiE9dHlwZW9mIFNoYXJlZEFycmF5QnVmZmVyJiZlIGluc3RhbmNlb2YgU2hhcmVkQXJyYXlCdWZmZXIpKXRocm93IG5ldyBUeXBlRXJyb3IoIlVuZXhwZWN0ZWQgYXJndW1lbnRbMF06IG11c3QgYmUgJ3BhdGgnIG9yICdidWZmZXInLiIpO3tjb25zdCByPWU7bGV0IGk9MCx1PWUuYnl0ZUxlbmd0aDtpZigib2JqZWN0Ij09dHlwZW9mIHQmJm51bGwhPT10KWE9dDtlbHNlIGlmKCJudW1iZXIiPT10eXBlb2YgdCl7aWYoaT10LCFOdW1iZXIuaXNTYWZlSW50ZWdlcihpKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ2J5dGVPZmZzZXQnIG11c3QgYmUgYW4gaW50ZWdlci4iKTtpZihpPDB8fGk+PXIuYnl0ZUxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgJ2J5dGVPZmZzZXQnIGlzIG91dCBvZiByYW5nZSBbMCwgJHtyLmJ5dGVMZW5ndGh9KS5gKTtpZih1PWUuYnl0ZUxlbmd0aC1pLCJudW1iZXIiPT10eXBlb2Ygbil7aWYodT1uLCFOdW1iZXIuaXNTYWZlSW50ZWdlcih1KSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ2J5dGVMZW5ndGgnIG11c3QgYmUgYW4gaW50ZWdlci4iKTtpZih1PD0wfHxpK3U+ci5ieXRlTGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKGAnYnl0ZUxlbmd0aCcgaXMgb3V0IG9mIHJhbmdlICgwLCAke3IuYnl0ZUxlbmd0aC1pfV0uYCk7aWYoIm9iamVjdCI9PXR5cGVvZiBvJiZudWxsIT09bylhPW87ZWxzZSBpZih2b2lkIDAhPT1vKXRocm93IG5ldyBUeXBlRXJyb3IoIidvcHRpb25zJyBtdXN0IGJlIGFuIG9iamVjdC4iKX1lbHNlIGlmKHZvaWQgMCE9PW4pdGhyb3cgbmV3IFR5cGVFcnJvcigiJ2J5dGVMZW5ndGgnIG11c3QgYmUgYSBudW1iZXIuIil9ZWxzZSBpZih2b2lkIDAhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoIidvcHRpb25zJyBtdXN0IGJlIGFuIG9iamVjdC4iKTtzPW5ldyBVaW50OEFycmF5KHIsaSx1KTt9fWNvbnN0IHU9KGEuZXhlY3V0aW9uUHJvdmlkZXJzfHxbXSkubWFwKChlPT4ic3RyaW5nIj09dHlwZW9mIGU/ZTplLm5hbWUpKSxsPWF3YWl0KDAsIHIucmVzb2x2ZUJhY2tlbmQpKHUpLGM9YXdhaXQgbC5jcmVhdGVTZXNzaW9uSGFuZGxlcihzLGEpO3JldHVybiBuZXcgaShjKX1zdGFydFByb2ZpbGluZygpe3RoaXMuaGFuZGxlci5zdGFydFByb2ZpbGluZygpO31lbmRQcm9maWxpbmcoKXt0aGlzLmhhbmRsZXIuZW5kUHJvZmlsaW5nKCk7fWdldCBpbnB1dE5hbWVzKCl7cmV0dXJuIHRoaXMuaGFuZGxlci5pbnB1dE5hbWVzfWdldCBvdXRwdXROYW1lcygpe3JldHVybiB0aGlzLmhhbmRsZXIub3V0cHV0TmFtZXN9fXQuSW5mZXJlbmNlU2Vzc2lvbj1pO30sMzk3NDooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuSW5mZXJlbmNlU2Vzc2lvbj12b2lkIDA7Y29uc3Qgcj1uKDgwMzYpO3QuSW5mZXJlbmNlU2Vzc2lvbj1yLkluZmVyZW5jZVNlc3Npb247fSw3ODUyOihlLHQpPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO30sMjM1MDooZSx0KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LnRlbnNvclRvSW1hZ2VEYXRhPXQudGVuc29yVG9EYXRhVVJMPXZvaWQgMCx0LnRlbnNvclRvRGF0YVVSTD0oZSx0KT0+e2NvbnN0IG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7bi53aWR0aD1lLmRpbXNbM10sbi5oZWlnaHQ9ZS5kaW1zWzJdO2NvbnN0IHI9bi5nZXRDb250ZXh0KCIyZCIpO2lmKG51bGwhPXIpe2xldCBvLGk7dm9pZCAwIT09dD8udGVuc29yTGF5b3V0JiYiTkhXQyI9PT10LnRlbnNvckxheW91dD8obz1lLmRpbXNbMl0saT1lLmRpbXNbM10pOihvPWUuZGltc1szXSxpPWUuZGltc1syXSk7Y29uc3Qgcz12b2lkIDAhPT10Py5mb3JtYXQ/dC5mb3JtYXQ6IlJHQiIsYT10Py5ub3JtO2xldCB1LGw7dm9pZCAwPT09YXx8dm9pZCAwPT09YS5tZWFuP3U9WzI1NSwyNTUsMjU1LDI1NV06Im51bWJlciI9PXR5cGVvZiBhLm1lYW4/dT1bYS5tZWFuLGEubWVhbixhLm1lYW4sYS5tZWFuXToodT1bYS5tZWFuWzBdLGEubWVhblsxXSxhLm1lYW5bMl0sMF0sdm9pZCAwIT09YS5tZWFuWzNdJiYodVszXT1hLm1lYW5bM10pKSx2b2lkIDA9PT1hfHx2b2lkIDA9PT1hLmJpYXM/bD1bMCwwLDAsMF06Im51bWJlciI9PXR5cGVvZiBhLmJpYXM/bD1bYS5iaWFzLGEuYmlhcyxhLmJpYXMsYS5iaWFzXToobD1bYS5iaWFzWzBdLGEuYmlhc1sxXSxhLmJpYXNbMl0sMF0sdm9pZCAwIT09YS5iaWFzWzNdJiYobFszXT1hLmJpYXNbM10pKTtjb25zdCBjPWkqbztsZXQgcD0wLGQ9YyxmPTIqYyxoPS0xOyJSR0JBIj09PXM/KHA9MCxkPWMsZj0yKmMsaD0zKmMpOiJSR0IiPT09cz8ocD0wLGQ9YyxmPTIqYyk6IlJCRyI9PT1zJiYocD0wLGY9YyxkPTIqYyk7Zm9yKGxldCB0PTA7dDxpO3QrKylmb3IobGV0IG49MDtuPG87bisrKXtjb25zdCBvPShlLmRhdGFbcCsrXS1sWzBdKSp1WzBdLGk9KGUuZGF0YVtkKytdLWxbMV0pKnVbMV0scz0oZS5kYXRhW2YrK10tbFsyXSkqdVsyXSxhPS0xPT09aD8yNTU6KGUuZGF0YVtoKytdLWxbM10pKnVbM107ci5maWxsU3R5bGU9InJnYmEoIitvKyIsIitpKyIsIitzKyIsIithKyIpIixyLmZpbGxSZWN0KG4sdCwxLDEpO31yZXR1cm4gbi50b0RhdGFVUkwoKX10aHJvdyBuZXcgRXJyb3IoIkNhbiBub3QgYWNjZXNzIGltYWdlIGRhdGEiKX0sdC50ZW5zb3JUb0ltYWdlRGF0YT0oZSx0KT0+e2NvbnN0IG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIikuZ2V0Q29udGV4dCgiMmQiKTtsZXQgcjtpZihudWxsPT1uKXRocm93IG5ldyBFcnJvcigiQ2FuIG5vdCBhY2Nlc3MgaW1hZ2UgZGF0YSIpO3tsZXQgbyxpLHM7dm9pZCAwIT09dD8udGVuc29yTGF5b3V0JiYiTkhXQyI9PT10LnRlbnNvckxheW91dD8obz1lLmRpbXNbMl0saT1lLmRpbXNbMV0scz1lLmRpbXNbM10pOihvPWUuZGltc1szXSxpPWUuZGltc1syXSxzPWUuZGltc1sxXSk7Y29uc3QgYT12b2lkIDAhPT10JiZ2b2lkIDAhPT10LmZvcm1hdD90LmZvcm1hdDoiUkdCIix1PXQ/Lm5vcm07bGV0IGwsYzt2b2lkIDA9PT11fHx2b2lkIDA9PT11Lm1lYW4/bD1bMjU1LDI1NSwyNTUsMjU1XToibnVtYmVyIj09dHlwZW9mIHUubWVhbj9sPVt1Lm1lYW4sdS5tZWFuLHUubWVhbix1Lm1lYW5dOihsPVt1Lm1lYW5bMF0sdS5tZWFuWzFdLHUubWVhblsyXSwyNTVdLHZvaWQgMCE9PXUubWVhblszXSYmKGxbM109dS5tZWFuWzNdKSksdm9pZCAwPT09dXx8dm9pZCAwPT09dS5iaWFzP2M9WzAsMCwwLDBdOiJudW1iZXIiPT10eXBlb2YgdS5iaWFzP2M9W3UuYmlhcyx1LmJpYXMsdS5iaWFzLHUuYmlhc106KGM9W3UuYmlhc1swXSx1LmJpYXNbMV0sdS5iaWFzWzJdLDBdLHZvaWQgMCE9PXUuYmlhc1szXSYmKGNbM109dS5iaWFzWzNdKSk7Y29uc3QgcD1pKm87aWYodm9pZCAwIT09dCYmKHZvaWQgMCE9PXQuZm9ybWF0JiY0PT09cyYmIlJHQkEiIT09dC5mb3JtYXR8fDM9PT1zJiYiUkdCIiE9PXQuZm9ybWF0JiYiQkdSIiE9PXQuZm9ybWF0KSl0aHJvdyBuZXcgRXJyb3IoIlRlbnNvciBmb3JtYXQgZG9lc24ndCBtYXRjaCBpbnB1dCB0ZW5zb3IgZGltcyIpO2NvbnN0IGQ9NDtsZXQgZj0wLGg9MSxnPTIsYj0zLG09MCx5PXAsdj0yKnAsXz0tMTsiUkdCQSI9PT1hPyhtPTAseT1wLHY9MipwLF89MypwKToiUkdCIj09PWE/KG09MCx5PXAsdj0yKnApOiJSQkciPT09YSYmKG09MCx2PXAseT0yKnApLHI9bi5jcmVhdGVJbWFnZURhdGEobyxpKTtmb3IobGV0IHQ9MDt0PGkqbztmKz1kLGgrPWQsZys9ZCxiKz1kLHQrKylyLmRhdGFbZl09KGUuZGF0YVttKytdLWNbMF0pKmxbMF0sci5kYXRhW2hdPShlLmRhdGFbeSsrXS1jWzFdKSpsWzFdLHIuZGF0YVtnXT0oZS5kYXRhW3YrK10tY1syXSkqbFsyXSxyLmRhdGFbYl09LTE9PT1fPzI1NTooZS5kYXRhW18rK10tY1szXSkqbFszXTt9cmV0dXJuIHJ9O30sNDg2NjooZSx0LG4pPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQudGVuc29yRnJvbUltYWdlPXQuYnVmZmVyVG9UZW5zb3I9dm9pZCAwO2NvbnN0IHI9big5NjMpO3QuYnVmZmVyVG9UZW5zb3I9KGUsdCk9PntpZih2b2lkIDA9PT1lKXRocm93IG5ldyBFcnJvcigiSW1hZ2UgYnVmZmVyIG11c3QgYmUgZGVmaW5lZCIpO2lmKHZvaWQgMD09PXQuaGVpZ2h0fHx2b2lkIDA9PT10LndpZHRoKXRocm93IG5ldyBFcnJvcigiSW1hZ2UgaGVpZ2h0IGFuZCB3aWR0aCBtdXN0IGJlIGRlZmluZWQiKTtpZigiTkhXQyI9PT10LnRlbnNvckxheW91dCl0aHJvdyBuZXcgRXJyb3IoIk5IV0MgVGVuc29yIGxheW91dCBpcyBub3Qgc3VwcG9ydGVkIHlldCIpO2NvbnN0e2hlaWdodDpuLHdpZHRoOm99PXQsaT10Lm5vcm0/P3ttZWFuOjI1NSxiaWFzOjB9O2xldCBzLGE7cz0ibnVtYmVyIj09dHlwZW9mIGkubWVhbj9baS5tZWFuLGkubWVhbixpLm1lYW4saS5tZWFuXTpbaS5tZWFuWzBdLGkubWVhblsxXSxpLm1lYW5bMl0saS5tZWFuWzNdPz8yNTVdLGE9Im51bWJlciI9PXR5cGVvZiBpLmJpYXM/W2kuYmlhcyxpLmJpYXMsaS5iaWFzLGkuYmlhc106W2kuYmlhc1swXSxpLmJpYXNbMV0saS5iaWFzWzJdLGkuYmlhc1szXT8/MF07Y29uc3QgdT12b2lkIDAhPT10LmZvcm1hdD90LmZvcm1hdDoiUkdCQSIsbD12b2lkIDAhPT10LnRlbnNvckZvcm1hdCYmdm9pZCAwIT09dC50ZW5zb3JGb3JtYXQ/dC50ZW5zb3JGb3JtYXQ6IlJHQiIsYz1uKm8scD0iUkdCQSI9PT1sP25ldyBGbG9hdDMyQXJyYXkoNCpjKTpuZXcgRmxvYXQzMkFycmF5KDMqYyk7bGV0IGQ9NCxmPTAsaD0xLGc9MixiPTMsbT0wLHk9Yyx2PTIqYyxfPS0xOyJSR0IiPT09dSYmKGQ9MyxmPTAsaD0xLGc9MixiPS0xKSwiUkdCQSI9PT1sP189MypjOiJSQkciPT09bD8obT0wLHY9Yyx5PTIqYyk6IkJHUiI9PT1sJiYodj0wLHk9YyxtPTIqYyk7Zm9yKGxldCB0PTA7dDxjO3QrKyxmKz1kLGcrPWQsaCs9ZCxiKz1kKXBbbSsrXT0oZVtmXSthWzBdKS9zWzBdLHBbeSsrXT0oZVtoXSthWzFdKS9zWzFdLHBbdisrXT0oZVtnXSthWzJdKS9zWzJdLC0xIT09XyYmLTEhPT1iJiYocFtfKytdPShlW2JdK2FbM10pL3NbM10pO3JldHVybiAiUkdCQSI9PT1sP25ldyByLlRlbnNvcigiZmxvYXQzMiIscCxbMSw0LG4sb10pOm5ldyByLlRlbnNvcigiZmxvYXQzMiIscCxbMSwzLG4sb10pfSx0LnRlbnNvckZyb21JbWFnZT1hc3luYyhlLG4pPT57Y29uc3Qgcj0idW5kZWZpbmVkIiE9dHlwZW9mIEhUTUxJbWFnZUVsZW1lbnQmJmUgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50LG89InVuZGVmaW5lZCIhPXR5cGVvZiBJbWFnZURhdGEmJmUgaW5zdGFuY2VvZiBJbWFnZURhdGEsaT0idW5kZWZpbmVkIiE9dHlwZW9mIEltYWdlQml0bWFwJiZlIGluc3RhbmNlb2YgSW1hZ2VCaXRtYXAscz0ic3RyaW5nIj09dHlwZW9mIGU7bGV0IGEsdT1uPz97fTtpZihyKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpO3Qud2lkdGg9ZS53aWR0aCx0LmhlaWdodD1lLmhlaWdodDtjb25zdCByPXQuZ2V0Q29udGV4dCgiMmQiKTtpZihudWxsPT1yKXRocm93IG5ldyBFcnJvcigiQ2FuIG5vdCBhY2Nlc3MgaW1hZ2UgZGF0YSIpO3tsZXQgdD1lLmhlaWdodCxvPWUud2lkdGg7aWYodm9pZCAwIT09biYmdm9pZCAwIT09bi5yZXNpemVkSGVpZ2h0JiZ2b2lkIDAhPT1uLnJlc2l6ZWRXaWR0aCYmKHQ9bi5yZXNpemVkSGVpZ2h0LG89bi5yZXNpemVkV2lkdGgpLHZvaWQgMCE9PW4pe2lmKHU9bix2b2lkIDAhPT1uLnRlbnNvckZvcm1hdCl0aHJvdyBuZXcgRXJyb3IoIkltYWdlIGlucHV0IGNvbmZpZyBmb3JtYXQgbXVzdCBiZSBSR0JBIGZvciBIVE1MSW1hZ2VFbGVtZW50Iik7dS50ZW5zb3JGb3JtYXQ9IlJHQkEiLHUuaGVpZ2h0PXQsdS53aWR0aD1vO31lbHNlIHUudGVuc29yRm9ybWF0PSJSR0JBIix1LmhlaWdodD10LHUud2lkdGg9bztyLmRyYXdJbWFnZShlLDAsMCksYT1yLmdldEltYWdlRGF0YSgwLDAsbyx0KS5kYXRhO319ZWxzZSB7aWYoIW8pe2lmKGkpe2lmKHZvaWQgMD09PW4pdGhyb3cgbmV3IEVycm9yKCJQbGVhc2UgcHJvdmlkZSBpbWFnZSBjb25maWcgd2l0aCBmb3JtYXQgZm9yIEltYWdlYml0bWFwIik7Y29uc3Qgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTtyLndpZHRoPWUud2lkdGgsci5oZWlnaHQ9ZS5oZWlnaHQ7Y29uc3Qgbz1yLmdldENvbnRleHQoIjJkIik7aWYobnVsbCE9byl7Y29uc3Qgbj1lLmhlaWdodCxyPWUud2lkdGg7cmV0dXJuIG8uZHJhd0ltYWdlKGUsMCwwLHIsbiksYT1vLmdldEltYWdlRGF0YSgwLDAscixuKS5kYXRhLHUuaGVpZ2h0PW4sdS53aWR0aD1yLCgwLCB0LmJ1ZmZlclRvVGVuc29yKShhLHUpfXRocm93IG5ldyBFcnJvcigiQ2FuIG5vdCBhY2Nlc3MgaW1hZ2UgZGF0YSIpfWlmKHMpcmV0dXJuIG5ldyBQcm9taXNlKCgobixyKT0+e2NvbnN0IG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIiksaT1vLmdldENvbnRleHQoIjJkIik7aWYoIWV8fCFpKXJldHVybiByKCk7Y29uc3Qgcz1uZXcgSW1hZ2U7cy5jcm9zc09yaWdpbj0iQW5vbnltb3VzIixzLnNyYz1lLHMub25sb2FkPSgpPT57by53aWR0aD1zLndpZHRoLG8uaGVpZ2h0PXMuaGVpZ2h0LGkuZHJhd0ltYWdlKHMsMCwwLG8ud2lkdGgsby5oZWlnaHQpO2NvbnN0IGU9aS5nZXRJbWFnZURhdGEoMCwwLG8ud2lkdGgsby5oZWlnaHQpO3UuaGVpZ2h0PW8uaGVpZ2h0LHUud2lkdGg9by53aWR0aCxuKCgwLCB0LmJ1ZmZlclRvVGVuc29yKShlLmRhdGEsdSkpO307fSkpO3Rocm93IG5ldyBFcnJvcigiSW5wdXQgZGF0YSBwcm92aWRlZCBpcyBub3Qgc3VwcG9ydGVkIC0gYWJvcnRlZCB0ZW5zb3IgY3JlYXRpb24iKX17bGV0IHQscjtpZih2b2lkIDAhPT1uJiZ2b2lkIDAhPT1uLnJlc2l6ZWRXaWR0aCYmdm9pZCAwIT09bi5yZXNpemVkSGVpZ2h0Pyh0PW4ucmVzaXplZEhlaWdodCxyPW4ucmVzaXplZFdpZHRoKToodD1lLmhlaWdodCxyPWUud2lkdGgpLHZvaWQgMCE9PW4mJih1PW4pLHUuZm9ybWF0PSJSR0JBIix1LmhlaWdodD10LHUud2lkdGg9cix2b2lkIDAhPT1uKXtjb25zdCBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpO24ud2lkdGg9cixuLmhlaWdodD10O2NvbnN0IG89bi5nZXRDb250ZXh0KCIyZCIpO2lmKG51bGw9PW8pdGhyb3cgbmV3IEVycm9yKCJDYW4gbm90IGFjY2VzcyBpbWFnZSBkYXRhIik7by5wdXRJbWFnZURhdGEoZSwwLDApLGE9by5nZXRJbWFnZURhdGEoMCwwLHIsdCkuZGF0YTt9ZWxzZSBhPWUuZGF0YTt9fWlmKHZvaWQgMCE9PWEpcmV0dXJuICgwLCB0LmJ1ZmZlclRvVGVuc29yKShhLHUpO3Rocm93IG5ldyBFcnJvcigiSW5wdXQgZGF0YSBwcm92aWRlZCBpcyBub3Qgc3VwcG9ydGVkIC0gYWJvcnRlZCB0ZW5zb3IgY3JlYXRpb24iKX07fSw1OTU3OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5UZW5zb3I9dm9pZCAwO2NvbnN0IHI9bigyMzUwKSxvPW4oNDg2NiksaT1uKDEwNikscz1uZXcgTWFwKFtbImZsb2F0MzIiLEZsb2F0MzJBcnJheV0sWyJ1aW50OCIsVWludDhBcnJheV0sWyJpbnQ4IixJbnQ4QXJyYXldLFsidWludDE2IixVaW50MTZBcnJheV0sWyJmbG9hdDE2IixVaW50MTZBcnJheV0sWyJpbnQxNiIsSW50MTZBcnJheV0sWyJpbnQzMiIsSW50MzJBcnJheV0sWyJib29sIixVaW50OEFycmF5XSxbImZsb2F0NjQiLEZsb2F0NjRBcnJheV0sWyJ1aW50MzIiLFVpbnQzMkFycmF5XV0pLGE9bmV3IE1hcChbW0Zsb2F0MzJBcnJheSwiZmxvYXQzMiJdLFtVaW50OEFycmF5LCJ1aW50OCJdLFtJbnQ4QXJyYXksImludDgiXSxbVWludDE2QXJyYXksInVpbnQxNiJdLFtJbnQxNkFycmF5LCJpbnQxNiJdLFtJbnQzMkFycmF5LCJpbnQzMiJdLFtGbG9hdDY0QXJyYXksImZsb2F0NjQiXSxbVWludDMyQXJyYXksInVpbnQzMiJdXSk7bGV0IHU9ITE7dC5UZW5zb3I9Y2xhc3N7Y29uc3RydWN0b3IoZSx0LG4pe2xldCByLG8sbDtpZigoKCk9PntpZighdSl7dT0hMDtjb25zdCBlPSJ1bmRlZmluZWQiIT10eXBlb2YgQmlnSW50NjRBcnJheSYmImZ1bmN0aW9uIj09dHlwZW9mIEJpZ0ludDY0QXJyYXkuZnJvbSx0PSJ1bmRlZmluZWQiIT10eXBlb2YgQmlnVWludDY0QXJyYXkmJiJmdW5jdGlvbiI9PXR5cGVvZiBCaWdVaW50NjRBcnJheS5mcm9tO2UmJihzLnNldCgiaW50NjQiLEJpZ0ludDY0QXJyYXkpLGEuc2V0KEJpZ0ludDY0QXJyYXksImludDY0IikpLHQmJihzLnNldCgidWludDY0IixCaWdVaW50NjRBcnJheSksYS5zZXQoQmlnVWludDY0QXJyYXksInVpbnQ2NCIpKTt9fSkoKSwic3RyaW5nIj09dHlwZW9mIGUpaWYocj1lLGw9biwic3RyaW5nIj09PWUpe2lmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkEgc3RyaW5nIHRlbnNvcidzIGRhdGEgbXVzdCBiZSBhIHN0cmluZyBhcnJheS4iKTtvPXQ7fWVsc2Uge2NvbnN0IG49cy5nZXQoZSk7aWYodm9pZCAwPT09bil0aHJvdyBuZXcgVHlwZUVycm9yKGBVbnN1cHBvcnRlZCB0ZW5zb3IgdHlwZTogJHtlfS5gKTtpZihBcnJheS5pc0FycmF5KHQpKXtpZigiZmxvYXQxNiI9PT1lKXRocm93IG5ldyBUeXBlRXJyb3IoIkNyZWF0aW5nIGEgZmxvYXQxNiB0ZW5zb3IgZnJvbSBudW1iZXIgYXJyYXkgaXMgbm90IHN1cHBvcnRlZC4gUGxlYXNlIHVzZSBVaW50MTZBcnJheSBhcyBkYXRhLiIpO289InVpbnQ2NCI9PT1lfHwiaW50NjQiPT09ZT9uLmZyb20odCxCaWdJbnQpOm4uZnJvbSh0KTt9ZWxzZSB7aWYoISh0IGluc3RhbmNlb2YgbikpdGhyb3cgbmV3IFR5cGVFcnJvcihgQSAke3J9IHRlbnNvcidzIGRhdGEgbXVzdCBiZSB0eXBlIG9mICR7bn1gKTtvPXQ7fX1lbHNlIGlmKGw9dCxBcnJheS5pc0FycmF5KGUpKXtpZigwPT09ZS5sZW5ndGgpdGhyb3cgbmV3IFR5cGVFcnJvcigiVGVuc29yIHR5cGUgY2Fubm90IGJlIGluZmVycmVkIGZyb20gYW4gZW1wdHkgYXJyYXkuIik7Y29uc3QgdD10eXBlb2YgZVswXTtpZigic3RyaW5nIj09PXQpcj0ic3RyaW5nIixvPWU7ZWxzZSB7aWYoImJvb2xlYW4iIT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKGBJbnZhbGlkIGVsZW1lbnQgdHlwZSBvZiBkYXRhIGFycmF5OiAke3R9LmApO3I9ImJvb2wiLG89VWludDhBcnJheS5mcm9tKGUpO319ZWxzZSB7Y29uc3QgdD1hLmdldChlLmNvbnN0cnVjdG9yKTtpZih2b2lkIDA9PT10KXRocm93IG5ldyBUeXBlRXJyb3IoYFVuc3VwcG9ydGVkIHR5cGUgZm9yIHRlbnNvciBkYXRhOiAke2UuY29uc3RydWN0b3J9LmApO3I9dCxvPWU7fWlmKHZvaWQgMD09PWwpbD1bby5sZW5ndGhdO2Vsc2UgaWYoIUFycmF5LmlzQXJyYXkobCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQSB0ZW5zb3IncyBkaW1zIG11c3QgYmUgYSBudW1iZXIgYXJyYXkiKTtjb25zdCBjPSgwLCBpLmNhbGN1bGF0ZVNpemUpKGwpO2lmKGMhPT1vLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoYFRlbnNvcidzIHNpemUoJHtjfSkgZG9lcyBub3QgbWF0Y2ggZGF0YSBsZW5ndGgoJHtvLmxlbmd0aH0pLmApO3RoaXMuZGltcz1sLHRoaXMudHlwZT1yLHRoaXMuZGF0YT1vLHRoaXMuc2l6ZT1jO31zdGF0aWMgYXN5bmMgZnJvbUltYWdlKGUsdCl7cmV0dXJuICgwLCBvLnRlbnNvckZyb21JbWFnZSkoZSx0KX10b0RhdGFVUkwoZSl7cmV0dXJuICgwLCByLnRlbnNvclRvRGF0YVVSTCkodGhpcyxlKX10b0ltYWdlRGF0YShlKXtyZXR1cm4gKDAsIHIudGVuc29yVG9JbWFnZURhdGEpKHRoaXMsZSl9cmVzaGFwZShlKXtyZXR1cm4gKDAsIGkudGVuc29yUmVzaGFwZSkodGhpcyxlKX19O30sMTA2OihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC50ZW5zb3JSZXNoYXBlPXQuY2FsY3VsYXRlU2l6ZT12b2lkIDA7Y29uc3Qgcj1uKDk2Myk7dC5jYWxjdWxhdGVTaXplPWU9PntsZXQgdD0xO2ZvcihsZXQgbj0wO248ZS5sZW5ndGg7bisrKXtjb25zdCByPWVbbl07aWYoIm51bWJlciIhPXR5cGVvZiByfHwhTnVtYmVyLmlzU2FmZUludGVnZXIocikpdGhyb3cgbmV3IFR5cGVFcnJvcihgZGltc1ske259XSBtdXN0IGJlIGFuIGludGVnZXIsIGdvdDogJHtyfWApO2lmKHI8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgZGltc1ske259XSBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIGludGVnZXIsIGdvdDogJHtyfWApO3QqPXI7fXJldHVybiB0fSx0LnRlbnNvclJlc2hhcGU9KGUsdCk9Pm5ldyByLlRlbnNvcihlLnR5cGUsZS5kYXRhLHQpO30sOTYzOihlLHQsbik9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC5UZW5zb3I9dm9pZCAwO2NvbnN0IHI9big1OTU3KTt0LlRlbnNvcj1yLlRlbnNvcjt9LDkxMDQ6KGUsdCk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdC52ZXJzaW9uPXZvaWQgMCx0LnZlcnNpb249IjEuMTYuMyI7fSwxNTgzOihlLHQpPT57dmFyIG4scj1mdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksZS5kZWZhdWx0PXZvaWQgMDt2YXIgdD1udWxsO3RyeXt0PW5ldyBXZWJBc3NlbWJseS5JbnN0YW5jZShuZXcgV2ViQXNzZW1ibHkuTW9kdWxlKG5ldyBVaW50OEFycmF5KFswLDk3LDExNSwxMDksMSwwLDAsMCwxLDEzLDIsOTYsMCwxLDEyNyw5Niw0LDEyNywxMjcsMTI3LDEyNywxLDEyNywzLDcsNiwwLDEsMSwxLDEsMSw2LDYsMSwxMjcsMSw2NSwwLDExLDcsNTAsNiwzLDEwOSwxMTcsMTA4LDAsMSw1LDEwMCwxMDUsMTE4LDk1LDExNSwwLDIsNSwxMDAsMTA1LDExOCw5NSwxMTcsMCwzLDUsMTE0LDEwMSwxMDksOTUsMTE1LDAsNCw1LDExNCwxMDEsMTA5LDk1LDExNywwLDUsOCwxMDMsMTAxLDExNiw5NSwxMDQsMTA1LDEwMywxMDQsMCwwLDEwLDE5MSwxLDYsNCwwLDM1LDAsMTEsMzYsMSwxLDEyNiwzMiwwLDE3MywzMiwxLDE3Myw2NiwzMiwxMzQsMTMyLDMyLDIsMTczLDMyLDMsMTczLDY2LDMyLDEzNCwxMzIsMTI2LDM0LDQsNjYsMzIsMTM1LDE2NywzNiwwLDMyLDQsMTY3LDExLDM2LDEsMSwxMjYsMzIsMCwxNzMsMzIsMSwxNzMsNjYsMzIsMTM0LDEzMiwzMiwyLDE3MywzMiwzLDE3Myw2NiwzMiwxMzQsMTMyLDEyNywzNCw0LDY2LDMyLDEzNSwxNjcsMzYsMCwzMiw0LDE2NywxMSwzNiwxLDEsMTI2LDMyLDAsMTczLDMyLDEsMTczLDY2LDMyLDEzNCwxMzIsMzIsMiwxNzMsMzIsMywxNzMsNjYsMzIsMTM0LDEzMiwxMjgsMzQsNCw2NiwzMiwxMzUsMTY3LDM2LDAsMzIsNCwxNjcsMTEsMzYsMSwxLDEyNiwzMiwwLDE3MywzMiwxLDE3Myw2NiwzMiwxMzQsMTMyLDMyLDIsMTczLDMyLDMsMTczLDY2LDMyLDEzNCwxMzIsMTI5LDM0LDQsNjYsMzIsMTM1LDE2NywzNiwwLDMyLDQsMTY3LDExLDM2LDEsMSwxMjYsMzIsMCwxNzMsMzIsMSwxNzMsNjYsMzIsMTM0LDEzMiwzMiwyLDE3MywzMiwzLDE3Myw2NiwzMiwxMzQsMTMyLDEzMCwzNCw0LDY2LDMyLDEzNSwxNjcsMzYsMCwzMiw0LDE2NywxMV0pKSx7fSkuZXhwb3J0czt9Y2F0Y2goZSl7fWZ1bmN0aW9uIG4oZSx0LG4pe3RoaXMubG93PTB8ZSx0aGlzLmhpZ2g9MHx0LHRoaXMudW5zaWduZWQ9ISFuO31mdW5jdGlvbiByKGUpe3JldHVybiAhMD09PShlJiZlLl9faXNMb25nX18pfWZ1bmN0aW9uIG8oZSl7dmFyIHQ9TWF0aC5jbHozMihlJi1lKTtyZXR1cm4gZT8zMS10OnR9bi5wcm90b3R5cGUuX19pc0xvbmdfXyxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsIl9faXNMb25nX18iLHt2YWx1ZTohMH0pLG4uaXNMb25nPXI7dmFyIGk9e30scz17fTtmdW5jdGlvbiBhKGUsdCl7dmFyIG4scixvO3JldHVybiB0PyhvPTA8PShlPj4+PTApJiZlPDI1NikmJihyPXNbZV0pP3I6KG49bChlLDAsITApLG8mJihzW2VdPW4pLG4pOihvPS0xMjg8PShlfD0wKSYmZTwxMjgpJiYocj1pW2VdKT9yOihuPWwoZSxlPDA/LTE6MCwhMSksbyYmKGlbZV09biksbil9ZnVuY3Rpb24gdShlLHQpe2lmKGlzTmFOKGUpKXJldHVybiB0P3k6bTtpZih0KXtpZihlPDApcmV0dXJuIHk7aWYoZT49aClyZXR1cm4geH1lbHNlIHtpZihlPD0tZylyZXR1cm4gTztpZihlKzE+PWcpcmV0dXJuIFR9cmV0dXJuIGU8MD91KC1lLHQpLm5lZygpOmwoZSVmfDAsZS9mfDAsdCl9ZnVuY3Rpb24gbChlLHQscil7cmV0dXJuIG5ldyBuKGUsdCxyKX1uLmZyb21JbnQ9YSxuLmZyb21OdW1iZXI9dSxuLmZyb21CaXRzPWw7dmFyIGM9TWF0aC5wb3c7ZnVuY3Rpb24gcChlLHQsbil7aWYoMD09PWUubGVuZ3RoKXRocm93IEVycm9yKCJlbXB0eSBzdHJpbmciKTtpZigibnVtYmVyIj09dHlwZW9mIHQ/KG49dCx0PSExKTp0PSEhdCwiTmFOIj09PWV8fCJJbmZpbml0eSI9PT1lfHwiK0luZmluaXR5Ij09PWV8fCItSW5maW5pdHkiPT09ZSlyZXR1cm4gdD95Om07aWYoKG49bnx8MTApPDJ8fDM2PG4pdGhyb3cgUmFuZ2VFcnJvcigicmFkaXgiKTt2YXIgcjtpZigocj1lLmluZGV4T2YoIi0iKSk+MCl0aHJvdyBFcnJvcigiaW50ZXJpb3IgaHlwaGVuIik7aWYoMD09PXIpcmV0dXJuIHAoZS5zdWJzdHJpbmcoMSksdCxuKS5uZWcoKTtmb3IodmFyIG89dShjKG4sOCkpLGk9bSxzPTA7czxlLmxlbmd0aDtzKz04KXt2YXIgYT1NYXRoLm1pbig4LGUubGVuZ3RoLXMpLGw9cGFyc2VJbnQoZS5zdWJzdHJpbmcocyxzK2EpLG4pO2lmKGE8OCl7dmFyIGQ9dShjKG4sYSkpO2k9aS5tdWwoZCkuYWRkKHUobCkpO31lbHNlIGk9KGk9aS5tdWwobykpLmFkZCh1KGwpKTt9cmV0dXJuIGkudW5zaWduZWQ9dCxpfWZ1bmN0aW9uIGQoZSx0KXtyZXR1cm4gIm51bWJlciI9PXR5cGVvZiBlP3UoZSx0KToic3RyaW5nIj09dHlwZW9mIGU/cChlLHQpOmwoZS5sb3csZS5oaWdoLCJib29sZWFuIj09dHlwZW9mIHQ/dDplLnVuc2lnbmVkKX1uLmZyb21TdHJpbmc9cCxuLmZyb21WYWx1ZT1kO3ZhciBmPTQyOTQ5NjcyOTYsaD1mKmYsZz1oLzIsYj1hKDE8PDI0KSxtPWEoMCk7bi5aRVJPPW07dmFyIHk9YSgwLCEwKTtuLlVaRVJPPXk7dmFyIHY9YSgxKTtuLk9ORT12O3ZhciBfPWEoMSwhMCk7bi5VT05FPV87dmFyIHc9YSgtMSk7bi5ORUdfT05FPXc7dmFyIFQ9bCgtMSwyMTQ3NDgzNjQ3LCExKTtuLk1BWF9WQUxVRT1UO3ZhciB4PWwoLTEsLTEsITApO24uTUFYX1VOU0lHTkVEX1ZBTFVFPXg7dmFyIE89bCgwLC0yMTQ3NDgzNjQ4LCExKTtuLk1JTl9WQUxVRT1PO3ZhciBTPW4ucHJvdG90eXBlO1MudG9JbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnNpZ25lZD90aGlzLmxvdz4+PjA6dGhpcy5sb3d9LFMudG9OdW1iZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnNpZ25lZD8odGhpcy5oaWdoPj4+MCkqZisodGhpcy5sb3c+Pj4wKTp0aGlzLmhpZ2gqZisodGhpcy5sb3c+Pj4wKX0sUy50b1N0cmluZz1mdW5jdGlvbihlKXtpZigoZT1lfHwxMCk8Mnx8MzY8ZSl0aHJvdyBSYW5nZUVycm9yKCJyYWRpeCIpO2lmKHRoaXMuaXNaZXJvKCkpcmV0dXJuICIwIjtpZih0aGlzLmlzTmVnYXRpdmUoKSl7aWYodGhpcy5lcShPKSl7dmFyIHQ9dShlKSxuPXRoaXMuZGl2KHQpLHI9bi5tdWwodCkuc3ViKHRoaXMpO3JldHVybiBuLnRvU3RyaW5nKGUpK3IudG9JbnQoKS50b1N0cmluZyhlKX1yZXR1cm4gIi0iK3RoaXMubmVnKCkudG9TdHJpbmcoZSl9Zm9yKHZhciBvPXUoYyhlLDYpLHRoaXMudW5zaWduZWQpLGk9dGhpcyxzPSIiOzspe3ZhciBhPWkuZGl2KG8pLGw9KGkuc3ViKGEubXVsKG8pKS50b0ludCgpPj4+MCkudG9TdHJpbmcoZSk7aWYoKGk9YSkuaXNaZXJvKCkpcmV0dXJuIGwrcztmb3IoO2wubGVuZ3RoPDY7KWw9IjAiK2w7cz0iIitsK3M7fX0sUy5nZXRIaWdoQml0cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhpZ2h9LFMuZ2V0SGlnaEJpdHNVbnNpZ25lZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhpZ2g+Pj4wfSxTLmdldExvd0JpdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb3d9LFMuZ2V0TG93Qml0c1Vuc2lnbmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG93Pj4+MH0sUy5nZXROdW1CaXRzQWJzPWZ1bmN0aW9uKCl7aWYodGhpcy5pc05lZ2F0aXZlKCkpcmV0dXJuIHRoaXMuZXEoTyk/NjQ6dGhpcy5uZWcoKS5nZXROdW1CaXRzQWJzKCk7Zm9yKHZhciBlPTAhPXRoaXMuaGlnaD90aGlzLmhpZ2g6dGhpcy5sb3csdD0zMTt0PjAmJjA9PShlJjE8PHQpO3QtLSk7cmV0dXJuIDAhPXRoaXMuaGlnaD90KzMzOnQrMX0sUy5pc1plcm89ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuaGlnaCYmMD09PXRoaXMubG93fSxTLmVxej1TLmlzWmVybyxTLmlzTmVnYXRpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gIXRoaXMudW5zaWduZWQmJnRoaXMuaGlnaDwwfSxTLmlzUG9zaXRpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnNpZ25lZHx8dGhpcy5oaWdoPj0wfSxTLmlzT2RkPWZ1bmN0aW9uKCl7cmV0dXJuIDE9PSgxJnRoaXMubG93KX0sUy5pc0V2ZW49ZnVuY3Rpb24oKXtyZXR1cm4gMD09KDEmdGhpcy5sb3cpfSxTLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gcihlKXx8KGU9ZChlKSksKHRoaXMudW5zaWduZWQ9PT1lLnVuc2lnbmVkfHx0aGlzLmhpZ2g+Pj4zMSE9MXx8ZS5oaWdoPj4+MzEhPTEpJiZ0aGlzLmhpZ2g9PT1lLmhpZ2gmJnRoaXMubG93PT09ZS5sb3d9LFMuZXE9Uy5lcXVhbHMsUy5ub3RFcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuICF0aGlzLmVxKGUpfSxTLm5lcT1TLm5vdEVxdWFscyxTLm5lPVMubm90RXF1YWxzLFMubGVzc1RoYW49ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29tcChlKTwwfSxTLmx0PVMubGVzc1RoYW4sUy5sZXNzVGhhbk9yRXF1YWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29tcChlKTw9MH0sUy5sdGU9Uy5sZXNzVGhhbk9yRXF1YWwsUy5sZT1TLmxlc3NUaGFuT3JFcXVhbCxTLmdyZWF0ZXJUaGFuPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbXAoZSk+MH0sUy5ndD1TLmdyZWF0ZXJUaGFuLFMuZ3JlYXRlclRoYW5PckVxdWFsPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbXAoZSk+PTB9LFMuZ3RlPVMuZ3JlYXRlclRoYW5PckVxdWFsLFMuZ2U9Uy5ncmVhdGVyVGhhbk9yRXF1YWwsUy5jb21wYXJlPWZ1bmN0aW9uKGUpe2lmKHIoZSl8fChlPWQoZSkpLHRoaXMuZXEoZSkpcmV0dXJuIDA7dmFyIHQ9dGhpcy5pc05lZ2F0aXZlKCksbj1lLmlzTmVnYXRpdmUoKTtyZXR1cm4gdCYmIW4/LTE6IXQmJm4/MTp0aGlzLnVuc2lnbmVkP2UuaGlnaD4+PjA+dGhpcy5oaWdoPj4+MHx8ZS5oaWdoPT09dGhpcy5oaWdoJiZlLmxvdz4+PjA+dGhpcy5sb3c+Pj4wPy0xOjE6dGhpcy5zdWIoZSkuaXNOZWdhdGl2ZSgpPy0xOjF9LFMuY29tcD1TLmNvbXBhcmUsUy5uZWdhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gIXRoaXMudW5zaWduZWQmJnRoaXMuZXEoTyk/Tzp0aGlzLm5vdCgpLmFkZCh2KX0sUy5uZWc9Uy5uZWdhdGUsUy5hZGQ9ZnVuY3Rpb24oZSl7cihlKXx8KGU9ZChlKSk7dmFyIHQ9dGhpcy5oaWdoPj4+MTYsbj02NTUzNSZ0aGlzLmhpZ2gsbz10aGlzLmxvdz4+PjE2LGk9NjU1MzUmdGhpcy5sb3cscz1lLmhpZ2g+Pj4xNixhPTY1NTM1JmUuaGlnaCx1PWUubG93Pj4+MTYsYz0wLHA9MCxmPTAsaD0wO3JldHVybiBmKz0oaCs9aSsoNjU1MzUmZS5sb3cpKT4+PjE2LHArPShmKz1vK3UpPj4+MTYsYys9KHArPW4rYSk+Pj4xNixjKz10K3MsbCgoZiY9NjU1MzUpPDwxNnwoaCY9NjU1MzUpLChjJj02NTUzNSk8PDE2fChwJj02NTUzNSksdGhpcy51bnNpZ25lZCl9LFMuc3VidHJhY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIHIoZSl8fChlPWQoZSkpLHRoaXMuYWRkKGUubmVnKCkpfSxTLnN1Yj1TLnN1YnRyYWN0LFMubXVsdGlwbHk9ZnVuY3Rpb24oZSl7aWYodGhpcy5pc1plcm8oKSlyZXR1cm4gdGhpcztpZihyKGUpfHwoZT1kKGUpKSx0KXJldHVybiBsKHQubXVsKHRoaXMubG93LHRoaXMuaGlnaCxlLmxvdyxlLmhpZ2gpLHQuZ2V0X2hpZ2goKSx0aGlzLnVuc2lnbmVkKTtpZihlLmlzWmVybygpKXJldHVybiB0aGlzLnVuc2lnbmVkP3k6bTtpZih0aGlzLmVxKE8pKXJldHVybiBlLmlzT2RkKCk/TzptO2lmKGUuZXEoTykpcmV0dXJuIHRoaXMuaXNPZGQoKT9POm07aWYodGhpcy5pc05lZ2F0aXZlKCkpcmV0dXJuIGUuaXNOZWdhdGl2ZSgpP3RoaXMubmVnKCkubXVsKGUubmVnKCkpOnRoaXMubmVnKCkubXVsKGUpLm5lZygpO2lmKGUuaXNOZWdhdGl2ZSgpKXJldHVybiB0aGlzLm11bChlLm5lZygpKS5uZWcoKTtpZih0aGlzLmx0KGIpJiZlLmx0KGIpKXJldHVybiB1KHRoaXMudG9OdW1iZXIoKSplLnRvTnVtYmVyKCksdGhpcy51bnNpZ25lZCk7dmFyIG49dGhpcy5oaWdoPj4+MTYsbz02NTUzNSZ0aGlzLmhpZ2gsaT10aGlzLmxvdz4+PjE2LHM9NjU1MzUmdGhpcy5sb3csYT1lLmhpZ2g+Pj4xNixjPTY1NTM1JmUuaGlnaCxwPWUubG93Pj4+MTYsZj02NTUzNSZlLmxvdyxoPTAsZz0wLHY9MCxfPTA7cmV0dXJuIHYrPShfKz1zKmYpPj4+MTYsZys9KHYrPWkqZik+Pj4xNix2Jj02NTUzNSxnKz0odis9cypwKT4+PjE2LGgrPShnKz1vKmYpPj4+MTYsZyY9NjU1MzUsaCs9KGcrPWkqcCk+Pj4xNixnJj02NTUzNSxoKz0oZys9cypjKT4+PjE2LGgrPW4qZitvKnAraSpjK3MqYSxsKCh2Jj02NTUzNSk8PDE2fChfJj02NTUzNSksKGgmPTY1NTM1KTw8MTZ8KGcmPTY1NTM1KSx0aGlzLnVuc2lnbmVkKX0sUy5tdWw9Uy5tdWx0aXBseSxTLmRpdmlkZT1mdW5jdGlvbihlKXtpZihyKGUpfHwoZT1kKGUpKSxlLmlzWmVybygpKXRocm93IEVycm9yKCJkaXZpc2lvbiBieSB6ZXJvIik7dmFyIG4sbyxpO2lmKHQpcmV0dXJuIHRoaXMudW5zaWduZWR8fC0yMTQ3NDgzNjQ4IT09dGhpcy5oaWdofHwtMSE9PWUubG93fHwtMSE9PWUuaGlnaD9sKCh0aGlzLnVuc2lnbmVkP3QuZGl2X3U6dC5kaXZfcykodGhpcy5sb3csdGhpcy5oaWdoLGUubG93LGUuaGlnaCksdC5nZXRfaGlnaCgpLHRoaXMudW5zaWduZWQpOnRoaXM7aWYodGhpcy5pc1plcm8oKSlyZXR1cm4gdGhpcy51bnNpZ25lZD95Om07aWYodGhpcy51bnNpZ25lZCl7aWYoZS51bnNpZ25lZHx8KGU9ZS50b1Vuc2lnbmVkKCkpLGUuZ3QodGhpcykpcmV0dXJuIHk7aWYoZS5ndCh0aGlzLnNocnUoMSkpKXJldHVybiBfO2k9eTt9ZWxzZSB7aWYodGhpcy5lcShPKSlyZXR1cm4gZS5lcSh2KXx8ZS5lcSh3KT9POmUuZXEoTyk/djoobj10aGlzLnNocigxKS5kaXYoZSkuc2hsKDEpKS5lcShtKT9lLmlzTmVnYXRpdmUoKT92Onc6KG89dGhpcy5zdWIoZS5tdWwobikpLGk9bi5hZGQoby5kaXYoZSkpKTtpZihlLmVxKE8pKXJldHVybiB0aGlzLnVuc2lnbmVkP3k6bTtpZih0aGlzLmlzTmVnYXRpdmUoKSlyZXR1cm4gZS5pc05lZ2F0aXZlKCk/dGhpcy5uZWcoKS5kaXYoZS5uZWcoKSk6dGhpcy5uZWcoKS5kaXYoZSkubmVnKCk7aWYoZS5pc05lZ2F0aXZlKCkpcmV0dXJuIHRoaXMuZGl2KGUubmVnKCkpLm5lZygpO2k9bTt9Zm9yKG89dGhpcztvLmd0ZShlKTspe249TWF0aC5tYXgoMSxNYXRoLmZsb29yKG8udG9OdW1iZXIoKS9lLnRvTnVtYmVyKCkpKTtmb3IodmFyIHM9TWF0aC5jZWlsKE1hdGgubG9nKG4pL01hdGguTE4yKSxhPXM8PTQ4PzE6YygyLHMtNDgpLHA9dShuKSxmPXAubXVsKGUpO2YuaXNOZWdhdGl2ZSgpfHxmLmd0KG8pOylmPShwPXUobi09YSx0aGlzLnVuc2lnbmVkKSkubXVsKGUpO3AuaXNaZXJvKCkmJihwPXYpLGk9aS5hZGQocCksbz1vLnN1YihmKTt9cmV0dXJuIGl9LFMuZGl2PVMuZGl2aWRlLFMubW9kdWxvPWZ1bmN0aW9uKGUpe3JldHVybiByKGUpfHwoZT1kKGUpKSx0P2woKHRoaXMudW5zaWduZWQ/dC5yZW1fdTp0LnJlbV9zKSh0aGlzLmxvdyx0aGlzLmhpZ2gsZS5sb3csZS5oaWdoKSx0LmdldF9oaWdoKCksdGhpcy51bnNpZ25lZCk6dGhpcy5zdWIodGhpcy5kaXYoZSkubXVsKGUpKX0sUy5tb2Q9Uy5tb2R1bG8sUy5yZW09Uy5tb2R1bG8sUy5ub3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbCh+dGhpcy5sb3csfnRoaXMuaGlnaCx0aGlzLnVuc2lnbmVkKX0sUy5jb3VudExlYWRpbmdaZXJvcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhpZ2g/TWF0aC5jbHozMih0aGlzLmhpZ2gpOk1hdGguY2x6MzIodGhpcy5sb3cpKzMyfSxTLmNsej1TLmNvdW50TGVhZGluZ1plcm9zLFMuY291bnRUcmFpbGluZ1plcm9zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG93P28odGhpcy5sb3cpOm8odGhpcy5oaWdoKSszMn0sUy5jdHo9Uy5jb3VudFRyYWlsaW5nWmVyb3MsUy5hbmQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHIoZSl8fChlPWQoZSkpLGwodGhpcy5sb3cmZS5sb3csdGhpcy5oaWdoJmUuaGlnaCx0aGlzLnVuc2lnbmVkKX0sUy5vcj1mdW5jdGlvbihlKXtyZXR1cm4gcihlKXx8KGU9ZChlKSksbCh0aGlzLmxvd3xlLmxvdyx0aGlzLmhpZ2h8ZS5oaWdoLHRoaXMudW5zaWduZWQpfSxTLnhvcj1mdW5jdGlvbihlKXtyZXR1cm4gcihlKXx8KGU9ZChlKSksbCh0aGlzLmxvd15lLmxvdyx0aGlzLmhpZ2heZS5oaWdoLHRoaXMudW5zaWduZWQpfSxTLnNoaWZ0TGVmdD1mdW5jdGlvbihlKXtyZXR1cm4gcihlKSYmKGU9ZS50b0ludCgpKSwwPT0oZSY9NjMpP3RoaXM6ZTwzMj9sKHRoaXMubG93PDxlLHRoaXMuaGlnaDw8ZXx0aGlzLmxvdz4+PjMyLWUsdGhpcy51bnNpZ25lZCk6bCgwLHRoaXMubG93PDxlLTMyLHRoaXMudW5zaWduZWQpfSxTLnNobD1TLnNoaWZ0TGVmdCxTLnNoaWZ0UmlnaHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHIoZSkmJihlPWUudG9JbnQoKSksMD09KGUmPTYzKT90aGlzOmU8MzI/bCh0aGlzLmxvdz4+PmV8dGhpcy5oaWdoPDwzMi1lLHRoaXMuaGlnaD4+ZSx0aGlzLnVuc2lnbmVkKTpsKHRoaXMuaGlnaD4+ZS0zMix0aGlzLmhpZ2g+PTA/MDotMSx0aGlzLnVuc2lnbmVkKX0sUy5zaHI9Uy5zaGlmdFJpZ2h0LFMuc2hpZnRSaWdodFVuc2lnbmVkPWZ1bmN0aW9uKGUpe3JldHVybiByKGUpJiYoZT1lLnRvSW50KCkpLDA9PShlJj02Myk/dGhpczplPDMyP2wodGhpcy5sb3c+Pj5lfHRoaXMuaGlnaDw8MzItZSx0aGlzLmhpZ2g+Pj5lLHRoaXMudW5zaWduZWQpOmwoMzI9PT1lP3RoaXMuaGlnaDp0aGlzLmhpZ2g+Pj5lLTMyLDAsdGhpcy51bnNpZ25lZCl9LFMuc2hydT1TLnNoaWZ0UmlnaHRVbnNpZ25lZCxTLnNocl91PVMuc2hpZnRSaWdodFVuc2lnbmVkLFMucm90YXRlTGVmdD1mdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gcihlKSYmKGU9ZS50b0ludCgpKSwwPT0oZSY9NjMpP3RoaXM6MzI9PT1lP2wodGhpcy5oaWdoLHRoaXMubG93LHRoaXMudW5zaWduZWQpOmU8MzI/KHQ9MzItZSxsKHRoaXMubG93PDxlfHRoaXMuaGlnaD4+PnQsdGhpcy5oaWdoPDxlfHRoaXMubG93Pj4+dCx0aGlzLnVuc2lnbmVkKSk6KHQ9MzItKGUtPTMyKSxsKHRoaXMuaGlnaDw8ZXx0aGlzLmxvdz4+PnQsdGhpcy5sb3c8PGV8dGhpcy5oaWdoPj4+dCx0aGlzLnVuc2lnbmVkKSl9LFMucm90bD1TLnJvdGF0ZUxlZnQsUy5yb3RhdGVSaWdodD1mdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gcihlKSYmKGU9ZS50b0ludCgpKSwwPT0oZSY9NjMpP3RoaXM6MzI9PT1lP2wodGhpcy5oaWdoLHRoaXMubG93LHRoaXMudW5zaWduZWQpOmU8MzI/KHQ9MzItZSxsKHRoaXMuaGlnaDw8dHx0aGlzLmxvdz4+PmUsdGhpcy5sb3c8PHR8dGhpcy5oaWdoPj4+ZSx0aGlzLnVuc2lnbmVkKSk6KHQ9MzItKGUtPTMyKSxsKHRoaXMubG93PDx0fHRoaXMuaGlnaD4+PmUsdGhpcy5oaWdoPDx0fHRoaXMubG93Pj4+ZSx0aGlzLnVuc2lnbmVkKSl9LFMucm90cj1TLnJvdGF0ZVJpZ2h0LFMudG9TaWduZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnNpZ25lZD9sKHRoaXMubG93LHRoaXMuaGlnaCwhMSk6dGhpc30sUy50b1Vuc2lnbmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5zaWduZWQ/dGhpczpsKHRoaXMubG93LHRoaXMuaGlnaCwhMCl9LFMudG9CeXRlcz1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLnRvQnl0ZXNMRSgpOnRoaXMudG9CeXRlc0JFKCl9LFMudG9CeXRlc0xFPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5oaWdoLHQ9dGhpcy5sb3c7cmV0dXJuIFsyNTUmdCx0Pj4+OCYyNTUsdD4+PjE2JjI1NSx0Pj4+MjQsMjU1JmUsZT4+PjgmMjU1LGU+Pj4xNiYyNTUsZT4+PjI0XX0sUy50b0J5dGVzQkU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmhpZ2gsdD10aGlzLmxvdztyZXR1cm4gW2U+Pj4yNCxlPj4+MTYmMjU1LGU+Pj44JjI1NSwyNTUmZSx0Pj4+MjQsdD4+PjE2JjI1NSx0Pj4+OCYyNTUsMjU1JnRdfSxuLmZyb21CeXRlcz1mdW5jdGlvbihlLHQscil7cmV0dXJuIHI/bi5mcm9tQnl0ZXNMRShlLHQpOm4uZnJvbUJ5dGVzQkUoZSx0KX0sbi5mcm9tQnl0ZXNMRT1mdW5jdGlvbihlLHQpe3JldHVybiBuZXcgbihlWzBdfGVbMV08PDh8ZVsyXTw8MTZ8ZVszXTw8MjQsZVs0XXxlWzVdPDw4fGVbNl08PDE2fGVbN108PDI0LHQpfSxuLmZyb21CeXRlc0JFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBuKGVbNF08PDI0fGVbNV08PDE2fGVbNl08PDh8ZVs3XSxlWzBdPDwyNHxlWzFdPDwxNnxlWzJdPDw4fGVbM10sdCl9O3ZhciBBPW47cmV0dXJuIGUuZGVmYXVsdD1BLCJkZWZhdWx0ImluIGU/ZS5kZWZhdWx0OmV9KHt9KTt2b2lkIDA9PT0obj1mdW5jdGlvbigpe3JldHVybiByfS5hcHBseSh0LFtdKSl8fChlLmV4cG9ydHM9bik7fSw1Njg2OihlLHQsbik9PntuLnIodCksbi5kKHQse2ZsYXRidWZmZXJzOigpPT5yfSk7dmFyIHI9e307ci5PZmZzZXQsci5UYWJsZSxyLlNJWkVPRl9TSE9SVD0yLHIuU0laRU9GX0lOVD00LHIuRklMRV9JREVOVElGSUVSX0xFTkdUSD00LHIuU0laRV9QUkVGSVhfTEVOR1RIPTQsci5FbmNvZGluZz17VVRGOF9CWVRFUzoxLFVURjE2X1NUUklORzoyfSxyLmludDMyPW5ldyBJbnQzMkFycmF5KDIpLHIuZmxvYXQzMj1uZXcgRmxvYXQzMkFycmF5KHIuaW50MzIuYnVmZmVyKSxyLmZsb2F0NjQ9bmV3IEZsb2F0NjRBcnJheShyLmludDMyLmJ1ZmZlciksci5pc0xpdHRsZUVuZGlhbj0xPT09bmV3IFVpbnQxNkFycmF5KG5ldyBVaW50OEFycmF5KFsxLDBdKS5idWZmZXIpWzBdLHIuTG9uZz1mdW5jdGlvbihlLHQpe3RoaXMubG93PTB8ZSx0aGlzLmhpZ2g9MHx0O30sci5Mb25nLmNyZWF0ZT1mdW5jdGlvbihlLHQpe3JldHVybiAwPT1lJiYwPT10P3IuTG9uZy5aRVJPOm5ldyByLkxvbmcoZSx0KX0sci5Mb25nLnByb3RvdHlwZS50b0Zsb2F0NjQ9ZnVuY3Rpb24oKXtyZXR1cm4gKHRoaXMubG93Pj4+MCkrNDI5NDk2NzI5Nip0aGlzLmhpZ2h9LHIuTG9uZy5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxvdz09ZS5sb3cmJnRoaXMuaGlnaD09ZS5oaWdofSxyLkxvbmcuWkVSTz1uZXcgci5Mb25nKDAsMCksci5CdWlsZGVyPWZ1bmN0aW9uKGUpe2lmKGUpdD1lO2Vsc2UgdmFyIHQ9MTAyNDt0aGlzLmJiPXIuQnl0ZUJ1ZmZlci5hbGxvY2F0ZSh0KSx0aGlzLnNwYWNlPXQsdGhpcy5taW5hbGlnbj0xLHRoaXMudnRhYmxlPW51bGwsdGhpcy52dGFibGVfaW5fdXNlPTAsdGhpcy5pc05lc3RlZD0hMSx0aGlzLm9iamVjdF9zdGFydD0wLHRoaXMudnRhYmxlcz1bXSx0aGlzLnZlY3Rvcl9udW1fZWxlbXM9MCx0aGlzLmZvcmNlX2RlZmF1bHRzPSExO30sci5CdWlsZGVyLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuYmIuY2xlYXIoKSx0aGlzLnNwYWNlPXRoaXMuYmIuY2FwYWNpdHkoKSx0aGlzLm1pbmFsaWduPTEsdGhpcy52dGFibGU9bnVsbCx0aGlzLnZ0YWJsZV9pbl91c2U9MCx0aGlzLmlzTmVzdGVkPSExLHRoaXMub2JqZWN0X3N0YXJ0PTAsdGhpcy52dGFibGVzPVtdLHRoaXMudmVjdG9yX251bV9lbGVtcz0wLHRoaXMuZm9yY2VfZGVmYXVsdHM9ITE7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmZvcmNlRGVmYXVsdHM9ZnVuY3Rpb24oZSl7dGhpcy5mb3JjZV9kZWZhdWx0cz1lO30sci5CdWlsZGVyLnByb3RvdHlwZS5kYXRhQnVmZmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmJ9LHIuQnVpbGRlci5wcm90b3R5cGUuYXNVaW50OEFycmF5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmIuYnl0ZXMoKS5zdWJhcnJheSh0aGlzLmJiLnBvc2l0aW9uKCksdGhpcy5iYi5wb3NpdGlvbigpK3RoaXMub2Zmc2V0KCkpfSxyLkJ1aWxkZXIucHJvdG90eXBlLnByZXA9ZnVuY3Rpb24oZSx0KXtlPnRoaXMubWluYWxpZ24mJih0aGlzLm1pbmFsaWduPWUpO2Zvcih2YXIgbj0xK34odGhpcy5iYi5jYXBhY2l0eSgpLXRoaXMuc3BhY2UrdCkmZS0xO3RoaXMuc3BhY2U8bitlK3Q7KXt2YXIgbz10aGlzLmJiLmNhcGFjaXR5KCk7dGhpcy5iYj1yLkJ1aWxkZXIuZ3Jvd0J5dGVCdWZmZXIodGhpcy5iYiksdGhpcy5zcGFjZSs9dGhpcy5iYi5jYXBhY2l0eSgpLW87fXRoaXMucGFkKG4pO30sci5CdWlsZGVyLnByb3RvdHlwZS5wYWQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDxlO3QrKyl0aGlzLmJiLndyaXRlSW50OCgtLXRoaXMuc3BhY2UsMCk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLndyaXRlSW50OD1mdW5jdGlvbihlKXt0aGlzLmJiLndyaXRlSW50OCh0aGlzLnNwYWNlLT0xLGUpO30sci5CdWlsZGVyLnByb3RvdHlwZS53cml0ZUludDE2PWZ1bmN0aW9uKGUpe3RoaXMuYmIud3JpdGVJbnQxNih0aGlzLnNwYWNlLT0yLGUpO30sci5CdWlsZGVyLnByb3RvdHlwZS53cml0ZUludDMyPWZ1bmN0aW9uKGUpe3RoaXMuYmIud3JpdGVJbnQzMih0aGlzLnNwYWNlLT00LGUpO30sci5CdWlsZGVyLnByb3RvdHlwZS53cml0ZUludDY0PWZ1bmN0aW9uKGUpe3RoaXMuYmIud3JpdGVJbnQ2NCh0aGlzLnNwYWNlLT04LGUpO30sci5CdWlsZGVyLnByb3RvdHlwZS53cml0ZUZsb2F0MzI9ZnVuY3Rpb24oZSl7dGhpcy5iYi53cml0ZUZsb2F0MzIodGhpcy5zcGFjZS09NCxlKTt9LHIuQnVpbGRlci5wcm90b3R5cGUud3JpdGVGbG9hdDY0PWZ1bmN0aW9uKGUpe3RoaXMuYmIud3JpdGVGbG9hdDY0KHRoaXMuc3BhY2UtPTgsZSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEludDg9ZnVuY3Rpb24oZSl7dGhpcy5wcmVwKDEsMCksdGhpcy53cml0ZUludDgoZSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEludDE2PWZ1bmN0aW9uKGUpe3RoaXMucHJlcCgyLDApLHRoaXMud3JpdGVJbnQxNihlKTt9LHIuQnVpbGRlci5wcm90b3R5cGUuYWRkSW50MzI9ZnVuY3Rpb24oZSl7dGhpcy5wcmVwKDQsMCksdGhpcy53cml0ZUludDMyKGUpO30sci5CdWlsZGVyLnByb3RvdHlwZS5hZGRJbnQ2ND1mdW5jdGlvbihlKXt0aGlzLnByZXAoOCwwKSx0aGlzLndyaXRlSW50NjQoZSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZsb2F0MzI9ZnVuY3Rpb24oZSl7dGhpcy5wcmVwKDQsMCksdGhpcy53cml0ZUZsb2F0MzIoZSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZsb2F0NjQ9ZnVuY3Rpb24oZSl7dGhpcy5wcmVwKDgsMCksdGhpcy53cml0ZUZsb2F0NjQoZSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZpZWxkSW50OD1mdW5jdGlvbihlLHQsbil7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fHQhPW4pJiYodGhpcy5hZGRJbnQ4KHQpLHRoaXMuc2xvdChlKSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZpZWxkSW50MTY9ZnVuY3Rpb24oZSx0LG4peyh0aGlzLmZvcmNlX2RlZmF1bHRzfHx0IT1uKSYmKHRoaXMuYWRkSW50MTYodCksdGhpcy5zbG90KGUpKTt9LHIuQnVpbGRlci5wcm90b3R5cGUuYWRkRmllbGRJbnQzMj1mdW5jdGlvbihlLHQsbil7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fHQhPW4pJiYodGhpcy5hZGRJbnQzMih0KSx0aGlzLnNsb3QoZSkpO30sci5CdWlsZGVyLnByb3RvdHlwZS5hZGRGaWVsZEludDY0PWZ1bmN0aW9uKGUsdCxuKXshdGhpcy5mb3JjZV9kZWZhdWx0cyYmdC5lcXVhbHMobil8fCh0aGlzLmFkZEludDY0KHQpLHRoaXMuc2xvdChlKSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZpZWxkRmxvYXQzMj1mdW5jdGlvbihlLHQsbil7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fHQhPW4pJiYodGhpcy5hZGRGbG9hdDMyKHQpLHRoaXMuc2xvdChlKSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZpZWxkRmxvYXQ2ND1mdW5jdGlvbihlLHQsbil7KHRoaXMuZm9yY2VfZGVmYXVsdHN8fHQhPW4pJiYodGhpcy5hZGRGbG9hdDY0KHQpLHRoaXMuc2xvdChlKSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmFkZEZpZWxkT2Zmc2V0PWZ1bmN0aW9uKGUsdCxuKXsodGhpcy5mb3JjZV9kZWZhdWx0c3x8dCE9bikmJih0aGlzLmFkZE9mZnNldCh0KSx0aGlzLnNsb3QoZSkpO30sci5CdWlsZGVyLnByb3RvdHlwZS5hZGRGaWVsZFN0cnVjdD1mdW5jdGlvbihlLHQsbil7dCE9biYmKHRoaXMubmVzdGVkKHQpLHRoaXMuc2xvdChlKSk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLm5lc3RlZD1mdW5jdGlvbihlKXtpZihlIT10aGlzLm9mZnNldCgpKXRocm93IG5ldyBFcnJvcigiRmxhdEJ1ZmZlcnM6IHN0cnVjdCBtdXN0IGJlIHNlcmlhbGl6ZWQgaW5saW5lLiIpfSxyLkJ1aWxkZXIucHJvdG90eXBlLm5vdE5lc3RlZD1mdW5jdGlvbigpe2lmKHRoaXMuaXNOZXN0ZWQpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogb2JqZWN0IHNlcmlhbGl6YXRpb24gbXVzdCBub3QgYmUgbmVzdGVkLiIpfSxyLkJ1aWxkZXIucHJvdG90eXBlLnNsb3Q9ZnVuY3Rpb24oZSl7dGhpcy52dGFibGVbZV09dGhpcy5vZmZzZXQoKTt9LHIuQnVpbGRlci5wcm90b3R5cGUub2Zmc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmIuY2FwYWNpdHkoKS10aGlzLnNwYWNlfSxyLkJ1aWxkZXIuZ3Jvd0J5dGVCdWZmZXI9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jYXBhY2l0eSgpO2lmKDMyMjEyMjU0NzImdCl0aHJvdyBuZXcgRXJyb3IoIkZsYXRCdWZmZXJzOiBjYW5ub3QgZ3JvdyBidWZmZXIgYmV5b25kIDIgZ2lnYWJ5dGVzLiIpO3ZhciBuPXQ8PDEsbz1yLkJ5dGVCdWZmZXIuYWxsb2NhdGUobik7cmV0dXJuIG8uc2V0UG9zaXRpb24obi10KSxvLmJ5dGVzKCkuc2V0KGUuYnl0ZXMoKSxuLXQpLG99LHIuQnVpbGRlci5wcm90b3R5cGUuYWRkT2Zmc2V0PWZ1bmN0aW9uKGUpe3RoaXMucHJlcChyLlNJWkVPRl9JTlQsMCksdGhpcy53cml0ZUludDMyKHRoaXMub2Zmc2V0KCktZStyLlNJWkVPRl9JTlQpO30sci5CdWlsZGVyLnByb3RvdHlwZS5zdGFydE9iamVjdD1mdW5jdGlvbihlKXt0aGlzLm5vdE5lc3RlZCgpLG51bGw9PXRoaXMudnRhYmxlJiYodGhpcy52dGFibGU9W10pLHRoaXMudnRhYmxlX2luX3VzZT1lO2Zvcih2YXIgdD0wO3Q8ZTt0KyspdGhpcy52dGFibGVbdF09MDt0aGlzLmlzTmVzdGVkPSEwLHRoaXMub2JqZWN0X3N0YXJ0PXRoaXMub2Zmc2V0KCk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmVuZE9iamVjdD1mdW5jdGlvbigpe2lmKG51bGw9PXRoaXMudnRhYmxlfHwhdGhpcy5pc05lc3RlZCl0aHJvdyBuZXcgRXJyb3IoIkZsYXRCdWZmZXJzOiBlbmRPYmplY3QgY2FsbGVkIHdpdGhvdXQgc3RhcnRPYmplY3QiKTt0aGlzLmFkZEludDMyKDApO2Zvcih2YXIgZT10aGlzLm9mZnNldCgpLHQ9dGhpcy52dGFibGVfaW5fdXNlLTE7dD49MCYmMD09dGhpcy52dGFibGVbdF07dC0tKTtmb3IodmFyIG49dCsxO3Q+PTA7dC0tKXRoaXMuYWRkSW50MTYoMCE9dGhpcy52dGFibGVbdF0/ZS10aGlzLnZ0YWJsZVt0XTowKTt0aGlzLmFkZEludDE2KGUtdGhpcy5vYmplY3Rfc3RhcnQpO3ZhciBvPShuKzIpKnIuU0laRU9GX1NIT1JUO3RoaXMuYWRkSW50MTYobyk7dmFyIGk9MCxzPXRoaXMuc3BhY2U7ZTpmb3IodD0wO3Q8dGhpcy52dGFibGVzLmxlbmd0aDt0Kyspe3ZhciBhPXRoaXMuYmIuY2FwYWNpdHkoKS10aGlzLnZ0YWJsZXNbdF07aWYobz09dGhpcy5iYi5yZWFkSW50MTYoYSkpe2Zvcih2YXIgdT1yLlNJWkVPRl9TSE9SVDt1PG87dSs9ci5TSVpFT0ZfU0hPUlQpaWYodGhpcy5iYi5yZWFkSW50MTYocyt1KSE9dGhpcy5iYi5yZWFkSW50MTYoYSt1KSljb250aW51ZSBlO2k9dGhpcy52dGFibGVzW3RdO2JyZWFrfX1yZXR1cm4gaT8odGhpcy5zcGFjZT10aGlzLmJiLmNhcGFjaXR5KCktZSx0aGlzLmJiLndyaXRlSW50MzIodGhpcy5zcGFjZSxpLWUpKToodGhpcy52dGFibGVzLnB1c2godGhpcy5vZmZzZXQoKSksdGhpcy5iYi53cml0ZUludDMyKHRoaXMuYmIuY2FwYWNpdHkoKS1lLHRoaXMub2Zmc2V0KCktZSkpLHRoaXMuaXNOZXN0ZWQ9ITEsZX0sci5CdWlsZGVyLnByb3RvdHlwZS5maW5pc2g9ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPW4/ci5TSVpFX1BSRUZJWF9MRU5HVEg6MDtpZih0KXt2YXIgaT10O2lmKHRoaXMucHJlcCh0aGlzLm1pbmFsaWduLHIuU0laRU9GX0lOVCtyLkZJTEVfSURFTlRJRklFUl9MRU5HVEgrbyksaS5sZW5ndGghPXIuRklMRV9JREVOVElGSUVSX0xFTkdUSCl0aHJvdyBuZXcgRXJyb3IoIkZsYXRCdWZmZXJzOiBmaWxlIGlkZW50aWZpZXIgbXVzdCBiZSBsZW5ndGggIityLkZJTEVfSURFTlRJRklFUl9MRU5HVEgpO2Zvcih2YXIgcz1yLkZJTEVfSURFTlRJRklFUl9MRU5HVEgtMTtzPj0wO3MtLSl0aGlzLndyaXRlSW50OChpLmNoYXJDb2RlQXQocykpO310aGlzLnByZXAodGhpcy5taW5hbGlnbixyLlNJWkVPRl9JTlQrbyksdGhpcy5hZGRPZmZzZXQoZSksbyYmdGhpcy5hZGRJbnQzMih0aGlzLmJiLmNhcGFjaXR5KCktdGhpcy5zcGFjZSksdGhpcy5iYi5zZXRQb3NpdGlvbih0aGlzLnNwYWNlKTt9LHIuQnVpbGRlci5wcm90b3R5cGUuZmluaXNoU2l6ZVByZWZpeGVkPWZ1bmN0aW9uKGUsdCl7dGhpcy5maW5pc2goZSx0LCEwKTt9LHIuQnVpbGRlci5wcm90b3R5cGUucmVxdWlyZWRGaWVsZD1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuYmIuY2FwYWNpdHkoKS1lLHI9bi10aGlzLmJiLnJlYWRJbnQzMihuKTtpZigwPT10aGlzLmJiLnJlYWRJbnQxNihyK3QpKXRocm93IG5ldyBFcnJvcigiRmxhdEJ1ZmZlcnM6IGZpZWxkICIrdCsiIG11c3QgYmUgc2V0Iil9LHIuQnVpbGRlci5wcm90b3R5cGUuc3RhcnRWZWN0b3I9ZnVuY3Rpb24oZSx0LG4pe3RoaXMubm90TmVzdGVkKCksdGhpcy52ZWN0b3JfbnVtX2VsZW1zPXQsdGhpcy5wcmVwKHIuU0laRU9GX0lOVCxlKnQpLHRoaXMucHJlcChuLGUqdCk7fSxyLkJ1aWxkZXIucHJvdG90eXBlLmVuZFZlY3Rvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLndyaXRlSW50MzIodGhpcy52ZWN0b3JfbnVtX2VsZW1zKSx0aGlzLm9mZnNldCgpfSxyLkJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZVN0cmluZz1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgVWludDhBcnJheSl2YXIgdD1lO2Vsc2Uge3Q9W107Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDspe3ZhciByLG89ZS5jaGFyQ29kZUF0KG4rKyk7KHI9bzw1NTI5Nnx8bz49NTYzMjA/bzoobzw8MTApK2UuY2hhckNvZGVBdChuKyspKy01NjYxMzg4OCk8MTI4P3QucHVzaChyKToocjwyMDQ4P3QucHVzaChyPj42JjMxfDE5Mik6KHI8NjU1MzY/dC5wdXNoKHI+PjEyJjE1fDIyNCk6dC5wdXNoKHI+PjE4Jjd8MjQwLHI+PjEyJjYzfDEyOCksdC5wdXNoKHI+PjYmNjN8MTI4KSksdC5wdXNoKDYzJnJ8MTI4KSk7fX10aGlzLmFkZEludDgoMCksdGhpcy5zdGFydFZlY3RvcigxLHQubGVuZ3RoLDEpLHRoaXMuYmIuc2V0UG9zaXRpb24odGhpcy5zcGFjZS09dC5sZW5ndGgpLG49MDtmb3IodmFyIGk9dGhpcy5zcGFjZSxzPXRoaXMuYmIuYnl0ZXMoKTtuPHQubGVuZ3RoO24rKylzW2krK109dFtuXTtyZXR1cm4gdGhpcy5lbmRWZWN0b3IoKX0sci5CdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVMb25nPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHIuTG9uZy5jcmVhdGUoZSx0KX0sci5CeXRlQnVmZmVyPWZ1bmN0aW9uKGUpe3RoaXMuYnl0ZXNfPWUsdGhpcy5wb3NpdGlvbl89MDt9LHIuQnl0ZUJ1ZmZlci5hbGxvY2F0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHIuQnl0ZUJ1ZmZlcihuZXcgVWludDhBcnJheShlKSl9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLnBvc2l0aW9uXz0wO30sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5ieXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJ5dGVzX30sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5wb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBvc2l0aW9uX30sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5zZXRQb3NpdGlvbj1mdW5jdGlvbihlKXt0aGlzLnBvc2l0aW9uXz1lO30sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5jYXBhY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJ5dGVzXy5sZW5ndGh9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucmVhZFVpbnQ4KGUpPDwyND4+MjR9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVhZFVpbnQ4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmJ5dGVzX1tlXX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTY9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucmVhZFVpbnQxNihlKTw8MTY+PjE2fSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLnJlYWRVaW50MTY9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuYnl0ZXNfW2VdfHRoaXMuYnl0ZXNfW2UrMV08PDh9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmJ5dGVzX1tlXXx0aGlzLmJ5dGVzX1tlKzFdPDw4fHRoaXMuYnl0ZXNfW2UrMl08PDE2fHRoaXMuYnl0ZXNfW2UrM108PDI0fSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLnJlYWRVaW50MzI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucmVhZEludDMyKGUpPj4+MH0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50NjQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByLkxvbmcodGhpcy5yZWFkSW50MzIoZSksdGhpcy5yZWFkSW50MzIoZSs0KSl9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVhZFVpbnQ2ND1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHIuTG9uZyh0aGlzLnJlYWRVaW50MzIoZSksdGhpcy5yZWFkVWludDMyKGUrNCkpfSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdDMyPWZ1bmN0aW9uKGUpe3JldHVybiByLmludDMyWzBdPXRoaXMucmVhZEludDMyKGUpLHIuZmxvYXQzMlswXX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXQ2ND1mdW5jdGlvbihlKXtyZXR1cm4gci5pbnQzMltyLmlzTGl0dGxlRW5kaWFuPzA6MV09dGhpcy5yZWFkSW50MzIoZSksci5pbnQzMltyLmlzTGl0dGxlRW5kaWFuPzE6MF09dGhpcy5yZWFkSW50MzIoZSs0KSxyLmZsb2F0NjRbMF19LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4PWZ1bmN0aW9uKGUsdCl7dGhpcy5ieXRlc19bZV09dDt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50OD1mdW5jdGlvbihlLHQpe3RoaXMuYnl0ZXNfW2VdPXQ7fSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTY9ZnVuY3Rpb24oZSx0KXt0aGlzLmJ5dGVzX1tlXT10LHRoaXMuYnl0ZXNfW2UrMV09dD4+ODt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50MTY9ZnVuY3Rpb24oZSx0KXt0aGlzLmJ5dGVzX1tlXT10LHRoaXMuYnl0ZXNfW2UrMV09dD4+ODt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMj1mdW5jdGlvbihlLHQpe3RoaXMuYnl0ZXNfW2VdPXQsdGhpcy5ieXRlc19bZSsxXT10Pj44LHRoaXMuYnl0ZXNfW2UrMl09dD4+MTYsdGhpcy5ieXRlc19bZSszXT10Pj4yNDt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVaW50MzI9ZnVuY3Rpb24oZSx0KXt0aGlzLmJ5dGVzX1tlXT10LHRoaXMuYnl0ZXNfW2UrMV09dD4+OCx0aGlzLmJ5dGVzX1tlKzJdPXQ+PjE2LHRoaXMuYnl0ZXNfW2UrM109dD4+MjQ7fSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLndyaXRlSW50NjQ9ZnVuY3Rpb24oZSx0KXt0aGlzLndyaXRlSW50MzIoZSx0LmxvdyksdGhpcy53cml0ZUludDMyKGUrNCx0LmhpZ2gpO30sci5CeXRlQnVmZmVyLnByb3RvdHlwZS53cml0ZVVpbnQ2ND1mdW5jdGlvbihlLHQpe3RoaXMud3JpdGVVaW50MzIoZSx0LmxvdyksdGhpcy53cml0ZVVpbnQzMihlKzQsdC5oaWdoKTt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdDMyPWZ1bmN0aW9uKGUsdCl7ci5mbG9hdDMyWzBdPXQsdGhpcy53cml0ZUludDMyKGUsci5pbnQzMlswXSk7fSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXQ2ND1mdW5jdGlvbihlLHQpe3IuZmxvYXQ2NFswXT10LHRoaXMud3JpdGVJbnQzMihlLHIuaW50MzJbci5pc0xpdHRsZUVuZGlhbj8wOjFdKSx0aGlzLndyaXRlSW50MzIoZSs0LHIuaW50MzJbci5pc0xpdHRsZUVuZGlhbj8xOjBdKTt9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUuZ2V0QnVmZmVySWRlbnRpZmllcj1mdW5jdGlvbigpe2lmKHRoaXMuYnl0ZXNfLmxlbmd0aDx0aGlzLnBvc2l0aW9uXytyLlNJWkVPRl9JTlQrci5GSUxFX0lERU5USUZJRVJfTEVOR1RIKXRocm93IG5ldyBFcnJvcigiRmxhdEJ1ZmZlcnM6IEJ5dGVCdWZmZXIgaXMgdG9vIHNob3J0IHRvIGNvbnRhaW4gYW4gaWRlbnRpZmllci4iKTtmb3IodmFyIGU9IiIsdD0wO3Q8ci5GSUxFX0lERU5USUZJRVJfTEVOR1RIO3QrKyllKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMucmVhZEludDgodGhpcy5wb3NpdGlvbl8rci5TSVpFT0ZfSU5UK3QpKTtyZXR1cm4gZX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5fX29mZnNldD1mdW5jdGlvbihlLHQpe3ZhciBuPWUtdGhpcy5yZWFkSW50MzIoZSk7cmV0dXJuIHQ8dGhpcy5yZWFkSW50MTYobik/dGhpcy5yZWFkSW50MTYobit0KTowfSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLl9fdW5pb249ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5iYl9wb3M9dCt0aGlzLnJlYWRJbnQzMih0KSxlLmJiPXRoaXMsZX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5fX3N0cmluZz1mdW5jdGlvbihlLHQpe2UrPXRoaXMucmVhZEludDMyKGUpO3ZhciBuPXRoaXMucmVhZEludDMyKGUpLG89IiIsaT0wO2lmKGUrPXIuU0laRU9GX0lOVCx0PT09ci5FbmNvZGluZy5VVEY4X0JZVEVTKXJldHVybiB0aGlzLmJ5dGVzXy5zdWJhcnJheShlLGUrbik7Zm9yKDtpPG47KXt2YXIgcyxhPXRoaXMucmVhZFVpbnQ4KGUraSsrKTtpZihhPDE5MilzPWE7ZWxzZSB7dmFyIHU9dGhpcy5yZWFkVWludDgoZStpKyspO2lmKGE8MjI0KXM9KDMxJmEpPDw2fDYzJnU7ZWxzZSB7dmFyIGw9dGhpcy5yZWFkVWludDgoZStpKyspO3M9YTwyNDA/KDE1JmEpPDwxMnwoNjMmdSk8PDZ8NjMmbDooNyZhKTw8MTh8KDYzJnUpPDwxMnwoNjMmbCk8PDZ8NjMmdGhpcy5yZWFkVWludDgoZStpKyspO319czw2NTUzNj9vKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHMpOihzLT02NTUzNixvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDU1Mjk2KyhzPj4xMCksNTYzMjArKDEwMjMmcykpKTt9cmV0dXJuIG99LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUuX19pbmRpcmVjdD1mdW5jdGlvbihlKXtyZXR1cm4gZSt0aGlzLnJlYWRJbnQzMihlKX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5fX3ZlY3Rvcj1mdW5jdGlvbihlKXtyZXR1cm4gZSt0aGlzLnJlYWRJbnQzMihlKStyLlNJWkVPRl9JTlR9LHIuQnl0ZUJ1ZmZlci5wcm90b3R5cGUuX192ZWN0b3JfbGVuPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnJlYWRJbnQzMihlK3RoaXMucmVhZEludDMyKGUpKX0sci5CeXRlQnVmZmVyLnByb3RvdHlwZS5fX2hhc19pZGVudGlmaWVyPWZ1bmN0aW9uKGUpe2lmKGUubGVuZ3RoIT1yLkZJTEVfSURFTlRJRklFUl9MRU5HVEgpdGhyb3cgbmV3IEVycm9yKCJGbGF0QnVmZmVyczogZmlsZSBpZGVudGlmaWVyIG11c3QgYmUgbGVuZ3RoICIrci5GSUxFX0lERU5USUZJRVJfTEVOR1RIKTtmb3IodmFyIHQ9MDt0PHIuRklMRV9JREVOVElGSUVSX0xFTkdUSDt0KyspaWYoZS5jaGFyQ29kZUF0KHQpIT10aGlzLnJlYWRJbnQ4KHRoaXMucG9zaXRpb25fK3IuU0laRU9GX0lOVCt0KSlyZXR1cm4gITE7cmV0dXJuICEwfSxyLkJ5dGVCdWZmZXIucHJvdG90eXBlLmNyZWF0ZUxvbmc9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gci5Mb25nLmNyZWF0ZShlLHQpfTt9fSxfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX189e307ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhlKXt2YXIgdD1fX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bZV07aWYodm9pZCAwIT09dClyZXR1cm4gdC5leHBvcnRzO3ZhciBuPV9fd2VicGFja19tb2R1bGVfY2FjaGVfX1tlXT17ZXhwb3J0czp7fX07cmV0dXJuIF9fd2VicGFja19tb2R1bGVzX19bZV0uY2FsbChuLmV4cG9ydHMsbixuLmV4cG9ydHMsX193ZWJwYWNrX3JlcXVpcmVfXyksbi5leHBvcnRzfV9fd2VicGFja19yZXF1aXJlX18ubj1lPT57dmFyIHQ9ZSYmZS5fX2VzTW9kdWxlPygpPT5lLmRlZmF1bHQ6KCk9PmU7cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uZCh0LHthOnR9KSx0fSxfX3dlYnBhY2tfcmVxdWlyZV9fLmQ9KGUsdCk9Pntmb3IodmFyIG4gaW4gdClfX3dlYnBhY2tfcmVxdWlyZV9fLm8odCxuKSYmIV9fd2VicGFja19yZXF1aXJlX18ubyhlLG4pJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHtlbnVtZXJhYmxlOiEwLGdldDp0W25dfSk7fSxfX3dlYnBhY2tfcmVxdWlyZV9fLm89KGUsdCk9Pk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpLF9fd2VicGFja19yZXF1aXJlX18ucj1lPT57InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZToiTW9kdWxlIn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt9O3ZhciBfX3dlYnBhY2tfZXhwb3J0c19fPV9fd2VicGFja19yZXF1aXJlX18oMTA1Nyk7cmV0dXJuIF9fd2VicGFja19leHBvcnRzX199KSgpLG1vZHVsZS5leHBvcnRzPXQoKTt9KShvcnRfbWluLG9ydF9taW4uZXhwb3J0cyk7dmFyIG9ydF9taW5FeHBvcnRzPW9ydF9taW4uZXhwb3J0cztnZXREZWZhdWx0RXhwb3J0RnJvbUNqcyhvcnRfbWluRXhwb3J0cyk7CgpjbGFzcyBXb3JrZXJOYXRpdmV7Y29uc3RydWN0b3IoKXt0aGlzLnJlYWR5PSExO29ydF9taW5FeHBvcnRzLmVudi53YXNtLndhc21QYXRocz0ie3tNRVRBX1VSTH19Iix0aGlzLmluZGV4ZWREQk1hbmFnZXI9bmV3IEluZGV4ZWREQk1hbmFnZXIoIm9uaXJpeC1zZGsiLCJmaWxlcyIpLHRoaXMuaW5kZXhlZERCTWFuYWdlci5nZXRGaWxlRnJvbUluZGV4ZWREQigiU0RLXzEuNi41IikudGhlbigoYXN5bmMgdD0+e2xldCBlPVVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3RdLHt0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSkpO2NvbnN0e2RlZmF1bHQ6YX09YXdhaXQgaW1wb3J0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUsIHdlYnBhY2tNb2RlOiAibGF6eSIgKi9lKSxpPWF3YWl0IGEoKTt0aGlzLm5hdGl2ZVNESz1pLHRoaXMuY29hcnNlRnJhbWU9dGhpcy5uYXRpdmVTREsuX21hbGxvYygzNjg2NDAwKSx0aGlzLmJ1ZmZlckxlbmd0aD0wLHRoaXMuZnJhbWVMYXlvdXRTdHJ1Y3Q9dGhpcy5uYXRpdmVTREsuX21hbGxvYygyOCk7bGV0IHM9YXdhaXQgdGhpcy5pbmRleGVkREJNYW5hZ2VyLmdldEZyb21DYWNoZU9yRmV0Y2goImNvYXJzZWxvYy5vbm54IiwiaHR0cHM6Ly9zZGsub25pcml4LmNvbS9jb21tb24vY29hcnNlbG9jLm9ubngiKTtjb25zdCByPWF3YWl0IG9ydF9taW5FeHBvcnRzLkluZmVyZW5jZVNlc3Npb24uY3JlYXRlKHMse2V4ZWN1dGlvblByb3ZpZGVyczpbIndhc20iXX0pO3RoaXMuc2Vzc2lvbj1yLGF3YWl0IHRoaXMuc2Vzc2lvbi5ydW4oe2lucHV0Om5ldyBvcnRfbWluRXhwb3J0cy5UZW5zb3IobmV3IEZsb2F0MzJBcnJheShBcnJheSg5MjE2MDApLmZpbGwoMCkpLFsxLDMsNjQwLDQ4MF0pfSksdGhpcy5yZWFkeT0hMCxwb3N0TWVzc2FnZSgicmVhZHkiKTt9KSk7fXN0YXJ0KCl7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jIHQ9PntpZighdGhpcy5yZWFkeSlyZXR1cm4gdm9pZCBwb3N0TWVzc2FnZSghMSk7dGhpcy5yZWFkeT0hMTtjb25zdCBlPXQuZGF0YSxhPWUud2lkdGgqZS5oZWlnaHQqNDswIT10aGlzLmJ1ZmZlckxlbmd0aCYmdGhpcy5idWZmZXJMZW5ndGg9PWF8fCgwIT10aGlzLmJ1ZmZlckxlbmd0aCYmdGhpcy5uYXRpdmVTREsuX2ZyZWUodGhpcy5idWZmZXIpLHRoaXMuYnVmZmVyTGVuZ3RoPWEsdGhpcy5idWZmZXI9dGhpcy5uYXRpdmVTREsuX21hbGxvYyh0aGlzLmJ1ZmZlckxlbmd0aCkpLHRoaXMubmF0aXZlU0RLLkhFQVBVOC5zZXQoZS5kYXRhLHRoaXMuYnVmZmVyKSx0aGlzLm5hdGl2ZVNESy5IRUFQVTMyW3RoaXMuZnJhbWVMYXlvdXRTdHJ1Y3QvNCswXT1lLndpZHRoLHRoaXMubmF0aXZlU0RLLkhFQVBVMzJbdGhpcy5mcmFtZUxheW91dFN0cnVjdC80KzFdPWUuaGVpZ2h0LHRoaXMubmF0aXZlU0RLLkhFQVBVMzJbdGhpcy5mcmFtZUxheW91dFN0cnVjdC80KzJdPTQqZS53aWR0aCx0aGlzLm5hdGl2ZVNESy5IRUFQVTMyW3RoaXMuZnJhbWVMYXlvdXRTdHJ1Y3QvNCszXT0hMSx0aGlzLm5hdGl2ZVNESy5IRUFQVTMyW3RoaXMuZnJhbWVMYXlvdXRTdHJ1Y3QvNCs0XT1lLmNvbG9yU3BhY2UsdGhpcy5uYXRpdmVTREsuSEVBUFUzMlt0aGlzLmZyYW1lTGF5b3V0U3RydWN0LzQrNV09ZS5yb3RhdGUsdGhpcy5uYXRpdmVTREsuSEVBUFUzMlt0aGlzLmZyYW1lTGF5b3V0U3RydWN0LzQrNl09ZS5mbGlwO2xldCBpPXRoaXMubmF0aXZlU0RLLl9PWF9FeHRyYWN0KHRoaXMuYnVmZmVyLHRoaXMuY29hcnNlRnJhbWUsdGhpcy5mcmFtZUxheW91dFN0cnVjdCxlLmR0eXBlKSxzPVtdO2ZvcihsZXQgdD0wO3Q8OTIxNjAwO3QrKylzLnB1c2godGhpcy5uYXRpdmVTREsuSEVBUEYzMlt0aGlzLmNvYXJzZUZyYW1lLzQrdF0pO2xldCByPWF3YWl0IHRoaXMuc2Vzc2lvbi5ydW4oe2lucHV0Om5ldyBvcnRfbWluRXhwb3J0cy5UZW5zb3IobmV3IEZsb2F0MzJBcnJheShzKSxbMSwzLDY0MCw0ODBdKX0pO3Bvc3RNZXNzYWdlKHtleHRyYWN0aW9uOm5ldyBGbG9hdDMyQXJyYXkodGhpcy5yZWFkRXh0cmFjdGlvbkRhdGEodGhpcy5uYXRpdmVTREsuSEVBUEYzMixpLzQpKSxkZXNjcmlwdG9yOnIub3V0cHV0LmRhdGF9KSx0aGlzLnJlYWR5PSEwO30pKTt9cmVhZEV4dHJhY3Rpb25EYXRhKHQsZSl7bGV0IGE9ZSxpPVtdLHM9dFthXTtpLnB1c2gocyksYSsrO2ZvcihsZXQgZT0wO2U8cztlKyspaS5wdXNoKHRbYV0pLGkucHVzaCh0W2ErMV0pLGErPTI7Zm9yKGxldCBlPTA7ZTwxMjgqcztlKyspaS5wdXNoKHRbYV0pLGErKztyZXR1cm4gaX19Y29uc3Qgd29ya2VyPW5ldyBXb3JrZXJOYXRpdmU7d29ya2VyLnN0YXJ0KCk7Cg==").replace("{{META_URL}}",new URL("./",import.meta.url)),s=new Blob([i],{type:"application/javascript"});this.workers[e]=new Worker(URL.createObjectURL(s),{type:"module"}),this.callbacks[e]=t,this.workers[e].addEventListener("message",o=>{this.callbacks[e](o.data)})}}createMatchingWorker(e,t){if(!this.workerExists(e)){let i=new Blob([atob("Y2xhc3MgSW5kZXhlZERCTWFuYWdlcntjb25zdHJ1Y3RvcihlLHIpe3RoaXMuZGJOYW1lPWUsdGhpcy5zdG9yZU5hbWU9cjt9YXN5bmMgZ2V0RnJvbUNhY2hlT3JGZXRjaChlLHIpe2xldCB0PW51bGw7dHJ5e3Q9YXdhaXQgdGhpcy5nZXRGaWxlRnJvbUluZGV4ZWREQihlKTt9Y2F0Y2goZSl7Y29uc29sZS5sb2coIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgZWxlbWVudCBmcm9tIGluZGV4ZWREQi4iKTt9cmV0dXJuIHR8fCh0PWF3YWl0IHRoaXMuZmV0Y2hBbmRDYWNoZUZpbGUocixlKSksbmV3IFVpbnQ4QXJyYXkodCl9YXN5bmMgZ2V0RmlsZUZyb21JbmRleGVkREIoZSl7cmV0dXJuIG5ldyBQcm9taXNlKCgocix0KT0+e2NvbnN0IG89aW5kZXhlZERCLm9wZW4odGhpcy5kYk5hbWUpO28ub25lcnJvcj0oKT0+dChvLmVycm9yKSxvLm9uc3VjY2Vzcz0oKT0+e2NvbnN0IHM9by5yZXN1bHQudHJhbnNhY3Rpb24odGhpcy5zdG9yZU5hbWUsInJlYWRvbmx5Iikub2JqZWN0U3RvcmUodGhpcy5zdG9yZU5hbWUpLmdldChlKTtzLm9uc3VjY2Vzcz0oKT0+cihzLnJlc3VsdCkscy5vbmVycm9yPSgpPT50KHMuZXJyb3IpO30sby5vbnVwZ3JhZGVuZWVkZWQ9ZT0+e2UudGFyZ2V0LnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZSh0aGlzLnN0b3JlTmFtZSk7fTt9KSl9YXN5bmMgc2F2ZUZpbGVUb0luZGV4ZWREQihlLHIpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsbyk9Pntjb25zdCBzPWluZGV4ZWREQi5vcGVuKHRoaXMuZGJOYW1lKTtzLm9uZXJyb3I9KCk9Pm8ocy5lcnJvcikscy5vbnVwZ3JhZGVuZWVkZWQ9ZT0+e2UudGFyZ2V0LnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZSh0aGlzLnN0b3JlTmFtZSk7fSxzLm9uc3VjY2Vzcz0oKT0+e3RyeXtjb25zdCBuPXMucmVzdWx0LnRyYW5zYWN0aW9uKHRoaXMuc3RvcmVOYW1lLCJyZWFkd3JpdGUiKSxhPW4ub2JqZWN0U3RvcmUodGhpcy5zdG9yZU5hbWUpLnB1dChyLGUpO2Eub25zdWNjZXNzPSgpPT50KGEucmVzdWx0KSxhLm9uZXJyb3I9KCk9Pm8oYS5lcnJvcik7fWNhdGNoKGUpe28oZSk7fX07fSkpfWFzeW5jIGZldGNoQW5kQ2FjaGVGaWxlKGUscil7Y29uc3QgdD1hd2FpdCBmZXRjaChlKSxvPWF3YWl0IHQuYXJyYXlCdWZmZXIoKTtyZXR1cm4gYXdhaXQgdGhpcy5zYXZlRmlsZVRvSW5kZXhlZERCKHIsbyksb319CgpjbGFzcyBXb3JrZXJOYXRpdmV7Y29uc3RydWN0b3IoKXt0aGlzLnJlYWR5PSExO3RoaXMuaW5kZXhlZERCTWFuYWdlcj1uZXcgSW5kZXhlZERCTWFuYWdlcigib25pcml4LXNkayIsImZpbGVzIiksdGhpcy5pbmRleGVkREJNYW5hZ2VyLmdldEZpbGVGcm9tSW5kZXhlZERCKCJTREtfMS42LjUiKS50aGVuKChhc3luYyBlPT57bGV0IHQ9VVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbZV0se3R5cGU6InRleHQvamF2YXNjcmlwdCJ9KSk7Y29uc3R7ZGVmYXVsdDphfT1hd2FpdCBpbXBvcnQoLyogd2VicGFja0lnbm9yZTogdHJ1ZSwgd2VicGFja01vZGU6ICJsYXp5IiAqL3QpLHI9YXdhaXQgYSgpO3RoaXMubmF0aXZlU0RLPXIsdGhpcy5mcm9tQnVmZmVyPXRoaXMubmF0aXZlU0RLLl9tYWxsb2MoMjJlNSksdGhpcy50b0J1ZmZlcj10aGlzLm5hdGl2ZVNESy5fbWFsbG9jKDIyZTUpLHRoaXMucmVhZHk9ITAscG9zdE1lc3NhZ2UoInJlYWR5Iik7fSkpO31zdGFydCgpe2FkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLChhc3luYyBlPT57aWYoIXRoaXMucmVhZHkpcmV0dXJuO2NvbnN0IHQ9ZS5kYXRhLGE9dC5mcm9tLHI9dC50bzt0aGlzLm5hdGl2ZVNESy5IRUFQRjMyLnNldChhLHRoaXMuZnJvbUJ1ZmZlci80KSx0aGlzLm5hdGl2ZVNESy5IRUFQRjMyLnNldChyLHRoaXMudG9CdWZmZXIvNCk7bGV0IHM9dGhpcy5uYXRpdmVTREsuX09YX01hdGNoKHRoaXMuZnJvbUJ1ZmZlcix0aGlzLnRvQnVmZmVyLHQuZHR5cGUpO3Bvc3RNZXNzYWdlKG5ldyBGbG9hdDMyQXJyYXkodGhpcy5yZWFkTWF0Y2hpbmdEYXRhKHRoaXMubmF0aXZlU0RLLkhFQVBGMzIscy80KSkpO30pKTt9cmVhZE1hdGNoaW5nRGF0YShlLHQpe2xldCBhPXQscj1bXSxzPWVbYV07ci5wdXNoKHMpLGErKztmb3IobGV0IHQ9MDt0PHM7dCsrKXIucHVzaChlW2FdKSxyLnB1c2goZVthKzFdKSxhKz0yO3JldHVybiByfX1jb25zdCB3b3JrZXI9bmV3IFdvcmtlck5hdGl2ZTt3b3JrZXIuc3RhcnQoKTsK")],{type:"application/javascript"});this.workers[e]=new Worker(URL.createObjectURL(i),{type:"module"}),this.callbacks[e]=t,this.workers[e].addEventListener("message",s=>{this.callbacks[e](s.data)})}}replaceCallback(e,t){this.workerExists(e)&&(this.callbacks[e]=t)}sendDataToWorker(e,t){this.workers[e].postMessage(t)}createWorkers(){return lt(this,null,function*(){return Promise.all([new Promise((e,t)=>{this.createExtractionWorker("extraction",i=>{i==="ready"&&e()})}),new Promise((e,t)=>{this.createMatchingWorker("matching",i=>{i==="ready"&&e()})})])})}},Pf=class{constructor(e,t,i,s){this.uiManager=e,this.nativeManager=t,this.deviceManager=i,this.workerManager=s}isWebXRSupported(){return lt(this,null,function*(){let e=!1;return navigator.xr&&(e=yield navigator.xr.isSessionSupported("immersive-ar")),e})}init(e,t,i){return lt(this,null,function*(){this.onPose=t,this.onSessionEnd=i,yield this.uiManager.displayPermissionsDialog(()=>lt(this,null,function*(){let s=["hit-test"],o=["dom-overlay"];e&&o.push("camera-access");try{let r=yield navigator.xr.requestSession("immersive-ar",{requiredFeatures:s,optionalFeatures:o,domOverlay:{root:document.body}});yield this.onXRSessionStarted(r)}catch(r){throw new Zo(`error while initializing webXR API: ${r}`)}}))})}start(){this.started=!0,this.usingSpatial&&(this.relocating=!1,this.workerManager.replaceCallback("extraction",e=>{if(e===!1)return void(this.relocating=!1);let t=this.nativeManager.loadExtractionData(e);this.candidates=Array.from(Array(t).keys()).reverse(),this.siftData=e.extraction,this.matchKeyframes()}),this.workerManager.replaceCallback("matching",e=>{this.nativeManager.loadMatch(e),this.matchKeyframes()}))}matchKeyframes(){if(this.candidates.length>0){let e=this.candidates.pop();this.workerManager.sendDataToWorker("matching",new Iu(e,this.siftData,this.nativeManager.getCandidateData(e),this.nativeManager.extractionType()))}else this.nativeManager.spatialLocate(),this.relocating=!1}destroy(){return lt(this,null,function*(){this.xrSession&&(yield this.xrSession.end(),this.xrSession=null,this.xrLastPose=null)})}onXRSessionStarted(e){return lt(this,null,function*(){let t=this.uiManager.renderCanvas.getContext("webgl2");t||(t=this.uiManager.renderCanvas.getContext("webgl")),t.getContextAttributes().xrCompatible||(yield t.makeXRCompatible()),this.xrContext=t,this.framebuffer=this.xrContext.createFramebuffer(),this.xrLayer=new XRWebGLLayer(e,this.xrContext);let i=this.xrLayer.framebufferWidth,s=this.xrLayer.framebufferHeight;this.usingSpatial&&(this.glBinding=new XRWebGLBinding(e,this.xrContext),this.nativeManager.xrbuffer=this.nativeManager.nativeSDK._malloc(i*s*4),this.nativeManager.siftBuffer=this.nativeManager.nativeSDK._malloc(22e5),this.nativeManager.matchBuffer=this.nativeManager.nativeSDK._malloc(14e3),this.nativeManager.netvladBuffer=this.nativeManager.nativeSDK._malloc(32768)),e.updateRenderState({baseLayer:this.xrLayer}),this.xrLocalRefSpace=yield e.requestReferenceSpace("local"),this.xrViewerRefSpace=yield e.requestReferenceSpace("viewer"),this.xrHitTestSource=yield e.requestHitTestSource({space:this.xrViewerRefSpace}),e.requestAnimationFrame(this.onXRFrame.bind(this)),window.navigator.userAgent.includes("WebXRViewer")?(window.addEventListener("click",o=>{this.onTouch&&this.onTouch(this.getNormalizedTouchCoords(o))}),window.addEventListener("touchstart",o=>{this.onTouchStart&&this.onTouchStart(this.getNormalizedTouchCoords(o))}),window.addEventListener("touchend",o=>{this.onTouchEnd&&this.onTouchEnd(this.getNormalizedTouchCoords(o))})):(e.addEventListener("select",o=>{this.onTouch&&this.onTouch(this.getXRInputCoords(o))}),e.addEventListener("selectstart",o=>{this.onTouchStart&&this.onTouchStart(this.getXRInputCoords(o))}),e.addEventListener("selectend",o=>{this.onTouchEnd&&this.onTouchEnd(this.getXRInputCoords(o))})),window.addEventListener("touchmove",o=>{this.onTouchMove&&this.onTouchMove(this.getNormalizedTouchCoords(o))}),e.addEventListener("end",()=>{this.onSessionEnd&&this.onSessionEnd()}),this.xrSession=e})}hasRelocated(){return this.usingSpatial&&this.nativeManager.xrTransform}needsRelocation(){return this.usingSpatial&&!this.hasRelocated()&&(this.lastRelocationTry==null||this.msSinceRelocation()>2500)}startRelocationTimer(){this.lastRelocationTry=new Date}msSinceRelocation(){let e=new Date;return this.lastRelocationTry?e-this.lastRelocationTry:0}onXRFrame(e,t){let i=t.session;i.requestAnimationFrame(this.onXRFrame.bind(this));let s=t.getViewerPose(this.xrLocalRefSpace);if(s){if(this.needsRelocation()){for(let c of s.views)if(c.camera){let d=c.camera.width,u=c.camera.height;var o=new Uint8ClampedArray(d*u*4);let h=this.glBinding.getCameraImage(c.camera),m=this.xrContext,f,g;m.bindTexture(m.TEXTURE_2D,h),m.bindFramebuffer(m.FRAMEBUFFER,this.framebuffer),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),m.readPixels(0,0,c.camera.width,c.camera.height,m.RGBA,m.UNSIGNED_BYTE,o),this.uiManager.isPortrait()?(f=1,g=3):(f=2,g=0),this.relocating||(this.relocating=!0,this.extractionFrame=o,this.extractionWidth=d,this.extractionHeight=u,this.workerManager.sendDataToWorker("extraction",new yu(o,d,u,g,f,this.nativeManager.extractionType())),this.nativeManager.lastXrPose=new Pt().fromArray(s.transform.matrix).toArray()),this.startRelocationTimer()}}this.xrContext.bindFramebuffer(this.xrContext.FRAMEBUFFER,i.renderState.baseLayer.framebuffer);let r=s.views[0],l=new Pt().fromArray(r.transform.matrix);if(this.deviceManager.os===yo.OS.Android&&this.started&&this.lastPose&&!this.jumpPose&&2*Math.acos(Math.abs(new Ys().setFromRotationMatrix(l).dot(new Ys().setFromRotationMatrix(this.lastPose))))>1&&(this.jumpPose=l),this.jumpPose){let c=this.jumpPose.clone().invert().multiply(l);l=this.lastPose.clone().multiply(c)}else this.lastPose=l;this.hasRelocated()&&(l=new Pt().fromArray(this.nativeManager.xrTransform.elements).multiply(l)),this.usingSpatial&&!this.hasRelocated()||this.onPose(l.toArray());let a=this.xrLastPose==null||this.lastViewportWidth!=window.innerWidth||this.lastViewportHeight!=window.innerHeight;if(this.xrLastPose=s,this.lastViewportWidth=window.innerWidth,this.lastViewportHeight=window.innerHeight,a&&this.onResize&&this.onResize(),this.onHitTestResult){let c=t.getHitTestResults(this.xrHitTestSource);if(c.length>0){let d=c[0].getPose(this.xrLocalRefSpace),u=new Pt().fromArray(d.transform.matrix),h=u.extractPosition(),m=(new Ys().setFromRotationMatrix(u),l.extractPosition()),f=Math.atan2(m.x-h.x,m.z-h.z),g={position:h,rotation:new Ys().setFromEuler(new Zu(0,f,0))};this.onHitTestResult(g)}}}this.onFrame&&this.onFrame(t)}fitCanvasToXRViewport(){if(this.xrLastPose){let e=this.xrLastPose.views[0],t=this.xrLayer.getViewport(e);if((t.width>t.height&&window.innerWidth>window.innerHeight||t.width<=t.height&&window.innerWidth<=window.innerHeight)&&t.width*t.height>window.innerWidth*window.innerHeight)this.uiManager.renderCanvas.width=t.width,this.uiManager.renderCanvas.height=t.height;else{this.uiManager.renderCanvas.width=window.innerWidth;let i=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sat"),10)||0,s=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab"),10)||0,o=window.innerHeight+i+s;this.uiManager.renderCanvas.height=o}}}getCameraParameters(){let e=60,t=9/16;if(this.xrSession&&this.xrLastPose){let i=this.xrLastPose.views[0].projectionMatrix;t=this.uiManager.renderCanvas.width/this.uiManager.renderCanvas.height,e=DX(2*Math.atan(1/i[5]))}return{fov:e,aspect:t}}getXRLayer(){return this.xrLayer}getXRInputCoords(e){let t=e.inputSource.gamepad.axes;return new la(t[0],-t[1])}getNormalizedTouchCoords(e){let t=new la;return t.x=e.touches[0].clientX/window.innerWidth*2-1,t.y=-e.touches[0].clientY/window.innerHeight*2+1,t}setResizeListener(e){this.onResize=e}setTouchListener(e){this.onTouch=e}setTouchStartListener(e){this.onTouchStart=e}setTouchMoveListener(e){this.onTouchMove=e}setTouchEndListener(e){this.onTouchEnd=e}setSessionEndListener(e){this.onSessionEnd=e}setHitTestListener(e){this.onHitTestResult=e}setFrameListener(e){this.onFrame=e}},Ef=class{constructor(){this.eventListeners={},this.eventListenerCount=0}stop(){this.eventListeners={},this.eventListenerCount=0}addEventListener(e,t){this.eventListeners[e]||(this.eventListeners[e]=[]);let i=this.eventListenerCount++;return this.eventListeners[e].push({id:i,func:t}),i}triggerEvent(e,t){this.eventListeners[e]&&this.eventListeners[e].map(i=>i.func(t))}removeEventListener(e){for(let t of Object.keys(this.eventListeners))for(let i=0;i<t.length;i++)if(t[i].id===e){t.splice(i,1);break}}},zf=class{constructor(e,t){this.dbName=e,this.storeName=t}getFromCacheOrFetch(e,t){return lt(this,null,function*(){let i=null;try{i=yield this.getFileFromIndexedDB(e)}catch{console.log("An error occurred while trying to get element from indexedDB.")}return i||(i=yield this.fetchAndCacheFile(t,e)),new Uint8Array(i)})}getFileFromIndexedDB(e){return lt(this,null,function*(){return new Promise((t,i)=>{let s=indexedDB.open(this.dbName);s.onerror=()=>i(s.error),s.onsuccess=()=>{let o=s.result.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);o.onsuccess=()=>t(o.result),o.onerror=()=>i(o.error)},s.onupgradeneeded=o=>{o.target.result.createObjectStore(this.storeName)}})})}saveFileToIndexedDB(e,t){return lt(this,null,function*(){return new Promise((i,s)=>{let o=indexedDB.open(this.dbName);o.onerror=()=>s(o.error),o.onupgradeneeded=r=>{r.target.result.createObjectStore(this.storeName)},o.onsuccess=()=>{try{let r=o.result.transaction(this.storeName,"readwrite"),l=r.objectStore(this.storeName).put(t,e);l.onsuccess=()=>i(l.result),l.onerror=()=>s(l.error)}catch(r){s(r)}}})})}fetchAndCacheFile(e,t){return lt(this,null,function*(){let i=yield fetch(e),s=yield i.arrayBuffer();return yield this.saveFileToIndexedDB(t,s),s})}},zn=class{constructor(e){this.authToken=e,this.deviceManager=new yo,this.indexedDBManager=new zf("onirix-sdk","files"),this.uiManager=new Jf,this.workerManager=new Bf,this.nativeManager=new Uf(this.uiManager,this.deviceManager,this.workerManager,this.indexedDBManager),this.cameraManager=new Af(this.uiManager),this.webXRManager=new Pf(this.uiManager,this.nativeManager,this.deviceManager,this.workerManager),this.imuManager=new Ff(this.uiManager,this.deviceManager),this.eventManager=new Ef}init(e){return lt(this,null,function*(){this.started=!1;let t=this.readConfig(e);this.mode=t.mode,this.debug=t.debug;let i=this.mode==Yt.Spatial||t.cameraAccess;switch(yield this.nativeManager.init(this.authToken,t),t.renderCanvas?(this.uiManager.setRenderCanvas(t.renderCanvas),this.usingProvidedCanvas=!0):(this.uiManager.createRenderCanvas(),this.usingProvidedCanvas=!1),this.mode){case Yt.Surface:let s=yield this.webXRManager.isWebXRSupported();t.disableWorldTracking||!s&&!t.disableWebXR&&t.disableSLAM?(this.surfaceMode=$t.Gyroscope,yield this.imuManager.init(this.onRotation.bind(this),this.onAcceleration.bind(this),this.onHitTestResult.bind(this)),this.imuManager.start()):t.disableWebXR||!s?(this.surfaceMode=$t.SLAM,yield this.imuManager.init(this.onRotation.bind(this),this.onAcceleration.bind(this),this.onHitTestResult.bind(this)),this.imuManager.start()):(this.surfaceMode=$t.WebXR,yield this.webXRManager.init(i,this.onPose.bind(this),()=>this.stop()),this.webXRManager.setTouchListener(this.onTouch.bind(this)),this.webXRManager.setTouchStartListener(this.onTouchStart.bind(this)),this.webXRManager.setTouchMoveListener(this.onTouchMove.bind(this)),this.webXRManager.setTouchEndListener(this.onTouchEnd.bind(this)),this.webXRManager.setSessionEndListener(this.onSessionEnd.bind(this)),this.webXRManager.setHitTestListener(this.onHitTestResult.bind(this)),this.webXRManager.setResizeListener(this.onResize.bind(this)),this.webXRManager.setFrameListener(this.onFrame.bind(this)),this.webXRManager.start(),this.usingWebXR=!0);break;case Yt.Image:case Yt.QRCode:break;case Yt.Spatial:{let o=yield this.webXRManager.isWebXRSupported();t.disableWebXR||!o?(this.surfaceMode=$t.SLAM,yield this.imuManager.init(this.onRotation.bind(this),this.onAcceleration.bind(this),this.onHitTestResult.bind(this)),this.imuManager.start(),this.nativeManager.siftBuffer=this.nativeManager.nativeSDK._malloc(22e5),this.nativeManager.matchBuffer=this.nativeManager.nativeSDK._malloc(14e3),this.nativeManager.netvladBuffer=this.nativeManager.nativeSDK._malloc(32768),this.extractingIdx=1,this.workerManager.replaceCallback("extraction",r=>{let l=this.nativeManager.loadExtractionData(r,this.extractingIdx);this.candidates=Array.from(Array(l).keys()).reverse(),this.siftData=r.extraction,this.matchKeyframes()}),this.workerManager.replaceCallback("matching",r=>{this.nativeManager.loadMatch(r),this.matchKeyframes()})):(this.surfaceMode=$t.WebXR,this.usingWebXR=!0,this.webXRManager.usingSpatial=!0,yield this.webXRManager.init(i,this.onPose.bind(this),()=>this.stop()),this.webXRManager.setTouchListener(this.onTouch.bind(this)),this.webXRManager.setTouchStartListener(this.onTouchStart.bind(this)),this.webXRManager.setTouchMoveListener(this.onTouchMove.bind(this)),this.webXRManager.setTouchEndListener(this.onTouchEnd.bind(this)),this.webXRManager.setSessionEndListener(this.onSessionEnd.bind(this)),this.webXRManager.setHitTestListener(this.onHitTestResult.bind(this)),this.webXRManager.setResizeListener(this.onResize.bind(this)),this.webXRManager.setFrameListener(this.onFrame.bind(this)),this.webXRManager.start(),this.webXRManager.startRelocationTimer())}}if(this.surfaceMode!==$t.WebXR){yield this.cameraManager.startCamera(t.highResolutionCamera),this.uiManager.setTouchListener(this.onTouch.bind(this)),this.uiManager.setTouchStartListener(this.onTouchStart.bind(this)),this.uiManager.setTouchMoveListener(this.onTouchMove.bind(this)),this.uiManager.setTouchEndListener(this.onTouchEnd.bind(this)),this.frameLoop=!0;let s=()=>{this.frameLoop&&(this.onFrame(null),requestAnimationFrame(s))};requestAnimationFrame(s)}return this.onResize(),window.addEventListener("resize",s=>this.onResize()),this.uiManager.renderCanvas})}start(){return lt(this,null,function*(){switch(this.started=!0,this.mode){case Yt.Surface:switch(this.surfaceMode){case $t.Gyroscope:this.imuManager.start();break;case $t.SLAM:this.nativeManager.startSLAM(e=>{this.onPose(e)},this.debug?this.onKeyFrame.bind(this):null,this.onStatusChange.bind(this)),this.processLoop();break;case $t.WebXR:this.webXRManager.start()}break;case Yt.Image:this.nativeManager.startImageTracking(this.onDetected.bind(this),this.onPose.bind(this),this.onLost.bind(this)),this.processLoop();break;case Yt.QRCode:this.nativeManager.startQRCodeTracking(this.onDetected.bind(this),this.onPose.bind(this),this.onLost.bind(this)),this.processLoop();break;case Yt.Spatial:this.nativeManager.startSpatialTracking(this.onDetected.bind(this),this.onPose.bind(this),this.usingWebXR),this.processLoop()}})}stop(){return lt(this,null,function*(){switch(this.mode){case Yt.Surface:switch(this.surfaceMode){case $t.Gyroscope:this.imuManager.stop();break;case $t.SLAM:this.nativeManager.stopSLAM()}break;case Yt.Image:this.nativeManager.stopImageTracking();break;case Yt.QRCode:this.nativeManager.stopQRCodeTracking();break;case Yt.Spatial:this.nativeManager.stopSpatialTracking()}this.started=!1})}matchKeyframes(){if(this.candidates.length>0){let e=this.candidates.pop();this.workerManager.sendDataToWorker("matching",new Iu(e,this.siftData,this.nativeManager.getCandidateData(e),this.nativeManager.extractionType()))}else this.nativeManager.loadKeyframePose(this.extractingIdx),this.extractingIdx++,this.locating=!1}destroy(){return lt(this,null,function*(){this.eventManager.stop(),this.nativeManager.destroy(),this.surfaceMode!==$t.WebXR?this.cameraManager.stopCamera():this.webXRManager.destroy(),this.usingProvidedCanvas||this.uiManager.renderCanvas.remove(),this.frameLoop=!1})}readConfig(e){if(!e)throw new Ar("A config object must be provided.");if(!e.mode)throw new Ar("'mode' is a required parameter.");if(e.mode<=0||e.mode>4)throw new Ar("Selected mode is not a valid tracking mode.");return e.mode==4&&e.sceneOid,Object.assign(ST,e)}onCameraFrame(){if(this.started){let e=this.uiManager.getVideoData();if(e){if(this.mode===Yt.Spatial&&!this.locating&&this.nativeManager.numSLAMKeyframes()>this.extractingIdx&&!this.nativeManager.spatialLocated){this.locating=!0;let i=this.nativeManager.getSLAMKeyframe(this.extractingIdx);this.workerManager.sendDataToWorker("extraction",new yu(i,640,480,0,0,this.nativeManager.extractionType()))}this.nativeManager.processFrame(e)}let t=this.uiManager.getVideoElement();t&&t.requestVideoFrameCallback(this.onCameraFrame.bind(this))}}processLoop(){this.onCameraFrame()}getCameraParameters(){return this.usingWebXR?this.webXRManager.getCameraParameters():this.uiManager.getCameraParameters()}getXRLayer(){return this.usingWebXR?this.webXRManager.getXRLayer():null}getXRParams(){return this.usingWebXR?{xrSession:this.webXRManager.xrSession,xrLocalRefSpace:this.webXRManager.xrLocalRefSpace,xrViewerRefSpace:this.webXRManager.xrViewerRefSpace}:null}getCameraFeed(){return this.uiManager.getVideoElement()}getSurfaceMode(){return this.surfaceMode}addImage(e,t){return lt(this,null,function*(){let i=yield(s=e,new Promise((a,c)=>{let d=new Image;d.crossOrigin="Anonymous",d.addEventListener("load",()=>a(d)),d.addEventListener("error",u=>c(u)),d.src=s}));var s;let o=document.createElement("canvas");o.width=640,o.height=480;let r=o.getContext("2d");r.drawImage(i,0,0);let l=r.getImageData(0,0,640,480).data;this.nativeManager.addImage(t,l)})}onPose(e){this.eventManager.triggerEvent(yn.OnPose,e)}onKeyFrame(){this.eventManager.triggerEvent(yn.OnKeyFrame)}onStatusChange(e){this.eventManager.triggerEvent(yn.OnStatusChange,e)}onDetected(e){this.eventManager.triggerEvent(yn.OnDetected,e)}onLost(e){this.eventManager.triggerEvent(yn.OnLost,e)}onResize(){this.surfaceMode===$t.WebXR?this.webXRManager.fitCanvasToXRViewport():this.uiManager.fitVideoToScreen(),this.eventManager.triggerEvent(yn.OnResize)}onTouch(e){this.eventManager.triggerEvent(yn.OnTouch,e)}onTouchStart(e){this.eventManager.triggerEvent(yn.OnTouchStart,e)}onTouchEnd(e){this.eventManager.triggerEvent(yn.OnTouchEnd,e)}onTouchMove(e){this.eventManager.triggerEvent(yn.OnTouchMove,e)}onSessionEnd(){this.eventManager.triggerEvent(yn.OnSessionEnd)}onHitTestResult(e){this.eventManager.triggerEvent(yn.OnHitTestResult,e)}onAcceleration(e){if((this.mode===Yt.Spatial||this.surfaceMode===$t.SLAM)&&this.started){let t=e;this.uiManager.isPortrait()||(t.x*=-1,t.y*=-1),t.z*=-1;let i=t.toArray().concat(0);this.nativeManager.nativeSDK.HEAPF64.set(i,this.nativeManager.nativeSDK.imuAccData/8),this.nativeManager.nativeSDK._OX_ProcessIMUAcceleration(this.nativeManager.nativeSDK.imuAccData)}}onRotation(e){if(this.surfaceMode===$t.Gyroscope||this.surfaceMode===$t.SLAM&&!this.started){let t=new Pt;t.setRotation(e),this.onPose(t.toArray())}else if(this.mode===Yt.Spatial||this.surfaceMode===$t.SLAM){let t=e;this.uiManager.isPortrait()&&t.multiply(YT),this.nativeManager.nativeSDK.HEAPF64.set(t.toArray(),this.nativeManager.nativeSDK.imuRotData/8),this.nativeManager.nativeSDK._OX_ProcessIMURotation(this.nativeManager.nativeSDK.imuRotData)}}onFrame(e){this.eventManager.triggerEvent(yn.OnFrame,e)}subscribe(e,t){return this.eventManager.addEventListener(e,t)}unsubscribe(e){this.eventManager.removeEventListener(e)}getSLAMMap(){return this.nativeManager.getSLAMMap()}getSLAMTrackingPoints(){return this.nativeManager.getSLAMTrackingPoints()}raycast(e,t,i,s,o,r){return this.nativeManager.raycast(e,t,i,s,o,r)}};zn.TrackingMode=Yt,zn.Events=yn;var Gu=class n{_model;oxSDK=null;_raycaster;_animationMixers;_clock;_envMap;_modelPlaced=!1;_carPlaced=!1;_camera;_renderer;_scene;initSDK(){return lt(this,null,function*(){this.oxSDK=new zn("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjc3MTgzLCJwcm9qZWN0SWQiOjEyNDg0Mywicm9sZSI6MywiaWF0IjoxNzU5NjQ4MjY0fQ.z56P0TKW6TNFDygScXvrvgqfXHdyqB42lhwJojI0pkc");let e={mode:zn.TrackingMode.Surface};return this.oxSDK.init(e)})}init(){return lt(this,null,function*(){this._raycaster=new ru,this._animationMixers=[],this._clock=new ou(!0),this._carPlaced=!1;let e=yield this.initSDK();this.setupRenderer(e),this.oxSDK.subscribe(zn.Events.OnFrame,()=>{let i=this._clock.getDelta();this._animationMixers.forEach(s=>{s.update(i)}),this.render()}),this.oxSDK.subscribe(zn.Events.OnFrame,()=>{this.render()}),this.oxSDK.subscribe(zn.Events.OnPose,i=>{this.updatePose(i)}),this.oxSDK.subscribe(zn.Events.OnResize,()=>{this.onResize()}),this.oxSDK.subscribe(zn.Events.OnHitTestResult,i=>{i&&this._model&&!this._modelPlaced&&(this._model.position.copy(i.position),this._model.position.z=-3,this._scene.add(this._model),this._modelPlaced=!0,this.oxSDK.start())}),new uu().load("/range_rover.glb",i=>{this._model=i.scene,this._model.scale.set(.5,.5,.5)})})}setupRenderer(e){let t=e.width,i=e.height;this._renderer=new Ud({canvas:e,alpha:!0}),this._renderer.setClearColor(0,0),this._renderer.setSize(t,i),this._renderer.outputColorSpace=Kt;let s=this.oxSDK.getCameraParameters();this._camera=new Jt(s.fov,s.aspect,.1,200),this._camera.matrixAutoUpdate=!1,this._scene=new Jd;let o=new iu(13421772,.4);this._scene.add(o);let r=new $d(12303359,4473890);this._scene.add(r)}render(){this._renderer.render(this._scene,this._camera)}updatePose(e){let t=new Ye;t=t.fromArray(e),this._camera.matrix=t,this._camera.matrixWorldNeedsUpdate=!0}onResize(){let e=this._renderer.domElement.width,t=this._renderer.domElement.height,i=this.oxSDK.getCameraParameters();this._camera.fov=i.fov,this._camera.aspect=i.aspect,this._camera.updateProjectionMatrix(),this._renderer.setSize(e,t)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Xu=class n{onirixService=se(Gu);ngOnInit(){this.onirixService.init()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Xc({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){t&1&&Ty(0,"Test")},encapsulation:2})};Gm(Xu,zI).catch(n=>console.error(n));
